
            <li>2023/2024 summer
                <li><a href="https://gitlab.mff.cuni.cz/uradnikf/bc_lec/-/raw/master/2324z/past/main.pdf">Probability and Statistics 2}
\author{Filip Úradník}
\date{\today}

\input{template}
\input{color}
\input{english}

\def\states{\mathcal{S}}
\def\pit#1{\pi^{(#1)}}
\def\r#1#2#3{\fce{r_{#1#2}}{#3}}
\def\attime#1#2{#1^{( #2 )}}
\def\pri#1#2{\fceb{\Pr_{#1}}{#2}}

\begin{document}
\maketitle

\section{Markov chains}

\begin{defi}[Stochastic process]
	A \emph{stochastic process} is a sequence $ X_0, X_1, \dots $ of random variables $ X_i $.
\end{defi}

\begin{defi}[Markov chain]
	A \emph{Markov chain} is a stochastic process $ X_0, X_1, \dots $, such that \begin{enumerate}
		\item $ \left( \forall t \right)\! \left( \rng X_t = \states \mohle \N \right) $,
		\item $ \left( \forall i,j \in \states \right)\! \left( \forall t \geq 0 \right)\! \left( \forall a_0, \dots, a_{t-1} \in \states \right)\! $ \[
			      \pr{X_{t+1} = j \suchthat X_t = i} = p_{ij} = \pr{X_{t+1} = j \suchthat X_t = i, X_{t-1} = a_{t-1}, \dots},
		      \]
		      if the right hand side is defined.
	\end{enumerate}
\end{defi}

The second equation is called the Markov condition.
The formula $ \pr{X_{t+1} = j \suchthat X_t = i} $ is called the \emph{transitional probability}.

\begin{note}[]
	The set $ \states $ can be any set, but we usually say it is the set $ \left\{ 1, \dots, s \right\} $, or $ \N $.
\end{note}

\begin{defi}[Transition matrix]
	A \emph{transition matrix} is the matrix $ P \in \R^{s \times s} $, such that \[
		P_{ij} \deq p_{ij}.
	\]
\end{defi}

\begin{defi}[Transition diagram]
	A \emph{transition diagram} is a digraph $ \left< V,E \right> $, where \begin{enumerate}
		\item $ V = \states $,
		\item $ E = \left\{ \left< i,j \right> \in \states^2 \suchthat p_{ij} \neq 0 \right\} $.
	\end{enumerate}
\end{defi}

\begin{notation}
	We denote the distribution function of $ X_t $ as \[
		\pit t_i \deq \pr{X_t = i}.
	\]
	More generally, \[
		\pit t \deq \left< \pit t_1, \pit t_2, \dots, \pit t_s \right>.
	\]
\end{notation}

\begin{lemma}[]
	\[
		\left( \forall t \geq 0 \right)\! \left( \pit {t+1}_j = \sum_{i \in \states} \pit t_i p_{ij} \right).
	\]
\end{lemma}

\begin{cor}[]
	\[
		\left( \forall t \geq 0 \right)\! \left( \pit {t+1} = \pit t \times P \right).
	\]
\end{cor}

\begin{thm}[]
	$ \left( \forall t \geq 0 \right)\!  $ \begin{enumerate}
		\item $ \pit t = \pit 0 P^t $,
		\item $ \left( \forall k \right)\; \pit {t+k} = \pit t \times P^k $.
	\end{enumerate}
\end{thm}

\begin{notation}
	\[
		\r ijk \deq \pr {X_k = j \suchthat X_0 = i}.
	\]
\end{notation}

\begin{thm}[Chapman, Kolmogorov]
	$ \left( \forall i,j,k,l \geq 0 \right)\!  $
	\begin{enumerate}
		\item $ \r ijk = \left( P^k \right)_{ij} $,
		\item $ \r ij{k+l} = \sum_{l \in \states} \r ilk \r ljk $.
	\end{enumerate}
\end{thm}

\begin{obs}[]
	For a Markov chain $ X $, it holds \[
		\pr{X_t = a_t \suchthat X_{t-1} = a_{t-1} \land X_{t-100} = a_{t-100}} = P_{a_{t-1}a_t}.
	\]
\end{obs}

\begin{thm}[]
	Let $ X $ be a Markov chain.
	Let $ H $ be a function of $ X_{t-1}, \dots, X_0 $, and $ F $ a function of $ X_{t+1}, \dots $.
	Then \[
		\pr{F \suchthat X_t=i \land P} = \pr{F \suchthat X_t = i}.
	\]
\end{thm}

\begin{defi}[Accessibility]
	$ j $ is \emph{accessible} from $ i $, $ i \to j $, for $ i,j \in \states $ $ \equiv $ \[
		\left( \exists t \geq 0 \right)\! \left( \r ijt > 0 \right).
	\]
\end{defi}

\begin{defi}[Commuting states]
	States $ i,j $ \emph{commute}, $ i \leftrightarrow j $ $ \equiv $ \[
		i \to j \land j \to i.
	\]
\end{defi}

\begin{obs}[]
	$ \leftrightarrow $ is an equivalence.
\end{obs}

\begin{defi}[Communiting class]
	Communiting classes are the classes of equivalence of $ \leftrightarrow $.
	We further define: \begin{enumerate}
		\item A communicating class $ C $ is \emph{closed} $ \equiv $ $ \left( i \in C \land i \to j \right) \implies j \in C $.
		\item $ i $ is an \emph{absorbing state} $ \equiv $ $ \left\{ i \right\} $ is a closed communicating class.
		\item A Markov chain is \emph{irreducible} $ \equiv $ the number of its communicating classes is 1.
	\end{enumerate}
\end{defi}

\begin{defi}[Return probability]
	\emph{Return probability} is \[
		f_{ij} \deq \pr{\left( \exists t \geq 1 \right)\! \left( X_t = j \right) \suchthat X_0 = i}.
	\]
	From this, we define \[
		T_{ij} \deq \fcec \min{t > 0:\ X_t = j \suchthat X_0 = i}.
	\]
	Then we say that $ i $ is \begin{enumerate}
		\item \emph{recurrent/persistent} $ \equiv $ $ f_{ii} = 1 $,
		\item \emph{transient} $ \equiv $ $ f_ii <1 $.
	\end{enumerate}
\end{defi}

\begin{thm}[]
	$ i $ is recurrent, if and only if \[
		\sum_{n=1}^{\infty} \r iin = \infty.
	\]
\end{thm}

\begin{defi}[Stationary distribution]
	$ \pi $ is a \emph{stationary distribution} of a Markov chain $ X $ $ \equiv $ \begin{enumerate}
		\item $ \pi $ is a distribution,
		\item $ \pi P = \pi $.
	\end{enumerate}
\end{defi}

\begin{obs}[]
	\[
		\attime \pi 0 = \pi \;\implies\; \left( \forall i \right)\; \attime \pi i = \pi.
	\]
\end{obs}

\begin{obs}[]
	Limit distribution must be stationary.
\end{obs}

\begin{thm}[]
	Let $ X $ be a finite, irreducible, aperiodic Markov chain.
	Then \begin{enumerate}
		\item $ \exists !\pi $ stationary distribution,
		\item $ P^n \to \pi $.
	\end{enumerate}
\end{thm}

\begin{note}[Usage of the previous theorem]
	\
	\begin{enumerate}
		\item Study long-term behaviour of a MC.
		\item Create a MC to sample from a distribution (MCMC: MC Monte-Carlo).
	\end{enumerate}
\end{note}

\begin{notation}
	\[
		\pri i\varphi \deq \pr{\varphi \suchthat X_0 = i}.
	\]
\end{notation}

\begin{thm}[]
	Suppose $ X $ is a MC with absorbing state $ f $.
	Let us define \begin{equation}
		a_i \deq \pri i{\left( \exists t \right)\! \left( X_t = f \right)} \quad \left( \forall i \right)\!
	\end{equation}
	Then $ \left< a_i \right>_i $ are unique, defined as \[
		a_i = \begin{cases}
			1                   & i = f,                                     \\
			0                   & i \neq f, i\text{ is an absorbing state, } \\
			\sum_{j} a_j p_{ij} & \text{ otherwise. }
		\end{cases}
	\]
\end{thm}

\begin{thm}[]
	Suppose $ X $ is a Markov chain, $ S \supseteq A $ are absorbing states.
	Let us define \begin{align*}
		T     & \deq \left\{ \fceb \min {t \suchthat X_t \in A} \right\},
		\mu   & \deq \E T,
		\mu_i & \deq \fce E{T \suchthat X_0 = i}.
	\end{align*}
	Then \[
		\left( \forall a \in A \right)\! \left( \mu_a = 0 \right) , \qquad \left( \forall i \notin A \right)\! \left( \mu_i = 1+ \sum_j p_{ij}\mu_j \right).
	\]
\end{thm}

\begin{examp}[Gambler's run problem]

\end{examp}

\section{SAT}

\begin{algo}[2-SAT]\ \\
	\AlgIn $ \varphi $ in the 2-SAT form, with $ n $ variables, $ m $.
	\begin{algorithmic}[1]
		\State $ x \gets x \randin \left\{ 0,1 \right\}^n $
		\Indent Loop up to $ mn^2 $-times:
		\State If $ x \models \varphi $, return \textit{yes}.
		\State Find an unsatisfied clause.
		\State Pick its variable randomly.
		\State Flip the value of the chosen variable.
		\EndIndent
		\State Return \textit{no}.
	\end{algorithmic}
	\AlgOut \textit{yes} or \textit{no}, whether or not $ \varphi $ is satisfiable.
\end{algo}

\begin{thm}[]
	\[
		\pr{\varphi \text{ is satisfiable} \suchthat \textit{yes}} = 1, \qquad \pr{\textit{yes} \suchthat \varphi \text{ is satisfiable}} \geq 1 - 2^{-m}.
	\]
\end{thm}


\end{document                </a></li>

<li><a href="https://gitlab.mff.cuni.cz/uradnikf/bc_lec/-/raw/master/2324z/lingebra/main.pdf">Lineární algebra 3}
\author{Filip Úradník}
\date{\today}

\input{template}
\input{color}
\input{czech}

\def\slp#1{\fce {\mathcal{S}}{#1}}
\def\rdk#1{\fce {\mathcal{R}}{#1}}
\def\ker#1{\fce \Ker{#1}}
\def\pinv#1{{#1}^\dag}
\def\mr#1#2{\R^{#1 \times #2}}
\def\I#1{I_{#1}}

\begin{document}
\maketitle

\section{SVD rozklad}

\begin{thm}[SVD rozklad]
	Nechť $ A \in \R^{m \times n}, q \deq \fce \min{m,n} $. Pak existuje $ \Sigma \in \R^{m \times n} $ diagonální, s prvky $ \sigma_{11} \geq \dots \geq \sigma_{qq} \geq 0 $, a ortogonální $ U \in \R^{m \times m}, V \in \R^{n \times n} $, tž. \[
		A = U \Sigma \trans V.
	\]
\end{thm}

\begin{defi}[]
	Číslům $ \sigma_{ii} $ říkáme \emph{singulární čísla} a maticím $ U, \Sigma, V $ \emph{SVD rozklad} matice $ A $.
\end{defi}

\begin{defi}[Redukovaný SVD rozklad]
	\emph{Redukovaný SVD rozklad} jsou matice $ U_1, S, V_1 $, tž. \[
		A = U \Sigma \trans V = \begin{pmatrix}
			U_1 & U_2
		\end{pmatrix}
		\begin{pmatrix}
			S & 0 \\
			0 & 0 \\
		\end{pmatrix}
		\begin{pmatrix}
			\trans V_1 \\
			\trans V_2
		\end{pmatrix}
		= U_1 S \trans V_1.
	\]
\end{defi}

\begin{thm}[Singulární a vlastní čísla]
	Nechť $ A \in \R^{m \times n} $ a $ \sigma_1 \geq \dots \geq \sigma_q \geq 0 $ jsou singulární čísla matice $ A \times \trans A $.
	Pak platí \[
		\left( \forall i \in \left\{ 1, \dots, r \right\} \right)\! \left( \sigma_i = \sqrt {\lambda_i} \right).
	\]
\end{thm}

\begin{thm}[Singulární a vlastní čísla II]
	Nechť $ A \in \R^{m \times n} $.
	Singulární čísla $ A $ jsou $ \sigma_1, \dots, \sigma_r $, právě když nenulová vlastní čísla matice \[
		\begin{pmatrix}
			0        & A \\
			\trans A & 0
		\end{pmatrix}
	\]
	jsou $\sigma_1, \dots, \sigma_r, -\sigma_1, \dots, -\sigma_r$ .
\end{thm}


\begin{thm}[]
	Nechť $ A = U \Sigma \trans V = U_1 S \trans V_1 $ je SVD rozklad matice $ A \in \R^{m \times n} $.
	Pak \begin{enumerate}
		\item sloupce $ U_1 $ tvoří ortonormální bázi $ \slp A $,
		\item sloupce $ U_2 $ tvoří ortonormální bázi $ \ker {\trans A} $,
		\item sloupce $ V_1 $ tvoří ortonormální bázi $ \rdk A $,
		\item sloupce $ V_2 $ tvoří ortonormální bázi $ \ker A $.
	\end{enumerate}
\end{thm}

\begin{thm}[]
	Nechť $ A = U \Sigma \trans V = U_1 S \trans V_1 $ je SVD rozklad matice $ A \in \R^{m \times n} $.
	Pak matice projekce do \begin{enumerate}
		\item $ \slp A $ je $ U_1 \trans U_1 $,
		\item $ \rdk A $ je $ V_1 \trans V_1 $.
	\end{enumerate}
\end{thm}

\begin{prop}[]
	SVD rozklad se hodí na aproximaci matice $ A $, a na kompresi dat.
\end{prop}

\section{Pseudoinverzní matice}

\begin{defi}[Mooreova-Penroseova pseudoinverze]
	Nechť $ A \in \R^{m \times n} $ má SVD rozklad $ A = U_1 S \trans V_1 $.
	Pak její \emph{pseudoinverze} je $ \pinv A \deq V_1 S^{-1} \trans U_1 $.
\end{defi}

\begin{thm}[Vlastnosti pseudoinverze]
	Nechť $ A \in \mr mn $. Pak \begin{enumerate}
		\item je-li $ A $ regulární, pak $ A^{-1} = \pinv A $,
		\item $ \pinv {\left( \pinv A \right)} = A $,
		\item $ \pinv {\left( \trans A \right)} = \trans {\left( \pinv A \right)} $,
		\item $ A = A \pinv AA $, \label{pi vl penrose start}
		\item $ \pinv A = \pinv AA \pinv A $.
		\item $ A\pinv A $ je symetrická,
		\item $ \pinv AA $ je symetrická, \label{pi vl penrose end}
		\item má-li $ A $ lineárně nezávislé sloupce, pak $ \pinv A = \left( \trans AA \right)^{-1} \trans A $,
		\item má-li $ A $ lineárně nezávislé řádky, pak $ \pinv A = \trans A \left( A \trans A \right)^{-1} $.
	\end{enumerate}
\end{thm}

\begin{note}[]
	(\ref{pi vl penrose start}) až (\ref{pi vl penrose end}) byly původní axiomatickou definicí Penrose.
\end{note}

\begin{thm}[]
	Buď $ A \in \mr mn $. Pak matice projekce do \begin{enumerate}
		\item $ \Colsp A $ je $ A \pinv A $, \label{pi projekce moore}
		\item $ \Rowsp A $ je $ \pinv AA $,
		\item $ \ker A $ je $ \I n - \pinv AA $.
	\end{enumerate}
\end{thm}

\begin{note}[]
	Moore zkoumal (\ref{pi projekce moore}), což vedlo jeho k objevení pseudoinverze.
\end{note}

\begin{thm}[Pseudoinverze a zobrazení]
	Nechť $ \fce fx = Ax $, kde $ A \in \mr mn $.
	\begin{enumerate}
		\item $ \restrict f{\Rowsp A} $ je isomorfismus mezi $ \Rowsp A $ a $ \fceb f{\R^n} $.
		\item Zobrazení $(f{\Rowsp A})^{-1}$ je $ y \mapsto \pinv Ay $.
	\end{enumerate}
\end{thm}

\begin{thm}[Pseudoinverze a řešení soustav rovnic]
	Nechť $ A \in \mr mn, b \in \R^m $ a $ X \neq \emptyset $ je množina řešení $ Ax = b $.
	Pak \[
		X = \pinv Ab + \ker A = \pinv Ab + \Colsp{\I n - \pinv AA}.
	\]
	Navíc, $ \pinv Ab $ má ze všech řešení nejmenší eukleidovskou normu.
\end{thm}

\begin{thm}[Pseudoinverze a metoda nejmenších čtverců]
	Nechť $ A \in \mr mn, b \in \R^m $ a $ X $ je množina přibližných řešení $ Ax = b $ pomocí metody nejmenších čtverců.
	Pak \[
		X = \pinv Ab + \ker A = \pinv Ab + \Colsp{\I n - \pinv AA}.
	\]
	Navíc, $ \pinv Ab $ má ze všech řešení nejmenší eukleidovskou normu.
\end{thm}

\begin{defi}[Drazinova pseudoinverze]
	Nechť $ A \in \mr nn $, tž. $ A = SJS^{-1} $, kde $ J $ je Jordanova normální forma $ A $ ve tvaru \[
		J = \begin{pmatrix}
			C & 0 \\
			0 & N
		\end{pmatrix},
	\]
	kde $ C $ je regulární a $ N $ obsahuje Jordanovy buňky pro nulová vlastní čísla.
	Pak Drazinova pseudoinverze je $ A^D = S \left( \begin{smallmatrix} C^{-1}&0\\0&0 \end{smallmatrix} \right)S^{-1} $.
\end{defi}

\begin{thm}[Vlastnosti Drazinovy pseudoinverze]
	Nechť $ A \in \mr mn $. Pak
	\begin{enumerate}
		\item je-li $ A $ regulární, pak $ A^{-1} = \pinv A $,
		\item $ A^DAA^D = A^D $,
		\item $ AA^D = A^DA $,
		\item $ A^{k+1}A^D = A^k $, kde $ k $ je nejmenší takové, že $ \rank A^{k+1} = \rank A^k $.
	\end{enumerate}
\end{thm}

\begin{examp}[Maticová grupa]
	Nechť $ S \in \mr nn $ je pevná a regulární, $ k < n $.
	Definujeme $ \mathcal{G} $ množinu všech matic z $ \mr nn $ tvaru $ S \left( \begin{smallmatrix} C&0\\0&0 \end{smallmatrix} \right) S^{-1} $, kde $ C \in \mr kk $ je regulární.
	Pak $ \mathcal{G} $ tvoří grupu s násobením, invers k $ A $ je $ A^D $.
\end{examp}



\end{document                </a></li>

<li><a href="https://gitlab.mff.cuni.cz/uradnikf/bc_lec/-/raw/master/2324z/introml/main.pdf">Introduction to Machine Learning}
\author{Filip Úradník}
\date{\today}

\input{template}
\input{color}
\input{english}

\def\trset{\vec X}
\DeclareMathOperator{\mse}{MSE}
\DeclareMathOperator{\sign}{sign}
\def\td#1#2{\nabla_{\vec {#1}}\, {#2}}
\def\ftd#1#2#3{\fce{\td{#1}{#2}}{#3}}
\def\I{\vec I}
\def\trans#1{{#1}^\top}
\def\vtrans#1{\trans{\vec{#1}}}
\def\rv#1{\text{#1}}
\def\vrv#1{\vec{\rv{#1}}}
\def\inf#1{\fce I{#1}}
\def\infr#1{\fce I{\rand{#1}}}
\def\ent#1{\fce H{#1}}
\def\entr#1{\fce H{\rand{#1}}}
\def\cent#1#2{\ent{#1, #2}}
\def\dkl#1#2{\fce{D_{\text{KL}}}{#1\|#2}}
\def\normp#1#2#3{\fce{\mathcal{N}}{#3\supposing #1, #2}}
\def\normd#1#2{\fce{\mathcal{N}}{#1, #2}}

\def\pdi#1{p_{\text{#1}}}
\def\epdi#1{\hat p_{\text{#1}}}
\def\pdif#1#2{\fce{\pdi{#1}}{#2}}
\def\epdif#1#2{\fce{\epdi{#1}}{#2}}
\def\ptrd{\hat p_{\text{data}}}

\begin{document}
\maketitle

\begin{defi}[Learning]
	A computer program is said to learn from experience $E$ with respect to some class of tasks $T$ and performance measure $P$, if its performance at tasks in $T$,
	as measured by $P$, improves with experience $E$.
\end{defi}

\begin{defi}[Learning based on $ E $]
	\
	\begin{enumerate}
		\item \emph{Supervised learning} $ \equiv $ we know exactly what we want the output to be.
		\item \emph{Unsupervised learning} $ \equiv $ we only have raw data, goals include looking for patterns, outliers, etc.
		\item \emph{Reinforcement learning} $ \equiv $ we have a reward function, which we want to maximize.
	\end{enumerate}

\end{defi}


\begin{defi}[Basic ML Settings]
	We assume an input $ \vec x \in \R^D $, where $ D $ is the number of features.
	Then, our goal can be \begin{enumerate}
		\item \emph{regression} $ \equiv $ we're predicting a target value $ t \in \R $ for a given $ \vec x $,
		\item \emph{classification} $ \equiv $ we're choosing a class $ t \in \left\{ 0, 1, \dots, K \right\} $.
	\end{enumerate}
\end{defi}

Classification can be further divided by whether we want to predict the best class, or a distribution over all classes.

\section{Linear Regression}

\begin{defi}[Linear Regression]
	Given an input $ \vec x \in \R^D $, we want to predict a value using \[
		\fce y{\vec x \supposing \vec w, b} \deq \vec x^T\vec w + b,
	\]
	where $ \vec w \in \R^D $ is a vector of weights and $ b \in \R $ is a bias.
\end{defi}

\begin{note}[]
	We usually add a constant feature $ x_0 = 1 $, so that we can write $ \vec x^T\vec w + b $ as $ \vec x^T\vec w $.
\end{note}

\begin{defi}[MSE]
	A \emph{mean square error} is a popular error function with many nice properties, defined as \[
		\fce \mse {\vec w}\deq \frac 1N \sum_{i=1}^N \left( \fce y{\vec x_i \supposing \vec w} - t_i \right)^2.
	\]
\end{defi}

\begin{note}
	Often, the so-called \emph{sum of squares} is used instead: \[
		\fce \mse {\vec w}\deq \frac 12 \sum_{i=1}^N \left( \fce y{\vec x_i \supposing \vec w} - t_i \right)^2 = \frac 12 \aabsolute{ \vec X \vec w - \vec t }^2.
	\]
	Minimizing it is equal to minimizing the MSE, but the derivative is nicer.
\end{note}

\begin{thm}[Fermat]
	Let $ \vec f: \R^D \to \R $ be a function. If $ \vec x $ is a minimum or a maximum of $ \vec f $, and $ \left( \forall i \right)\; \frac{\partial f}{\partial x_i} $ exists,
	then $ \left( \forall i \right)\; \frac{\partial f}{\partial x_i} = 0 $, i.e. $ \td xf = \vec 0 $.
\end{thm}

\begin{thm}[]
	If the matrix $ \trset^T\trset $ is invertible, then the minimum of $ \mse $ is achieved at \[
		\vec w = \left( \trset^T\trset \right)^{-1}\trset^T\vec t.
	\]
\end{thm}

\begin{algo}[Linear Regression Learning]\ \\
	\AlgIn $ \trset \in \R^{N \times D}, \vec t \in \R^N $.
	\begin{algorithmic}[1]
		\State $ \vec w \gets \left( \trset^T\trset \right)^{-1}\trset^T\vec t $
	\end{algorithmic}
	\AlgOut Weights $ \vec w \in \R^D $ minimising $ \mse $.
\end{algo}

\begin{defi}[Capacity]
	A model's \emph{capacity} is its ability to hold information. It can be \begin{enumerate}
		\item \emph{representational} -- the physical ability to hold information,
		\item \emph{effective} -- based on the choice of hyper-parameters.
	\end{enumerate}
\end{defi}

\begin{defi}[Regularization]
	\emph{Regularization} is a part of the model definition designed to reduce \emph{generalization error}.
\end{defi}

\begin{defi}[$ L^2 $-regularization]
	\emph{$ L^2 $-regularization} is a regularization technique which forces the model to choose smaller weights.
	It implies the following error function: \[
		\frac 12 \sum_{i=1}^N \left( \fce y{\vec x_i \supposing \vec w} - t_i \right)^2 + \frac \lambda 2 \norm w^2.
	\]
\end{defi}

\begin{defi}[Hyperparameters]
	A \emph{hyperparameter} is a parameter chosen outside of the learning.
\end{defi}


\begin{note}[]
	$ L^2 $-regularization is usually not applied to the bias, only the proper weights, as you cannot really overfit the bias.
\end{note}

\begin{algo}[Linear Regression Learning with $ L^2 $-regularization]\ \\
	\AlgIn $ \trset \in \R^{N \times D}, \vec t \in \R^N, \lambda \in \R^+_0$.
	\begin{algorithmic}[1]
		\State $ \vec w \gets \left( \trans \trset \trset + \lambda \I \right)^{-1}\trset^T\vec t $
	\end{algorithmic}
	\AlgOut Weights $ \vec w \in \R^D $ minimising $ \mse $ with $ L^2 $-regularization.
\end{algo}

\begin{note}[]
	Assuming $ \lambda > 0 $, $ \trans \trset \trset + \lambda \I $ is positive definite, ie. it is always regular.
\end{note}

\begin{defi}[Gradient Descent]
	\emph{Gradient descent} is an approach for searching for weights minimizing some $ \fce E{\vec w} $ in an iterative manner, by \[
		\vec w \gets \vec w - \alpha \ftd wE{\vec w},
	\]
	where $ \alpha $ is a \emph{learning rate}.
\end{defi}

\begin{defi}[Variants of GD]
	Let $ \trset \in \R^{N \times D}, \vec t \in \R^N$ and \[
		\fce \ptrd{\vec x, t} \deq \frac{\absolute{\left\{ i \suchthat \left< \vec x, t \right> = \left< \vec x_i, t \right> \right\}}}{N}.
	\]
	Further, assume an error function \[
		\fce E{\vec w} \deq \E_{\left< \vec x, t \right> \sim \ptrd} \fce L{\fce y{\vec x \supposing \vec w}, t} \text{, such that } \ftd {\vec w}E{\vec w} = \E_{\left< \vec x, t \right> \sim \ptrd}
		\ftd {\vec w}L{\fce y{\vec x \supposing \vec w}, t}.
	\]
	We define \begin{enumerate}
		\item \emph{Standard Gradient Descent} as using all training data to compute $ \td {\vec w}E $,
		\item \emph{Stochastic Gradient Descent} as using a single training example to compute $ \td {\vec w}E $,
		\item \emph{Mini-batch Gradient Descent} as using a subset of $ B $ training examples to approximate $ \td {\vec w}E $.
	\end{enumerate}
\end{defi}

\begin{thm}[]
	If $ L $ is convex and continuous, then any SGD variant converges to the global minimum with probability 1.
\end{thm}

\begin{defi}[LR using SGD]
	When solving Linear Regression using SGD, we use one half of MSE as the loss function: \[
		\fce E{\vec w} = \fceb{\E_{\left< \vec x, t \right> \sim \ptrd}}{\frac 12 \left( \fce y{\vec x \supposing \vec w} - t \right)^2} + \frac \lambda 2 \norm{\vec w}^2.
	\]
\end{defi}

\begin{algo}[LR using SGD]\ \\
	\AlgIn $ \trset \in \R^{N \times D}, \vec t \in \R^N, \lambda \in \R^+_0, \alpha \in \R^+_0, B $.
	\begin{algorithmic}[1]
		\State $ \vec w \gets \vec 0 $
		\Indent Iterate until convergence:
		\State Sample a minibatch $ \vec b $ of size $ B $.
		\State $ \vec w \gets \vec w - \alpha \frac 1B \sum_{\left< \vec x, t \right> \in \vec b} \left( \vtrans x \vec w - t \right) \vec x - \alpha \lambda \vec w $.
		\EndIndent
	\end{algorithmic}
	\AlgOut Weights $ \vec w \in \R^D $ minimising $ \mse $ with $ L^2 $-regularization.
\end{algo}

\begin{defi}[Feature Engineering]
	\emph{Feature engineering} is a process of editing the input data to improve the model's performance.
	Commonly used features are \begin{enumerate}
		\item \emph{polynomial features} -- add $ x_{*i}^2, x_{*i}^3, \dots $, so the model can use non-linear functions,
		\item \emph{categorical one-hot features} -- if we have a categorical feature with $ K $ possible values, we can add $ K $ features, each of which is 1 if the original feature is equal to the value, and 0 otherwise,
		\item \emph{feature normalization} -- replace the feature by \[
			      x'_{ij} \deq \frac{x_{ij} - \min_k x_{kj}}{\max_k x_{kj} - \min_k x_{kj}},
		      \]
		\item \emph{feature standardization} -- replace the feature by \[
			      x'_{ij} \deq \frac{x_{ij} - \mu_j}{\sigma_j},
		      \]
		      where $ \mu_j $ is the mean and $ \sigma_j $ is the standard deviation of the $ j $-th feature.
	\end{enumerate}

\end{defi}

\section{Binary Classification}

\begin{defi}[Binary classification]
	A \emph{binary classification} is classification into two classes.
\end{defi}

\begin{defi}[Accuracy]
	\emph{Accuracy} is the fraction of correctly classified examples, out of all samples.
\end{defi}

To use linear regression for binary classification, we can find a \emph{treshold}, such that values below it are classified as 0, and values above it are classified as 1.
It actually suffices to choose $ 0 $ as the treshold, because bias already acts as a trainable treshold parameter.
The set of points with $ \fce y{\vec x, \vec w} = 0 $ is called the \emph{decision boundary}.
The \emph{Pecreptron algorithm} is trying to learn weights $ \vec w $, such that, for target $ t_i \in \left\{ -1, 1 \right\}$ of $ \vec x_i \in \Rm D $ \[
	\fce \sign{\fce y{\vec x_i\supposing \vec w}} = t_i.
\]

\begin{defi}[Linearly separable set]
	A dataset $ \mat X $ is \emph{linearly separable} $ \equiv  $ \[
		\left( \exists \vec w \right)\! \left( \forall i \right)\! \left( t_i \matii Xi* \vec w > 0 \right).
	\]
\end{defi}


\begin{algo}[Perceptron]\ \\
	\AlgIn $ \mat X \in \Rmm ND, \vec t \in \left\{ -1, +1 \right\}^N $.
	\begin{algorithmic}[1]
		\State $ \vec w \gets \vec 0 $
		\Indent While $ \left( \exists i \right)\! \left( t_i\matii Xi* \vec w \leq 0 \right) $:
		\State $ \vec w \gets \vec w + t_i \matii Xi* $
		\EndIndent
	\end{algorithmic}
	\AlgOut Weights $ \vec w \in \R^D $.
\end{algo}

\begin{thm}[]
	After each step, the angle between the optimal weights and current weights decreases like \[
		\cos \alpha_k \geq \frac{k\gamma}{\sqrt{kR^2}\norm{\veci w*}}.
	\]
	As a consequence, if $ \mat X $ is linearly separable, then the Perceptron algorithm converges in at most $ \frac{R^2}{\gamma^2} $ steps.
\end{thm}

\begin{prop}[Issues of Perceptron]
	\
	\begin{enumerate}
		\item If the input is not linearly separable, the algorithm does not converge.
		\item The algorithm cannot return probabilities of belonging to a class.
		\item The solution found by Perceptron isn't necessairly the best one, it can be closer to one class.
	\end{enumerate}
\end{prop}

\section{Probability Preliminaries}

\begin{defi}[Bernoulli Distribution]
	A random variable $ \rand X $ has a \emph{Bernoulli distribution} with parameter $ p \in \left[ 0, 1 \right] $ $ \equiv  $ \[
		\pr{\rand X = 1} = p, \qquad \pr{\rand X = 0} = 1-p.
	\]
\end{defi}

\begin{defi}[Categorical Distribution]
	A \emph{Categorical distribution} is a generalization of the Bernoulli distribution to $ K $ classes.
\end{defi}

\begin{defi}[Self Information]
	\emph{Self information} quantifies the surprise that an event $ A $ occured.
	It is defined as \[
		\inf A \deq -\log \pr A.
	\]
\end{defi}

\begin{defi}[Entropy]
	\emph{Entropy} of distribution $ P $ is the amount of surprise in the whole distribution. For a discrete distribution $ P $, it is \[
		\entr P \deq \E_{\rand x \sim P}\infr x = -\E_{\rand x \sim P} \log \fce P{\rand x}.
	\]
\end{defi}

\begin{note}
	We consider $ \pr{A}\log \pr{A} = 0 $.
\end{note}

\begin{note}[]
	Entropy is measured in \emph{bits} for binary logs, but as we're using natural logs, ours is measured in \emph{nats}.
\end{note}

\begin{defi}[Cross Entropy]
	\emph{Cross entropy} is a measure of how different two distributions $ P $ and $ Q $ are. For discrete $ P,Q $, it is \[
		\cent P Q \deq -\E_{\rand x \sim P} \log \fce Q{\rand x}.
	\]
\end{defi}

\begin{thm}[Gibbs Inequality]
	Let $ P,Q $ be probability distributions.
	\begin{enumerate}
		\item $ \cent P Q \geq \entr P $,
		\item $ \cent P Q = \entr P \iff P = Q $.
	\end{enumerate}
\end{thm}

\begin{defi}[Relative Entropy]
	\emph{Relative entropy}, or Kullback-Leiber divergence, is \[
		\dkl PQ \deq \cent PQ - \ent P.
	\]
\end{defi}

\begin{note}[]
	Generally, \[
		\dkl PQ \neq \dkl QP.
	\]
\end{note}

\begin{defi}[Normal Distribution]
	A \emph{normal distribution} is given by its probability density function \[
		\normp \mu {\sigma^2}x = \sqrt{\frac 1{2\pi\sigma^2}}\fce\exp{-\frac{\left( x-\mu \right)^2}{2\sigma^2}}.
	\]
\end{defi}

\begin{thm}[Central Limit]
	The sum of iid rvs with finite variance converges to a normal distribution.
\end{thm}

\begin{thm}[Principle of Maximum Entropy]
	Given a set of constraints, a distribution with maximal entropy fulfilling the constraints can be considered the most general one, containing as little additional assumptions as possible.
\end{thm}

\begin{thm}[]
	Considering distributions with a mean and variance, such a distribution is the normal distribution.
\end{thm}

\section{Maximum Likelihood Estimation}

\begin{defi}[Empirical data distribution]
	Let $ \mat X $ be the training data, drawn independently from a distribution $ \pdi {data} $.
	Then the \emph{empirical data distribution} is $ \epdi{data} $, where \[
		\epdif{data}{\vec x} \deq \frac{\absolute{\left\{ i \suchthat \veci xi = \vec x \right\}}}{N}.
	\]
\end{defi}

\begin{defi}[Model distributions]
	We denote $ \pdif{model}{\vec x \supposing \vec w} $ a family of distribution, where for fixed $ \vec w $, $ \pdif{model}{\vec x \supposing \vec w} $ is a distribution.
\end{defi}

\begin{defi}[Likelihood]
	For fixed $ \mat X $, we get the \emph{likelihood of weights $ \vec w $}, denoted \[
		\fce L{\vec w} \deq \pdif{model}{\mat X \supposing \vec w} \deq \prod_{i=1}^N \pdif{model}{\vec x_i \supposing \vec w}.
	\]
\end{defi}

\begin{prop}[]
	When maximizing $ \fce L{\vec w} $, we want \begin{align*}
		\vec w^* & = \argmax_{\vec w} \pdif{model}{\mat X \supposing \vec w}                                \\
		         & = \argmin_{\vec w} \sum_i -\log \pdif{model}{\vec x_i \supposing \vec w}                 \\
		         & = \argmin_{\vec w} \dkl{\epdif{data}{\mat X}\!}{\pdif{model}{\mat X \supposing \vec w}}.
	\end{align*}
\end{prop}

\begin{prop}[]
	The previous approach can be generalized to finding $ t $ given $ \vec x $.
	\begin{align*}
		\vec w^* & = \argmax_{\vec w} \pdif{model}{\vec t \suchthat \mat X \supposing \vec w}                                               \\
		         & = \argmin_{\vec w} \sum_i -\log \pdif{model}{t_i \suchthat \vec x_i \supposing \vec w}                                   \\
		         & = \argmin_{\vec w} \dkl{\epdif{data}{\vec t \suchthat\mat X}\!}{\pdif{model}{\vec t \suchthat\mat X \supposing \vec w}}.
	\end{align*}
\end{prop}

\begin{defi}[Sigmoid function]
	The \emph{sigmoid function} is \[
		\fce \sigma x = \frac 1{1+e^{-x}}.
	\]
\end{defi}

\begin{defi}[Logistic regression]
	\emph{Logistic regression} is an extension of perceptron, which models conditional probabilities \[
		\fce p{C_0 \suchthat \vec x}, \qquad \fce p{C_1 \suchthat \vec x}.
	\]
\end{defi}

\begin{prop}[]
	Sigmoid has values in range $ \left( 0,1 \right) $, is monotonically increasing, and has a derivative of $ \tfrac 14 $ at $ x = 0 $.
\end{prop}

\begin{notation}
	In Logistic regression, we denote $ \hat y $ the linear part, and $ y $ the overall prediction: \[
		\fce{\hat y}{\vec x \supposing \vec w} = \vtrans xw, \qquad \fce y{\vec x \supposing \vec w} = \fce \sigma{\fce{\hat y}{\vec x \supposing \vec w}}.
	\]
\end{notation}

\begin{algo}[Logistic Regression using SGD]\ \\
	\AlgIn $ \mat X \in \Rmm ND, \vec t \in \left\{ 0,1 \right\}^N $, learning rate $ \alpha \in \R^+ $.
	\begin{algorithmic}[1]
		\State $ \vec w \gets \vec 0 $,
		\Indent Iterate until convergence:
		\State $ \vec b \gets $ Choose the next batch according to batch policy.
		\State $ \vec g \gets \frac 1{\absolute{\vec b}} \sum_{i \in \vec b} \ftd w{\log p}{C_{t_i} \suchthat \vec x_i \supposing \vec w} $
		\EndIndent
	\end{algorithmic}
	\AlgOut Weights $ \vec w $.
\end{algo}

\begin{note}[]
	In the above algorithm, for $ \absolute{\vec C} = 2 $, $ \fce p{C_1\suchthat \vec x_i \supposing \vec w} = \fce y{\vec x \supposing \vec w} $.
\end{note}

\begin{prop}[]
	$ L^2 $-regularization can be used with Logistic Regression.
\end{prop}

\end{document                </a></li>

<li><a href="https://gitlab.mff.cuni.cz/uradnikf/bc_lec/-/raw/master/2324z/ga/main.pdf">Graph Algorithms}
\author{Filip Úradník}
\date{\today}

\input{template}
\input{color}
\input{english}

\def\path#1#2{\fce {\mathcal{P}} {#1 \to #2}}
\def\edgeconn#1{\fce{\kappa}{#1}}
\def\edgeconnv#1#2#3{\fce{\kappa}{#1, #2, #3}}
\def\vertexconn#1{\fce{\lambda}{#1}}
\def\vertexconnv#1#2#3{\fce{\lambda}{#1, #2, #3}}
\def\contract{\slash}

\begin{document}
\maketitle

\begin{defi}[Basic assumptions]
	\
	\begin{itemize}
		\item $ n \in \fce \O m $, i.e. graphs are always connected unless stated otherwise.
	\end{itemize}
\end{defi}

\begin{notation}[My extra stuff]
	\
	\begin{itemize}
		\item $ \fce \delta v \deq \left\{ e \suchthat v \in e \right\} $,
		\item $ \fce {\delta^+} v \deq \left\{ uv \suchthat uv \in E \right\} $,
		\item $ \fce {\delta^-} v \deq \left\{ vu \suchthat uv \in E \right\} $,
		\item for $ f: E \to X $ and $ F \subseteq E $: $ \fce f{F} \deq \sum_{e \in F} \fce fe $,
		\item $ \path uv $ is a path from $ u $ to $ v $.
	\end{itemize}
\end{notation}


\section{Flows}

\begin{defi}[Network]
	A \emph{network} is $ \left< G, s, t, c \right> $, where \begin{enumerate}
		\item $ G = \left< V,E \right> $ is a \emph{digraph}, WLOG symmetric,
		\item $ s \neq t \in V $ are \emph{source} and \emph{target} vertices,
		\item $ c: E \rightarrow \R^+_0 $ is a \emph{capacity function}.
	\end{enumerate}
\end{defi}

\begin{defi}[Flow]
	A function $ f: E \to \R^+_0 $ is a \emph{flow} $ \equiv $ \begin{enumerate}
		\item $ \left( \forall e \right)\; 0 \leq \fce fe \leq \fce ce $,
		\item $ \left( \forall v \neq s,t \right)\; \fce f{\fce {\delta^+}v} - \fce f{\fce {\delta^-}v} = 0 $,
	\end{enumerate}
\end{defi}

\def\fp{f^+}
\def\fm{f^-}
\def\fd{f^\Delta}
\def\fs{f^*}
\begin{notation}
	For flow $ f $, \begin{itemize}
		\item $ \fce \fp v \deq \fce f{\fce \deltap v} $,
		\item $ \fce \fm v \deq \fce f{\fce \deltam v} $,
		\item $ \fce \fd v \deq \fce \fp v - \fce \fm v $,
		\item $ \absolute f \deq \fce \fd t $.
	\end{itemize}
\end{notation}

\begin{lemma}[]
	\[
		\absolute f = - \fce \fd s.
	\]
\end{lemma}

\begin{defi}[Residual capacity]
	\[
		\fce r{uv} \deq \left( \fce c{uv} - \fce f{uv} \right) + \fce f{vu}.
	\]
\end{defi}

\begin{algo}[Ford-Fulkerson]\ \\
	\AlgIn a network $ \left< G,s,t,c \right> $.
	\begin{algorithmic}[1]
		\State $ f \gets \vec 0 $
		\Indent While $ \left( \exists P \right)\! \left( P = \path st \land \left( \forall e \right)\! \fce re > 0 \right) $:
		\State $ \varepsilon \gets \min_{e \in P} \fce re $
		\Indent For $ uv \in P $:
		\State $ \delta \gets \fce \min {\fce c{uv} - \fce f{uv}, \varepsilon} $
		\State $ \fce f{uv} \gets \fce f{uv} + \delta $
		\State $ \fce f{vu} \gets \varepsilon - \delta $
		\EndIndent
		\EndIndent
	\end{algorithmic}
	\AlgOut a flow $ f $.
\end{algo}

\begin{thm}[]
	If $ \rng c \subseteq \Q $, then Ford-Fulkerson terminates.
\end{thm}

\begin{notation}
	For $ A,B \subseteq V $, \[
		\fce E{A,B} \deq E \cap A \times B.
	\]
\end{notation}

\begin{defi}[Elemental cut]
	$ C \subseteq E $ is an \emph{elemental cut} $ \equiv $ \[
		\left( \exists A \subseteq V \right)\! \left( s \in A \land t \notin A \land C = \fce E{A, \overline A} \right).
	\]
\end{defi}

\begin{notation}
	For $ A,B \subseteq V $, $ g: E \to X $, \[
		\fce g{A,B} \deq \fce g{\fce E{A,B}}.
	\]
\end{notation}

\begin{thm}[]
	Let $ C = \fce E{A,B} $ be an elemental cut. Then \[
		\fce \fd C = \absolute f.
	\]
\end{thm}

\begin{cor}[]
	\[
		\absolute{f} \leq \fce c{A,B}.
	\]
\end{cor}

\begin{thm}[Correctness of FF]
	For $ \rng c \subseteq \Q $, Ford-Fulkerson computes a maximum flow.
\end{thm}

\begin{thm}[]
	For $ \rng c \subseteq \N $, Ford-Fulkerson computes a maximum flow $ f $, such that $ \rng f \subseteq \N $.
\end{thm}


\begin{defi}[Pure flow]
	For a flow $ f $, its \emph{pure flow} is \[
		\fce {f^*}{uv} \deq \fce f{uv} - \fce f{vu}.
	\]
\end{defi}

\begin{cor}[]
	\[
		\fce \fd v \deq \sum_{e \in E} \fce \fs {e}
	\]
\end{cor}

\begin{lemma}[]
	For any function $ f^* $  satisfying: \begin{enumerate}
		\item $ \fce \fs {uv} = - \fce \fs{vu} $,
		\item $ \fce \fs{e} \leq \fce c{e} $,
		\item $ \left( \forall v \neq s,t \right)\; \fce \fd v = 0 $,
	\end{enumerate}
	there exists a corresponding flow $ f $, for which $ f^* $ is a pure flow.
\end{lemma}

\def\res#1#2{\fce{\mathcal{R}}{#1, #2}}

\begin{defi}[Residual network]
	A \emph{residual network} of network $ N = \left< G, s, t, c \right> $ and flow $ f $ is \[
		\res Nf \deq \left< G, s, t, r \right>.
	\]
\end{defi}

\begin{lemma}[]
	For a flow $ f $ in $ N $, and $ g $ in $ \res Nf $, there exists a flow $ h $, such that \[
		\absolute h = \absolute f + \absolute g,
	\]
	further, $ h $ is constructable in $ \fce \O m $.
\end{lemma}

\begin{defi}[Blocking flow]
	A flow $ f $ is \emph{blocking} $ \equiv $ \[
		\left( \forall P = \path st \right)\! \left( \exists e \in P \right)\! \left( \fce fe = \fce ce \right).
	\]
\end{defi}

\begin{algo}[Dinic]\ \\
	\AlgIn $ N $.
	\begin{algorithmic}[1]
		\State $ f \gets 0 $
		\Indent Loop:
		\Indent Construct a \emph{Layered network}:
		\State $ R \gets \res Nf $
		\State Remove $ e: \fce re = 0 $.
		\State Keep only those vertices and edges included on some shortest $ st $ paths. \Comment Via Queue
		\EndIndent
		\State If $ \nexists \path st $, stop.
		\Indent Get a blocking flow $ g $ in the layered network:
		\State $ g \gets 0 $
		\Indent While $ \exists P = \path st$:
		\State $ \varepsilon \gets \fce {\min_{e \in P}}{\fce re - \fce ge} $
		\State Increase $ \fce gP $ by $ \varepsilon $
		\State Remove $ \left\{ e \in P \suchthat \fce gP = \fce rP \right\} $
		\State Cleanup dead ends.
		\EndIndent
		\EndIndent
		\State $ f \gets f + g $ \Comment Not so easy..
		\EndIndent
	\end{algorithmic}
	\AlgOut $ f $, maximal flow.
\end{algo}

\begin{lemma}[]
	Between phases, the number of layers increases.
\end{lemma}

\begin{cor}[]
	Dinic finishes in $ \fce \O{n^2m} $.
\end{cor}

\begin{thm}[]
	If $ c = \vec 1 $, then Dinic runs in $ \fce \O{nm} $.
\end{thm}

\begin{thm}[]
	If $ c = \vec 1 $, then Dinic runs in $ \fce \O{m \sqrt m} $.
\end{thm}

\begin{thm}[]
	If $ c = \vec 1 $ and $ \fce \min{\deg^{i}, \deg^o} \leq 1 $, then Dinic runs in $ \fce \O{m \sqrt n} $.
\end{thm}

\begin{thm}[]
	If $ c = \vec 1 $ and there are no parallel lines, then Dinic runs in $ \fce \O{m n^{\frac 23}} $.
\end{thm}


\begin{thm}[]\label{thm: dinic bound delta f}
	If $ \rng c \subseteq \Z $, then Dinic runs in $ \fce \O{\Delta f \cdot m + mn} $.
\end{thm}

\begin{thm}[]
	If $ c \leq C \in \R $, then Dinic runs in $ \fce \O{Cn^2 + mn} $.
\end{thm}

\begin{defi}[Scaled capacities]
	For a network $ N $, where $ \rng c \subseteq \left\{ 0, \dots, C \right\} $, we define \begin{enumerate}
		\item $ k \deq k \deq \lfloor \log_2 C \rfloor  $,
		\item $ \fce {c_i}e \deq \lfloor \frac{ \fce ce }{2^{k-i}} \rfloor $ ($ i $ most important bits of $ c $),
		\item $ N_i \deq \left< G, s, t, c_i \right> $.
	\end{enumerate}
\end{defi}

\begin{thm}[]
	For a flow $ f_i $ in $ N_i $, $ 2f_i $ is a valid flow in $ N_{i+1} $.
\end{thm}

\begin{thm}[]
	When computing maximal $ f_{i+1} $ from maximal $ f_i $, it takes $ \fce \O {mn} $ by \ref{thm: dinic bound delta f},
	so computing the whole flow incrementally takes $ \fce \O{mn\log C} $.
\end{thm}

\begin{defi}[Edge-connectivity]
	Let $ G $ be a graph.
	\begin{enumerate}
		\item $ G $ is \emph{$ k $-edge-connected} $ \equiv $ $\left( \forall F \subseteq E, \absolute{F} < k \right)\; G - F$ is connected.
		\item $ F \subseteq E $ is a \emph{cut} $ \equiv  $ $ G-F $ is disconnected.
		\item The \emph{edge-connectivity} of $ G $ is $ \edgeconn G \deq $ the size of the minimal cut.
		\item $ F $ is an \emph{$ st $-cut} $ \equiv $ $ G-F $ has no $ st $-path.
		\item (my notation) $ \edgeconnv Gst \deq $ the size of the smallest $ st $-cut.
	\end{enumerate}
\end{defi}

\begin{prop}[]
	The minimal $ st $-cut is an elementary cut.
\end{prop}

\begin{prop}[]
	$ \edgeconnv Gst $ is the number of edge-disjoint $ st $-paths, and the conversion from the maximal $ st $-flow to the paths can be done in $ \fce \O{m} $.
\end{prop}

\begin{prop}[]
	The minimal $ st $-cut can be found using flows in $ \fce \O{n^{\frac 23}m} $.
\end{prop}


\begin{thm}[Finding the global minimal cut]
	The minimal cut in an undirected graph can be found by \begin{enumerate}
		\item trying all choices of $ s,t $, in $ \fce \O{n^{\frac 83}m} $,
		\item fixing $ s $, trying all $ t $, in $ \fce \O{n^{\frac 53}m} $.
	\end{enumerate}
\end{thm}

\begin{defi}[Vertex-connectivity]
	Let $ G $ be a graph.
	\begin{enumerate}
		\item $ W \subset V $ is a \emph{cut}, or \emph{separator} $ \equiv  $ $ G-W $ is disconnected.
		\item The \emph{vertex-connectivity} of $ G $ is $ \vertexconn G \deq $ the size of the minimal separator, or $ n-1 $ for $ K_n $.
		\item $ G $ is \emph{$ k $-vertex-connected} $ \equiv $ its vertex-connectivity is at least $ k $.
		\item $ W \subseteq \left( V \setminus \left\{ s,t \right\} \right) $ is an \emph{$ st $-separator} $ \equiv $ $ G-W $ has no $ st $-path.
		\item (my notation) $ \vertexconnv Gst \deq $ the size of the smallest $ st $-separator.
	\end{enumerate}
\end{defi}

\begin{defi}[Internally-vertex-disjoint path]
	A path is \emph{Internally-vertex-disjoint} $ \equiv  $ it is vertex-disjoint except for the endpoints.
\end{defi}

\begin{prop}[]
	$ \vertexconnv Gst $ is the number of internally-vertex-disjoint $ st $-paths, and the conversion from the maximal $ st $-flow to the paths can be done in $ \fce \O{m} $.
\end{prop}

\begin{prop}[]
	The minimal $ st $-separator can be found in $ \fce \O{n^{\frac 12}m} $.
\end{prop}

\begin{thm}[]
	\
	\begin{enumerate}
		\item The globally-minimal separator can be found by gridsearch in $ \fce \O{n^{\frac 52}m} $.
		\item If its size $ k $ is known, it can be found in $ \fce \O{kn^{\frac 12}m} $.
		\item If $ k $ is unknown, stop after the number of iterations is less than the current minimal separator.
	\end{enumerate}
\end{thm}

\begin{algo}[Contraction]\ \\
	\AlgIn $ G $ with $ n $ vertices, $ l $.
	\begin{algorithmic}[1]
		\State $ G' \gets G $
		\Indent While $ n > l $:
		\State $ e \randin E $
		\State $ G \gets G \contract e $
		\EndIndent
	\end{algorithmic}
	\AlgOut $ G' $ with $ l $ vertices.
\end{algo}

\begin{prop}[]
	If $ C $ is a cut in $ G \concat e $, then $ C $ is a cut in $ G $.
\end{prop}

\begin{prop}[]
	If $ C $ is a cut in $ G $ and $ e \notin C $, then $ C $ is a cut in $ G \concat e $.
\end{prop}

\begin{cor}[]
	$ \edgeconn G = \edgeconn {G \contract e} $.
\end{cor}

\begin{thm}[]
	\[
		\pr{\edgeconn G = \edgeconn {G'}} = \frac{l \left( l-1 \right)}{n \left( n-1 \right)}.
	\]
\end{thm}

\end{document                </a></li>

<li><a href="https://gitlab.mff.cuni.cz/uradnikf/bc_lec/-/raw/master/2324z/algt/main.pdf">Algoritmická teorie her}
\author{Filip Úradník}
\date{\today}

\input{template}
\input{color}
\input{english}

\def\pdist#1{\fce {\Pi}{#1}}
\def\supp#1{\fce {\Sigma}{#1}}
\def\expayoff#1#2{\fce {u_{#1}}{#2}}
\def\vmin#1#2{{#1}_{-#2}}
\def\bestresp#1#2{{#1}_{-#2}}
\def\given{;}
\def\u#1#2{\fce{u_{#1}}{#2}}
\def\ug#1#2#3{\fce{u_{#1}}{#2 \given #3}}
\DeclareMathOperator{\conv}{conv}

\begin{document}
\maketitle

\begin{defi}[Normal form game]
	A \emph{game in normal form} is $ \left< P, A, u \right> $, where \begin{enumerate}
		\item $ P $ is a finite set of $ n $ players,
		\item $ A = A_1 \times \dots \times A_n $ is a set of action profiles, where $ A_i $ is the set of actions available to player $ i $,
		\item $ u = \left< u_1, \dots, u_n \right> $ is a tuple of utility functions $ u_i: A \to \R $, describing the payoff for player $ i $.
	\end{enumerate}
\end{defi}

A normal-form game can be represented by an $ n $-dimensional matrix $ M \deq \left( M_a \right)_{a \in A} = \left( \fce ua \right)_a $.

\begin{defi}[Pure strategy]
	\
	\begin{itemize}
		\item The set of \emph{pure strategies} for player $ i $ is $ A_i $.
		\item A \emph{pure strategy profile} is $ \left< s_1, \dots, s_n \right> $, such that $ s_i \in A_i $.
	\end{itemize}
\end{defi}

\begin{defi}[Mixed strategy]
	\
	\begin{itemize}
		\item The set of mixed strategies for $ i $ is $ S_i \deq \pdist {A_i} $, where $ \pdist X $ is the set of all probability distributions on $ X $.
		\item A \emph{mixed strategy profile} is $ \left< s_1, \dots, s_n \right> $, such that $ s_i \in S_i $.
		\item $ \fce {s_i}{a} \deq \pr{s_i = a} $.
		\item The \emph{support} of $ s_i $ is the set $ \supp {s_i} \left\{ a_i \in A_i \suchthat \fce {s_i}{a_i} \neq 0 \right\} $.
		\item A strategy profile $ s $ is \emph{fully mixed} $ \equiv  \left( \forall i \in P \right)\! \left( \supp {s_i} = A_i \right)$.
	\end{itemize}
\end{defi}

\begin{defi}[Expected payoff]
	The \emph{expected payoff} of a mixed strategy $ s $ for player $ i $ is \[
		\expayoff is \deq \sum_{a \in A} \fce {u_i}{a} \prod_{j \in P} \fce {s_j}{a_j} .
	\]
\end{defi}

\begin{notation}[Vector without element]
	When discussing vectors with missing elements at certain positions, we use: \begin{itemize}
		\item $ \vmin si \deq \left< s_1, \dots, s_{i-1}, s_{i+1}, \dots, s_n \right> $,
		\item $ \left( \forall s \in \pdist {A} \right)\; \fce {u_i}{s_i \given \vmin si} \deq \fce {u_i}{s} $.
	\end{itemize}
\end{notation}

\begin{defi}[Zero-sum game]
	A game $ G $ is a \emph{zero-sum game} $ \equiv $ \begin{enumerate}
		\item $ P = \left\{ 1,2 \right\} $,
		\item $ \left( \forall a \in A \right)\! \left( \u 1a + \u 2a = 0 \right) $.
	\end{enumerate}
\end{defi}

\begin{defi}[Solution concepts]
	A \emph{solution concept} is a mapping $ x: G \mapsto S $, where $ S $ is a set of strategy profiles in $ G $.
\end{defi}

\begin{defi}[Best response]
	The \emph{best response} of $ i $ to strategy profile $ \vmin si $ is a mixed strategy $ \bestresp si $, suchthat \[
		\left( \forall s'_i \in S_i \right)\! \left( \ug i{\bestresp si}{\vmin si} \geq \ug i{s'_i}{\vmin si} \right)
	\]
\end{defi}

\begin{defi}[Nash equilibrium]
	A \emph{Nash equilibrium} in $ G $ is a strategy profile $ s $, such that $ \forall i \in P: s_i $ is a best response of $ i $ to $ \vmin si $.
\end{defi}

\begin{thm}[Nash]
	Every normal-form game has a Nash equilibrium.
\end{thm}

\begin{thm}[Brouwer's Fixed Point Theorem]
	For a positive integer $ d $, let $ K $ be a non-empty compact convex set in $ \R^d $. Let $ f: K \to K $ be a continuous mapping. Then, there exists a fixed point $ x_0 \in K $ for $ f $, that is, $ \fce f{x_0} = x_0 $.
\end{thm}

\begin{lemma}[]
	For positive integers $ n $ and $ d_1, \dots, d_n $, let $ K_1 \dots K_n $ be compact sets, such that $ \left( \forall i \right)\! \left( K_i \subseteq \R^{d_i} \right) $.
	Then, the Cartesian product $ K_1 \times \dots \times K_n $ is a compact set in $ \R^{d_1 + \dots + d_n} $.
\end{lemma}

\def\pard{\mohlt}
\begin{defi}[Pareto domination]
	A strategy profile $ s $ \emph{Pareto dominates} $ s' $, $ s' \pard s $ $ \equiv $\[
		\left( \forall i \in P \right)\! \left( \u is \geq \u i{s'} \right) \land \left( \exists i \in P \right)\! \left( \u is > \u i{s'} \right).
	\]
\end{defi}

\begin{defi}[Pareto optimality]
	A strategy profile $ s $ is \emph{Pareto optimal} $ \equiv $\[
		\left( \forall s' \right)\! \left( s \not\pard s' \right).
	\]
\end{defi}

\begin{obs}[Best response condition]
	Let $ G = \left< P, A, u \right> $ be a normal-form game on $ n $ players.
	Then $ \left( \forall i \right)\! \left( \forall \vmin si \right)\! \left( \forall s_i \right) $ $ s_i  $ is a best response to $ \vmin si $, iff $ \left( \forall a \in \supp {s_i} \right) $ $ a $ is a best response to $ \vmin si $.
\end{obs}


\section{Zero-sum games}

\begin{notation}
	Let $ G = \left< P, A, u \right> $ be a zero-sum game. Then we denote \begin{enumerate}
		\item $ P = \left\{ 1,2 \right\} $,
		\item $ A_1 = \left\{ a_1, \dots, a_m \right\} $,
		\item $ A_2 = \left\{ b_1, \dots, b_n \right\} $,
		\item the payoff matrix $ M \in \R^{m \times n} $ as $ M_{ij} \deq \u 1{a_i, b_j} $,
		\item for a mixed strategy profile $ \left< s_1, s_2 \right> $, we use \emph{mixed strategy vectors} $ x,y: x_i = \fce{s_1}{a_i}, y_j = \fce{s_2}{b_j} $,
	\end{enumerate}
\end{notation}

\begin{cor}[]
	With this notation, it holds: \begin{enumerate}
		\item $ \u 1s = \trans xMy $.
	\end{enumerate}
\end{cor}

\begin{defi}[]
	For given strategies $ \left< x,y \right> $, we define \begin{itemize}
		\item player $ 1 $s best response's payoff as $ \fce \alpha y = \max_{x \in S_1} \trans xMy $,
		\item player $ 2 $s best response's payoff as $ \fce \beta x = \min_{y \in S_2} \trans xMy $.
	\end{itemize}
\end{defi}

\begin{cor}[]
	A strategy profile $ \left< x,y \right> $ is a \emph{Nash equilibrium}, if and only if \[
		\fce \alpha y = \trans xMy = \fce \beta x.
	\]
\end{cor}

\begin{defi}[Worst-case optimal]
	Supposing the other player selects its best response to a strategy, we define the \emph{worst-case optimal} solution
	\begin{itemize}
		\item for player 1 as $ \bar x \deq \max_{x \in S_1} \fce \beta x $,
		\item for player 2 as $ \bar y \deq \max_{y \in S_2} \fce \beta y $.
	\end{itemize}
\end{defi}

\begin{lemma}[]
	\
	\begin{enumerate}
		\item For all mixed strategies $ x, y $, we have $ \fce \beta x \leq \trans xMy \leq \fce \alpha y $.
		\item If a strategy profile $ \left< x^*, y^* \right> $ is a Nash equilibrium, then both strategies are worst-case optimal for 1 and 2.
		\item Any mixed strategies $ x^*, y^* $ satisfying $ \fce \beta {x^*} = \fce \alpha {y^*} $ form a Nash equilibrium.
	\end{enumerate}
\end{lemma}

\begin{thm}[Minimax]
	For every zero-sum game, worst-case optimal strategies for both players exist and can be efficiently computed using LP.
	Moreover, there is a number $ v $, such that, for any worst-case optimal strategies $ x^*, y^* $, the strategy profile $ \left< x^*, y^* \right> $ is a Nash equilibrium, and \[
		\fce \beta {x^*} = \fce \alpha {y^*} = v.
	\]
\end{thm}

\section{Bimatrix games}

\begin{notation}[Bimatrix games]
	Let $ G = \left< \left\{ 1,2 \right\}, A = A_1 \times A_2, u \right> $ be a normal-form game, so-called \emph{bimatrix game}.
	We will denote \begin{enumerate}
		\item $ A_1 = \left\{ 1, \dots, m \right\} $,
		\item $ A_2 = \left\{ 1, \dots, n \right\} $,
		\item $ M, N \in \Rmm mn $, such that \[
			      \u 1{i,j} = M_{ij}, \qquad \u 2{i,j} = N_{ij}.
		      \]
		\item From the above, we see that \[
			      \u 1{s} = \trans xMy, \qquad \u 2{s} = \trans xNy.
		      \]
	\end{enumerate}
\end{notation}

\begin{obs}[]\label{obs bimatrix best response}
	Let $ \left< x,y \right> $ be a mixed strategy profile.
	Then $ x $ is the best response to $ y $, iff \[
		x_i > 0 \implies M_{i*}y = \max_{k \in A_2} M_{k*}y,
	\]
	analogously, $ y $ is the best response to $ x $, iff \[
		y_j > 0 \implies \trans N_{j*}x = \min_{k \in A_1} \trans N_{k*}x.
	\]
\end{obs}

\begin{defi}[Nondegenerate games]
	A bimatrix game $ G $ is \emph{nondegenerate} $ \equiv $ for each mixed strategy $ s $ with $ \absolute{\supp s} = k $, there are at most $ k $ pure best responses.
\end{defi}

\begin{thm}[]
	For given supports $ I \subseteq A_1 $, $ J \subseteq A_2 $, a Nash equilibrium can be found by solving a system of $ \absolute{J} + \absolute{I} + 2 $ equations with $ \absolute{I} + \absolute{J} + 2 $ variables:
	\begin{align*}
		\sum_{i \in I} x_i & = 1                                         \\
		\sum_{j \in J} y_j & = 1                                         \\
		\trans M_iy        & = u \qquad \left( \forall i \in I \right)\! \\
		\trans N_jx        & = v \qquad \left( \forall j \in J \right)\! \\
	\end{align*}
	If a solution exists, with $ x_i, y_j > 0 $, and $ u = \max_{i \in I} M_{i*}y, v = \max_{j \in J} \trans N_{j*}x $, then $ \left< x,y \right> $ is a Nash equilibrium.
\end{thm}

\begin{cor}[]
	A Nash equilibrium of a nondegenerate bimatrix game can be found in $ \fce \O{4^n} $ for $ n=m $.
\end{cor}

\section{Preliminaries from Geometry}

\begin{defi}[Affine combination]
	For $ k, d \in \N $, let $ p_1, \dots, p_k \in \R^d $.
	An \emph{affine combination} of $ p_1, \dots, p_k $ is a vector $ p \in \R^d $, such that \[
		p = \sum_{i=1}^k \alpha_i p_i, \qquad \sum_{i=1}^k \alpha_i = 1.
	\]
	The points $ p_1, \dots, p_k $ are \emph{affinely independent} $ \equiv $ none of them is an affine combination of the others.
\end{defi}

\begin{defi}[Convex combination]
	A \emph{convex combination} of $ p_1, \dots, p_k $ is an affine combination, such that $ \alpha_i \geq 0 \; \left( \forall i \right) $.
	Further \begin{enumerate}
		\item the set of all convex combinations of a set $ P \subseteq \Rm n $ is $ \conv P $,
		\item a set $ P \subseteq \Rm n $ is \emph{convex} $ \equiv \conv P = P $,
		\item $ p_1, \dots, p_k $ are \emph{convexly independent} $ \equiv $ none of them is a convex combination of the others.
	\end{enumerate}
\end{defi}

\begin{defi}[Dimension]
	A \emph{dimension} of a convex set $ P \subseteq \Rm n $ is the maximal number of convexly independent points in $ P $ minus 1.
\end{defi}

\begin{defi}[Polyhedron]
	\
	\begin{enumerate}
		\item A \emph{hyperplane} is a set $ \left\{ x \in \R^d \suchthat \trans vx = w \right\} $ for some $ v \in \R^d, w \in \R $.
		\item A \emph{halfspace} is a set $ \left\{ x \in \R^d \suchthat \trans vx \leq w \right\} $ for some $ v \in \R^d, w \in \R $.
		\item A \emph{polyhedron} is a finite intersection of halfspaces, i.e. $ \left\{ x \in \R^d \suchthat Ax = b \right\} $ for $ A \in \Rmm nd, b \in \Rm n $.
		\item A \emph{polytope} is a bounded polyhedron.
	\end{enumerate}
\end{defi}

\begin{defi}[Faces]
	Let $ P \subseteq \Rm d $ be a polyhedron.
	\begin{enumerate}
		\item A \emph{face} is an intersection of $ P $ with a hyperplane $H$, such that $ P $ is fully in one of the halfspaces defined by the hyperplane, or $ P $ itself.
		\item A \emph{facet} is a face of dimension $ d - 1 $.
		\item A \emph{vertex} is a face of dimension 0.
		\item An \emph{edge} is a face of dimension 1.
	\end{enumerate}
\end{defi}

\begin{defi}[]
	A polyhedron is \emph{simple} $ \equiv $ none of its vertices belongs to more than $ d $ facets.
\end{defi}

\end{document                </a></li>

<li><a href="https://gitlab.mff.cuni.cz/uradnikf/bc_lec/-/raw/master/2324z/algebra/main.pdf">Algebra 1}
\author{Filip Úradník}
\date{\today}

\input{template}
\input{color}
\input{english}

\def\ddivides{\middle\|}
\def\ring#1{\mathbf{#1}}
\def\inv#1{{#1}^{-1}}
\def\equivclass#1#2{\left[ #1 \right]_{#2}}

\DeclareMathOperator{\Gcd}{gcd}
\DeclareMathOperator{\Lcm}{lcm}
\def\gcd#1#2{\fce \Gcd{#1, #2}}
\def\lcm#1#2{\fce \Lcm{#1, #2}}

\begin{document}
\maketitle

\begin{notation}
	In this course, we use the following notation: \begin{itemize}
		\item $ \N \deq \left\{ 1, 2, \dots \right\} $,
		\item $ \Z_n \deq \left\{ 0, 1, 2, \dots, n-1 \right\} $,
		\item $ \left( \forall a,b \in \Z \right)\; a \divides b \equiv \left( \exists q \in \Z \right)\! \left( b = a \cdot q \right) $,
		\item $ \left( \forall a,b \in \Z \right)\; a \divides b \equiv \left( \exists q \in \Z \right)\! \left( b = a \cdot q \right) $.
	\end{itemize}
\end{notation}

\begin{prop}[]
	\[
		\left( \forall a,b \in \Z, b \neq 0 \right)\! \left( \exists !q \in \Z, r \in \Z_{\absolute{b}} \right)\! \left( a = qb+r \right).
	\]
\end{prop}

\begin{notation}
	From the previous proposition, we can define more notation: $ \left( \forall a,b \in \Z \right)\; $ \begin{itemize}
		\item $  a \div b = q $,
		\item $ a \bmod b = r $.
	\end{itemize}
\end{notation}

\begin{defi}[Trivial divisor]
	A number $ 0 \neq a \in \Z $ has trivial divisors $ \pm 1 $ and $ \pm a $.
\end{defi}

\begin{defi}[Prime number]
	A number $ p > 1 $ is a \emph{prime} $ \equiv $ it only has trivial divisors.
	The set of all primes is $ \P $.
\end{defi}

\begin{thm}[Fundemental theorem of arithmetic]
	Let $ a \in \N $, $ a > 1 $. Then \[
		\left( \exists ! p_1 > p_2 > \dots > p_n \in \P \right)\! \left( \exists ! k_1, \dots, k_n \in \N \right)\! \left( a = \prod_{i = 1}^n p_i^{k_i} \right).
	\]
\end{thm}

The product is called a \emph{factorization} or a \emph{prime decomposition} of $ a $.

\begin{defi}[gcd \& lcm]
	Let $ a,b \in \Z $. Then \begin{enumerate}
		\item $ \gcd a b = c \equiv $ $ c $ is the largest number, s.t. $ c \divides a, c \divides b $,
		\item $ \lcm a b = d \equiv $ $ d $ is the smallest number, s.t. $ a \divides d, b \divides d $,
		\item $ a $ and $ b $ are \emph{coprime}, $ a \perp b $ $ \equiv \gcd ab = 1 $.
	\end{enumerate}
\end{defi}

\begin{obs}[]
	Let $ a,b \in \Z $. Then \begin{enumerate}
		\item $ \gcd {\pm a}{\pm b} = \gcd ab $,
		\item $ \gcd ab \cdot \lcm ab = a \cdot b $.
	\end{enumerate}
\end{obs}

\begin{lemma}[]
	Let $ a,b \in \Z $. Then \[
		\gcd ab = \gcd {a \bmod b} b.
	\]
\end{lemma}


\begin{algo}[Euclid]\ \\
	\AlgIn $ x,y \in \Z \neq 0 $.
	\begin{algorithmic}[1]
		\State $ a_0 \gets x $, $ a_1 \gets y $, $ i \gets 0 $
		\Indent While $ a_{i+1} \neq 0 $:
		\State $ i \gets i + 1 $
		\State $ a_{i+1} \gets a_{i-1} \bmod a_i $
		\EndIndent
	\end{algorithmic}
	\AlgOut $ a_i $, their GCD.
\end{algo}

\begin{prop}[Bezout's identity]
	Let $ a,b \in \Z $. Then \[
		\left( \exists u,v \in \Z \right)\! \left( \gcd ab = au + bv \right).
	\]
\end{prop}

$ u $ and $ v $ are called \emph{Bézout's coefficients}.

\begin{lemma}[]
	Let $ p \in \P $, $ a,b \in \Z $. Then \[
		p \divides ab \implies \left( p \divides a \lor p \divides b \right).
	\]
\end{lemma}

\begin{lemma}[]
	Let $ p \in \P $, $ a_1, \dots, a_n \in \Z $. Then \[
		p \divides \prod_{i = 1}^n a_i \implies \left( \exists i \in \left\{ 1, \dots, n \right\} \right)\! \left( p \divides a_i \right).
	\]
\end{lemma}

\begin{defi}[Congruence]
	Let $ a,b,m \in \Z, m \neq 0 $. Then $ a $ is \emph{congruent} to $ b $ modulo $ m $, $ a \equiv b \pmod m $ $ \equiv $ \[
		m \divides a-b.
	\]
\end{defi}

\begin{obs}[]
	\[
		a \equiv \left( a \mod m \right) \pmod m
	\]
\end{obs}

\begin{obs}[]
	$ \equiv $ is an equivalence $ \left( \forall m \right)\! $.
\end{obs}

\begin{prop}[]
	Let $ a \equiv b \pmod m $, $ c \equiv d \pmod m $. Then \[
		a\pm c \equiv b\pm d \pmod m, \qquad a \cdot c \equiv b \cdot d \pmod m, \qquad \left( \forall k \right)\; a^k \equiv b^k \pmod m.
	\]
\end{prop}

\begin{prop}[]
	Let $ a,b,c,m \in \Z, m \neq 0 $. Then \begin{enumerate}
		\item $ a \equiv b \pmod m \iff ac \equiv bc \mod mc $,
		\item $ m \perp c \implies \left( a \equiv b \pmod m \iff ac \equiv bc \pmod m \right) $.
	\end{enumerate}
\end{prop}

\begin{defi}[Euler's function]
	Let $ n \in \N $. We define \begin{enumerate}
		\item $ \Phi_n \deq \left\{ i \in \Z_n \suchthat i \perp n \right\} $,
		\item $ \fce \varphi n \deq \absolute{\Phi_n} $.
	\end{enumerate}
\end{defi}

\begin{prop}[]
	Let $ n = p_1^{k_1} \cdot \dots \cdot p_m^{k_m} $. Then \[
		\fce \varphi n = p_1^{k_1-1} \left( p_1 - 1 \right) \dots p_m^{k_m-1} \left( p_m -1 \right).
	\]
\end{prop}

\begin{thm}[Euler's]
	Let $ a,m \in \N $, $ a \perp m $. Then \[
		a^{\varphi(n)} \equiv 1 \mod m
	\]
\end{thm}

\begin{cor}[]
	For $ a \in \N, p \in \P $, it holds \[
		a^{p-1} \equiv 1 \pmod p.
	\]
\end{cor}

\begin{lemma}[]
	Let $ f:X \to Y $ be a map between finite sets $ X,Y $ of the same size. Then $ f $ is injective, iff it is bijective.
\end{lemma}

\begin{lemma}[]
	Let $ a \perp m \in \N $, $ f_a: \Phi_m \to \Phi_m $, such that $ x \mapsto ax \mod m $. Then $ f_a $ is well-defined and bijective.
\end{lemma}

\begin{obs}[]
	\[
		\left( \forall a,m \in \N \right)\! \left( \exists !b \in \Phi_m \right)\! \left( ab \equiv 1 \mod m \right).
	\]
\end{obs}

\begin{thm}[Chinese Remainder]
	Let $ m_1, \dots, m_n $ be mutually coprime, $ M = \prod_i m_i  $. Let $ u_1, \dots, u_n \in \Z$.
	Then \[
		\left( \exists ! x \in \Z_M \right)\! \left( \forall i \right)\! \left( x \equiv u_i \mod m_i \right).
	\]
\end{thm}

\begin{note}[]
	There is a constructive proof of the CRT, which allows us to use the CRT in computation (and proofs).
\end{note}

\section{Fields, Rings and Integral Domains}

\begin{defi}[Ring]
	A \emph{ring} is $ \ring R = \left< R, +, -, \cdot, 0 \right> $, such that \begin{enumerate}
		\item $ R $ is a non-empty set,
		\item $ +: R \times R \to R $,
		\item $ \cdot: R \times R \to R $,
		\item $ -: R \to R $,
		\item $0 \in R$,
	\end{enumerate}
	and it holds $ \left( \forall a,b,c \in R \right)\!  $
	\begin{axioms}
		\item $ a+ \left( b+c \right) = \left( a+b \right)+c $,
		\item $ a+b = b+a $,
		\item $ a+0 = a $,
		\item $ a + \left( -a \right) = 0 $,
		\item $ a \cdot \left( b \cdot c \right) = \left( a \cdot b \right) \cdot c $,
		\item $ a \cdot \left( b+c \right) = \left( a \cdot b \right) + \left( a \cdot c \right) $,
		\item $ \left( a+b \right) \cdot c = \left( a \cdot c \right) + \left( b \cdot c \right) $.
	\end{axioms}
\end{defi}

\begin{defi}[]
	A ring $ \ring R $ is \begin{enumerate}
		\item \emph{commutative} $ \equiv $ $ \left( \forall a,b \in R \right)\; a \cdot b = b \cdot a $,
		\item \emph{with unity} $ \equiv $ $ \left( \exists 1 \in R \right)\! \left( \forall a \in R \right)\; 1 \cdot a = a \cdot 1 = a $,
	\end{enumerate}
\end{defi}

\begin{defi}[]
	A commutative ring $ \ring R $ with unity $ 1 \neq 0 $ is \begin{enumerate}
		\item \emph{an integral domain} $ \equiv $ $ \left( \forall a,b \in R \right)\; a \cdot b = 0 \implies a = 0 \lor b = 0 $,
		\item \emph{a field} $ \equiv $ $ \left( \forall a \in R \setminus \left\{ 0 \right\} \right)\! \left( \exists b \in R \right)\! \left( a \cdot b = 1 \right) $, where $ b $ is an \emph{inverse}, denoted as $ \inv a $.
	\end{enumerate}
\end{defi}

\begin{examp}[]
	$ \Z_n $ is a ring $ \left< \left\{ 0, \dots, n-1 \right\}, +, -, \cdot \right> $, where all operations are done modulo $ n $.
\end{examp}

\begin{prop}[]
	For $ n \in \N $, the following are equivalent \begin{enumerate}
		\item $ \Z_n $ is a field,
		\item $ \Z_n $ is an integral domain,
		\item $ n $ is a prime.
	\end{enumerate}
\end{prop}

\begin{defi}[Subring]
	For a ring $ \ring R = \left< R, +, -, \cdot, 0 \right> $, let $ S \subseteq R $, such that \begin{enumerate}
		\item $ 0 \in S $,
		\item $ \left( \forall a,b \in S \right)\; a+b \in S $,
		\item $ \left( \forall a,b \in S \right)\; a \cdot b \in S $,
		\item $ \left( \forall a \in S \right)\; -a \in S $.
	\end{enumerate}
	Then $ S $ forms a \emph{subring} $ \ring S $, $ \ring S \leq \ring R $.
	Further, if $ \ring R $ is a field, and $ \left( \forall a \in S \setminus \left\{ 0 \right\} \right)\! \left( \inv a \in S \right)  $, then $ \ring S $ is a \emph{subfield} of $ \ring R $.
\end{defi}

\begin{prop}[]
	For $ \star $ an associative operation on $ X $, it holds that for any product of $ x_1 \star \dots \star x_n, $ such that $ \left( \forall i \right)\; x_i \in X $, the result is independent of the position of the brackets.
\end{prop}

\begin{prop}[Basic properties of commutative rings]
	Let $ \ring R $ be a cummutative ring. Then $ \left( \forall a,b,c \in R \right)\!  $ \begin{enumerate}
		\item $ a+c = b+c \implies a=b $,
		\item $ a \cdot 0 = 0 $,
		\item $ -\left( -a \right) = a $,
		\item $ -\left( a+b \right) = -a-b $,
		\item $ -\left( a \cdot b \right) = \left( -a \right) \cdot b = a \cdot \left( -b \right) $,
		\item $ \left( -a \right) \cdot \left( -b \right) = a \cdot b $,
		\item if $ \ring R $ is an integral domain, $ a \cdot c = b \cdot c $, and $ c \neq 0 $, then $ a = b $.
	\end{enumerate}
\end{prop}

\begin{prop}[]
	Every field is an integral domain.
\end{prop}

\begin{defi}[]
	Let $ \ring R $ be an integral domain, and $ M = R \setminus \left\{ 0 \right\} $.
	Then we define $ \sim $ on $ R \times M $ as \[
		\left< a,b \right> \sim \left< c,d \right> \equiv ad = bc.
	\]
\end{defi}

\begin{cor}[]
	$ \sim $ is an equivalence.
\end{cor}

\begin{defi}[Fraction]
	We define a fraction $ \frac ab $ as the equivalence class $ \equivclass {\left< a,b \right>}{\sim} $.
\end{defi}

\begin{defi}[Quotient field]
	The quotient field $ \ring Q $ of the integral domain $ \ring R $ is the field of all fractions $ \left< \left\{ \frac ab \suchthat a,b \in R, b \neq 0 \right\}, +, -, \cdot, 0, 1 \right> $, where \begin{enumerate}
		\item $ \frac ab + \frac cd = \frac {ad+bc}{bd} $,
		\item $ \frac ab \cdot \frac cd = \frac {ac}{bd} $,
		\item $ -\frac ab = \frac {-a}b = \frac a{-b} $,
		\item $ \frac ab = \frac cd \iff ad = bc $,
		\item $ 0 = \frac 01 $,
		\item $ 1 = \frac 11 $.
	\end{enumerate}
\end{defi}

\begin{prop}[]
	The operations on $ \ring Q $ are well-defined and $ \ring Q $ is a field.
\end{prop}

\end{document                </a></li>

            </li>


            <li>2022/2023 summer
                <li><a href="https://gitlab.mff.cuni.cz/uradnikf/bc_lec/-/raw/master/2223z/matalyza/main.pdf">Matematická analýza 2}
\author{Filip Úradník}
\date{\today}

\input{template}
\input{czech_c}

\DeclareMathOperator*{\Max}{max}
\DeclareMathOperator*{\diam}{diam}
\DeclareMathOperator*{\vol}{vol}
\DeclareMathOperator{\okoli}{\mathcal{U}}
\def\bb{\mathcal{B}}
\def\dd{\text{d}}
\def\deriv#1#2{\frac{\dd #1}{\dd #2}}
\def\pderiv#1#2{\frac{\partial#1}{\partial#2}}
\def\npderiv#1#2#3{\frac{\partial^{#3}#1}{\partial#2}}

\begin{document}
\maketitle

\section{Metrické prostory}

\begin{defi}[Metrický prostor]
  \textit{Metrický prostor} je dvojice $ \left(X,d\right) $, kde $ X $ je
  množina a $ d: X \times X \to \R $ je metrika.
\end{defi}

\begin{examp}
  \textit{Eukleidovský} prostor $ \E_n $ je $ \left( \R^n, d \right) $, kde \[
    \fce{d}{\vec x, \vec y} \deq \sqrt{ \sum_i{\left( x_i-y_i \right)^2} }.
  \]
\end{examp}

\begin{defi}[Podprostor]
  $ \left( Y, d' \right) $ je \textit{podprostor} prostoru $ \left( X,d \right) \equiv Y \subseteq X $ a $ \forall x,y \in Y:\fce{d'}{x,y} = \fce{d}{x,y} $.
\end{defi}

\begin{defi}[Spojité zobrazení]
  Zobrazení $ f: \left( X,d \right) \to \left( Y,d' \right) $ je \textit{spojité} $ \equiv $ \[
    \forall x \in X \; \forall \varepsilon > 0 \;\exists \delta > 0: \fce{d}{x,y} < \delta \implies \fce{d'}{\fce{f}{x}, \fce{f}{y}} < \varepsilon.
  \]
\end{defi}

\begin{defi}[Konvergence]
  Nechť $ \left( x_n \right)_n$ je posloupnost. $ \left( x_n \right)_n $ \textit{konverguje k $ x $}, $ \lim _{n \to \infty} x_n = x \equiv $ \[
    \forall \varepsilon > 0 \; \exists n_0 \in \N : n > n_0 \implies \fce{d}{x_n, x} < \varepsilon.
  \]
\end{defi}

\begin{thm}[Spojitost a konvergence]
  Nechť $ f: \left( X, d_1 \right) \to \left( Y, d_2 \right) $. Pak 
  \[
    f \text{ je spojité } \Longleftrightarrow \forall x_n \text{ konvergentní}: 
    \fce{f}{x_n} \text{ konverguje } \& \lim_{n \to \infty} \fce{f}{x_n} = \fce{f}{\lim_{n \to \infty} x_n}.
  \]

  \begin{proof}
    Nechť $ \left( x_n \right)_n $ konverguje. Pro zvolené $ \varepsilon $
    hledáme $ n_0 $ na konvergenci $ \left( \fce{f}{x_n} \right)_n $. Víme, že
    $ f $ je spojité, tedy pro to $ \varepsilon $ existuje $ \delta_f $, kde
    pro $ \delta_f $-okolí se vejdeme do $ \varepsilon $. Pro toto $ \delta_f $
    najdeme z konvergence $ x_n $ $ \varepsilon_{x_n} $. To je naše hledané $
    \varepsilon $.
  \end{proof}
\end{thm}

\begin{defi}[Okolí]
  \textit{Okolím} bodu $ x $ nazýváme množinu $ \fce{\Omega}{x,\varepsilon} \deq \{ y\; |\; \fce{d}{x,y} < \varepsilon \}$.

  Množina $ M $ \textit{je okolím} bodu $ x \equiv \exists \varepsilon > 0: \fce{\Omega}{x,\varepsilon} \subseteq M $.
\end{defi}

\begin{defi}[Otevřená množina]
  Množina $ M $ je \textit{otevřená} $ \equiv \forall x \in M \; \exists \varepsilon: \fce{\Omega}{x, \varepsilon} \subseteq M$.
\end{defi}

\begin{defi}[Uzavřená množina]
  Množina $ M $ je \textit{uzavřená} $ \equiv \forall \left( x_n \right)_n \subseteq M $ konvergentní je $ \lim_{n \to \infty} x_n \in M $.
\end{defi}

\begin{thm}[Otevřenost a uzavřenost]
  Množina $ A \subseteq \left( X,d \right) $ je uzavřená v $ \left( X,d \right) $, právě když $ A' \deq X \setminus A $ je otevřená.

  \begin{proof}
    Nechť $ A $ je otevřená. Nechť $ \left( x_n \right)_n $ je libovolná
    konvergentní v $ A' $ k $ x $. Kdyby $ x \in A $, pak by existovalo i $
    \varepsilon_A $-okolí, které je také v $ A $. Pro všechna $ \varepsilon <
    \varepsilon_A $ by tedy nemohla být splněna podmínka konvergence.

    Naopak, nechť $ A' $ je uzavřená a $ \exists a \in A:\forall \varepsilon >
    0: \fce{\Omega}{x, \varepsilon} \nsubseteq A $. Z toho vyplývá, že část
    okolí je vždy v $ A' $. To ale znamená, že $ \fce{d}{A', a} = 0 $, tedy $
    A' $ není uzavřená.
  \end{proof}
\end{thm}

\begin{defi}[Uzávěr]
  \textit{Uzávěr} množiny $ A $ je množina $ \overline{A} \deq \{ x \in X \; | \; \fce{d}{x,A} = 0 \}$
\end{defi}

\begin{thm}
  Platí:
  \begin{enumerate}
    \item $ \overline{\emptyset} = \emptyset $
    \item $ A \subseteq \overline{A} $
    \item $ A \subseteq B \implies \overline{A} \subseteq \overline{B} $
    \item $ \overline{A \cup B} = \overline{A} \cup \overline{B} $
    \item $ \overline{A} = \overline{\overline{A}}$
  \end{enumerate}
\end{thm}

\begin{thm}
  $ \overline{A} $ je množina všech limit konvergentních $ x_n \subseteq A $.
\end{thm}

\begin{thm}
  $ \overline{A} $ je uzavřená, a je to nejmenší uzavřená množina obsahující $ A $.
\end{thm}

\begin{thm}
  Pro $ \left( X_1, d_1 \right), \left( X_2, d_2 \right) $ metrické prostory a 
  $ f: X_1 \to X_2 $ zobrazení je ekvivalentní:
  \begin{enumerate}
    \item $ f $ je spojité.
    \item $ \forall x \in X_1 $ a $ V $ okolí bodu $ \fce{f}{x}\; \exists  U $ okolí bodu $ x : \fce{f}{U} \subseteq V$
    \item $ \forall U \subseteq X_2 $ otevřenou v $ X_2 $ je $ \fce{f ^{-1}}{U}  $ otevřený v $ X_1 $.
    \item $ \forall U \subseteq X_2 $ uzavřenou v $ X_2 $ je $ \fce{f ^{-1}}{U}  $ uzavřený v $ X_1 $.
    \item $ \forall A \subseteq X_1 : \fce{f}{\overline{A}} \subseteq \overline{\fce{f}{A}} $
  \end{enumerate}
\end{thm}

\begin{defi}[Homeomorfismus]
  $ f $ je \textit{homeomorfismus} $ \equiv $ je to bijekce, a v obou směrech je spojité.
\end{defi}

\begin{defi}[Topologická vlastnost]
  Vlastnost je \textit{topologická} $ \equiv $ je zachovávána homeomorfismy.
\end{defi}

\begin{thm}[Topologické vlastnosti] Z námi definovaných vlastností jsou topologické:
  \begin{itemize}
    \item konvergence,
    \item otevřenost,
    \item bytí uzávěrem,
    \item bytí okolím,
    \item spojitost (triviálně).
  \end{itemize}
\end{thm}

\begin{defi}[Ekvivalentní metriky]
  $ d_1 $ a $ d_2 $ jsou \textit{ekvivalentní} $ \equiv \id: \left( X,d_1
  \right) \to \left( X,d_2 \right) $ je homeomorfismus.
\end{defi}

\begin{defi}[Silně ekvivalentní]
  $ d_1 $ a $ d_2 $ jsou \textit{silně ekvivalentní} $ \equiv \exists \alpha, \beta: $ \[
    \alpha \fce{d_1}{x,y} \leq \fce{d_2}{x,y} \leq \beta \fce{d_1}{x,y}.
  \]
\end{defi}


\begin{thm}[Silná ekvivalence standardních metrik]
  Definujme:
  \begin{align*}
    \fce{d}{\vec x, \vec y} &\deq \sqrt{\sum_i \left( x_i-y_i \right)^2}, \\
    \fce{\lambda}{\vec x, \vec y} &\deq \sum_i \absolute{x_i-y_i}, \\
    \fce{\sigma}{\vec x, \vec y} &\deq \Max_i \absolute{x_i-y_i}.
  \end{align*}
  $d,\lambda,\sigma$ jsou silně ekvivalentní na $ \E_n $.
\end{thm}

\begin{defi}[Součin prostorů]
  Pro $ \left( X_i,d_i \right), i \in \left[ n \right] $ definujeme \textit{součin prostorů} jako \[
    \prod_i \left( X_i, d_i \right) \deq \left( \prod_i X_i, d \right)\!,
  \]
  kde výsledná metrika $ d $ je definovaná jako \[
    \fce{d}{\vec x, \vec y} \deq \Max_i \fce{d_i}{x_i,y_i}.
  \]
\end{defi}

\begin{thm} \
  \begin{enumerate}
    \item Projekce $ p_j: \prod_i \left(X_i,d_i  \right) \to \left( X_j,d_j
      \right) $ definované předpisem $ \fce{p_j}{\vec x} = x_j $ jsou spojitá
      zobrazení.
    \item Pro libovolné spojité $ f_j: \left( Y,d' \right) \to \left( X_j,d_j
      \right) $ definujme $ \fce{f}{\vec x} \deq \left( \fce{f_1}{x_1}, \dots,
      \fce{f_n}{x_n} \right) $. Tj., $ f $ je libovolné zobrazení splňující $
      p_j \circ f = f_j$ spojité. Pak i $ f $ je spojité.
  \end{enumerate}

  Tedy studujeme-li spojitá zobrazení $ \vec f: \E_n \to \E_m $, záleží (na rozdíl od definičního oboru) spojitost oboru hodnot jen na
  spojitosti v jednotlivých souřadnicích.
\end{thm}

\begin{defi}[Obrazy a vzory]
  Pro $ f: X \to Y ,A \subseteq X, B \subseteq Y $:
  \begin{itemize}
    \item \textit{obraz} $ A $ je \[
      \fceb{f}{A} \deq \{ \fce{f}{x} \suchthat x \in A \},
    \]
    \item \textit{vzor} $ B $ je \[
      \fceb{f^{-1}}{B} \deq \{x \suchthat \fce{f}{x} \in B \}.
    \]
  \end{itemize}
\end{defi}

$ f ^{-1} $ má tedy dva významy, respektive dvě platnosti. Jakožto funkce
nemusí existovat, ale jakožto symbol vzoru má smysl vždy.

\begin{defi}[Funkce v $ n $ proměnných] Zobrazení $ f: D \to X $ je \textit{funkce v $ n $ proměnných} $ \equiv D \subseteq \E_n $. \end{defi}

\section{Parciální derivace}

\begin{defi}[Parciální derivace]
Nechť $ f: A \subseteq \E_n \to B \subseteq \R $. Dále nechť \[
  \forall k \in \left[ k \right]: \fce{\phi_k}{t} = \fce{f}{x_1,\dots,x_{k-1},t,x_{k+1},\dots,x_n}.
\]
\textit{Parciální derivace} funkce $ f $ podle $ x_k $ v bodě $ \vec x $ je \[
  \pderiv{f}{x_k} \deq \deriv{\phi_k}{x_k}.
\]
\end{defi}

\begin{thm}[Parciální derivace a spojitost]
  Existence (ani všech) parciálních derivací neimplikuje spojitost.
\end{thm}

\begin{defi}[Norma]
  Norma vektoru $ \vec x \in \E_n $ je \[
    \norm {\vec x} \deq \Max_i \absolute{x_i}.
  \]
\end{defi}

\begin{defi}[Totální diferenciál]
  Funkce $ f $ má \textit{totální diferenciál} v bodě $ \vec x $ $ \equiv $
  \begin{enumerate}
    \item $\exists \mu $ spojitá na $ \fce{\Omega}{\vec o, \varepsilon}: \fce{\mu}{\vec o} = 0 $,
    \item $\exists \left( A_i \right)_{i \leq n}: \fce{f}{\vec a + \vec h} - \fce{f}{\vec a} = \sum_k A_kh_k + \norm {\vec h} \fce{\mu}{\vec h} $ pro $ \vec h \to \vec o $.
  \end{enumerate}
\end{defi}

\begin{thm}[Totální diferenciál a spojitost]
  Nechť $ f $ má v bodě $ \vec a $ totální diferenciál. Pak
  \begin{enumerate}
    \item $ f $ je spojitá,
    \item $ f $ má všechny parciální derivace v $ \vec a $, a to s hodnotami \[
        \pderiv{\fce{f}{\vec a}}{x_k} = A_k.
    \]
  \end{enumerate}

  \begin{proof}
    Nechť $ f $ má totální diferenciál. \begin{enumerate}
      \item $ \absolute{\fce{f}{\vec b} - \fce{f}{\vec a}} \leq \absolute{\sum_k A_kh_k} + \norm {\vec b - \vec a} \absolute{\fce{\mu}{\vec b - \vec a}} $, a pravá strana se blíží $ \vec o $,
      \item $ \frac{\partial f}{\partial x_k} = \lim_{h \to 0} \frac{\fce{f}{x_1, \dots, x_k+h, \dots, x_n} - \fce{f}{x_1, \dots, x_n}}{h} = \lim_{h \to 0}\frac{1}{h}\left( \sum_{i \neq k} A_i \cdot 0 + hA_k + h \fce{\mu}{0, \dots, h, \dots, 0} \right) $.
    \end{enumerate}
  \end{proof}
\end{thm}

\begin{thm}[Spojité parciální derivace a totální diferenciál]
  Nechť má $ f $ spojité parciální derivace v okolí $ \vec a $. Potom má v $
  \vec a $ totální diferenciál.

  \begin{proof}
    Nechť $ f $ má spojité parciální derivace na okolí $ \vec a $. definujme $ \vec h^{\left( k \right)} $ tak, že \[
       h^{\left( k \right)}_i = \begin{cases}
         h_i & \text{pro $ i \geq k $,} \\
         0 & \text{jinak.} \\
      \end{cases}
    \] Přepíšeme \[
      \fce{f}{\vec a + \vec h} - \fce{f}{\vec a} = \sum_i \fce{f}{\vec a + \vec h^{\left( i \right)}} - \fce{f}{\vec a + \vec h^{\left( i+1 \right)}} .
    \] Z Lagrangeovy věty pak $\forall i\; \exists \theta_i \in \left[ 0,1 \right]: $
    \[
      \fce{f}{\vec a + \vec h^{\left( i \right)}} - \fce{f}{\vec a + \vec h^{\left( i+1 \right)}} = \fce{\frac{\partial f}{\partial x_i}}{\chi_i}h_i,
    \]kde $ \chi_i = \vec a + \left( 0, \dots, h_i\theta, h_{i+1}, \dots, h_n \right)$.

    Dostáváme \begin{align*}
      \fce{f}{\vec a + \vec h} - \fce{f}{\vec a} &= \sum_i \fce{f}{\vec a + \vec h^{\left( i \right)}} - \fce{f}{\vec a + \vec h^{\left( i+1 \right)}} \\
      &= \sum_i \fce{\frac{\partial f}{\partial x_i}}{\chi_i}h_i = \sum_{i}^{} \fce{\frac{\partial f}{\partial x_i}}{\vec a}h_i + \sum_{i}^{} \left( \fce{\frac{\partial f}{\partial x_i}}{\chi_i} - \fce{\frac{\partial f}{\partial x_i}}{\vec a} \right)h_i \\
      &= \sum_{i}^{} \fce{\frac{\partial f}{\partial x_i}}{\vec a}h_i + \norm{\vec h}\sum_{i}^{} \left( \fce{\frac{\partial f}{\partial x_i}}{\chi_i} - \fce{\frac{\partial f}{\partial x_i}}{\vec a} \right)\frac{h_i}{\norm{\vec h}}. \\
    \end{align*}
  \end{proof}
\end{thm}

\begin{thm}[Řetězové pravidlo v 1 proměnné]
  Nechť $ f: A \subseteq \E_n \to B \subseteq \R $ má totální diferenciál v $ \vec a $. 

  Dále nechť $ \forall k \in \left[ n \right]: g_k:G_k \to K_k,\;
  g_k$~má~derivaci v bodě $ b $ a $ \fce{g_k}{b} = a_k $.

  Nyní mějme \[
    \fce{F}{t} \deq \fce{f}{\fce{\vec g}{t}} = \fce{f}{\fce{g_1}{t}, \dots, \fce{g_n}{t}}.
  \]
  Potom $  $ \[
    \exists \deriv Fx \left( b \right) = \sum_k \fce{\pderiv{f}{x_k}}{\vec a} \fce{\deriv{g_k}t}{b}.
  \]

  \begin{proof}
    \[
      \frac{\fce{f}{\fce{g}{x+h}}-\fce{f}{\fce{g}{x}}}{h} = \frac{1}{h} \left( \fce{f}{\fce{g}{x} + \left( \fce{g}{x+h} - \fce{g}{x} \right)} + \fce{f}{\fce{g}{x}} \right).
    \]

    Použijeme definici TD, který víme, že $ f $ má:
    \[
    = \sum_{k}^{} A_k \left( \frac{\fce{g_k}{x+h} - \fce{g_k}{x}}{h} \right) + \frac{\fce{\mu}{\fce{\vec g}{x+h} - \fce{\vec g}{x}} \norm{ \fce{\vec g}{x+h} - \fce{\vec g}{x} }}h.
    \]

    Funkce $ g_k $ mají derivace, jsou tedy spojité, a proto i omezené na
    jistém okolí. Pro malá $ h $ je tedy člen s $ \mu $ blízko nule. Pokud z
    tohoto tvaru vezmeme limitu pro $ h \to 0 $, dostaneme tedy požadovaný
    tvar.
  \end{proof}
  
\end{thm}

\begin{cor}[Řetězové pravidlo]
  Nechť $ f: A \subseteq \E_n \to B \subseteq \R $ má totální diferenciál v $
  \vec a $. Nechť $ \forall k \in \left[ n \right]: \; g_k: C_k \subseteq \E_m
  \to D_k \subseteq \R $ mají parciální derivace v $ \vec b $ a $ \fce{g_k}{\vec b} = a_k $.
  Potom \[
    \fce{\left( f \circ \vec g \right)}{\vec t} = \fce{f}{\fce{\vec g}{\vec t}}
  \]
  má všechny parciální derivace v $ \vec b $ a \[
    \fce{\pderiv{\left( f \circ \vec g \right)}{t_j}}{\vec b} = \sum_{k \in \left[ n \right]} \fce{\pderiv{f}{x_k}}{\vec a} \fce{\pderiv{g_k}{t_j}}{\vec b}.
  \]
\end{cor}

\begin{cor}[Řetězové pravidlo pro funkce do $ \R^m $] \label{retez}
  Nechť $ \vec f = \left( f_1,\dots,f_m \right)$, kde $f_i: A \subseteq \E_n \to B_i \subseteq \R $ má totální diferenciál v $
  \vec a $. Nechť $ \forall k \in \left[ n \right]: \; g_k: C_k \subseteq \E_m
  \to D_k \subseteq \R $ mají parciální derivace v $ \vec b $ a $ \fce{g_k}{\vec b} = a_k $.
  Potom po dosazení do předchozí věty dostaneme \[
    \fce{\pderiv{\left( f_i \circ \vec g \right)}{t_j}}{\vec b} = \sum_{k \in \left[ n \right]} \fce{\pderiv{f_i}{x_k}}{\vec a} \fce{\pderiv{g_k}{t_j}}{\vec b}.
  \]
\end{cor}

\begin{defi}[Matice lineární aproximace]
  Pro funkci $ \vec h $ je \textit{matice lineární aproximace} matice $ D \vec h $ definovaná jako: \[
    D \vec h _{ij} \deq \pderiv {h_i} {x_j}.
  \]
\end{defi}

\begin{cor}
  Podle předchozí věty platí \[
    \fce{D}{\vec f \circ \vec g} = D \vec f \times D \vec g.
  \]
\end{cor}

\begin{defi}[Konvexní množina]
  Množina $ U $ je \textit{konvexní} $ \equiv $ \[
    \forall \vec x, \vec y \in U, \forall t \in \left[ 0,1 \right]: \vec x + t \left( \vec y - \vec x \right) \in U
  \]
\end{defi}

\begin{thm}[Lagrange v $ \R^n $] \label{lagrange}
  Nechť $ f $ má spojité parciální derivace v konvexní otevřené množině $ U \subseteq \E^n $. Pak \[
    \forall \vec x, \vec y \in U \; \exists \theta \in \left[ 0,1 \right]: 
    \fce{f}{\vec y} - \fce{f}{\vec x} = \sum_{j=1}^{n} \pderiv{\fce{f}{\vec x + \theta \left( \vec y - \vec x \right)}}{x_j} \left( y_j-x_j \right).
  \]

  \begin{proof}
    Dokážeme převedením na Lagrange v $ \R $. Zadefinujeme funkci $ F = f \circ
    \vec g $, kde $ \fce{g_i}{t} = x_i + t \left( y_i - x_i \right) $. 

    Z definice $ F $ vychází \[
      \fce{f}{\vec x} - \fce{f}{\vec y} = \fce{F}{0} - \fce{F}{1} = \fce{F'}{\theta},
    \]
    kde poslední rovnost je podle klasické Lagrangeovy věty a $ \theta \in \left( 0,1 \right) $.

    Teď už jen stačí spočítat $ F' $ pomocí \ref{retez}: \[
      \fce{F'}{t} = \sum_{i}^{} \fce{\frac{\partial f}{\partial x_i}}{\fce{\vec g}{t}} \fce{\deriv { g_i } {t}}{t} = \sum_i \fce{\frac{\partial f}{\partial x_i}}{\vec x + \theta \left( \vec y - \vec x \right)} \left( y_i - x_i \right).
    \]
  \end{proof}
  
\end{thm}

\begin{defi}[Parciální derivace řádu $ r $]
  Nechť funkce $ f $ má na nějakém okolí parciální derivace podle $ x_k $. Pak \[
    \npderiv{\fce{f}{\vec x}}{x_k \partial x_l}2 \deq \pderiv{}{x_l} \pderiv{\fce{f}{\vec x}}{x_k}
  \]
  Iterováním tohoto procesu se dostaneme až na \textit{parciální derivace řádu
  $ r $}. Řád nezávisí na derivovaných proměnných.
\end{defi}

\begin{thm}
Nechť funkce $ f $ má {\bf spojité} $ \npderiv{\fce{f}{\vec x}}{x \partial y}2,
  \npderiv{\fce{f}{\vec x}}{y \partial x}2 $. Pak se tyto derivace rovnají.

  \begin{proof}
    Snažíme se spočítat obě derivace na ráz, na což zadefinujeme funkci \[
      \fce{F}{h} = \frac{\fce{f}{x+h, y+h} - \fce{f}{x, y+h} - \fce{f}{x+h, y} + \fce{f}{x,y}}{h^2}.
    \]

    Pro výpočet si zadefinujeme ještě dvě pomocné funkce \begin{align*}
      \fce{\varphi_h}{x} &= \fce{f}{x, y+h} - \fce{f}{x,y}, \\
      \fce{\psi_h}{y} &= \fce{f}{x+h, y} - \fce{f}{x,y}.
    \end{align*}

    Funkce $ \varphi $ má derivaci $ \fce{\varphi_h'}x = \frac{\partial
    }{\partial x} \fce{f}{x, y+h} - \frac{\partial }{\partial x} \fce{f}{x,y}
    $.

    Nyní použijeme Lagrange (\ref{lagrange}): \[
      \fce{F}{h} = \frac{\fce{\varphi_h}{x+h} - \fce{\varphi_h}{x}}{h^2} = \frac{\fce{\varphi_h'}{x+ \theta h}}{h} = \frac{\frac{\partial }{\partial x}\fce{f}{x+\theta h,y+h} - \frac{\partial }{\partial x}\fce{f}{x+\theta h,y}}{h}.
    \]

    Dalším použitím Lagrange dostaneme: \[
    \frac{\frac{\partial }{\partial x}\fce{f}{x+\theta h,y+h} - \frac{\partial }{\partial x}\fce{f}{x+\theta h,y}}{h} = \frac{\partial }{\partial x \partial y} \fce{f}{x+\theta h,y + \gamma h}
    \]

    Stejným způsobem lze dojít i k \[
      \fce{F}{h} = \frac{\fce{\psi_h'}{y+ \alpha h}}{h^2} = \frac{\partial }{\partial y \partial x} \fce{f}{x+\beta h,y + \alpha h}.
    \]

    Nyní už stačí jen limitit k nule a dostáváme \[
      \lim_{h \to 0} \fce{F}{h} = \frac{\partial }{\partial y \partial x} \fce{f}{x,y} = \frac{\partial }{\partial x \partial y} \fce{f}{x,y}.
    \]
  \end{proof}
\end{thm}

\begin{cor}
  Nechť má funkce $ f $ spojité parciální derivace řádu $ k $. Pak záleží jen
  na počtu derivací v jednotlivých proměnných, ne v jakém pořadí bylo
  derivováno.
\end{cor}

\section{Kompaktní prostory}

\begin{defi}[Supremum]
  \textit{Suprémum} množiny $ M $ je $ s $, tž. 
  \begin{align*}
    \left( \forall x \in M: x \leq s \right) \land \left( \left( \forall x \in M: x \leq y \right) \Rightarrow s \leq y \right)  
  \end{align*}
  Pokud je $ \leq $ lineární, tak je tato definice ekvivalentní s 
  \begin{align*}
    \left( \forall x \in M: x \leq s \right) \land \left( \forall y: y < s \Rightarrow \exists x: y \leq x \right)  
  \end{align*}
\end{defi}

\begin{thm}[Konvergentní podposloupnost]
  Z každé posloupnosti na kompaktním intervalu lze vybrat konvergentní
  podposloupnost.

  \begin{proof}
    Nechť $ \left( x_n \right)_n $ je na kompaktním $ \left< a,b \right> $.
    Označme $ M \deq \{ x \in \left< a,b \right> \suchthat x \leq x_n \text{
    pro nekonečně } n \} $. Toto je nekonečná množina omezená $ a,b $, tedy má
    supremum, nazvěme ho $ s $.

    Z definice suprema je $ \forall n: $ \[
    K_n \deq \left\{ k \suchthat s + \frac{1}{n} \geq x_k \geq s - \frac{1}{n} \right\}
    \] nekonečná. Můžeme tedy $ \forall n $ vybrat $ x_{k_n} \in K_n $, aby $
    k_n > k_{n-1} $. To je hledaná posloupnost.
  \end{proof}
  
\end{thm}

\begin{defi}[Kompaktní prostor]
  Prostor $ \left( X,d \right) $ je \textit{kompaktní} $ \equiv $ v něm každá
  posloupnost má konvergentní podposloupnost.
\end{defi}

\begin{thm}[Kompaktní podprostor]
  Podprostor kompaktního prostoru je kompaktní právě když je uzavřený.
\end{thm}

\begin{thm}[Kompaktní $ \Rightarrow $ uzavřený]
  Kompaktní podprostor libovolného prostoru je uzavřený.
\end{thm}

\begin{defi}[Omezený prostor]
  Prostor $ \left( X,d \right) $ je \textit{omezený} $ \equiv $ \[
    \exists K: \forall x,y \in X: \fce{d}{x,y} < K.
  \]
\end{defi}

\begin{thm}[Kompaktní $ \Rightarrow $ omezený]
  Každý kompaktní prostor je omezený.
\end{thm}

\begin{thm}[Součin kompaktních prostorů]
  Pro $ X_i, i \in \left[ n \right] $ kompaktní platí \[
    \prod_i X_i \text{ je kompaktní. }
  \]
\end{thm}

\begin{defi}[Kompaktní interval]
  V prostoru $ \E_n $ je \textit{kompaktní interval} součin \[
    \prod_i \left< a_i,b_i \right>.
  \]
\end{defi}

\begin{thm}[Kompaktní podprostor $ \E_n $]
  Podprostor $ \E_n $ je kompaktní právě když je uzavřený a omezený.
\end{thm}

\begin{thm}[Kompaktní obraz]
  Nechť $ f: \left( X,d \right) \to \left( Y,d' \right) $ je spojité, $ A
  \subseteq X $ kompaktní množina. Pak $ \fceb{f}{A} $ je kompaktní.
\end{thm}

\begin{thm}[Kompaktnost $ \Rightarrow $ extrémy]
  Nechť $ \left( X,d \right) $ je kompaktní. Pak $ \forall f: \left( X,d
  \right) \to \R $ spojité nabývá minima i maxima.
\end{thm}

\begin{thm}[Homeomorfismus z kompaktní množiny]
  Nechť $ \left( X,d \right) $ je kompaktní, $ f: \left( X,d \right) \to \left(
  Y,d' \right) $ je vzájemně jednoznačné spojité zobrazení. Pak $ f $ je
  \textit{homeomorfismus}.
\end{thm}

\begin{defi}[Cauchyovská posloupnost]
  Posloupnost $ x_n $ je \textit{Cauchyovská} $ \equiv $ \[
    \forall \varepsilon > 0 \; \exists n_0: m,n > n_0 \Rightarrow \fce{d}{x_n, x_m} < \varepsilon
  \]
\end{defi}

\begin{cor}
  Každá konvergentní posloupnost je Cauchyovská.
\end{cor}

\begin{thm}[Cauchy a konvergence]
  Nechť má Cauchyovská posloupnost konvergentní podposloupnost. Pak i ta
  posloupnost konverguje.
\end{thm}

\begin{defi}[Úplný prostor]
  Metrický prostor $ \left( X,d \right) $ je \textit{úplný}, jestliže v něm
  každá Cauchyovská posloupnost konverguje.
\end{defi}

\begin{thm}[Úplný podprostor]
  Podprostor úplného prostoru je úplný právě když je uzavřený.
\end{thm}

\begin{thm}[Kompaktní $ \Rightarrow $ úplný]
  Každý kompaktní prostor je úplný.
\end{thm}

\begin{lemma}[Součin Cauchyovských posloupností]
  Nechť vektory $ \vec x_k \deq \left( x_{0,k}, \dots x_{n,k} \right) $. Pak
  posloupnost $ \left(\vec  x_k \right)_k $ je Cauchyovská v $ \prod_i \left(
  X_i,d_i \right) $, právě když $ \forall i: \left( x_{i,k} \right)_k $ je
  Cauchyovská v $ \left( X_i, d_i \right) $.
\end{lemma}

\begin{thm}
  Součin úplných prostorů je úplný.
\end{thm}

\begin{cor}
  Podprostor $ \E_n $ je úplný právě když je uzavřený.
\end{cor}

\section{Implicitní funkce}

\begin{examp}[Ilustrace úlohy]
  Nechť jsou dány funkce $ \fce{F_i}{x_1,\dots,x_m,y_1,\dots,y_n}, i \in \left[
  n \right] $. Otázka: Existuje funkce $ \vec f, f_i \equiv
  \fce{y_i}{x_1,\dots,x_m} $, která určuje systém rovnic $ \fce{\vec F}{\vec x,
  \vec y} = \vec o $? Jaké vlastnosti mají $ f_i $?
\end{examp}

\begin{thm}[O implicitních funkcích v $ 1+1 $] \label{impl 1 1}
  Buď $ \fce{F}{x,y} $ reálná funkce definovaná na okolí $ \left( x_0,y_0
  \right) $. Nechť má $ F $ spojité parciální derivace do řádu $ k \geq 1 $,
  nechť je $ \fce{F}{x_0,y_0} = 0 $ a $ \absolute{\frac{\partial
  \fce{F}{x_0,y_0}}{\partial y}} \neq 0$. Pak \[ 
    \exists \delta > 0, \Delta > 0 : \forall x \in \left( x_0-\delta, x_0+\delta \right)\;  \exists ! y \in \left( y_0-\Delta, y_0+\Delta \right): \fce{F}{x,y} = 0 
  \]

  Dále, pokud $ \fce{f}{x} \deq y $, pak získaná $ f: \left( x_0-\delta,
  x_0+\delta \right) \to \R $ má spojité derivace do řádu $ k $.

  \begin{proof}[Důkaz existence $ f $]
    Protože $ \fce{F}{x_0, y_0} = 0 $ a $ \fce{\frac{\partial F}{\partial
    y}}{x_0, y_0} \neq 0 $ (BÚNO $ > 0 $), pak $ \exists \delta: \fce{F}{x_0,
    y^+} > 0 \land \fce{F}{x_0, y^-} < 0 $. Ze spojitosti pak také $ \exists
    \varepsilon: \fce{\Omega}{\left( x_0, y^+ \right), \varepsilon} $ je kladné
    a $ \fce{\Omega}{\left( x_0, y^- \right), \varepsilon} $ je záporné, tedy i
    na nějakém intervalu mezi $ x_1 < x_0 < x_2 $. Ze spojitosti pak také
    vyplývá, že při pohybu mezi $ \left( x_*,y^+ \right) $ a $ \left( x_*, y^-
    \right) $ musíme projít nulou, a to $ \forall x_* \in \left( x_1, x_2
    \right) $. Protože tam všude je $ \frac{\partial F}{\partial y} > 0 $, tak
    je $ \fce{F}{x_*,y} $ prostá, tedy nulu protneme právě jednou. Tam tedy
    definujeme funkci $ f $.
  \end{proof}

  \begin{proof}[Důkaz spojitosti.]
    Nechť $ f $ je naše funkce, tedy $ \fce{F}{x, \fce{f}{x}} = 0 $ pro $ x $
    na nějakém okolí $ x_0 $.

    Použijeme Lagrange (\ref{lagrange}) pro výpočet derivace $ f $. Při výpočtu
    si opět pomůžeme trikem $ \fce{f}{t+h} = \fce{f}{t} + \left( \fce{f}{t+h} -
    \fce{f}{t} \right) $:
    \begin{align*}
      &0 = \fce{F}{t+h, \fce{f}{t+h}} - \fce{F}{t} = \fce{F}{t+h, \fce{f}{t} + \left( \fce{f}{t+h} - \fce{f}{t} \right)} =\\ 
        &\left( \frac{\partial }{\partial x} \fce{F}{t+ \theta h, \fce{f}{t} + \theta\left( \fce{f}{t+h} - \fce{f}{t} \right)} \right) h + \left( \frac{\partial }{\partial y} \fce{F}{t+\theta h, \fce{f}{t} + \theta \left( \fce{f}{t+h} - \fce{f}{t} \right)} \right) \left( \fce{f}{t+h} - \fce{f}{t} \right),
    \end{align*}
    jednoduchou úpravou dostaneme \[
    \frac{\fce{f}{t+h} - \fce{f}{t}}h = -\frac{\frac{\partial }{\partial x} \fce{F}{t+ \theta h, \fce{f}{t} + \theta\left( \fce{f}{t+h} - \fce{f}{t} \right)}}{\frac{\partial }{\partial y} \fce{F}{t+\theta h, \fce{f}{t} + \theta \left( \fce{f}{t+h} - \fce{f}{t} \right)}}.
    \]

    Po limitě $ h \to 0 $ dostaneme \[
      \fce{f'}{t} = -\frac{\frac{\partial }{\partial x}\fce{F}{t, \fce{f}{t}}}{\frac{\partial }{\partial y} \fce{F}{t, \fce{f}{t}}},
    \]
    což je výraz, který všude existuje, protože $ \frac{\partial F}{\partial y}
    \neq 0 $. Funkce $ f $ je tedy spojitá. Jako bonus dostáváme i zbytek
    derivací, dokud existují derivace $ F $.
  \end{proof}
\end{thm}

\begin{thm}[O implicitních funkcích v $ m+1 $] \label{impl m 1}
  Buď $ \fce{F}{\vec x,y} $ reálná funkce definovaná na okolí $ \left( \vec x_0,y_0
  \right) $. Nechť má $ F $ spojité parciální derivace do řádu $ k \geq 1 $,
  nechť je $ \fce{F}{\vec x_0,y_0} = 0 $ a $ \absolute{\frac{\partial
  \fce{F}{\vec x_0,y_0}}{\partial y}} \neq 0$. Pak \[ 
    \exists \delta > 0, \Delta > 0 : \forall \vec x: \norm{\vec x - \vec x_0} < \delta \; \exists ! y \in \left( y_0-\Delta, y_0+\Delta \right): \fce{F}{\vec x,y} = 0 
  \]

  Dále, pokud $ \fce{f}{\vec x} \deq y $, pak získaná $ f: \left( \prod_i
    \left( x_{0,i}-\delta,
    x_{0,i}+\delta \right) \right) \to \R $ má spojité derivace do řádu $ k $.

  \begin{proof}
    Důkaz v obou krocích funguje identicky jako \ref{impl 1 1}.
  \end{proof}
  
\end{thm}

\begin{defi}[Jacobiho determinant]
  Pro $ \vec y = \left( y_i \suchthat i \in \left[ m \right] \right), \vec F = \left( \fce{F_i}{\vec y} \suchthat i \in \left[ m \right] \right) $ definujeme \textit{Jacobiho determinant}, aka Jacobián, jako \[
    \frac{\fce{D}{\vec F}}{\fce{D}{\vec y}} = \fce{\det}{\frac{\partial F_i}{\partial y_j}}_{i,j \in \left[ m \right]}.
  \]
\end{defi}

\begin{thm}[O implicitních funkcích v $ m+n $] \label{impl}
  Nechť $ \vec y = \left( y_1, \dots y_n \right) , \fce{\vec F}{\vec
  x, \vec y} = \left( \fce{F_1}{\vec x, \vec y}, \dots, \fce{F_n}{\vec x, \vec
  y} \right) $ je funkce o $ m+n $ proměnných se spojitými derivacemi řádu $ k \geq 1 $. Dále, nechť $ \left( \vec x_0, \vec y_0 \right) $ je bod, kde \begin{enumerate}
    \item $ \fce{\frac{\fce{D}{\vec F}}{\fce{D}{\vec y}}}{\vec x_0, \vec y_0} \neq 0 $,
    \item $ \fce{\vec F}{\vec x_0, \vec y_0} = \vec o $.
  \end{enumerate}
  
  Pak $ \exists \delta, \Delta > 0: $ \[
    \forall \vec x \in \fce{\okoli}{\vec x_0, \delta} \;\exists ! \vec y \in \fce{\okoli}{\vec y_0, \Delta}: \fce{\vec F}{\vec x, \vec y} = \vec o.
  \]

  Pokud označíme tyto $ \vec y = \fce{\vec f}{\vec x}, $ pak mají $ \forall i \in \left[ n \right] \; f_i $ spojité parciální derivace řádu $ k $.

  \begin{proof}
    Indukcí. Pro $ n=1 $ se dostáváme na \ref{impl m 1}. Nyní, nechť platí pro
    $ n $ a máme $ \fce{F_i}{\vec x, \vec y}_{i \leq n+1} $ splňující
    předpoklady.

    Protože Jacobián je nenulový, pak poslední sloupec je nenulový, BÚNO není
    nula poslední pozice $ m+1, m+1 $. Nechť $ \vec y' $ je prvních $ n $ pozic
    vektoru $ \vec y $. Podle IP existuje pro poslední rovnici funkce $
    \fce{\psi}{\vec x, \vec y'} $, tž. po dosazení za $ y_{m+1} $ na nějakém $
    \delta $-okolí vyjde v poslední rovnici nula. 

    Protože pro jiné $ y_{m+1} $ nula nevyjde, pak jestli má existovat nějaké
    řešení, tak musí $ y_{m+1} $ splňovat $ \psi $, tedy můžeme $ \psi $
    dosadit ve všech rovnicích v $ \vec F $. Výsledek označme $ \vec G: $ \[
      \fce{\vec G}{\vec x, \vec y'} = \fce{\vec F}{\vec x, \vec y', \fce{\psi}{\vec x, \vec y'}}.
    \]

    Navíc, $ \psi $ má tolik parciálních derivací, jako jich má $ F_{m+1} $,
    tedy jich tolik má i $ \vec F $. Zbývá ověřit, že na $ \vec G $ lze použít
    IP, tedy že má nenulový determinant. Původní matice vypadala jako: \[
      \left( \frac{\partial F_i}{\partial y_j} \right)_{ij}.
    \]
    Přičtěme k $ j $-tému sloupci $ \frac{\partial \psi}{\partial y_j} $-násobek
    $ \left( m+1 \right) $-ního. Získáme matici \[
      \left( \frac{\partial F_i}{\partial y_j} + \frac{\partial F_{i}}{\partial y_{m+1}} \frac{\partial \psi}{\partial y_j} \right)_{ij} \stackrel{\ref{retez}}{=} \left( \frac{\partial G_i}{\partial y_j} \right),
    \]
    jejíž poslední řádek je nulový až na poslední člen, který je $ \frac{\partial F_{m+1}}{\partial y_{m+1}} $. Získáváme vztah \[
      0 \neq \frac{\fce{D}{\vec F}}{\fce{D}{\vec y}} = \frac{\partial F_{m+1}}{\partial y_{m+1}} \frac{\fce{D}{\vec G}}{\fce{D}{\vec y'}},
    \]
    tedy IP lze použít a věta je dokázaná.
  \end{proof}
  
\end{thm}

\subsection{Vázané extrémy}

\begin{thm}[O vázaných extrémech]
  Nechť $ f, g_1, \dots, g_k $ jsou funkce definované na otevřené $ D \subseteq
  \E_n \to \R $, mají parciální derivace. Nechť $ M $ je matice \[
    M \deq \left( \frac{\partial g_i}{\partial x_j} \right)_{ij}: i \in \left[ k \right], j \in \left[ n \right],
  \]
  a její hodnost nechť je maximální (tedy $ k $) $ \forall  \vec x \in D $.

  Nechť nabývá $ f $ v bodě $ \vec a $ lokálního extrému podmíněného vazbami $
  \fce{\vec g}{\vec x} = \vec o $. Pak existují $ \lambda_1, \dots, \lambda_k
  $, takové, že $ \forall i \in \left[ n \right]: $\[
    \frac{\partial \fce{f}{\vec a}}{\partial x_i} + \sum_{j=1}^{k} \lambda_j \frac{\partial \fce{g_j}{\vec a}}{\partial x_i} = 0.
  \]

  \begin{proof}
    Z hodnosti matice $ M $ vyplývá, že pro $ i \leq k $ je přesně definované
    řešení rovnice \[
      \frac{\partial \fce{f}{\vec a}}{\partial x_i} + \sum_{j=1}^{k} \lambda_j \frac{\partial \fce{g_j}{\vec a}}{\partial x_i} = 0.
    \]

    Těžší část důkazu bude ukázat, že to platí i pro ostatní $ i $ se stejnými
    lambdami. Protože $ M $ má rank $ k $, existuje $ M' $, regulární čtvercová
    matice $ k \times k $, BÚNO je to prvních $ k $ sloupců. Podle \ref{impl}
    tedy existuje funkce $ \psi $, tž. $ \fce{\vec g}{\fce{\psi}{\vec
    x'}, \vec x'} = \vec o $. Protože navíc v bodě $ \vec a $ je extrém $ f $
    při $ \vec g = 0 $, tak $ \forall i > k: $ \[
      \frac{\partial }{\partial x_i} \fce{f}{\fce{\psi}{\vec a'}, \vec a'} = 0 \stackrel{\ref{retez}}{=} \frac{\partial \fce{f}{\vec a}}{\partial x_i} + \sum_{j=1}^{k} \frac{\partial \fce{f}{\vec a}}{\partial x_j} \frac{\partial \fce{\psi_j}{\vec a'}}{\partial x_i}.
    \]

    Stejný trik lze udělat i u $ \fce{\vec g}{\fce{\psi}{\vec x'}, \vec x'} $, protože ta je konstantní $ 0 $. Opět $ \forall i > k: $\[
      \frac{\partial }{\partial x_i} \fce{g_l}{\fce{\psi}{\vec a'}, \vec a'} = 0 \stackrel{\ref{retez}}{=} \frac{\partial \fce{g_l}{\vec a}}{\partial x_i} + \sum_{j=1}^{k} \frac{\partial \fce{g_l}{\vec a}}{\partial x_j} \frac{\partial \fce{\psi_j}{\vec a'}}{\partial x_i}.
    \]

    Nyní se podíváme na požadovanou rovnici explicitně pro $ i > k $: \begin{align*}
      \frac{\partial \fce{f}{\vec a}}{\partial x_i} + \sum_{j=1}^{k} \lambda_j \frac{\partial \fce{g_j}{\vec a}}{\partial x_i} &= \left( - \sum_{r=1}^{k} \frac{\partial \fce{f}{\vec a}}{\partial x_r} \frac{\partial \fce{\psi_r}{\vec a'}}{\partial x_i} \right) + \sum_{j=1}^{k} \lambda_j \left( - \sum_{r=1}^{k} \frac{\partial \fce{g_j}{\vec a}}{\partial x_r} \frac{\partial \fce{\psi_r}{\vec a'}}{\partial x_i} \right) \\
      &= - \sum_{r=1}^{k} \underbrace{\left( \frac{\partial \fce{f}{\vec a}}{\partial x_r} + \sum_{j=1}^{k} \lambda_j \frac{\partial \fce{g_j}{\vec a}}{\partial x_r}\right)}_{0} \frac{\partial \fce{\psi_r}{\vec a'}}{\partial x_i} = 0.
  \end{align*}
  
\end{proof}
\end{thm}

\subsection{Regulární zobrazení}

\begin{defi}[Regulární zobrazení]
Nechť $ U \subseteq \E_n $ je otevřená, $ \forall i \in \left[ n \right]: f_i
  $ mají spojité parciální derivace. Pak je $ \vec f : U \to \E_n $
  \textit{regulární} $ \equiv $\[
    \forall \vec x_0 \in U: \fce{\frac{\fce{D}{\vec f}}{\fce{D}{\vec x}}}{\vec x_0} \neq \vec o.
  \]
\end{defi}

\begin{thm}
  Je-li $ \vec f $ regulární, pak $ \forall V \subseteq U $ otevřené je $ \vec
  f \left[ V \right] $ otevřená.

  \begin{proof}
    Chceme ukázat, že $ \forall y \in \fce{\Omega}{y_0, \delta} \, \exists x
    \in \fceb{f}{V}: \fce{f}{x} = y $.


    Nechť $ \fce{F_i}{\vec x, \vec y} \deq \fce{f}{\vec x} - y_i $. Z
    \ref{impl} existuje $ \psi $, tž. $ \fce{F_i}{\fce{\psi}{\vec y}, \vec y} =
    0 $, tedy $ \fce{f}{\fce{\psi}{\vec y}} = \vec y $. Věta tedy platí.
  \end{proof}
\end{thm}

\begin{defi}[Restrikce]
  Pro $ f: A \to B $, $ C \subseteq A $ je \textit{restrikce} $ f|C $ zobrazení
  $ f|C: C \to B $, kde $ \forall x \in C: \fce{f|C}{x} = \fce{f}{x} $.
\end{defi}

\begin{thm}
  Nechť je $ \vec f $ regulární. Pak $ \forall \vec x_0 \in U \; \exists V $
  otevřené okolí $ \vec x_0 $ takové, že \begin{enumerate}
    \item $ \vec f|V $ je prosté zobrazení,
    \item $ \exists \left( \vec f|V \right)^{-1}: \vec f \left[ V \right] \to \E_n $ a je regulární.
  \end{enumerate}

  \begin{proof}
    Opět použijeme $ \fce{F_i}{\vec x, \vec y} \deq \fce{f}{\vec x} - y_i $,
    akorát na $ \vec x $ místo $ \vec y $. Věta pak plyne z jednoznačnosti $
    \psi $ a z vlastností násobení matic a determinantů.
  \end{proof}
  
\end{thm}

\begin{cor}
  Prosté regulární $ \vec f $ má regulární inverzi.
\end{cor}

\section{Integrály}

\begin{defi}[Objem]
  \textit{Objem} množiny $ A \subseteq \E_n $ je funkce s násedujícími vlastnostmi: \begin{enumerate}
    \item $ A \subseteq B \implies \fce{\vol}{A} \leq \fce{\vol}{B} $,
    \item $ \fce{\vol}{A \cup B} = \fce{\vol}{A} + \fce{\vol}{B} - \fce{\vol}{A \cap B} $,
    \item $ \vol $ je zachován isometrií,
    \item v $ \E_n $ platí \[
        \fce{\vol}{\prod_{i \in \left[ n \right]} \left< a_i, b_i \right>} \deq \prod_{i \in \left[ n \right]} \left( b_i - a_i \right).
    \]
  \end{enumerate}
  
\end{defi}

\begin{cor}
    Pro $ m < n: $ v $ \E_n $ je $ \fce{\vol}{\prod_{i \in \left[ m \right]} \left< a_i, b_i \right>} = 0 $.
\end{cor}

\begin{defi}[Stejnoměrná spojitost]
  Nechť $ f: \left( X,d \right) \to \left( Y,d' \right) $. Pak $ f $ je \textit{stejnoměrně spojité} $ \equiv $ \[
    \forall \varepsilon > 0 \; \exists \delta > 0: \forall x,y \in X: \left( \fce{d}{x,y} < \delta \implies \fce{d}{\fce{f}{x}, \fce{f}{y}} < \varepsilon \right).
  \]
\end{defi}

\begin{thm}[Kompaktnost \& stejnoměrná spojitost]
  Nechť $ X $ je kompaktní, $ f: \left( X, d \right) \to \left( Y,d' \right) $
  je spojité. Pak $ f $ je i stejnoměrně spojité.

  \begin{proof}
    Sporem. Předpokládáme, že $ f $ je spojitá, ale ne stejnoměrně, tedy $ \exists \varepsilon: \forall \delta: $\[
      \exists x_\delta, y_\delta: \fce{d}{x_\delta, y_\delta} < \delta \land \fce{d}{\fce{f}{x_\delta}, \fce{f}{y_\delta}} \geq \varepsilon.
    \]

    Zadefinujeme $ \left( x_n \right)_n, \left( y_n \right)_n $, kde $ x_n =
    x_\delta, y_n = y_\delta $ pro $ \delta = \frac{1}{n} $. Vybereme z nich
    konvergentní podposloupnosti (kompaktnost), tyto posloupnosti konvergují k
    sobě ($ \delta $ libovolně malá), jejich limita je tedy stejná. Limita
    jejich funkčních hodnot ale nemůže být stejná, musí se lišit o $
    \varepsilon $, tedy $ f $ není spojitá. $ \lightning $
  \end{proof}
\end{thm}

\subsection{Jedna proměnná}

\begin{defi}[Rozdělení]
  \textit{Rozdělení} intervalu $ \left< a,b \right> \equiv$ \[
    \left( a, t_1, t_2, \dots, b \right), a < t_1 < t_2 < \dots < b.
  \]

  Spolu s rozdělením definujeme dále pojmy \begin{itemize}
    \item \textit{jemnost} $ \equiv \fce{\mu}{P} \deq \fce{\Max_i}{t_i - t_{i-1}}$,
    \item \textit{zjemnění} $P \equiv $ nové rozdělení  $ P': P \subseteq P' $.
  \end{itemize}
\end{defi}

\begin{defi}[Součty]
  Pro $ f: \left< a,b \right> \to \R $, rozdělení $ P $ jsou horní/dolní Riemannovy součty funkce $ S,s \equiv$\[
    \fce{s}{f,P} \deq \sum_{i=1}^{n} m_i \left( t_i - t_{i-1} \right),
  \]\[
    \fce{S}{f,P} \deq \sum_{i=1}^{n} M_i \left( t_i - t_{i-1} \right),
  \]
  kde $ m_i \deq \fcec{\inf}{\fce{f}{x} \suchthat x \in \left< t_{i-1}, t_i
  \right>} $ a $ M_i \deq \fcec{\sup}{\fce{f}{x} \suchthat x \in \left<
  t_{i-1}, t_i \right>} $.
\end{defi}

\begin{cor}
  Pro $ f: \left< a,b \right> \to \R $, rozdělení $ P $, $ P' $ jeho zjemnění platí \begin{enumerate}
    \item $ \fce{s}{f, P} \leq \fce{s}{f,P'} $,
    \item $ \fce{S}{f, P} \geq \fce{S}{f,P'} $,
    \item $ \fce{s}{f, P} \leq \fce{S}{f,P} $.
  \end{enumerate}
\end{cor}

\begin{defi}[Integrál]
  Pro $ f: \left< a,b \right> \to \R $ je \begin{itemize}
    \item \textit{horní Riemannův integrál $ \equiv $} \[
      \overline{\int_{a}^{b}} \fce{f}{x} \text{d}x \deq \fcec{\inf}{\fce{S}{f, P} \suchthat P \text{ rozdělení}},
    \]
    \item \textit{dolní Riemannův integrál $ \equiv $} \[
      \underline{\int_{a}^{b}} \fce{f}{x} \text{d}x \deq \fcec{\sup}{\fce{s}{f, P} \suchthat P \text{ rozdělení}}.
    \]
  \end{itemize}
  
  Pokud $ \overline{\int_{a}^{b}} \fce{f}{x} \text{d}x = \underline{\int_{a}^{b}} \fce{f}{x} \text{d}x $, označujeme je jako \textit{Riemannův integrál}, značíme: \[
    \integ abx {\fce{f}{x}}.
  \]
\end{defi}

\begin{thm}[Existence RI]
  Riemannův integrál existuje $ \forall f: \left< a,b \right> \to \R $, pokud \[
    \forall \varepsilon \;\exists P: \fce{S}{f,P} - \fce{s}{f,P} \leq \varepsilon.
  \]
\end{thm}

\begin{thm}[Spojitost \& integrál]
  Pro každou spojitou $ f $ existuje Riemannův interál.

  \begin{proof}
    Náčrt. Když existuje pro každý bod okolí, na kterém se jeho hodnota změní
    libovolně málo, pak bude existovat i jemnost rozdělení, na kterým se budou
    součty lišit libovolně málo.
  \end{proof}
\end{thm}

\begin{thm}[Střední hodnota pro integrál]
  Nechť $ f: \left< a,b \right> \to \R $ je spojitá. Pak $ \exists c \in \left< a,b \right>: $ \[
    \integ abx {\fce{f}{x}} = \fce{f}{c} \left( b-a \right).
  \]
\end{thm}

\begin{lemma}
  Nechť $ f $ je spojitá, $ a < b < c $. Pak \[
    \integ abx {\fce{f}{x}} + \integ bcx {\fce{f}{x}} = \integ acx {\fce{f}{x}}.
  \]
\end{lemma}

\begin{thm}[Základní věta analýzy]
  Nechť $ f: \left< a,b \right> \to \R $ je spojitá. Pro $ x \in \left< a,b \right> $ definujme \[
    \fce{F}{x} \deq \integ axt {\fce{f}{t}}.
  \] 

  Pak $ \fce{F'}{x} = \fce{f}{x} $.
\end{thm}

\begin{cor}
  Nechť $ f: \left< a,b \right> \to \R $ je spojitá. Potom má primitivní funkci
  $ G $ na $ \left( a,b \right) $ spojitou na $ \left< a,b \right> $. Navíc pro
  každou $ G $ primitivní k $ f $ na $ \left( a,b \right) $, spojitou na $
  \left< a,b \right> $, platí \[
    \integ abx {\fce{f}{x}} = \fce{G}{b} - \fce{G}{a}.
  \]
\end{cor}

\begin{cor}
  Nechť $ f: \left< a,b \right> \to \R $ je spojitá. Pak $\exists c: a < c < b :$ \[
    \fce{F}{b} - \fce{F}{a} = \integ abx {\fce{f}{x}} = \fce{f}{c} \left( b-a \right) = \fce{F'}{c} \left( b-a \right).
  \]
\end{cor}

\subsection{Více proměnných}

\begin{defi}[Rozdělení ve více proměnných]
  Nechť $ J = \prod_{i \in \left[ n \right]} \left< a_i, b_i \right> $. Pak $ P $ je \textit{rozdělení intervalu} $ \equiv P = \left( P_i \right)_{i \in \left[ n \right]}:$ \[
    P_j = \left( t_{j,k} \right)_{k \in \left[ n_j \right]}: t_{j,0} = a_j \land t_{j,n_j} = b_j \land \forall l,m: \left( l < m \implies t_{j,l} < t_{j,m} \right).
  \]

  Intervalům $ \prod_{i \in \left[ n \right]} \left< t_{i,j_i}, t_{i,j_i+1} \right>$ říkáme \textit{cihly rozdělení $ P $} a $ \fce{\bb}{P} $ je \textit{množina všech cihel rozdělení $ P $}.
\end{defi}

\begin{cor}
  Pro $ J $ kompaktní interval a $ P $ jeho rozdělení je \[
    \fce{\vol}{J} = \sum_{B \in \fce{\bb}{P}}^{} \fce{\vol}{B}.
  \]
\end{cor}

\begin{defi}[Diametr intervalu]
  Nechť $ J = \prod_{i \in \left[ n \right]} \left< a_i, b_i \right> $. Pak \textit{diametr intervalu} $ \equiv $ \[
    \fce{\diam}{J} = \fce{\Max_{i \in \left[ n \right]}}{b_i - a_i}.
  \]
\end{defi}

\begin{defi}[Jemnost rozdělení]
  Nechť $ P $ je rozdělení nějakého kompaktního intervalu. Pak $ \fce{\mu}{P} $ je \textit{jemnost rozdělení $ P $} $ \equiv $ \[
    \fce{\mu}{P} \deq \fce{\Max_{B \in \fce{\bb}{P}}}{\fce{\diam}{B}}.
  \]
\end{defi}

\begin{defi}[Zjemnění]
  Nechť $ Q = \left( Q_i \right)_i, P = \left( P_i \right)_i $ jsou rozdělení. Pak $ Q $ \textit{zjemňuje} $ P \equiv $ \[
    \forall i: Q_i \text{ zjemňuje } P_i.
  \]
\end{defi}

\begin{cor}
  Nechť $ Q $ je zjemnění $ P $. Pak $ \forall B \in \fce{\bb}{P} $ nechť je $ Q_B $ ta část rozdělení $ Q $, která dělí cihlu $ B   $. Pak platí \[
    \fce{\bb}{Q} = \bigcup_{B \in \fce{\bb}{P}} \fce{\bb}{Q_B}.
  \]
\end{cor}

\begin{cor}
  Každá $ P,Q $ rozdělení $n$-rozměrného kompaktního intervalu mají společné zjemnění.
\end{cor}

\begin{defi}
  Nechť $ f: J \to \R $ je omezená, $ J $ je kompaktní $ n $-rozměrný, $ B \subseteq J $ je $ n $-rozměrný kompaktní podinterval. Definujeme \[
    \fce{m}{f,B} \deq \fce{\inf_{\vec x \in B}}{\fce{f}{\vec x}},
  \]\[
    \fce{M}{f,B} \deq \fce{\sup_{\vec x \in B}}{\fce{f}{\vec x}}.
  \]
\end{defi}

\begin{cor}
  Nechť $ C \subseteq B $. Pak \begin{align*}
    \fce{m}{f,B} &\leq \fce{M}{f,B}, \\
    \fce{m}{f,B} &\leq \fce{m}{f,C}, \\
    \fce{M}{f,C} &\leq \fce{M}{f,B}. \\
  \end{align*}
\end{cor}

\begin{defi}[Horní, dolní součty]
  Pro $ P $ rozdělení $ J $ a $ f: J \to \R $ omezenou definujeme \begin{align*}
    \fce{s_J}{f,B} \deq \sum_{B \in \fce{\bb}{P}}^{} \fce{M}{B}, \\
    \fce{S_J}{f,B} \deq \sum_{B \in \fce{\bb}{P}}^{} \fce{m}{B}, \\
  \end{align*}
\end{defi}

\begin{thm}
  Nechť $ Q $ je zjemnění $ P $. Pak \[
    \fce{s}{f,P} \leq \fce{s}{f,Q} \leq \fce{S}{f,Q} \leq \fce{S}{f,P}.
  \]
\end{thm}

\begin{thm}
  Nechť $ P,Q $ jsou libovolná rozdělení. Pak \[
    \fce{s}{f,P} \leq \fce{S}{f,Q}.
  \]

  Tedy jsou $ s,S $ omezené shora, zdola.
\end{thm}

\begin{defi}[Riemannův integrál]
  Nechť $ f: J \to \R $ je omezená, $ J $ je kompaktní $ n $-rozměrný. 

  \textit{Horní Riemannův integrál} funkce $ f $ přes $ J $ je \[
    \overline{\int_{J}^{}} \fce{f}{\vec x} \text{d}\vec x \deq \fcec{\inf}{\fce{S}{f, P} \suchthat P \text{ rozdělení}}.
  \]

  \textit{Dolní Riemannův integrál} funkce $ f $ přes $ J $ je \[
    \underline{\int_{J}^{}} \fce{f}{\vec x} \text{d}\vec x \deq \fcec{\inf}{\fce{S}{f, P} \suchthat P \text{ rozdělení}}.
  \]

  Pokud jsou si rovny, pak definujeme \textit{Riemannův integrál} funkce $ f $ přes $ J $ jako \begin{align*}
    \integ J{}{\vec x}{\fce{f}{\vec x}} &= \underline{\int_{J}^{}} \fce{f}{\vec x} \text{d}\vec x = \overline{\int_{J}^{}} \fce{f}{\vec x} \text{d}\vec x. \\
                                        &\equiv \int_J \fce{f}{x_1, \dots, x_n} \text{d}x_1, \dots, x_n \\
                                        &\equiv \int_J \fce{f}{x_1, \dots, x_n} \text{d}x_1, \dots, \text{d}x_n
  \end{align*}
\end{defi}

\begin{thm}
  Riemannův integrál funkce $ f $ existuje, právě když $ \forall \varepsilon > 0 \; \exists P $ rozdělení: \[
    \fce{S_J}{f,P} - \fce{s_J}{f,P} < \varepsilon.
  \]
\end{thm}

\begin{thm}
  Každá spojitá $ f $ na $ n $-rozměrném kompaktním $ J $ má Riemannův integrál.
\end{thm}

\begin{thm}[Fubini]
  Nechť $ J' \in \E_n, J''\! \in \E_m, \, J = J' \times J'' $. Nechť $ f: J \to
  \R $. Nechť $ \exists \integ J{}{\vec x \vec y}{\fce{f}{\vec x, \vec y}} $ a
  $ \forall \vec x \in J' \; \exists \integ {J''}{}{\vec y}{\fce{f}{\vec x, \vec
  y}} $, stejně jako $ \forall \vec y \in J''\; \exists \integ {J'}{}{\vec x}{\fce{f}{\vec x, \vec y}} $. Pak \[
    \integ J{}{\vec x \vec y}{\fce{f}{\vec x, \vec y}} = \integ {J'}{}{\vec x}{\left( \integ {J''}{}{\vec y}{\fce{f}{\vec x, \vec y}} \right)}
  \]

  \begin{proof}
    Nechť $ \fce{F}{\vec y} = \int_{J''} \fce{f}{\vec x, \vec y} \dd \vec x $.
    Ukážeme, že $ \int_{J'} \fce{F}{\vec y} \dd \vec y = \int_J \fce{f}{\vec x,
    \vec y} \dd \vec x \vec y $, a to přímo z definice.

    Víme, že $ \int_J f $ existuje, tedy pro dané $ \varepsilon $ zvolíme
    rozdělení $ P $, aby \[
      \int_J f - \varepsilon \leq \fce{s}{f, P} \leq \fce{S}{f, P} \leq \int_J f + \varepsilon.
    \]

    Toto rozdělení roztrhneme na $ P', P'' $. Z definice $ F $ víme, že \[
      \sum_{B'' \in \fce{\bb}{P''}}^{} \fce{\min_{\vec x \in B''}}{\fce{f}{\vec x, \vec y}} \fce{\vol}{B''} \leq \fce{F}{\vec y} \leq \sum_{B'' \in \fce{\bb}{P''}}^{} \fce{\max_{\vec x \in B''}}{\fce{f}{\vec x, \vec y}} \fce{\vol}{B''}.
    \]
    Z toho a ze vztahu pro integrál $ \int_{J'} F $ máme \begin{align*}
      \fce{S}{F, P'} &\leq \sum_{B' \in \fce{\bb}{P'}}^{} \fce{\max_{\vec y \in B'}}{\sum_{B'' \in \fce{\bb}{P''}}^{} \fce{\max_{\vec x \in B''}}{\fce{f}{\vec x, \vec y}} \fce{\vol}{B''} }\fce{\vol}{B'} \\
                     &\leq \sum_{B \in \fce{\bb}{P}}^{} \fce{\max_{\vec z \in B}}{\fce{f}{\vec z}} \fce{\vol}{B} = \fce{S}{f, P},
    \end{align*} podobně i \[
      \fce{s}{F, P'} \geq \sum_{B \in \fce{\bb}{P}}^{} \fce{\min_{\vec z \in B}}{\fce{f}{\vec z}} \fce{\vol}{B} = \fce{s}{f, P}.
    \]

    Vyšlo nám tedy \[
      \int_J f - \varepsilon \leq \fce{s}{f, P} \leq \int_{J'} F \leq \fce{S}{f, P} \leq \int_J f + \varepsilon.
    \]
  \end{proof}
  
\end{thm}

\begin{defi}[Bodová konvergence funkcí]
  Nechť $ \forall n: f_n: \left( X, d \right) \to \left( Y,d' \right) $. Pak $
  \left( f_n \right)_n $ \textit{bodově konverguje} k $ f \equiv $\[
    \forall x: \lim_{n \to \infty} \fce{f_n}{x} = \fce{f}{x}.
  \]
\end{defi}

\begin{defi}[Stejnoměrná konvergence funkcí]
  Nechť $ \forall n: f_n: \left( X, d \right) \to \left( Y,d' \right) $. Pak $
  \left( f_n \right)_n $ \textit{stejnosměrně konverguje} k $ f \equiv $ \[
    \forall \varepsilon \; \exists n_0: \forall x \in X, n \in \N: \left( n \geq n_0 \implies \fce{d'}{\fce{f_n}{x}, \fce{f}{x}} < \varepsilon \right).
  \]

  Značíme $ \left( f_n \right)_n \rightrightarrows f $.
\end{defi}

\begin{thm}
  Nechť $ \forall n: f_n $ je spojité a $ f_n \rightrightarrows f $. Pak $ f $ je spojité.
\end{thm}

\begin{thm}
  Nechť $ \forall n \; \exists \integ abx{\fce{f_n}{x}} $ a $ f_n
  \rightrightarrows f $. Pak \[
    \integ abx{\fce{f}{x}} = \lim_n \integ abx{\fce{f_n}{x}}.
  \]
\end{thm}

\begin{lemma}
  Nechť $ \forall \left( x_n \right)_n: \lim_n x_n = a \implies \lim_n \fce{g}{x_n} = A $. Pak \[
    \lim_{x \to a} \fce{g}{x} = A.
  \]
\end{lemma}

\begin{thm}
  Nechť $ f: \left< a,b \right> \times \left< c,d \right> \to \R $ je spojitá.
  Pak \[
    \lim_{y \to y_0} \integ abx{\fce{f}{x,y}} = \integ abx{\fce{f}{x,y_0}}.
  \]
\end{thm}

\begin{thm}
  Nechť $ f: \left< a,b \right> \times \left< c,d \right> \to \R  $ je spojitá
  a má spojitou parciální derivaci podle $ y $ v $ \left< a,b \right> \times
  \left( c,d \right) $. Pak má $ \integ abx{\fce{f}{x,y}} $ na $ \left( c,d
  \right) $ derivaci a platí \[
    \deriv{}y \integ abx {\fce{f}{x,y}} = \integ abx {\frac{\partial \fce{f}{x,y}}{\partial y}}.
  \]
\end{thm}

\begin{prop}
  Nechť $ A,B $ jsou disjunktní uzavřené množiny v $ \left( X,d \right) $. Pak funkce \[
    \fce{\varphi}{x} = \frac{\fce{d}{x,A}}{\fce{d}{x,A}+\fce{d}{x,B}}
  \] je spojitá.
\end{prop}

\begin{lemma}
  Nechť $ \forall n: \phi_n: X \to \R $ jsou spojité a nechť $ \exists \alpha:
  0 < \alpha < 1 $, tž. $ \forall n: \absolute{\fce{\phi_n}{x}} \leq
  \alpha^n $. Nechť $ g_n \deq \sum_{k=1}^{n} \phi_k $. Pak funkce $ g_n $ stejnoměrně konvergují ke $ g: X \to \R $.
\end{lemma}


\begin{thm}[Tietzeova]
  Nechť je $ Y $ uzavřený podprostor metrického prostoru $ X $. Pak $ \forall
  f: Y \to \left< a,b \right> $ spojitá na $ Y $ se dá rozšířit na $ f': X \to
  \left< a,b \right> $ spojitou na $ X $.
  % pozor, sjednoceno v Dk ne!
\end{thm}

\begin{defi}[Lebesgueův integrál]
  \textit{Lebesgueův integrál} je rozšíření definice Riemannova integrálu, aby
  fungoval např. lépe na limity.
\end{defi}

\begin{thm}[Pravidla pro Lebesgueův integrál]
  \ \begin{enumerate}
    \item Pokud Riemannův integrál existuje na intervalu $ J $, shoduje se s Lebesgueovým,
    \item Pokud $ \int_{D_n} f $ existuje $ \forall n $, pak existuje i $ \int_{\bigcup_n D_n} f $,
    \item Pokud $ \forall n: \int_{D} f_n $ existuje a $ \left( f_n \right)_n $ je monotonní, pak existuje i $ \int_D \lim_n f_n = \lim_n \int_D f_n $,
    \item Pokud $ \forall n: \int_{D} f_n $ existuje a $ \absolute{f_n} \leq g $, kde $ g $ má $ \int_D g $, pak existuje i $ \int_D \lim_n f_n = \lim_n \int_D f_n $,
    \item Pokud $ D $ je omezená a $ \exists C: \forall n,x: \absolute{\fce{f_n}{x}} \leq C $, pak existuje i $ \int_D \lim_n f_n = \lim_n \int_D f_n $.
  \end{enumerate}
\end{thm}

\begin{thm}[Substituce]
  Nechť $ \phi: U \to \E_n $, kde $ U \subseteq \E_n $ a $ D \subseteq U, \vec f: D \to \E_n $. Pak \[
    \int_{\phi \left[ D \right]} \fce{\vec f}{\vec x} \dd x = \int_{D} \fce{\vec f}{\fce{\phi}{\vec x}} \absolute{\frac{\fce{D}{\phi}}{\fce{D}{\vec x}}} \dd x.
  \]
\end{thm}
\end{document                </a></li>

<li><a href="https://gitlab.mff.cuni.cz/uradnikf/bc_lec/-/raw/master/2223z/logika/main.pdf">Výroková a predikátová logika}
\author{Filip Úradník}
\date{\today}

\input{template}
\input{czech_c}
\usepackage{stmaryrd}

\DeclareMathOperator{\Thm}{Thm}
\DeclareMathOperator{\aut}{Aut}
\DeclareMathOperator{\delo}{DeLO}
\DeclareMathOperator{\Th}{Th}
\DeclareMathOperator{\Term}{Term}
\DeclareMathOperator{\Proof}{Proof}
\DeclareMathOperator{\Prf}{Prf}
\DeclareMathOperator{\Con}{Con}
\DeclareMathOperator{\ar}{ar}
\DeclareMathOperator{\Df}{Df}
\def\dfn{\Df^n}
\def\P{\mathbb{P}}
\def\P{\mathbb{P}}
\def\uzaver{\mathcal{R}}
\def\Mp{M_\P}
\def\pha{P\!H^\aa}
\def\pa{P\!A}
\def\fcenb#1#2#3{\fceb{\fce{#1}{#2}}{#3}}
\def\vfp{V\!F_\mathbb{P}}
\def\vfpsim{\vfp \slash_\sim}
\def\implgraph{\mathcal{G}_\varphi}
\def\restrict#1#2{#1\!\restriction_{#2}}
\def\treelt{<_T}
\def\treegt{>_T}
\def\rr{\mathcal{R}}
\def\ff{\mathcal{F}}
\def\bb{\mathcal{B}}
\def\aa{\mathcal{A}}
\def\aas{\aa \slash_\sim}

\begin{document}
\maketitle
\tableofcontents

\pagestyle{fancy}
\fancyhead{}
\fancyhead[R]{\itshape\nouppercase{\leftmark}}


\chapter{Výroková logika}

\section{Syntax a sémantika}

\begin{defi}[Výrokové proměnné]
  Množina $ \P $ je \textit{množina výrokových proměnných}, které buď značíme $ p_i $, nebo písmeny $ p,q,r,s $.
\end{defi}

\begin{defi}[Jazyk]
  \textit{Jazyk} je určen množinou $ \P $, navíc do něj patří \textit{logické symboly}: $ \land, \lor, \rightarrow, \leftrightarrow $; a závorky.
\end{defi}

\begin{defi}[Výrok]
  \textit{Výrok} v jazyce $ \P $ je prvek množiny $ \vfp $
\end{defi}

\begin{defi}[Množina $ \vfp $]
  $ \vfp $ nazveme nejmenší množinu, pro kterou platí:
  \begin{itemize}
    \item $ \forall p \in \P: p \in \vfp $
    \item $ \forall \varphi \in \vfp: \left( \lnot \varphi \right) \in \vfp $
    \item $ \forall \varphi ,\psi \in \vfp, \forall \; \square \in \{ \land, \lor \}: \left( \varphi \; \square \; \psi \right) \in \vfp $
  \end{itemize}
  
\end{defi}

\begin{defi}[Podvýrok]
  \textit{Podvýrok} je podřetězec výroku, který je sám o sobě výrokem.
\end{defi}

\begin{defi}[Prvovýroky]
  \textit{Prvovýrok} je nejmenší výrok, který nelze rozdělit na menší výroky. Množinu prvovýroků, ze kterých se skládá výrok $ \varphi $ značíme $ \fce{\Var}{\varphi} $.
\end{defi}

\begin{defi}[Teorie]
  \textit{Teorie} v jazyce $ \P $ je podmnožina $ \vfp $. Výrokům teorie se říká \textit{axiomy.}
\end{defi}

\begin{defi}[Strom výroku]\label{VL strom výroku}
  \textit{Strom výroku} $ \fce{\Tree}{\varphi} $ je zakořeněný uspořádaný binární strom definovaný rekurzivně:
  \begin{itemize}
    \item Pro $ \varphi $ prvovýrok obsahuje jen jeden vrchol, $ \varphi $.
    \item Pro $ \varphi \approx \lnot \psi $ je v kořeni $ \lnot $, které má pod sebou podstrom $ \fce{\Tree}{\psi} $.
    \item Pro $ \varphi \approx \psi \square \mu $ je v kořeni $ \square $, jeho pravý podstrom je $ \fce{\Tree}{\psi} $, a levý $ \fce{\Tree}{\mu} $
  \end{itemize}
\end{defi}

\begin{defi}[Booleovská funkce]
  \textit{Booleovská funkce} je každá funkce $ f: \{ 0,1 \}^n \to \{ 0,1 \} $.
  Každá logická spojka reprezentuje booleovskou funkci.
\end{defi}

\begin{defi}[Pravdivostní funkce]
  Nechť $ \vec x \deq \left( x_1,\dots,x_n \right), f_{\square} $ jsou funkce operací. Pak pravdivostní funkce je funkce $ f_{\varphi, \P}: \{ 0,1 \}^n \to \{ 0,1 \} $ definovaná induktivně:
  \begin{itemize}
    \item Pro $ \varphi =i$-tý prvovýrok je $ \fce{f_{\varphi, \P}}{\vec x}= x_i $.
    \item Pro $ \varphi \approx \lnot \psi $ je $ \fce{f_{\varphi, \P}}{\vec x}= \fce{f_{\lnot}}{\fce{f_{\psi, \P}}{\vec x}} $.
    \item Pro $ \varphi \approx \psi \square \mu $ je $ \fce{f_{\varphi, \P}}{\vec x}= \fce{f_{\square}}{\fce{f_{\psi, \P}}{\vec x},\fce{f_{\mu, \P}}{\vec x}} $.
  \end{itemize}
\end{defi}

\begin{thm}
  Pravdivostní funkce výroku $ \varphi $ závisí jen na $ \fce{\Var}{\varphi} $.
\end{thm}

\begin{defi}[Model]
  \textit{Model jazyka $ \P $} je pravdivostní ohodnocení $ v: \P \to \{ 0,1 \}
  $. Model jazyka lze také značit jako vektor $ \left( x_1,\dots,x_{\absolute{\P}} \right) $, 
  čímž se rozumí pravdivostní ohodnocení $ v: \fce{v}{p_i} = x_i$.
\end{defi}

\begin{defi}[Množina modelů]
  \textit{Množina modelů} $ M_{\P} \deq \{ 0,1 \}^{\P} = \{ v \;|\; v: \P \to \{ 0,1 \} \} $.
\end{defi}

\begin{defi}[Platnost výroku, model výroku]
  Nechť $ \varphi $ je výrok v jazyce $ \P $ a $ v \in M_{\P} $. Pak pokud $ \fce{f_{\varphi, \P}}{v} = 1 $, pak říkáme že výrok \textit{platí} v $ v $, $ v $ je \textit{modelem} $ \varphi $ a $ v \models \varphi $.

  Dále lze definovat $ \fce{M_{\P}}{\varphi} \deq \{ v \; |\; v \models \varphi \} $
\end{defi}

\begin{defi}[Platnost teorie, model teorie]
  Teorie $ T $ \textit{platí} v modelu $ v $, pokud $ \forall \varphi $ axiom $ T: v \models \varphi $. $ v $ je tedy \textit{model teorie $ T $.}
\end{defi}

\begin{defi}[Zkratky zápisu]
  \begin{align*}
    \fce{M_{\P}}{\varphi_1, \varphi_2, \dots} &= \fce{M_{\P}}{\{ \varphi_1, \varphi_2, \dots \}} \\
    \fce{M_{\P}}{T, \varphi} &= \fce{M_{\P}}{T \cup \{ \varphi \}} \\
    p^v &= p \text{ pokud } \fce{v}{p} = 1, \text{ jinak } \lnot p \\
    v \in M_{\P'} \to \restrict v \P &= w \in M_\P : \forall p \in \P: \fce{w}{p} = \fce{v}{p}
  \end{align*}
\end{defi}

\begin{defi}[Další sémantické pojmy]
  Výrok $ \varphi $ je: 
  \begin{itemize}
    \item \textit{pravdivý, tautologie, platí, $ \models \varphi $} $ \equiv  \forall v \in M_{\P}: v \models \varphi$
    \item \textit{lživý, sporný} $ \equiv  \forall v \in M_{\P}: v \nvDash \varphi$
    \item \textit{nezávislý} $ \equiv \emptyset \subset \fce{M_{\P}}{\varphi} \subset M_{\P} $
    \item \textit{splnitelný} $ \equiv \fce{M_{\P}}{\varphi} \neq \emptyset $
    \item \textit{logicky ekvivalentní s $ \psi $, $ \varphi \sim \psi $} $ \equiv \fce{M_{\P}}{\varphi} = \fce{M_{\P}}{\psi} $
  \end{itemize}
\end{defi}

\begin{defi}[Sémantické pojmy vzhledem k teorii]
  Výrok $ \varphi $ je v teorii $ T $: 
  \begin{itemize}
    \item \textit{pravdivý v $ T $, důsledek $ T $, platí v $ T $, $ T \models \varphi $} $ \equiv  \forall v \in \fce{M_{\P}}{T}: v \models \varphi$
    \item \textit{lživý v $ T $, sporný v $ T $} $ \equiv \fce{M_{\P}}{T} \cap \fce{M_{\P}}{\varphi} = \emptyset $
    \item \textit{nezávislý v $ T $} $ \equiv \emptyset \subset \fce{M_{\P}}{T, \varphi} \subset \fce{M_{\P}}{T} $
    \item \textit{splnitelný v $ T $, konzistentní s $ T $} $ \equiv \fce{M_{\P}}{T,\varphi} \neq \emptyset $
    \item \textit{v $ T $ logicky ekvivalentní s $ \psi $, $ T $-ekvivalentní, $ \varphi \sim_T \psi $} $ \equiv \fce{M_{\P}}{T, \varphi} = \fce{M_{\P}}{T, \psi} $
  \end{itemize}
\end{defi}

\begin{defi}[Univerzálnost spojek]
  Množina logických spojek $ S $ je \textit{univerzální}, pokud $ \forall f $
  booleovskou funkci lze vyjádřit jako $ f_{\varphi, \P} $ pro nějaký výrok $
  \varphi $ složený ze spojek z $ S $.
\end{defi}

\begin{thm}
  Množiny $ \{ \land, \lor, \lnot \}, \{ \lnot, \to \} $ jsou univerzální.
\end{thm}

\section{Normální formy}

\begin{defi}[Značení] \
  \begin{itemize}
    \item \textit{Literál} $ l $ je buď prvovýrok, nebo negace prvovýroku.
    \item \textit{Klauzule} je disjunkce literálů.
    \item \textit{CNF} je konjunkce klauzulí.
    \item \textit{Elementární konjunkce} je konjunkce literálů.
    \item \textit{DNF} je disjunkce elementárních konjunkcí.
  \end{itemize}
\end{defi}

\begin{thm}
  Nechť $ \P $ je konečný jazyk, $ M \subseteq M_{\P} $. Pak $ \exists \varphi_{\text{CNF}}, \varphi_{\text{DNF}} $ v CNF, DNF, tž. \[
    M = \fce{M_{\P}}{\varphi_{\text{CNF}}} = \fce{M_{\P}}{\varphi_{\text{DNF}}}.
  \]
  Konkrétně: 
  \begin{align*}
    \varphi_{\text{DNF}} &= \bigvee_{v \in M} \bigwedge_{p \in \P} p^{\fce{v}{p}} \\
    \varphi_{\text{CNF}} &= \bigwedge_{v \notin M} \bigvee_{p \in \P} p^{1-\fce{v}{p}}
  \end{align*}
\end{thm}

\begin{defi}[Množinový zápis CNF]
  Nechť $ \varphi $ je výrok v CNF. Pak tento výrok je roven nekonečné množině klauzulí $ S \deq \{ C_i \}_i $, kde každá $ C_i $ je pak množina literálů $ \{ l_{i_k} \}_k $.

  Každý výrok $ S $ se dá zkonstruovat zpět do $ \varphi $ tak, že \[
    \varphi = \bigwedge_{C_i \in S} \left( \bigvee_{l_{i_k} \in C_i} \! l_{i_k} \right).  \]
\end{defi}

\begin{thm}[Převod pomocí ekvivalentních úprav]
  TODO: pravidla
\end{thm}

\section{Teorie}

\begin{defi}[Ekvivalence teorií]
  \[
    T \sim T' \Leftrightarrow \fce{M_{\P}}{T} = \fce{M_{\P}}{T}.
  \]
\end{defi}

\begin{defi}[Vlastnosti teorií]
  Teorie $ T $ je:
  \begin{itemize}
    \item \textit{sporná} $ \equiv \fce{M_{\P}}{T} = \emptyset $,
    \item \textit{bezesporná, splnitelná} $ \equiv \fce{M_{\P}}{T} \neq \emptyset $,
    \item \textit{kompletní} $ \equiv \fce{M_{\P}}{T} \neq \emptyset \land \forall \varphi \in \vfp: \fce{M_{\P}}{T, \varphi} = \fce{M_{\P}}{T} \lor \fce{M_{\P}}{T, \lnot \varphi} = \fce{M_{\P}}{T} $.
  \end{itemize}
\end{defi}

\begin{defi}[Důsledky teorie]
  Množina \textit{důsledků} teorie $ T \equiv $ \[
    \fce{\Csq_\P}{T} \deq \{ \varphi \in \vfp \;|\; T \models \varphi \}
  \]
\end{defi}

\begin{thm}
  Nechť $ T,T' $ jsou teorie, $ \varphi, \varphi_i $ jsou výroky v $ \P $. Pak 
  \begin{enumerate}
    \item $ T \subseteq \fce{\Csq_\P}{T} $
    \item $ \fce{\Csq_\P}{T} = \fce{\Csq_\P}{\fce{\Csq_\P}{T}} $
    \item $ T \subseteq T' \Rightarrow \fce{\Csq_\P}{T} \subseteq \fce{\Csq_\P}{T'} $
    \item $ \varphi \in \fce{\Csq_\P}{\{ \varphi_i \;|\; i \in \left[ n \right] \}} \Leftrightarrow \left( \bigwedge_{i \in \left[ n \right]} \varphi_i \right) \to \varphi $
  \end{enumerate}
\end{thm}

\begin{defi}[Extenze teorie]
  $ T' $ v $ \P' \supseteq \P $ je \textit{extenzí} $ T $ v $ \P \equiv$ \[
    \fce{\Csq_\P}{T} \subseteq \fce{\Csq_\P}{T'}.
  \]
  Extenze může být \begin{itemize}
    \item \textit{jednoduchá} $ \equiv $ $ \P' = \P $,
    \item \textit{konzervativní} $ \equiv $ $ \fce{\Csq_\P}{T} = \fce{\Csq_\P}{T'} $.
  \end{itemize}
\end{defi}

\begin{thm}
  Nechť $ T $ je teorie v $ \P $ a $ T' $ je teorie v $ \P' \supseteq \P $.
  Pak \begin{itemize}
    \item $ T' $ je jednoduchou extenzí $ T \Leftrightarrow \P' = \P \land \fce{M_\P}{T'} \subseteq \fce{M_\P}{T} $,
    \item $ T' $ je extenzí $ T \Leftrightarrow \fce{M_\P'}{T'} \subseteq \fce{M_\P'}{T} $,
    \item $ T' $ je konzervativní extenzí $ T \Leftrightarrow \fce{M_\P}{T} = \{ \restrict v \P \;|\; v \in \fce{M_{\P'}}{T'} \} $,
    \item $ T' $ je extenzí $ T $ a $ T $ je extenzí $ T' \Leftrightarrow \P' = \P \land \fce{M_\P}{T'} = \fce{M_\P}{T} $,
    \item kompletní jednoduché extenze $ T $ jednoznačně až na ekvivalenci odpovídají modelům $ T $.
  \end{itemize}
\end{thm}

\section{Problém splnitelnosti}

\begin{defi}[SAT]
  Vstup: výrok v CNF, otázka, jestli je splnitelný.
\end{defi}

\begin{defi}[$ k $-SAT]
  Vstup: výrok v CNF, každá klauzule má max. $ k $ proměnných, otázka, jestli je splnitelný.
\end{defi}

\begin{thm}
  $ k $-SAT je NP-úplný pro $ k \geq 3$.
\end{thm}

\begin{lemma} 
  \label{implgraflemma}
  \[
    p \lor q \Rightarrow \lnot p \to q \land \lnot q \to p
  \]\[
    p \Rightarrow \lnot p \to p
  \]
\end{lemma}

\begin{defi}[Implikační graf]
  Implikační graf je grafová reprezentace výroku využívající Lemma \ref{implgraflemma}. Značí se $ \implgraph $ a je definován jako:
  \begin{align*}
    \fce{V}{\implgraph} &\deq \{ p, \lnot p \suchthat p \in \fce{\Var}{\varphi} \} \\
    \fce{E}{\implgraph} &\deq \{ \left( p,q \right) \suchthat p \lor q \text{ je klauzule } \varphi \} \cup \{ \left( p,\lnot p \right) \;|\; p \text{ je jednotková klauzule } \varphi \}
  \end{align*}
\end{defi}

\begin{algo}[2SatSolve]\ \\
\textit{Vstup:} výrok $ \varphi $ v CNF, kde každá klauzule má délku $ \leq 2 $.
\begin{algorithmic}[1]
  \State $ \implgraph \gets $ implikační graf výroku $ \varphi $.
  \State $ \implgraph^* \gets $ graf komponent $ C_i $ silné souvislosti grafu $ \implgraph $.
  \Indent Pokud $ \exists C_i, p: p \in C_i \land \lnot p \in C_i $:
    \State Odpovíme \textit{ne}.
  \EndIndent
  \State Jinak odpovíme \textit{ano}.
\end{algorithmic}
\textit{Výstup:} informace, jestli je $ \varphi $ splnitelný.
\end{algo}

\begin{algo}[2SatSolutions]\ \\
\textit{Vstup:} splnitelný výrok $ \varphi $ v CNF, kde každá klauzule má délku $ \leq 2 $.
\begin{algorithmic}[1]
  \State $ \implgraph \gets $ implikační graf výroku $ \varphi $.
  \State $ \implgraph^* \gets $ graf komponent $ C_i $ silné souvislosti grafu $ \implgraph $.
  \Indent Pro $ C_i $ neohodnocené komponenty v pořadí topologického uspořádání:
    \Indent Pro $ l \in C_i $:
      \State $ l \gets 0 $
      \State $ \overline l \gets 1 $
    \EndIndent
  \EndIndent
\end{algorithmic}
\textit{Výstup:} ohodnocení $ \varphi $.
\end{algo}

\begin{thm}[Správnost]
  $ \varphi $ splnitelný $ \Leftrightarrow $ žádná $ C_i $ neobsahuje $ p, \lnot p $.
\end{thm}

\begin{cor}[Složitost $ 2 $-SAT]
  Problém $ 2 $-SAT je řešitelný v $ \fce{\O}{n} $.
\end{cor}

\begin{defi}[Hornovská klauzule]
  Klauzule je \textit{hornovská}, pokud obsahuje nejvýše jeden pozitivní
  literál. Celý výrok je \textit{v hornově tvaru}, pokud je konjunkcí
  hornovských klauzulí.
\end{defi}

\begin{defi}[Jednotková propagace]
  Nechť $ \varphi = \{ C_i \}_i $ je výrok v hornovském tvaru a $ l $ je jednotková klauzule.
  Pak pomocí jednotkové propagace dostaneme výrok $ \varphi^l $, který je
  splnitelný právě když byl splnitelný $ \varphi $ a je jednodušší. Dostaneme
  ho pomocí následujícího algoritmu:
\end{defi}

\begin{algo}[JednotkováPropagace]\ \\
\textit{Vstup:} výrok $ \varphi = \{ C_i \}_i $, literál $ l $, tž. $ \{ l \} \in \varphi $.
\begin{algorithmic}[1]
  \State $ \varphi^l \gets \varphi $
  \Indent Pro $ C_i \in \varphi^l $:
    \Indent Pokud $ \overline l \in C_i $:
      \State $ C_i \gets C_i \setminus \{ \overline l \} $.
    \EndIndent
    \Indent Pokud $ l \in C_i $:
      \State $ \varphi^l \gets \varphi^l \setminus \{ C_i \} $.
    \EndIndent
  \EndIndent
  
\end{algorithmic}
\textit{Výstup:} výrok $ \varphi^l $.
\end{algo}

\begin{cor}
  $ \varphi^l $ neobsahuje $ l, \overline l $.
\end{cor}

\begin{algo}[HornSAT]\ \\
\textit{Vstup:} formule $ S $ v Hornově tvaru.
\begin{algorithmic}[1]
  \Indent Dokud $ \{ l \} \in S $ pro nějaký literál $ l $:
    \State $ S \gets S^l $
    \Indent Pokud $ \emptyset \in S $:
      \State Ohlásíme \textit{nesplnitelná}.
    \EndIndent
  \EndIndent
  \State Ohlásíme \textit{splnitelná}.
\end{algorithmic}
\textit{Výstup:} informace o splnitelnosti $ S $.
\end{algo}

\begin{algo}[DPLL]\ \\
\textit{Vstup:} $ S $ v CNF.
\begin{algorithmic}[1]
  \Indent Dokud $ \{ l \} \in S $ pro nějaký literál $ l $:
    \State $ S \gets S^l $
  \EndIndent
  \Indent Pokud $ S = \emptyset $:
    \State Ohlásíme \textit{splnitelná}.
  \EndIndent
  \Indent Pokud $ \emptyset \in S $:
    \State Ohlásíme \textit{nesplnitelná}.
  \EndIndent
  \State $ p \gets $ náhodná neohodnocená proměnná.
  \State Ohlásíme \textit{splnitelná}, pokud $ \algorithm{DPLL}{S^p} $ nebo $ \algorithm{DPLL}{S^{\lnot p}} $ ohlásí splnitelná, jinak \textit{nesplnitelná}.
\end{algorithmic}
\textit{Výstup:} informace o splnitelnosti $ S $.
\end{algo}

\section{Tablo}

\begin{defi}[Důkaz]
  \textit{Důkaz} ve formálním dokazovacím systému je konečný syntaktický objekt vycházející z axiomů $ T $, výroku $ \varphi $.
\end{defi}

\begin{defi}[Vlastnosti dokazovacího systému]
  U dokazovacího systému nás zajímají zejména dvě vlastnosti, a to:
  \begin{itemize}
    \item \textit{korektnost} $ \equiv T \vdash \varphi \Rightarrow T \models \varphi $,
    \item \textit{úplnost} $ \equiv T \models \varphi \Rightarrow T \vdash \varphi $.
  \end{itemize}
\end{defi}

\begin{defi}[Strom]
  \
  \begin{itemize}
    \item \textit{Strom} je neprázdná množina $ T $ s částečným uspořádáním $
      \treelt $, které má maximální prvek, kořen, a $ \forall v \subseteq T: v
      \neq \emptyset \Rightarrow \exists! v_{\max} \deq \max_{\treelt} v $
    \item \textit{Větev} je maximální lineárně uspořádaná podmnožina $ T $
    \item \textit{Uspořádaný strom} je strom $ T $ s lineárně uspořádanou množinou synů
    \item \textit{Označkovaný strom} je strom $ T $ se zobrazením $ l: T \to \mathcal{L} $
  \end{itemize}
\end{defi}

\begin{lemma}[Köenigovo]
  Nekonečný, konečně větvící-se strom má nekonečnou větev.
\end{lemma}

\begin{defi}[Položka]
  \textit{Položka} je nápis $ T\varphi $ nebo $ F\varphi $ pro $ \varphi \in
  \vfp $.
\end{defi}

\begin{defi}[Tablo]
  \textit{Konečné tablo teorie $ T $} je uspořádaný, položkami označkovaný
  strom zkonstruovaný pomocí konečně mnoha aplikací pravidel: 
  \begin{itemize}
    \item Jednoprvkový strom označkovaný libovolnou položkou
    \item Pro $ V $ libovolnou větev, $ P $ položku na $ V $, můžeme na konec $
      V $ připojit \textit{atomické tablo} pro položku $ P $.
    \item Na konec libovolné $ V $ větve $ T $ můžeme připojit $ T\alpha $ pro
      libovolný axiom $ \alpha \in T $.
  \end{itemize}
\end{defi}

\begin{defi}[Atomické tablo]
  \textit{Atomické tablo} pro položku $ P \in \fce{l}{T} $ je strom, který
  rozkládá položku $ P $ na podpoložky, podle toho, jaký výrok $ P $ vystihuje. 

  Pak je položka $ P $ \textit{redukovaná} na větvi $ V $, pokud je $ P =
  T\varphi $ nebo $ F\varphi $, nebo se na $ V $ nachází její atomické tablo.
\end{defi}

\begin{defi}[Sporné tablo]
  \
  \begin{itemize}
    \item \textit{Sporné tablo} $ \equiv $ každá jeho větev je sporná
    \item \textit{Sporná větev} $ \equiv $ obsahuje $ T\varphi,F\varphi $ pro $
      \varphi \in \vfp $
  \end{itemize}
  
\end{defi}

\begin{defi}[Tablo důkaz]
  \textit{Tablo důkaz výroku $ \varphi $ v teorii $ T $} je sporné tablo z
  teorie $ T $ s položkou $ F\varphi $ v kořeni.

  Pokud existuje, je $ \varphi $ \textit{tablo dokazatelný} v $ T \equiv T \vdash
  \varphi $.
\end{defi}

\begin{defi}[Dokončené tablo]
  \
  \begin{itemize}
    \item \textit{Dokončené tablo} $ \equiv $ každá jeho větev je dokončená.
    \item \textit{Dokončená větev} $ \equiv $ je sporná, nebo každá její
      položka je redukovaná a obsahuje $ T\alpha \; \forall \alpha \in T $.
  \end{itemize}
  
\end{defi}

\begin{defi}[Systematické tablo]
  \textit{Systematické tablo} položky $ R $ pro teorii $ T $ je $ \tau \deq
    \bigcup_{i \geq 0} \tau_i $ definované rekurzivně:
  \begin{itemize}
    \item $ \tau_0 $ je jednoprvkové tablo s položkou $ R $
    \item Nechť $ P $ je nejlevější položka v co nejmenší úrovni v $ \tau_i $,
      která není redukovaná na nějaké větvi procházející $ P $. Pak $ \tau'_i $
      je $ \tau_i $ s připojením $ P $ na každou bezespornou větev procházející
      $ P $, nebo $ \tau_i $, pokud takové $ P $ neexistuje.
    \item $ \tau_{i+1} $ je tablo vzniklé z $ \tau'_i $ připojením $ T\alpha_i
      $ na každou bezespornou větev, popř. je to $ \tau'_i $, pokud $ i >
      \absolute{T} $, nebo jsou všechny větve sporné.
  \end{itemize}
\end{defi}

\begin{lemma}
  Systematické tablo je dokončené.
\end{lemma}

\begin{thm}[Konečnost sporu]
  Je-li $ \tau $ sporné tablo, pak $ \exists n \in \N: \tau_n $ je sporné
  konečné tablo.
\end{thm}

\begin{cor}
  Pokud při konstrukci sporného tabla nikdy neprodloužíme sporné větve, pak je
  sporné tablo konečné. Speciálně, sporné systematické tablo je konečné.
\end{cor}

\begin{cor}
  Pokud $ T \vdash \varphi $, potom existuje i konečný tablo důkaz $ \varphi $
  v $ T $, a je jím např. systematický tablo důkaz.
\end{cor}

\begin{defi}
  $ v \in \fce{M}{\P} $ \textit{se shoduje} s položkou $ P \equiv $ \[
    \left( P = T\varphi \land v \models \varphi \right) \lor \left( P = F\varphi \land \lnot v \models \varphi \right)
  \]
\end{defi}

\begin{lemma} \label{VL Tablo korektnost lemma}
  Shoduje-li se model teorie $ T $ s položkou v kořeni tabla, pak se shoduje s
  nějakou větví.

  \begin{proof}
    Dokážeme indukcí podle konstrukce $ \tau $. První krok je triviální,
    protože $ \tau_0 $ je jen položka v kořeni. 

    V indukčním kroku jsme k $ \tau $ přidali axiom z $ T $ a připojili
    atomické tablo nějakého výroku. Z IP plyne, že před připojením existovala
    větev, se kterou se shodoval model $ v $. Pokud jsme k té větvi připojili
    axiom, pak se stále shoduje, protože $ v $ je modelem $ T $, tedy se
    shoduje se všemi axiomy. Pokud jsme přidali atomické tablo, pak se větev
    možná rozdělila, každopádně ale, protože se $ v $ shoduje s položkou, pro
    kterou toto atomické tablo děláme, tak se musí shodovat i s alespoň jednou
    novou větví vzniklou připojením toho atomického tabla. To vychází z
    konstrukce atomických tabel.
  \end{proof}
  
\end{lemma}

\begin{thm}[Korektnost]
  Nechť $ \varphi $ je výrok, $ T $ teorie. \[
    T \vdash \varphi \Rightarrow T \models \varphi
  \]

  \begin{proof}
    Sporem. Nechť $ T \vdash \varphi $, ale $ T \not\models \varphi $. Tedy $
    \exists v \in \fce{M}{T}: v \not\models \varphi $. Tento model se tedy
    shoduje s položkou $ F\varphi $. Podle lemma \ref{VL Tablo korektnost
    lemma} se tedy shoduje i s nějakou větví tabla. Všechny větve jsou ale
    sporné. $ \lightning $
  \end{proof}
  
\end{thm}

\begin{defi}[Kanonický model]
  Nechť $ V $ je bezesporná větev v dokončeném tablu. Potom \textit{kanonický
  model pro $ V $} je $ v $ definovaný jako
  \begin{equation*}
    \fce{v}{p} \deq \begin{cases}
        1 & \text{pokud se na $ V $ vyskytuje $ Tp $} \\
        0 & \text{jinak}
      \end{cases}
  \end{equation*}
\end{defi}

\begin{lemma}
  Kanonický model pro bezespornou dokončenou větev $ V $ se shoduje s $ V $.

  \begin{proof}
    Indukcí podle struktury položky. Pro $ Tp $ platí z konstrukce kanonického
    modelu.

    Nechť BÚNO $ T \varphi $ je položka na větvi $ V $, která není atomickým
    výrokem. Z konstrukce tabla se na větvi $ V $ musí nacházet i část
    atomického tabla pro $ \varphi $, se kterou se z IP $ v $ shoduje. Z
    konstrukce atomických tabel se tedy shoduje i s $ T\varphi $. 
  \end{proof}
  
\end{lemma}

\begin{thm}[Úplnost]
  Nechť $ \varphi \in \vfp, T \in 2^{\vfp}$. Pak \[
    T \models \varphi \Rightarrow T \vdash \varphi.
  \]

  \begin{proof}
    Sporem. Nechť $ T \models \varphi $, ale $ T \nvdash \varphi $. Pak ale
    existuje v tablu $ \tau $ dokončená nesporná větev $ V $, tedy i kanonický
    model, který se shoduje s $ F \varphi $ a platí v něm všechny axiomy. Je to
    tedy model $ T $, ve kterém neplatí $ \varphi $. $ \lightning $
  \end{proof}
  
\end{thm}

\begin{defi}[Theorém]
  Pro teorii $ T $ nad jazykem $ \P $ definujeme \textit{množinu theorémů} $ \fce{\Thm_\P}{T} $ jako \[
    \fce{\Thm_\P}{T} \deq \{ \varphi \in \vfp \suchthat T \vdash \varphi \}
  \]
\end{defi}

\begin{cor}[Dokazatelnost $ = $ platnost]
  Pro teorii $ T $ platí: \begin{enumerate}
    \item $ T \models \varphi \Leftrightarrow T \vdash \varphi $,
    \item $ \fce{\Csq_\P}{T} = \fce{\Thm_\P}{T} $.
  \end{enumerate}
\end{cor}

\begin{thm}[O dedukci]
  Pro teorii $ T $ a výroky $ \varphi, \psi \in \vfp $ platí \[
    \left( T \cup \{ \varphi \} \right) \vdash \psi \Leftrightarrow T \vdash \left( \varphi \to \psi \right).
  \]
\end{thm}

\begin{thm}[O kompaktnosti]
  Pro $ T $ teorii platí: \[
    \exists v: v \models T \Leftrightarrow \forall T' \subseteq T, \absolute{T} \in \N:  \exists v': v' \models T'.
  \]
\end{thm}

\begin{cor}
  Spočetně nekonečný graf je bipartitní, právě když každý jeho konečný podgraf je bipartitní.
\end{cor}

\section{Rezoluce}

\begin{thm}[Inferenční pravidlo]
  Nechť $ \varphi,\psi,\chi \in \vfp $. Pak platí: \[
    \left( \varphi \lor \psi \right) \land \left( \lnot \varphi \lor \chi \right) \implies \left( \psi \lor \chi \right).
  \]
\end{thm}

\begin{defi}[Ohodnocení]
  \textit{Ohodnocení} je množina literálů $ \mathcal{L} $. O ohodnocení řekneme, že
  \begin{itemize}
    \item je \textit{konzistentní} $ \equiv  \forall l \in \P: l \notin \mathcal{L} \lor \overline{l} \notin \mathcal{L}$
    \item je \textit{úplné} $ \equiv  \forall p \in \P: p \in \mathcal{L} \lor \lnot p \in \mathcal{L}$
    \item \textit{splňuje} $ S $, $ \mathcal{L} \models S \equiv \forall C \in S: C \cap \mathcal{L} \neq \emptyset $
  \end{itemize}
\end{defi}

\begin{defi}[Rezolventa]
  Nechť $ C_1,C_2 $ jsou klauzule, $ l \in C_1, \overline{l} \in C_2 $. Pak \textit{rezolventa $ C_1,C_2 $ přes literál $ l $} je \[
    C = \left( C_1 \setminus \{ l \} \right) \cup \left( C_2 \setminus \{ \overline{l} \} \right)
  \]

  Aplikace rezolventy se nazývá \textit{rezoluční pravidlo}.
\end{defi}

\begin{cor}[Korektnost rezolučního pravidla]
  Pro ohodnocení $ \mathcal{L} $, klauzule $ C_1, C_2 $ a $ C $ jejich rezolventu platí \[
    \mathcal{L} \models C_1 \land \mathcal{L} \models C_2 \implies \mathcal{L} \models C
  \]
\end{cor}

\begin{defi}[Rezoluční důkaz]
  \textit{Rezoluční důkaz} klauzule $ C $ z výroku $ S $ je \textit{konečná}
  posloupnost klauzulí $ C_1, C_2, \dots, C_n $, kde $ \forall i \in \left[ n \right]: $ \[
    C_i \in S \lor \exists j,k < i: C_i  \text{ je rezolventou } C_j,C_k.
  \]  

  Pokud existuje, je $ C $ rezolucí \textit{dokazatelná} z $ S $, píšeme $ S \vdash_R
  C $. Rezoluční \textit{zamítnutí} $ S $ je důkaz prázdné klauzule z $ S: S \vdash_R \square $.
\end{defi}

\begin{defi}[Rezoluční strom]
  \textit{Rezoluční strom} klauzule $ C $ je \textit{konečný binární strom}
  označený klauzulemi, kde 
  \begin{itemize}
    \item $ C $ je v kořeni,
    \item v listech jsou klauzule $ S $,
    \item v každém vrcholu, který není list, je rezolventa jeho synů.
  \end{itemize}
\end{defi}

\begin{cor}
  Pro výrok $ S $, klauzuli $ C $ platí \[
    S \vdash_R C \Longleftrightarrow C \text{ má rezoluční strom } S.
  \]
\end{cor}

\begin{defi}[Uzávěr]
  \textit{Rezoluční uzávěr} formule $ S $ je $ \fce{\uzaver}{S} \equiv $
  \begin{enumerate}
    \item $ S \subseteq \fce{\uzaver}{S} $,
    \item $ \forall C_1,C_2 \in \fce{\uzaver}{S}, C $ rezolventa $ C_1,C_2: C \in \fce{\uzaver}{S} $.
  \end{enumerate}
  
\end{defi}

\begin{thm}[Korektnost]
  \[
    S \vdash_R \square \implies \nexists \mathcal{V} \in 2^{\P}: \mathcal{V} \models S
  \]
\end{thm}

\begin{defi}[Dosazení literálu]
  Pro $ S $ formuli je \textit{dosazení literálu $ l $} množina $ S^{l} \equiv $ \[
    S^{l} \deq \{ C \setminus \{ \overline{l} \} \suchthat C \in S \land l \notin C \}
  \]
\end{defi}

\begin{thm}[Dosazení literálu]
  Pro $ S $ formuli a $ l $ literál platí \begin{itemize}
    \item $ S^l $ je výsledkem jednotkové propagace na $ S \cup \{ \{ l \} \} $,
    \item $ S^l $ neobsahuje $ l, \overline l $,
    \item $ \left( \forall C \in S: l, \overline l \notin C \right) \implies S^l = S $,
    \item $ \{ \overline l \} \in S \implies \square \in S^l $, tedy $ S^l $ je sporná.
  \end{itemize}
\end{thm}

\begin{defi}[Strom dosazení]
  \textit{Strom dosazení} je strom, v jehož kořeni je výrok $ S $, a dále každý
  jeho vrchol $ V $, který má volnou nějakou proměnnou $ p $, má dva syny, $
  V^p $, $ V^{\lnot p} $.
\end{defi}

\begin{lemma}[Splnitelnost a dosazení]
  \[
    S \text{ je splnitelná } \Longleftrightarrow S^l \text{ je splnitelná } \lor S^{\overline l}\text{ je splnitelná }
  \]
\end{lemma}

\begin{cor}
  Formule $ S $ je nesplnitelná $ \Longleftrightarrow \forall $ větev jejího
  stromu dosazení obsahuje $ \square $.
\end{cor}

\begin{thm}[Úplnost rezoluce] 
  \label{VL úplnost rezoluce}
  \[
    \left( \nexists \mathcal{V} \in 2^\P : \mathcal{V} \models S \right) \implies S \vdash_R \square
  \]
\end{thm}

\subsection{LI-rezoluce}

\begin{defi}[Lineární důkaz]
  \textit{Lineární důkaz} klauzule $ C $ z $ S \equiv $ konečná posloupnost \[
    \left( C_0, B_0 \right), \left( C_1, B_1 \right), \dots, \left( C_n, B_n \right), C_{n+1},
  \]
  kde $ C_i $ jsou \textit{centrální} klauzule a $ B_i $ jsou \textit{boční} klauzule. $ C_{n+1} = C $ je \textit{koncová} klauzule. Platí \begin{enumerate}
    \item $ C_0 \in S, B_0 \in S $,
    \item $ \forall i \geq 1: C_i $ je rezolventou $ C_{i-1} $ a $B_{i-1} , B_i
      \in S \lor \exists j < i: B_i = C_j$ .
  \end{enumerate}
  
  Lineární \textit{zamítnutí} je lineární důkaz $ \square $.
\end{defi}

\begin{defi}[LI-důkaz]
  \textit{LI-důkaz} je lineární důkaz, kde $ \forall i: B_i \in S $.
\end{defi}

\begin{defi}[Fakt, Pravidlo]
  V Hornových klauzulích definujeme \begin{itemize}
    \item \textit{fakt $ \equiv $} $ \{ p \} $, kde $ p \in \vfp $,
    \item \textit{cíl $ \equiv $} neprázdná Hornova klauzule bez pozitivního literálu.
  \end{itemize}
\end{defi}

\begin{cor}
  Nechť $ S $ je Hornova formule. Pak $ S $ je nesplnitelná a $ \square \notin
  S \implies S $ obsahuje fakt i cíl.
\end{cor}

\begin{thm}[Úplnost LI-rezoluce pro Hornovy formule] \label{LI pro HF VL}
  Nechť Hornova formule $ T $ je splnitelná a $ T \cup \{ G \} $ je nesplnitelná pro cíl $ G $. Pak \begin{itemize}
    \item $ T \cup \{ G \} \vdash_{LI} \square $,
    \item její LI-zamítnutí začíná $ G $.
  \end{itemize}

  \begin{proof}
    Nechť $ T $ je Hornova formule, $ G $ je cíl, $ \{ p \} $ je fakt. Důkaz
    provedeme indukcí podle počtu proměnných. 

    V prvním kroku, nechť dosadíme $ p $ do $ T \cup \{ G \} $ a vzniklá $ G^p
    $ je prázdná. Tedy $ G = \{ \lnot p \} $. Získáváme jednokrokový LI-důkaz. 

    V indukčním kroku, nechť opět dosadíme. $ T^p $ je splnitelná stejným
    ohodnocením jako $ T $, kvůli tomu, že fakt $ \{ p \} $ jinak splnit nelze.
    Zároveň ale $ T^p \cup G^p $ má méně proměnných, tedy podle IP existuje
    LI-důkaz $ T^p \cup G^p $, který začíná cílem $ G^p $. Do všech prvků
    důkazu můžeme přidat $ p $ všude tam, kde mají být (tj. kde jsou v původní
    teorii $ T $). V poslední klauzuli nám zbyde $ \lnot p $, tak tam můžeme
    přidat ještě fakt $ \{ p \} $, a výsledná rezolventa je konec LI-důkazu.
  \end{proof}
\end{thm}

\chapter{Predikátová logika}

\section{Syntax a sémantika}

\subsection{Syntax}

\begin{defi}[Signatura]
  \textit{Signatura} je množina $ \left< \rr, \ff \right> $, kde $ \rr $ je
  množina relačních symbolů, $ \ff $ je množina funkčních symbolů, $ \rr \cap
  \ff = \emptyset $ a \textquote{$ = $} $ \notin \rr \cup \ff $. Dále je určena funkce $
  \ar: \ff \cup \rr \to \N_0 $ určující aritu.
\end{defi}

\begin{defi}[Struktura]
  \textit{Struktura} $ \aa $ v signatuře $ \left< \rr, \ff \right> \equiv \left< A, \rr^\aa, \ff^\aa \right>$, kde \begin{enumerate}
    \item $ A $ je neprázdná množina, \textit{doména, univerzum},
    \item $ \rr^\aa = \{ R^\aa \suchthat R \in \rr \} $, kde $ R^\aa : A^{\fce{\ar}{R}} \to \{ 0,1 \} $ je interpretace $ R $,
    \item $ \ff^\aa = \{ f^\aa \suchthat f \in \ff \} $, kde $ f^\aa : A^{\fce{\ar}{f}} \to A $ je interpretace $ f $,
  \end{enumerate}

  Speciální příklad $ f \in \ff $ jsou konstanty, které mají aritu $ 0 $.
\end{defi}

\begin{defi}[Jazyk]
  \textit{Jazyk} je určen \textit{signaturou} a tím, jestli je s/bez rovnosti.
  Do jazyka patří \begin{enumerate}
    \item množina proměnných $ \Var $, která je spočetná,
    \item relační, funkční symboly a rovnost, pokud je s rovností,
    \item $ \left( \forall x \right), \left( \exists x \right) $ pro $ x \in \Var $,
    \item symboly pro logické spojky a závorky.
  \end{enumerate}

  Libovolný kvantifikátor budeme vyjadřovat $ Qx $, libovolnou spojku $ \varphi \square \psi $.
\end{defi}

\begin{defi}[Term]
  \textit{Term} jazyka $ L = \left< \rr, \ff \right> $ (nezávisle rovnosti) je
  prvek množiny všech termů $ \Term_L $, která je definována induktivně:
  \begin{enumerate}
    \item $ \forall x \in \Var: x \in \Term_L $,
    \item $ \forall f \in \ff: \fce{\ar}{f} = n, \, t_1, \dots, t_n \in \Term_L: \fce{f}{t_1, \dots, t_n} \in \Term_L $,
  \end{enumerate}

  Dále definujeme \begin{itemize}
    \item \textit{podterm} $ \equiv $ podřetězec termu, který je termem,
    \item \textit{konstantní term} $ \equiv $ term, který neobsahuje proměnnou,
    \item \textit{strom termu $ t, \fce{\Tree}{t} $} $ \equiv $ jako strom
      výroku (\ref{VL strom výroku}), ale v listech jsou proměnné nebo konstanty, uvnitř funkční
      symboly se správnou aritou.
  \end{itemize}
\end{defi}

\begin{defi}[Atomická formule]
   \textit{Atomická formule} jazyka $ L $ je nápis $ \fce{R}{t_1, \dots, t_n} $,
   kde $ R $ je relační symbol arity $ n $ a $ t_1, \dots, t_n \in \Term_L $. 
\end{defi}

\begin{defi}[Formule]
  \textit{Formule} jsou konečné nápisy definované induktivně: \begin{enumerate}
    \item $ \forall  $ atomická formule je formule,
    \item $ \forall \varphi, \psi $ formule a $ \square \in \{ \land, \lor,
      \leftrightarrow, \to \} $ je $ \varphi \square \psi $ formule,
    \item $ \forall \varphi $ formule, $ x $ proměnné, $ Q $ kvantifikátor jsou
      $ \lnot \varphi, \left( Qx \right)\!\varphi $ formule.
  \end{enumerate}
  
  Dále definujeme \begin{itemize}
    \item \textit{podformule} $ \equiv $ podřetězec formule, který je formulí,
    \item \textit{strom formule $ \varphi, \fce{\Tree}{\varphi} $} $ \equiv $ \begin{itemize}
      \item $ \varphi $ atomická $ \Rightarrow $ jen kořen, v něm $ \varphi $,
      \item $ \varphi = \psi \square \mu \Rightarrow $ v kořeni $ \square $, $ \psi, \mu $ jeho synové,
      \item $ \varphi = Q \psi \Rightarrow $ v kořeni $ Q $, $ \psi $ jeho syn,
      \item předchozí i pro $ \lnot $.
    \end{itemize}
  \end{itemize}
\end{defi}

\begin{defi}[Výskyt]
  \textit{Výskyt} proměnné $ x $ ve $ \varphi $ je list $ \fce{\Tree}{\varphi}
  $ označený $ x $.

  Výskyt je \begin{itemize}
    \item \textit{vázaný} $ \equiv \varphi $ má podformuli $ \psi $, která začíná $ \left( Qx \right) $,
    \item \textit{volný} $ \equiv  $ není vázaný.
  \end{itemize}

  Podle výskytů může být proměnná $ x $ ve $ \varphi $ \begin{itemize}
    \item \textit{vázaná} $ \equiv \exists $ vázaný výskyt.
    \item \textit{volná} $ \equiv \exists $ nevázaný výskyt.
  \end{itemize}
\end{defi}

\begin{defi}[Otevřená, uzavřená formule]
  Formule může být \begin{itemize}
    \item \textit{otevřená} $ \equiv  $ neobsahuje kvantifikátor.
    \item \textit{uzavřená, sentence} $ \equiv \nexists x $ volná ve $ \varphi $.
  \end{itemize}
\end{defi}

\begin{defi}[Instance]
  \textit{Instance} $ \varphi $ vzniklá substitucí $ t \in \Term_L $ za $ x $ je $
  \fce{\varphi}{x \slash t} $. Pokud to lze udělat a nezmění se význam, je $ t
  $ substituovatelný za $ x $.

  Přesněji, $ t $ je \textit{substituovatelný} za $ x $ $ \equiv $ po současném
  nahrazení všech volných výskytů $ x $ za $ t $ se nestane žádný volný výskyt
  proměnné $ y \in t $ vázaným ve $ \varphi $.
\end{defi}

\begin{defi}[Varianta]
  Nechť formule $ \varphi $ má podformuli $ \left( Qx \right)\!\psi $. Nechť $ y $ je proměnná, která \begin{enumerate}
    \item je substituovatelná za $ x $ do $ \psi $,
    \item není volná ve $ \varphi $.
  \end{enumerate}
  
  Potom \textit{varianta $ \varphi $} vznikne vyměněním podformule $ \left( Qx
  \right)\!\psi $ za $ \left( Qy \right)\!\fce{\psi}{x \slash y} $.
\end{defi}

\subsection{Sémantika}

\begin{defi}[Model]
  \textit{Model} jazyka $ L $ je libovolná konkrétní struktura v signatuře $ L $. 

  $ M_L $ je třída všech modelů jazyka $ L $. Chceme vlastně množinu
  všech modelů, ale musíme se vyhnout \textquote{množině množin}.
\end{defi}

\begin{defi}[Ohodnocení]
  \textit{Ohodnocení proměnných} v $ A $ je funkce $ e: \Var \to A$.
\end{defi}

\begin{defi}[Hodnota termu]
  \textit{Hodnota termu} $ t $ v $ \aa $ při ohodnocení $ e $ je $ \fceb{t^\aa}{e}: $ \begin{enumerate}
    \item $ \fceb{x^\aa}{e} = \fce{e}{x} $ pro $ x \in \Var $,
    \item $ \fceb{c^\aa}{e} = c^\aa $ pro konstantu $ c   $,
    \item $ \fceb{\left( \fce{f}{t_1, \dots, t_n} \right)^\aa}{e} = \fce{f^\aa}{\fceb{t_1^\aa}{e},\dots, \fceb{t_n^\aa}{e}} $ pro $ f \in \ff $.
  \end{enumerate}
\end{defi}

\begin{defi}[Pravdivostní hodnota]
  Nechť $ L $ je jazyk, $ \aa \in \fce{M}{L}, e $ ohodnocení. Pak \textit{pravdivostní hodnota} $ \varphi $ v $ \aa $ při ohodnocení $ e  $, značeno $ \fcenb{\pha}\varphi e $, je \begin{enumerate}
    \item $ \varphi = \fce{R}{t_1,\dots,t_n} $ atomická $ \implies \fcenb{\pha}{\varphi}e \deq \fce{R}{\fceb{t_1^\aa}{e}, \dots, \fceb{t_n^\aa}{e}} $,
    \item $ \varphi $ je tvaru $ t_1 = t_2 \implies \fcenb{\pha}{\varphi}e \deq \fceb{t_1^\aa}{e} = \fceb{t_2^\aa}{e} $,
    \item $ \varphi = \lnot \psi \implies \fcenb{\pha}{\varphi}e \deq 1-\fceb{\psi^\aa}{e} $,
    \item $ \varphi = \psi \square \mu \implies \fcenb{\pha}{\varphi}e \deq \fce{f_\square}{\fcenb{\pha}{\psi}e, \fcenb{\pha}{\mu}e} $,
    \item $ \varphi = \left( \forall x \right)\!\psi \implies \fcenb{\pha}{\varphi}e \deq \fcec{\min_{a \in A}}{\fcenb{\pha}{\varphi}{ \fce{e}{x\slash a}}} $,
    \item $ \varphi = \left( \exists x \right)\!\psi \implies \fcenb{\pha}{\varphi}e \deq \fcec{\max_{a \in A}}{\fcenb{\pha}{\varphi}{ \fce{e}{x\slash a}}} $,
  \end{enumerate}
\end{defi}

\begin{defi}[Platnost]
  Nechť $ \varphi $ je formule, $ \aa $ je struktura. Pak $ \varphi $
  \textit{platí} v $ \aa $ při $ e, \aa \models \fceb{\varphi}{e} \equiv \fcenb
  \pha \varphi e = 1$.

  Pokud $ \forall e : \aa \models \fceb \varphi e $, pak $
  \varphi $ je \textit{pravdivá}, \textit{platí} v $ \aa $, $ \aa \models
  \varphi $. Pokud $ \nexists e : \aa \models \fceb \varphi e $,
  pak $ \varphi $ je \textit{lživá} v $ \aa $.
\end{defi}

\begin{defi}[Generální uzávěr]
  Nechť $ \varphi $ má volné proměnné $ x_1,\dots,x_n $. Pak \textit{generální uzávěr $ \varphi \equiv$} \[
    \left( \forall x_1 \right) \dots \left( \forall x_n \right)\! \varphi.
  \]
\end{defi}

\begin{defi}[Teorie]
  \textit{Teorie} jazyka $ L $ je $ T $, množina formulí z jazyka $ L $. Dále definujeme \begin{itemize}
    \item \textit{axiomy} $ \equiv $ prvky $ T $,
    \item \textit{model teorie} $ \aa \equiv L$-struktura, ve které platí všechny axiomy, tj $ \forall \varphi \in T: \varphi \models \aa $,
    \item \textit{třídu modelů} $ \fce{M_L}{T} $,
  \end{itemize}
\end{defi}

\begin{defi}[Platnost v Teorii]
  Pro $ T $ teorii, $ L $ jazyk, $ \varphi $ formuli je \begin{itemize}
    \item $ \varphi $ \textit{pravdivá v $ T, T \models \varphi  \equiv \fce{M}{T} \subseteq \fce{M}{\varphi} $},
    \item $ \varphi $ \textit{lživá v $ T, T \models \lnot \varphi  \equiv \fce{M}{T} \cap \fce{M}{\varphi} = \emptyset $},
    \item $ \varphi $ \textit{nezávislá v $ T \equiv  $} není pravdivá, ani lživá.
  \end{itemize}
  
  Pro prázdnou teorii pak zavádíme pojmy jako \textit{tautologie} pro pravdivý výrok.
\end{defi}

\begin{defi}[Sporná teorie]
  Teorie $ T $ je sporná $ \equiv T \models \bot $. Ekvivalentně lze definovat
  jako $ \fce{M}{T} = \emptyset, \forall \varphi: T \models \varphi, \dots $

  \textit{Bezesporná} teorie je taková, ve které neplatí spor.
\end{defi}

\begin{defi}[Otevřená teorie]
  Teorie $ T $ je \textit{otevřená} $ \equiv \forall \varphi \in T: \varphi $ je otevřená.
\end{defi}


\begin{defi}[Důsledek]
  \textit{Důsledek} $ T $ je sentence pravdivá v $ T $. Množina všech důsledků je \[
    \fce{\Csq}{T} \deq \{ \varphi \suchthat \varphi \text{ je sentence} \land T \models \varphi \}.
  \]
\end{defi}

\begin{defi}[Kompletnost teorie]
  $ T $ je \textit{kompletní} $ \equiv  $ je bezesporná a $ \forall \varphi $ sentenci je $ T \models \varphi \; \lor \; T \models \lnot \varphi $.
\end{defi}

\begin{defi}[Elementární ekvivalence]
  Struktury $ \mathcal{A}, \mathcal{B} $ v jazyce $ L $ jsou \textit{elementárně ekvivalentní} $ \equiv $ pro ně platí stejné sentence. Značíme $ \mathcal A \equiv \mathcal B $.
\end{defi}

\begin{cor}
  Teorie je kompletní, právě když má jeden model až na elementární ekvivalenci.
\end{cor}

\begin{thm}[O nesplnitelnosti a pravdivosti]
  Nechť $ T $ je teorie a $ \varphi $ sentence. Pak \[
    \fce{M}{T \cup \{ \lnot \varphi \}} = \emptyset \Longleftrightarrow T \models \varphi.
  \]
\end{thm}

\begin{examp}[Teorie grafů]
  Teorie grafů je teorie v jazyce $ L = \left< E \right>, \fce{E}{x,y} $ je relace vyjadřující existenci hrany: \[
    T_{G} = \{ \lnot \fce{E}{x,x}, \fce{E}{x,y} \to \fce{E}{y,x} \}.
  \]
\end{examp}

\begin{examp}[Teorie uspořádání]
  Teorie uspořádání je teorie v jazyce $ L = \left< \geq \right>$ s rovností, $ \fce{\geq}{x,y} $ je relace vyjadřující nerovnost: \[
    T_{U} = \{ x \geq x, x \geq y \land y \geq x \to x = y, x \geq y \land y \geq z \to x \geq z \}.
  \]
\end{examp}

\begin{examp}[Teorie grup]
  Teorie uspořádání je teorie v jazyce $ L = \left< +,-,0 \right>$ s rovností: \[
    T_A = \{ x+\left( y+z \right) = \left( x+y \right) +z, 0+x=x=x+0, x+\left( -x \right)=0=-x+x \}
  \]
\end{examp}

\begin{defi}[Podstruktura]
  Nechť $ \aa = \left< A, \rr^\aa, \ff^\aa \right> $ je sturktura v signatuře $
  \left< \rr, \ff \right> $. Pak $ \bb $ je \textit{indukovaná podstruktura $
  \aa,\; \bb \subseteq \aa $, restrikce $ \aa $ na $ B \equiv $} \begin{itemize}
    \item $ \emptyset \neq B \subseteq A $,
    \item $ \forall R \in \rr: \rr^\bb = \rr^\aa \cap B^{\fce{\ar}{R}} $,
    \item $ \forall f \in \ff: \fceb{f^\aa}{B^{\fce{\ar}{B}}} \in B \land f^\bb = f^\aa \cap \left( B^{\fce{\ar}{R}} \times B \right) $,
    \item $ \forall c \in \ff: \fce{\ar}{c} = 0: c^\aa \in B \land c^\aa = c^\bb $.
  \end{itemize}
\end{defi}

\begin{defi}[Uzavřenost funkce]
  Množina $ C \subseteq A $ je \textit{uzavřená} na funkci $ f: A^n \to A \equiv \fceb{f}{C} \subseteq C $.
\end{defi}

\begin{cor}
  Množina $ \emptyset \neq C \subseteq A $ je univerzem podstruktury struktury $ \aa \Longleftrightarrow $ \[
    \forall f \in \ff^\aa: C \text{ je uzavřená na } f.
  \]
\end{cor}

\begin{thm}[Platnost v podstrukturách]
  Nechť $ \bb \subseteq \aa, e: \Var \to B. $ Pak $ \forall \varphi: $ \[
    \bb \models \fceb \varphi e \Longleftrightarrow \aa \models \fceb \varphi e.
  \]
\end{thm}

\begin{cor}
  Pro otevřenou formuli $ \varphi $ platí \[
    \aa \models \varphi \Longleftrightarrow \forall \bb \subseteq \aa: \bb \models \varphi.
  \]
\end{cor}

\begin{cor}
  Modely otevřené teorie jsou uzavřené na podstruktury, tj. pro $ T $ otevřenou, $ \aa \in \fce{M}{T}: $ \[
    \forall \bb \in \aa: \bb \in \fce{M}{T}.
  \]
\end{cor}

\begin{defi}
  Nechť $ \aa $ je struktura, $ X \subseteq A. $ Nechť $ B \supseteq X $ je nejmenší podmnožina $ A $ uzavřená na všechny $ f \in \ff^\aa. $ Pak $ \bb $ je \textit{generovaná} množinou $ X $, $ \bb = \fces{\aa}{X} $.
\end{defi}

\begin{defi}[Expanze, redukt]
  Nechť $ L \subseteq L' $. Nechť $ \aa $ je $ L $-struktura, $ \aa' $ je $ L' $-struktura a $ A = A' $. Nechť interpretace každého symbolu v $ \aa $ je stejná jako v $ \aa' $. Pak $ \aa' $ je \textit{expanzí} $ \aa $ do $ L' $ a $ \aa $ je \textit{reduktem} $ \aa' $ na $ L $.
\end{defi}

\begin{thm}[O konstantách]
  Nechť $ \varphi $ je formule $ L $ s volnými $ x_1, \dots, x_n $. Nechť $ L' $ je rozšířením $ L $ o konstantní symboly $ c_1,\dots,c_n $. Nechť $ T' $ je stejná jako $ T $, akorát v $ L' $. Pak \[
    T \models \varphi \Longleftrightarrow T' \models \fce{\varphi}{x_1 \slash c_1, x_2 \slash c_2, \dots, x_n \slash c_n}.
  \]
\end{thm}

\begin{defi}[Extenze teorie]
  $ T' $ v jazyce $ L' \supseteq L $ je \textit{extenze} teorie $ T $ v jazyce $ L \equiv $ \[
    \fce{\Csq_L}{T} \subseteq \fce{\Csq_L}{T'}
  \]
  $ T' $ je \begin{itemize}
    \item \textit{jednoduchá} extenze $ \equiv L' = L $,
    \item \textit{konzervativní} extenze $ \equiv \fce{\Csq_L}{T'} = \fce{\Csq_L}{T} $,
    \item \textit{ekvivalentní} $ T \equiv  T$ je extenzí $ T' $ a naopak.
  \end{itemize}
\end{defi}

\begin{cor}
  \
  \begin{enumerate}
    \item $ T' $ je extenze $ T \Leftrightarrow \fce{M_L}{T'} \subseteq \fce{M_L}{T} $,
    \item $ T' $ je ekvivalentní $ T \Leftrightarrow \fce{M_L}{T'} = \fce{M_L}{T} $,
  \end{enumerate}
\end{cor}

\begin{thm}
  Nechť $ L \subseteq L' $, $ T $ v $ L, T' $ v $ L' $. Pak \begin{enumerate}
    \item $ T' $ je extenzí $ T \Leftrightarrow \forall \aa $ redukt $ \aa' \in \fce{M_{L'}}{T'} $ je modelem $ T $,
    \item $ T' $ je extenzí $ T \land \forall \aa \in \fce{M_L}{T} \; \exists \aa' $ extenze $ \aa: \aa' \in \fce{M_{L'}}{T'} \Rightarrow  T' $ je konzervativní extenzí $ T $.
  \end{enumerate}
\end{thm}

\begin{defi}[Definice relačního symbolu]
  Nechť $ T $ je teorie v $ L $ a $ \fce{\varphi}{x_1, \dots, x_n} $ je formule $ L $. Označme $ L' $ \textit{rozšíření $ L $ o nový $ n $-ární relační symbol $ R $}. Pak $ T' $ je \textit{extenze teorie $ T $ o relační symbol $ R $ definovaný $ \psi $} $ \equiv $ \[
    T' \deq T \cup \{ \fce{R}{x_1, \dots, x_n} \leftrightarrow \fce{\psi}{x_1, \dots, x_n} \}.
  \]
\end{defi}

\begin{cor}
  Nechť platí předchozí. Pak $ T' $ je konzervativní extenzí $ T $.
\end{cor}

\begin{thm}
  Nechť platí předchozí. Pak $ \forall L'$-formuli $ \varphi' $ $ \exists L $-formule $ \varphi $, tž. \[
    T' \models \left( \varphi' \leftrightarrow \varphi \right) .
  \]
\end{thm}

\begin{defi}[Definice funkčního symbolu]
   Nechť $ T $ je teorie v $ L $ a $ \fce{\psi}{x_1, \dots, x_n, y} $ je
   formule $ L $. Označme $ L' $ \textit{rozšíření $ L $ o nový $ n $-ární
   relační symbol $ f $}. Nechť v teorii $ T $ platí \begin{itemize}
    \item axiom \textit{existence}: $ \left( \exists y \right) \fce{\psi}{x_1,\dots,x_n,y} $,
    \item axiom \textit{jednoznačnosti}: $ \fce{\psi}{x_1,\dots,x_n,y} \land \fce{\psi}{x_1,\dots,x_n,z} \leftrightarrow y=z  $.
   \end{itemize}

  Pak $ T' $ je \textit{extenze teorie $ T $ o funkční symbol $ f $ definovaný $ \psi $} $ \equiv $ \[
    T' \deq T \cup \{ \fce{f}{x_1, \dots, x_n} = y \leftrightarrow \fce{\psi}{x_1, \dots, x_n, y} \}.
  \]
\end{defi}

\begin{cor}
  Nechť platí předchozí. Pak $ T' $ je konzervativní extenzí $ T $.
\end{cor}

\begin{thm}
  Nechť platí předchozí. Pak $ \forall \varphi'\, L'$-formuli $ \exists \varphi \;L $-formule, tž. \[
    T' \models \left( \varphi' \leftrightarrow \varphi \right) .
  \]
\end{thm}

\begin{defi}[Extenze o definice]
  Nechť $ T $ je $ L $-teorie, $ T' $ je $ L' $-teorie. Pak $ T' $ je
  \textit{extenze $ T $ o definice} $ \equiv $ vznikla z $ T $ postupnými
  definicemi relačních a funkčních symbolů.
\end{defi}

\begin{cor}[Vlastnosti extenze o definice, L7]
  Nechť $ T' $ je extenze $ T $ o definice. Pak \begin{enumerate}
    \item $ \forall \aa \in \fce{M}{T} \exists ! \aa' \in \fce{M}{T'}: \aa'$ je expanzí $ \aa $,
    \item $ T' $ je konzervativní extenze $ T $,
    \item $ \forall \varphi' $ formuli $ L' \; \exists \varphi $ formule $ L: T' \models \left( \varphi \leftrightarrow \varphi' \right)$.
  \end{enumerate}
\end{cor}

\begin{defi}[Definovatelné množiny]
  Nechť $ \fce{\varphi}{x_1, \dots, x_n} $ je formule a $ \aa $ struktura v
  témže jazyce. Pak \textit{množina definovaná $ \varphi $} $ \equiv $ \[
    \fce{\varphi^\aa}{x_1,\dots,x_n} \deq \{ \left( a_1, \dots, a_n \right) \in A^n \suchthat \aa \models \fceb{\varphi}e: \fce{e}{x_i} = a_i \}.
  \]
\end{defi}

\begin{defi}
  Nechť $ \fce{\varphi}{\vec x, \vec y} $ je formule, $ \absolute{\vec x} = n, \absolute{\vec y} = m $, dále nechť $ \aa $ je struktura nad stejným jazykem, $ \vec b \in A^m $. Pak \textit{množina definovaná $ \fce{\varphi}{\vec x, \vec y} $ s parametry $ \vec b $ v $ \aa \equiv$}\[
    \fce{\varphi^{\aa, \vec b}}{\vec x, \vec y} \deq \{ \vec a \suchthat \aa \models \fceb \varphi e: \fce{e}{x_i} = a_i, \fce{e}{y_i} = b_i\}.
  \]

  Pro $ \aa, B \subseteq A $ je $ \fce{\dfn}{\aa, B} $ \textit{množina všech množin definovatelných nad $ \aa $ pomocí parametrů z $ B $.}
\end{defi}

\section{Vztah výrokové a predikátové logiky}

\begin{defi}[Booleovy algebry]
  \textit{Teorie Booleových algeber} je teorie jazyka $ \left< -,\land, \lor, \top, \bot \right> $ s rovností, s axiomy \begin{enumerate}
    \item \textit{asociavitiva $ \land, \lor $:} \[
        x \land \left( y \land z \right) = \left( x \land y \right) \land z,
        \] \[
        x \lor \left( y \lor z \right) = \left( x \lor y \right) \lor z,
      \]
  \item \textit{komutativita $ \land, \lor $:} \[
    x \land y = y \land x,
  \] \[
    x \lor y = y \lor x,
  \]
  \item \textit{distributivita $ \land, \lor $} z obou stran: \[
    x \land \left( y \lor z \right) = \left( x \land y \right) \lor \left( x \land z \right)  ,
    \] \[
    x \lor \left( y \land z \right) = \left( x \lor y \right) \land \left( x \lor z \right)  ,
  \]
  \item \textit{absorpce}: \[
    x \land \left( x \lor y \right) = x,
  \]\[
    x \lor \left( x \land y \right) = x,
  \]
  \item \textit{komplementace}: \[
    x \land \left( -x \right) = \bot,
  \]\[
    x \lor \left( -x \right) = \top,
  \]
  \item \textit{netrivialita}: \[
    \lnot \left( \bot = \top \right).
  \]
  \end{enumerate}
\end{defi}

\subsection{Algebra výroků}

\begin{defi}[Ekvivalenční třídy]
  $ \vfpsim \deq $ množina ekvivalenčních tříd operace $ \sim $. Ekvivalenční
  třída výroku $ \varphi \equiv \left[ \varphi \right]_\sim \deq \{ \psi \;|\;
  \psi \sim \varphi \}$.
\end{defi}

\begin{defi}[Zobrazení do modelů]
  Definujeme $ h: \vfpsim \to 2^{M_\P} $ s předpisem \[
    \fce{f}{\left[ \varphi \right]_\sim} = \fce{\Mp}{\varphi}
  \]
\end{defi}

\begin{thm}[Vlastnosti $ h $]
  $ h $ je korektně definované, prosté, a pro konečné $ \P $ bijekce.
\end{thm}

\begin{defi}[Operace na $ \vfpsim $]
  Nechť $ \varphi, \psi \in \vfp $. Pak zavedeme \begin{align*}
    \lnot \left[ \varphi \right]_\sim &\deq \left[ \lnot \varphi \right]_\sim \\
    \left[ \varphi \right]_\sim \land \left[ \psi \right]_\sim &\deq \left[ \varphi \land \psi \right]_\sim \\
    \left[ \varphi \right]_\sim \lor \left[ \psi \right]_\sim &\deq \left[ \varphi \lor \psi \right]_\sim \\
    \top &\deq \left[ \top \right]_\sim \\
    \bot &\deq \left[ \bot \right]_\sim \\
  \end{align*}
\end{defi}

\begin{defi}[Algebra výroků]
  \textit{Algebra výroků }je \textit{matematická struktura} definovaná jako \[
    {\bf AV}_\P \deq \left< \vfpsim, \lnot, \lor, \land, \top, \bot \right>
  \]
  Jedná se o příklad \textit{Booleovy algebry}, což znamená, že její operace se
  chovají jako množinové operace ($ \cup, \cap,\dots $) na $ 2^{X} $ pro
  nějakou množinu $ X $. Takové algebře říkáme \textit{potenční algebra}.

  Zobrazení $ h $ je tedy zobrazení z algebry $ {\bf AV}_\P $ do potenční algebry $ 2^{\Mp} $.
\end{defi}

\begin{thm}[$ h $ homomorfismem]
  Zobrazení $ h $ je homomorfismus Booleovských algeber, a  To znamená, že
  zachovává konstanty a operace. Tedy \begin{align*}
    \fce{h}{\lnot \left[ \varphi \right]_\sim }&\deq \overline{\fce{h}{\left[ \varphi \right]_\sim}} \\
    \fce{h}{\left[ \varphi \right]_\sim \land \left[ \psi \right]_\sim }&\deq \fce{h}{\left[ \varphi \right]_\sim} \cap \fce{h}{\left[ \psi \right]_\sim} \\
    \fce{h}{\left[ \varphi \right]_\sim \lor \left[ \psi \right]_\sim }&\deq \fce{h}{\left[ \varphi \right]_\sim} \cup \fce{h}{\left[ \psi \right]_\sim} \\
  \end{align*}
  Navíc, je-li $ h $ isomorfismus, je to bijekce.
\end{thm}

\begin{defi}[Algebra vůči teorii]
  Všechny poznatky a definice ohledně algebry výroků lze relatizovat vůči teorii $ T $. Tedy \begin{align*}
    \fce{h}{\top} &\deq \fce{\Mp}{T} \\
    \fce{h}{\bot} &\deq \emptyset \\
    \fce{h}{\left[ \varphi \right]_{\sim T}} &\deq \fce{\Mp}{T, \varphi} \\
  \end{align*}
\end{defi}

\begin{thm}
  Pro $ T $ bezespornou teorii nad konečným $ \P $ je $ {\bf AV}_\P $ isomorfní s potenční algebrou $ 2^{\fce{\Mp}T} $.
\end{thm}

\begin{thm}
  Nechť $ T $ je teorie nad jazykem $\P, \absolute{\P} = n,
  \absolute{\fce{\Mp}{T}} = k $. Pak je až na ekvivalenci
  \begin{itemize}
    \item \# výroků, resp. teorií $ = 2^{2^n} $
    \item \# pravdivých, resp. lživých výroků v $T = 2^{2^n-k} $
    \item \# nezávislých výroků v $T = 2^{2^n}-2 \times 2^{2^n-k} $
    \item \# jednoduchých extenzí $T = 2^{k}$ (z toho jedna sporná)
    \item \# kompletních jednoduchých extenzí $T = {k}$
  \end{itemize}
  A až na $ T $-ekvivalenci 
  \begin{itemize}
    \item \# výroků $ = 2^{k} $
    \item \# pravdivých, resp. lživých výroků v $T = 1 $
    \item \# nezávislých výroků v $T = 2^{k}-2 $
  \end{itemize}
  
  
\end{thm}



\section{Tablo}

\begin{defi}[Tablo bez rovnosti]
  Nechť $ L $ je spočetný jazyk bez rovnosti. Definujeme $ L_C $ jako rozšíření jazyka $ L $ o spočetně mnoho konstant $ c_i \in C $. Konstantní termy jazyka $ L_C $ lze tedy očíslovat jako $ \{ t_i \suchthat i \in \N \} $.
\end{defi}

\begin{defi}[Položka]
  \textit{Položka} je nápis $ T\varphi, F\varphi $ pro $ \varphi $ sentenci $ L_C $. Zvlášť označíme položky typu \begin{itemize}
    \item \textit{svědek} $ \equiv T\!\left( \exists x \right)\fce{\varphi}{x}, F\! \left( \forall x \right)\fce{\varphi}{x} $,
    \item \textit{všichni} $ \equiv T\!\left( \forall x \right)\fce{\varphi}{x}, F\! \left( \exists x \right)\fce{\varphi}{x} $.
  \end{itemize}
\end{defi}

\begin{defi}[Tablo]
  \textit{Konečné tablo z $ T $} je uspořádaný, položkami označený strom konstruovaný rekurzivně: \begin{itemize}
    \item jednoprvkový strom označený libovolnou položkou,
    \item pro libovolnou položku lze na konec jakékoliv větve připojit její atomické tablo, pokud je to svědek, musíme použít $ c_i $, která se ještě nevyskytuje,
    \item na konec libovolé větve lze připojit položku $ T\alpha $, pro $ \alpha \in T $.
  \end{itemize}

  Nekonečné tablo vzniklo iterací po spočetně mnoha krocích.
\end{defi}

\begin{defi}[Tablo důkaz]
  \textit{Tablo důkaz $ \varphi $ z $ T $} je sporné tablo s $ F\varphi $ v kořeni. 
\end{defi}

\begin{defi}[Vlastnosti tabla]
  \
  \begin{itemize}
    \item Tablo je \textit{sporné} $ \equiv $ každá jeho větev je sporná,
    \item Větev je \textit{sporná} $ \equiv $ obsahuje $ T\psi, F\psi $ pro $ \psi $ sentenci,
    \item Tablo je \textit{dokončené} $ \equiv $ každá jeho větev je dokončená,
    \item Větev je \textit{dokončená} $ \equiv $ je sporná, nebo je každá její položka redukovaná a nachází se na ní $ T\alpha \; \forall \alpha \in T, $
    \item Položka je \textit{redukovaná} na $ V \equiv $ není typu všichni a na $ V $ je její atomické tablo, nebo je typu všichni a všechny její výskyty jsou na $ V $ redukované, 
    \item Výskyt položky je \textit{$ i $-tý} na $ V \equiv $ má před sebou $ i-1 $ výskytů označených stejnou položkou,
    \item $ i $-tý výskyt položky je \textit{redukovaný} na $ V \equiv $ má $ i+1 $ výskyt a na $ V $ je položka \begin{itemize}
      \item $ T \fce{\varphi}{x \slash t_i} $, pokud je to $ T \left( \forall x \right)\fce{\varphi}{x} $, 
      \item $ F \fce{\varphi}{x \slash t_i} $, pokud je to $ F \left( \exists x \right)\fce{\varphi}{x} $.
    \end{itemize}
  \end{itemize}
\end{defi}

\begin{thm}[Konečnost důkazů]\label{PL konečnost tablo}
  Pokud $ T \vdash \varphi $, pak existuje i konečný tablo důkaz.
\end{thm}

\begin{defi}[Systematické tablo]
  \textit{Systematické tablo} položky $ R $ pro teorii $ T $ je $ \tau \deq
    \bigcup_{i \geq 0} \tau_i $ definované rekurzivně:
  \begin{itemize}
    \item $ \tau_0 $ je jednoprvkové tablo s položkou $ R $
    \item Nechť $ P $ je nejlevější položka v co nejmenší úrovni v $ \tau_i $,
      která není redukovaná na nějaké větvi procházející $ P $, resp. pokud je
      typu všichni, tak ať je to její neredukovaný výskyt. Pak $ \tau'_i $ je $
      \tau_i $ s připojením $ P $ na každou bezespornou větev procházející $ P
      $, nebo $ \tau_i $, pokud takové $ P $ neexistuje. \begin{itemize}
        \item pro $ k $-tý výskyt typu všichni substituujeme $ t_k $,
        \item pro typ svědek substituujeme nové $ c_i $,
      \end{itemize}
      
    \item $ \tau_{i+1} $ je tablo vzniklé z $ \tau'_i $ připojením $ T\alpha_i
      $ na každou bezespornou větev, popř. je to $ \tau'_i $, pokud $ i >
      \absolute{T} $, nebo jsou všechny větve sporné.
  \end{itemize}
\end{defi}

\begin{lemma}
  Systematické tablo je dokončené.
\end{lemma}

\begin{cor}
  Pokud při konstrukci sporného tabla nikdy neprodloužíme sporné větve, pak je
  sporné tablo konečné. Speciálně, sporné systematické tablo je konečné.
\end{cor}

\begin{defi}[Kongruence]
  Nechť $ \sim $ je ekvivalence na $ A,\;  f: A^n \to A,\; R: A^n \to \{ 0,1 \},\;\aa $ struktura. Pak $ \sim $ je \begin{itemize}
    \item \textit{kongruencí pro $ f $} $ \equiv \forall \vec x, \vec y \in A^n: x_i \sim y_i: \fce{f}{\vec x} \sim \fce{f}{\vec y} $,
    \item \textit{kongruencí pro $ R $} $ \equiv \forall \vec x, \vec y \in A^n: x_i \sim y_i: \fce{R}{\vec x} \leftrightarrow \fce{R}{\vec y} $.
    \item \textit{kongruencí pro $ \aa $} $ \equiv $ je kongruencí pro všechny funkční i relační symboly $ \aa $.
  \end{itemize}
\end{defi}

\begin{defi}[Faktorstruktura]
  Nechť $ \aa $ je struktura a $ \sim $ její kongruence. Pak $ \aas $ je
  struktura v témž jazyce, jejíž univerzum je množina rozkladových tříd $ A $
  podle $ \sim $ a jejíž funkce a relace jsou definovány pomocí reprezentantů.
\end{defi}

\begin{defi}[Axiomy rovnosti]
  \textit{Axiomy rovnosti} pro $ L $ s rovností jsou \begin{enumerate}
    \item $ x = x $,
    \item $ \forall f \in \ff: \vec x  = \vec y \rightarrow \fce{f}{\vec x} = \fce{f}{\vec y} $,
    \item $ \forall R \in \rr: \vec x  = \vec y \rightarrow \left( \fce{R}{\vec x} \rightarrow \fce{R}{\vec y} \right) $ (včetně rovnosti).
  \end{enumerate}
\end{defi}

\begin{defi}[Tablo s rovností]
  Je-li teorie $ T $ v $ L $ s rovností, pak $ T^* $ je rozšíření $ T $ o
  generální uzávěry axiomů rovnosti pro $ L $. \textit{Tablo důkaz $ R $ z $ T
  $} je tablo důkaz z $ T^* $.
\end{defi}

\begin{thm}
  Jestli $ \aa \models T^* $, pak i $ \aa \slash_{=^\aa} \models T^* $, a $ = $
  je interpretována jako identita. Na druhou stranu, $ \forall \aa $, kde je $
  = $ interpretována jako identita, platí axiomy rovnosti.
\end{thm}

\begin{defi}
  Model $ \aa $ se shoduje s položkou $ P $, pokud \begin{enumerate}
    \item $ P = T\varphi $ a $ \aa \models \varphi $, nebo
    \item $ P = F\varphi $ a $ \aa \nvDash \varphi $.
  \end{enumerate}
\end{defi}


\begin{lemma}
  Shoduje-li se $ \aa $ s položkou v kořeni tabla $ \tau $ teorie $ T $ v $ L
  $, pak lze $ \aa $ expandovat do $ L_C $ tak, že se shoduje s nějakou větví $
  \tau $.
\end{lemma}

\begin{thm}[Korektnost]
  Pro $ \varphi $ sentenci, $ T $ teorii platí \[
    T \vdash \varphi \implies T \models \varphi.
  \]
\end{thm}

\begin{defi}[Kanonický model]
  Nechť $ T = \left< \rr, \ff \right> $ je teorie v $ L $ bez rovnosti, nechť $ V $ je bezesporná větev tabla $ \tau $ v $ T $. Pak \textit{kanonický model} $ V $ je $ L_C $-struktura $ \aa = \left< A, \rr^A, \ff^A \right> $, kde \begin{itemize}
    \item $ A $ je množina všech konstantních termů $ L_C $,
    \item $ \forall R \in \rr, \left( s_1, \dots, s_n \right) \in A^n $ je $ \left( s_1, \dots, s_n \right) \in R^\aa \Longleftrightarrow T \fce{R}{s_1, \dots, s_n} \in V $,
    \item $ \forall f \in \ff, \left( s_1, \dots, s_n \right) \in A^n $ je $ \fce{f^\aa}{s_1, \dots, s_n} \deq "\fce{f}{s_1, \dots, s_n}" $,
  \end{itemize}
  
  Pro $ L $ s rovností zopakujeme předchozí kroky (pro teorii $ T^* $) a
  dostaneme $ \bb $ model $ L $ bez rovnosti. Dále definujeme relaci $ =^B $
  stejně jako pro ostatní relační symboly.

  Kanonický model pro $ V $ je potom faktorstruktura $ \aa = \bb \slash_{=^B} $.
\end{defi}

\begin{lemma}
  Kanonický model pro bezespornou dokončenou větev $ V $ se shoduje s $ V $.
\end{lemma}

\begin{thm}[Úplnost]
  Pro $ \varphi $ sentenci, $ T $ teorii platí \[
    T \models \varphi \implies T \vdash \varphi.
  \]
\end{thm}

\begin{defi}[Theorém]
  \[
    \fce{\Thm_L}{T} = \{ \varphi \suchthat \varphi \text{ je $ L $-sentence} \land T \vdash \varphi \}.
  \]
\end{defi}

\begin{cor}
  Pro $ T $ teorii a $ \varphi, \psi $ sentence platí \begin{enumerate}
    \item $ T \vdash \varphi \Longleftrightarrow T \models \varphi $,
    \item $ \fce{\Thm_L}{T} = \fce{\Csq_L}{T} $.
  \end{enumerate}
\end{cor}

\begin{thm}[Kompaktnost] \label{PL kompaktnost}
  Teorie má model, právě když každá její konečná část má model.

  \begin{proof}
    Nechť $ T $ je teorie, $ T' $ její konečná část. Pokud $ \aa $ je modelem $
    T $, pak je určitě i modelem $ T' $, protože splňuje axiomy $ T $, což je
    nadmnožina axiomů $ T' $.

    Naopak, pokud $ T $ nemá model, pak existuje sporné $ \tau $ z $ F\bot $.
    Toto tablo je konečné (\ref{PL konečnost tablo}), tedy používá jen konečně
    mnoho axiomů. $ T' $ používající právě tyto axiomy je konečná, a přesto
    nemá model.
  \end{proof}
  
\end{thm}

\begin{defi}[Nestandardní model]
  Nechť $ \underline \N \deq \left< \N, 0, +, 1, \cdot \right> $ je standardní
  model aritmetiky. Nechť $ c $ je nová konstanta. Definujeme
  \textit{nestandardní model} jako teorii $ T $: \[
    T \deq \fce{\Th}{\underline \N} \cup \{ c > \underline n \suchthat n \in \N \}.
  \]
\end{defi}


\section{Rezoluce}

\subsection{Prenexní forma}

\begin{defi}[Ekvisplnitelnost]
  Nechť $ T $ je teorie v $ L $, $ T' $ v $ L' $. Pak $ T,T' $ jsou \textit{ekvisplnitelné} $ \equiv $ \[
    T \text{ má model} \Longleftrightarrow T' \text{ má model.}
  \]
\end{defi}

\begin{defi}[Prenexní forma]
  Výrok $ \varphi $ je v \textit{prenexní formě} $ \equiv $ je ve tvaru \[
    \left( Q_1x_1 \right) \dots \left( Q_nx_n \right) \varphi',
  \]
  kde $ Q_i $ jsou kvantifikátory a $ \varphi' $ je otevřená formule. Takové $
  \varphi' $ je \textit{otevřené jádro} $ \varphi $ a $ \left( Q_1x_1
  \right)\dots \left( Q_nx_n \right) $ je \textit{kvantifikátorový prefix}.
\end{defi}

\begin{defi}[Univerzální formule]
  Formule $ \varphi $ je \textit{univerzální} $ \equiv \forall Q_i$ jejího
  kvantifikátorového jádra je univerzální kvantifikátor.
\end{defi}

\begin{thm}[Existence PNF]
  $ \forall \varphi $ existuje ekvivalentní formule v PNF.
\end{thm}

\begin{lemma}
  Nechť $ \varphi, \psi $ jsou formule, $ x $ není volná ve $ \psi $. Pak \begin{align*}
    \lnot \left( Qx \right)\varphi &\sim \left( \overline Qx \right) \lnot \varphi, \\
    \left( Qx \right)\varphi \land \psi &\sim \left(  Qx \right) \left( \varphi \land \psi \right) ,\\
    \left( Qx \right)\varphi \lor \psi &\sim \left(  Qx \right) \left( \varphi \lor \psi \right) ,\\
    \left( Qx \right)\varphi \to \psi &\sim \left( \overline Qx \right) \left( \varphi \to \psi \right) ,\\
    \psi \to \left( Qx \right)\varphi  &\sim \left(  Qx \right) \left( \psi \to \varphi \right) .\\
  \end{align*}
\end{lemma}

\begin{cor}[]
  Každé formuli existuje sentence v PNF.
\end{cor}

\subsection{Skolemizace}

\begin{defi}[Skolemova varianta]
  Nechť $ \varphi $ je $ L $-sentence v PNF. Nechť $ x_{i_1}, \dots, x_{i_n}  $ v jejím
  prefixu mají $ \exists $ a nechť $\forall j \in \left[ n \right]: x_{i_{j1}},
  \dots, x_{i_{jm_j}} $ jsou všechny proměnné, které v prefixu mají $ \forall $
  a předcházejí $ x_{i_j} $.
  Definujeme $ L' $ rozšíření $ L $ o $ n $ nových $ m_j $-árních funkčních
  symbolů $ f_1, \dots, f_n $. 

  \textit{Skolemova varianta} je $ L' $-sentence $ \varphi_S $ vzniklá z $ \varphi $ tak, že
  $ \forall k \in \left[ n \right] :$ \begin{itemize}
    \item vyjmeme $ \left( \exists x_{i_k} \right) $,
    \item substituujeme $ \fce{f_i}{x_{i_{j1}}, \dots, x_{i_{jm_j}}} $ za $ x_{i_k} $.
  \end{itemize}
\end{defi}

\begin{lemma}
  Nechť $ \varphi $ je $ L $-sentence ve tvaru $ \left( \forall x_1
  \right)\dots \left( \forall x_n \right)\left( \exists y
  \right)\fce{\psi}{x_1, \dots, x_n, y} $ a $ \varphi' $ je $ L' $-sentence ve tvaru $
  \left( \forall x_1 \right)\dots \left( \forall x_n \right)\fce{\psi}{x_1,
  \dots, x_n, y\slash \fce{f}{x_1\dots, x_n}} $, kde $ L' $ má nový funkční symbol $ f $. Pak \begin{enumerate}
    \item $ \forall \aa' $ model $ \varphi' $ je jeho $ L $-redukt modelem $ \varphi $,
    \item $ \forall \aa $ model $ \varphi $ lze expandovat na model $ \varphi' $.
  \end{enumerate}
\end{lemma}

\begin{thm}[Skolemova]
  Každá teorie má otevřenou konzervativní extenzi.
\end{thm}

\begin{cor}
  Ke každé teorii existuje ekvisplnitelná otevřená teorie.
\end{cor}

\begin{defi}[Základní instance]
  Nechť $ \varphi $ je formule ve volných proměnných $ x_1, \dots, x_n $. Pak
  instance $ \fce{\varphi}{x_1\slash t_1, \dots, x_n \slash t_n} $ je
  \textit{základní instance} $ \equiv \forall t_i$ je konstantní (ground) term.
\end{defi}

\begin{defi}[Herbrandův model]
  Nechť v $ L $ je alespoň jeden konstantní symbol. Pak $ L $-struktura $ \aa $ je \textit{Herbrandův model} $ \equiv $ \begin{itemize}
    \item $ A $ je množina všech konstantních termů $ L $,
    \item $ \forall f \in \ff, t_1, \dots, t_n \in A: \fce{f^\aa}{t_1, \dots, t_n} = "\fce{f}{t_1, \dots, t_n}" $,
  \end{itemize}
  
\end{defi}

\begin{thm}[Herbrandova] \label{Herbrandova}
  Nechť $ L $ je jazyk bez rovnosti s alespoň jedním konstantním symbolem.
  Nechť $ T $ je otevřená teorie $ L $. Potom $ \exists  $ Herbrandův model,
  nebo existuje konečně mnoho základních instancí axiomů z $ T $, jejichž
  konjungce je nesplnitelná.

  \begin{proof}
    Nechť $ L $ je bez rovnosti, $ T $ je otevřená. Označme $ T^* $ teorii
    základních instancí. Zkonstruujeme $ \tau $ s $ F\bot $ v kořeni. Buď je
    tablo sporné, tedy používá konečně axiomů z $ T^* $. Jejich konjungce je
    tedy sporná. 

    Pokud tablo není sporné, jeho nesporná větev je (po přidání konstantních
    symbolů) Herbrandovým modelem.
  \end{proof}
  
\end{thm}

\begin{cor}
  Nechť $ \fce{\varphi}{x_1, \dots, x_n} $ je otevřená v $ L $ s alespoň jedním
  konstantním symbolem. Potom existují konstantní $ L $-termy $ t_{ij}: 1 \leq
  i \leq m, 1 \leq j \leq n $, že \[
    \left( \exists x_1 \right) \dots \left( \exists x_n \right) \fce{\varphi}{x_1, \dots, x_n}
  \] je splnitelná $ \Longleftrightarrow $ \[
    \fce{\varphi}{t_{11}, \dots, t_{1n}} \lor \dots \lor \fce{\varphi}{t_{m1}, \dots, t_{mn}}
  \] je logická tautologie.
\end{cor}

\begin{cor}
  Nechť $ L $ je jazyk bez rovnosti s alespoň jedním konstantním symbolem.
  Nechť $ T $ je otevřená teorie $ L $. $ T $ má model $ \Longleftrightarrow
  T_{\text{ground}}$, teorie ze všech základních instancí axiomů $ T $, má
  model.
\end{cor}

\subsection{Unifikace}

\begin{defi}[Substituce]
  \textit{Substituce} je konečná množina $ \sigma \deq \{ x_1 \slash t_1, \dots, x_n \slash t_n \} $, kde $ x_i $ jsou navzájem různé proměnné, $ t_i $ termy, a $ \forall i: t_i \neq x_i $. Navíc je substituce \begin{itemize}
    \item \textit{základní} $ \equiv \forall t_i $ je konstantní term,
    \item \textit{přejmenování proměnných} $ \equiv \forall t_i $ jsou navzájem různé proměnné.
  \end{itemize}
\end{defi}

\begin{defi}[Instance]
  \textit{Instance výrazu $ E $ při $ \sigma $} je výraz vzniklý z $ E $
  simultálním nahrazením všech $ x_i $ za $ t_i $. Značíme $ E\sigma $.
\end{defi}

\begin{defi}[Složení substitucí]
  Nechť $ \sigma = \{ x_i \slash t_i \}_i, \tau = \{ y_i \slash s_i \}_i $ jsou
  substituce. Pak substituce vzniklá provedením $ \tau $ po $ \sigma $ je $
  \sigma\tau $ definovaná jako \[
    \sigma\tau \deq \{ x_i \slash t_i\tau \suchthat x_i \neq t_i\tau \} \cup \{ y_i \slash s_i \suchthat y_i \notin \{ x_j \}_j \}.
  \]
\end{defi}

\begin{cor}
  Nechť $ \sigma, \tau, \rho $ jsou substituce, $ E $ je výraz. Pak \begin{enumerate}
    \item $ \left( E\sigma \right)\tau = E \left( \sigma\tau \right) $, 
    \item $ \left( \sigma\tau \right)\rho = \sigma \left( \tau\rho \right) $.
  \end{enumerate}
\end{cor}

\begin{defi}[Unifikace]
  Nechť $ \sigma $ je substituce, $ S = \{ E_i \}_i $ je konečná množina
  výrazů. Pak $ \sigma $ je \textit{unifikace pro $ S $} $ \equiv E_1\sigma =
  E_2\sigma = \dots = E_n\sigma$.

  Pokud existuje, je $ S $ \textit{unifikovatelná.}

  Unifikace $ \sigma $ je \textit{nejobecnější} $ \equiv \forall \tau$ unifikace $ \exists \lambda $ substituce, tž. $ \tau = \sigma\lambda. $
\end{defi}

\begin{defi}[Neshoda]
  Nechť $ p $ je nejlevější pozice, na které se dva výrazy v $ S $ liší. Pak
  \textit{neshoda v $ S $}, $ \fce{D}{S} $, je množina všech podvýrazů výrazů z
  $ S $ začínajících na $ p $.
\end{defi}

\begin{algo}[Unifikace]\ \\
\textit{Vstup:} množina výrazů $ S \neq \emptyset $.
\begin{algorithmic}[1]
  \State $ k \gets 0 $
  \State $ \sigma_0 \gets \emptyset $
  \Indent Dokud $ \absolute{S} > 1 $:
    \Indent Pokud $ \nexists x $ proměnná, $ t $ term, tž. $ x,t \in \fce{D}{S} \land x \neq t $:
      \State Oznámíme, že $ S $ je \textit{neunifikovatelná}.
    \EndIndent
    \State $ k \gets k+1 $
    \State $ \sigma_k \gets \{ x \slash t \} $
    \State $ S \gets S \sigma_k $
  \EndIndent
  \State Vrátíme substituci $ \sigma_0 \dots \sigma_k $.
\end{algorithmic}
\textit{Výstup:} unifikace $ S $, případně zpráva o tom, že $ S $ je neunifikovatelná.
\end{algo}

\begin{thm}
  Unifikace je korektní algoritmus. Je-li $ S $ unifikovatelná, odpoví
  nejobecnější unifikaci. Navíc, je-li $ S $ unifikovatelná, pak $ \forall \tau
  $ unifikaci je $ \tau = \sigma\tau $.
\end{thm}

\subsection{Rezoluce}

\begin{defi}[Disjunktní sjednocení]
  Disjunktní sjednocení $ A,B $ je $ A \sqcup B $, rovné $ A \cup B $, se zaručením, že $ \forall a \in A, b \in B: b \notin A \land a \notin B $.
\end{defi}

\begin{defi}[Rezolventa]
  Nechť $ C_1, C_2 $ jsou klauzule s disjunktní množinou proměnných, a pro obě platí \[
    C_1 = C_1' \sqcup \{ A_i \}_i \land C_2 = C_2' \sqcup \{ \lnot B_j \}_j,
  \]
  kde $ S = \{ A_i \}_i \cup \{ B_j \}_j $ je unifikovatelná, $ \sigma $ je její nejobecnější unifikace.

  Pak \textit{rezolventa} $ C_1 $ a $ C_2 $ je \[
    C \deq C_1'\sigma \cup C_2'\sigma.
  \]
\end{defi}

\begin{defi}[Rezoluční důkaz]
  \textit{Rezoluční důkaz} $ C $ z $ S $ je konečná posloupnost $ \left( C_i \right)_i $, kde $ \forall i: C_i $ je \begin{itemize}
    \item $ C\sigma $, pro $ C \in S,\; \sigma $ přejmenování proměnných,
    \item rezolventa $ C_k, C_j $, kde $ j,k < i $.
  \end{itemize}
   
  Pokud existuje, je $ C $ \textit{rezolucí dokazatelná} z $ S $, $ S \vdash_R C $. \textit{Rezoluční zamítnutí} $ S $ je rezoluční důkaz $ \square $ z $ S $.
\end{defi}

\begin{thm}[Korektnost rezolučního kroku]
  Nechť $ C_1, C_2 $ jsou klauzule, $ C $ jejich rezolventa. Pak $ \forall \aa $ struktury platí \[
    \aa \models C_1 \land \aa \models C_2 \implies \aa \models C.
  \]
\end{thm}

\begin{thm}[Korektnost rezoluce]
  Nechť $ S \vdash_R \square $. Pak $ \fce{M}{S} = \emptyset $.
\end{thm}

\begin{lemma}[Lifting lemma] 
  \label{lifting}
  Nechť $ C_1, C_2 $ jsou klauzule, $ C_1^* = C_1\tau_1,\, C_2^* = C_2\tau_2 $ jejich
  základní instance, $ C^* $ rezolventa $ C_1^*, C_2^* $. Pak $ \exists C $
  rezolventa $ C_1, C_2 $, tž. $ C^* = C\tau_1\tau_2 $ je její základní instance.
\end{lemma}

\begin{cor}
  Nechť $ S $ je formule v CNF a $ S^* $ je množina jejích základních instancí.
  Nechť $ \exists C^* $ základní klauzule, pro kterou $ S^* \vdash_R C^* $. Pak
  $ \exists C, \sigma: $\[
    C^* = C\sigma \land S \vdash_R C.
  \]
\end{cor}

\begin{thm}[Úplnost rezoluce]
  Nechť $ S $ je nesplnitelná CNF formule. Pak $ S \vdash_R \square $.

  \begin{proof}
    Nechť $ S $ je nesplnitelná. Nemá tedy model, a proto podle Herbrandovy
    věty (\ref{Herbrandova}) existuje konečně mnoho klauzulí $ S^* $, jejichž
    konjungce je nesplnitelná. Podle úplnosti rezoluce ve výrokové logice
    (\ref{VL úplnost rezoluce}) existuje důkaz $ S^* \vdash_R \square $, a
    podle Lifting lemma (\ref{lifting}) je tento důkaz ekvivalentní důkazu $ S
    \vdash_R C $, kde $ C\sigma = \square $. Protože ale $ \square $ je
    základní instance $ C $, pak i $ C $ musí být $ \square $. Tedy $ S
    \vdash_R \square $.
  \end{proof}
  
\end{thm}

\subsection{Lineární a LI důkaz}

\begin{defi}[Lineární důkaz]
  \textit{Lineární důkaz} je konečná posloupnost \[
    \begin{bmatrix}
      C_0 \\ B_0
    \end{bmatrix}, 
    \begin{bmatrix}
      C_1 \\ B_1
    \end{bmatrix}, \dots
    \begin{bmatrix}
      C_n \\ B_n
    \end{bmatrix}, C_{n+1},
  \]
  kde $ C_i $ je centrální klauzule, $ C_0 $ počáteční, $ B_i $ boční, $ C_{n+1} = C $ koncová. Musí platit \begin{itemize}
    \item $ C_0 $ je varianta klauzule z $ S $,
    \item $ C_{i+1} $ je rezolventa $ C_i, B_i $,
    \item $ B_i $ je varianta klauzule z $ S $ nebo $ B_i=C_j $, pro $ j < i $.
  \end{itemize}
  
  Lineární zamítnutí je lineární důkaz $ \square $ z $ S $.
\end{defi}

\begin{defi}[LI-důkaz]
  \textit{LI-důkaz} je lineární důkaz, kde $ \forall B_i $ jsou varianty klauzulí z $ S $.
\end{defi}
 
\begin{thm}[Úplnost lineární rezoluce]
  \[
    C \vdash_{\text{Li}} S \Longleftrightarrow C \vdash_R S.
  \]
\end{thm}

\begin{thm}[Úplnost LI-rezoluce pro Hornovy formule]
  Nechť $ T $ je splnitelná Hornova formule, $ T \cup \{ G \} $ je nesplnitelná pro cíl $ G $. Potom \[
    T \cup \{ G \} \vdash_{LI} \square,
  \]
  a její LI-důkaz začíná cílem $ G $.

  \begin{proof}
    Nechť $ T \cup \{ G \} $ je nesplnitelná pro cíl $ G $. Podle Herbrandovy
    věty (\ref{Herbrandova}) existuje konečně mnoho základních instancí
    klauzulí z $ T \cup \{ G \} $, jejichž konjungce je nesplnitelná. $ S $,
    množina základních instancí $ T \cup \{ G \} $, je stále v Hornově tvaru,
    tedy existuje LI-důkaz z úplnosti LI-rezoluce pro Hornovy formule ve
    výrokové logice (\ref{LI pro HF VL}). Podle Lifting lemma (\ref{lifting})
    je rezolventa základních instancí základní instance rezolventy, tedy důkaz
    z výrokové logiky lze převést na ekvivalentní v predikátové logice, který
    také dojde na $ \square $.
  \end{proof}
  
\end{thm}

\chapter{Pokročilé partie}

\section{Teorie modelů}

\subsection{Elementární ekvivalence}

\begin{defi}[Teorie struktury]
  Nechť $ \aa $ je struktura. Pak \textit{teorie struktury $ \aa $}, neboli $ \fce{\Th}{\aa} $ je množina \[
    \fce{\Th}{\aa} = \{ \varphi \suchthat \aa \models \varphi \}
  \]
\end{defi}

\begin{thm}
  Nechť $ \aa, \bb $ jsou struktury, $ T $ teorie. Pak \begin{enumerate}
    \item $ \fce{\Th}{\aa} $ je kompletní teorie,
    \item $ \aa \in \fce{M_L}{T} \implies \fce{\Th}{\aa} $ je jednoduchá extenze $ T $,
    \item $ T $ je kompletní $ \land \aa \in \fce{M_L}{T} \implies \fce{\Th}{\aa} $ je ekvivalentní $ T $, $ \fce{\Csq}{T} = \fce{\Th}{\aa} $,
    \item $ \aa \equiv \bb \Longleftrightarrow \fce{\Th}{\aa} = \fce{\Th}{\bb}. $
  \end{enumerate}
\end{thm}

\begin{defi}[DeLO*]
  Teorie hustého lineárního uspořádání (Dense Linear Order) je extenze uspořádání o \begin{itemize}
    \item axiom \textit{linearity}: $ x \leq y \lor y \leq x $,
    \item axiom \textit{hustoty}: $ x \leq y \land x \neq y \implies \left( \exists z \right) \left( x \leq z \land z \leq y \land z \neq x \land z \neq y \right)$,
  \end{itemize}
\end{defi}

\begin{thm}
  Nechť $ \varphi = \left( \exists x \right) \left( \forall  y \right) \left( x
  \leq y \right) $ a $ \psi = \left( \exists x \right) \left( \forall  y
  \right) \left( y \leq x \right) $. Pak \begin{itemize}
    \item $ \delo = \delo^* \cup \{ \lnot \varphi, \lnot \psi \} $,
    \item $ \delo^+ = \delo^* \cup \{ \lnot \varphi, \psi \} $,
    \item $ \delo^- = \delo^* \cup \{  \varphi, \lnot \psi \} $,
    \item $ \delo^\pm = \delo^* \cup \{  \varphi, \psi \} $
  \end{itemize}
  jsou všechny jednoduché extenze $ \delo^* $.
\end{thm}

\begin{thm}[Löwenheim-Skolem] \label{lowskol}
  Je-li $ L $ jazyk bez rovnosti, pak každá bezesporná $ T $ nad $ L $ má spočetný model.

  \begin{proof}
    Nechť $ T $ je bezesporná. Pak $ \exists \tau $, dokončené bezesporné
    tablo, tedy $ \exists V $ větev $ \tau $, která není sporná.

    Existuje tedy i kaninický model podle $ V $ v $ L_C $. Jeho $ L $-redukt je hledaný
    spočetný model.
  \end{proof}
  
\end{thm}

\begin{cor}
  Nechť $ L $ je spočetný bez rovnosti. Pak každá $ L $-struktura má
  elementárně ekvivalentní spočetně nekonečnou strukturu.
\end{cor}

\begin{thm}[Löwenheim-Skolem s rovností]
  Nechť $ L $ je spočetný jazyk s rovností. Pak každá bezesporná $ L $-teorie
  má spočetný model (tj. konečný, nebo spočetně nekonečný).

  \begin{proof}
    Nechť $ T $ je bezesporná. Pak $ \exists \tau $ dokončené tablo $ F\bot $,
    které má nespornou větev $ V $. Hledaný model je $ L $-redukt kanonického
    modelu podle $ V $.
  \end{proof}
  
\end{thm}

\begin{cor}
  Nechť $ L $ je spočetný s rovností. Pak každá nekonečná $ L $-struktura má
  elementárně ekvivalentní spočetně nekonečnou strukturu.
\end{cor}

\begin{defi}[Algebraická uzavřenost]
  $ \aa $ je \textit{algebraicky uzavřené} $ \equiv $ každý polynom nenulového
  stupně v něm má kořen.
\end{defi}

\begin{cor}
  Existuje spočetné algebraicky uzavřené těleso.
\end{cor}

\subsection{Isomorfismus struktur}

\begin{defi}[Isomorfismus]
  Nechť $ \aa, \bb $ jsou struktury jazyka $ \left< \rr, \ff \right> $. Pak \textit{isomorfismus $ \aa $ na $ \bb $} je bijekce $ h: A \to B \equiv $ \begin{enumerate}
    \item $ \forall f \in \ff, \forall a_i \in \aa: $ \[
      \fce{h}{\fce{f^\aa}{a_1, \dots, a_n}} = \fce{f^\bb}{\fce{h}{a_1}, \dots, \fce{h}{a_n}},
    \]
    \item $ \forall R \in \rr, \forall a_i \in \aa: $\[
      \fce{R^\aa}{a_1, \dots, a_n} \Longleftrightarrow \fce{R^\bb}{\fce{h}{a_1}, \dots, \fce{h}{a_n}}.
    \]
  \end{enumerate}
  
  Pak \textit{$ \aa $ je isomorfní s $ \bb $ přes $ h $}, $ \aa \simeq \bb $, $
  \aa \simeq_h \bb $.
\end{defi}

\begin{defi}[Automorfismus]
   \textit{Automorfismus $ \aa $} je isomorfismus $ \aa $ na $ \aa $. Množina automorfismů $ \aa $ je $ \fce{\aut}{\aa}. $
\end{defi}


\begin{thm}
  Nechť $ \aa, \bb $ jsou struktury. Pak $ h: A \to B $ je isomorfismus $ \Longleftrightarrow $ \begin{enumerate}
    \item $ \forall t \in \Term_L, e: \Var \to A $: \[
      \fce{h}{\fceb{t^\aa}{e}} = \fceb{t^\bb}{e \circ h},
    \]
    \item $ \forall \varphi $ $ L $-formuli, $ e: \Var \to A $: \[
        \aa \models \fceb{\varphi}{e} \Longleftrightarrow \bb \models \fceb \varphi {e \circ h}.
    \]
  \end{enumerate}
\end{thm}

\begin{cor}
  \[
    \aa \simeq \bb \implies \aa \equiv \bb.
  \]
\end{cor}

\begin{thm}
  Nechť $ L $ je s rovností a $ \aa, \bb $ jsou konečné. Pak \[
    \aa \simeq \bb \Longleftrightarrow \aa \equiv \bb.
  \]
\end{thm}

\begin{cor}
  Nechť kompletní $ T $ má v jazyce s rovností konečný model. Potom jsou
  všechny její modely isomorfní. 
\end{cor}

\begin{thm}
  Nechť $ D \subseteq A^n $ je definovatelná v $ \aa $. Pak \[
    \forall h \in \fce{\aut}{\aa}: \{ \left( \fce{h}{a_i} \right)_i \suchthat \vec a \in D \} = D.
  \]
  Dále, nechť $ D $ je definovatelná s parametry $ \vec b $. Pak \[
    \forall h \in \fce{\aut}{\aa}: \forall i: \fce{h}{b_i} = b_i \implies \{ \left( \fce{h}{a_i} \right)_i \suchthat \vec a \in D \} = D.
  \]
\end{thm}

\subsection{$ \omega $-kategorické teorie}

\begin{defi}[Kardinalita]
  Kardinalita, neboli mohutnost, je vyjádření velikosti množiny.
\end{defi}


\begin{defi}[Isomorfní spektrum]
  \textit{Isomorfní spektrum} teorie $ T $ je \[
    \{ \fce{I}{\kappa, T} \suchthat \kappa \text{ je kardinalita} \},
  \] kde $ \fce{I}{\kappa, T} \deq $ počet modelů $ T $ kardinality $ \kappa $ až na isomorfismus.
\end{defi}

\begin{defi}[Kategoricita]
  Nechť $ \fce{I}{\kappa, T} = 1 $ pro konkrétní $ \kappa $. Pak $ T $ je \textit{$ \kappa $-kategorická}.
\end{defi}

\begin{defi}[]
  $ \omega $ je kardinalita množiny $ \N $.
\end{defi}

\begin{thm}
  $ \delo $ je $ \omega $-kategorická.

  \begin{proof}
    Nechť $ \aa, \bb $ jsou dva modely $ \delo $. Chceme $ h: A \to B $. Nechť
    $ A = \{ a_i \}_i $ a $ B = \{ b_i \}_i $. Indukcí budeme hledat $ h_n: A_n
    \to B_n $, kde $ \{ a_i \}_{i<n} \subseteq A_n $ a $ \{ b_i \}_{i<n}
    \subseteq B_n $, která zachovávají uspořádání. V $ h_0 $ je prostě
    definovaná pro jeden prvek, $ \fce{h_0}{a_0} = b_0 $.

    Nechť už máme $ h_m $ pro $ m < n $. Pokud $ a_n \in A_{n-1} $, vezmeme $
    A_n = A_{n-1} $. Jinak $ A_n = A_{n-1} \cup \{ a_n \} $. Pokud existují
    prvky $ a_i, a_j $ pro $ i,j < n $, pro které $ a_i \leq^\aa a_n \leq^\aa
    a_j $, pak zadefinujeme jako $ \fce{h_n}{a_n} = b_k $, pro $ b_k \notin
    B_{n-1} $ a $ \fce{h_n}{a_i} \leq^\bb b_k \leq^\bb \fce{h_n}{a_j} $. Takové
    $ b_k $ existuje díky hustotě. 

    Také se ale mohlo stát, že $ a_n $ není mezi dvěma $ a_i, a_j $. BÚNO je to
    maximum z $ A_n $. Z hustoty $ B $ a neexistence maxima v $ B $ víme, že $
    \exists b \in B: b \notin B_n \land \forall b' \in B_n: b \geq^\bb b' $.
    Takové $ b $ si vybereme a zadefinujeme $ \fce{h_n}{a_n} = b $.

    Tento postup opakujeme i \textquote{z druhé strany}, pokud $ b_n \notin B_{n-1} $.

    Z konstrukce $ h_n $ vyplývá, že $ \aa \simeq \bb $ přes $ h \deq \bigcup_n
    h_n $.
  \end{proof}
  
\end{thm}

\begin{thm}[$ \omega $-kategorické kritérium kompletnosti]
  Nechť $ T $ je $ \omega $-kategorická ve spočetném $ L $. Je-li \begin{itemize}
    \item $ L $ bez rovnosti, nebo
    \item $ L $ s rovností a $ T $ nemá konečné modely, 
  \end{itemize}
  pak $ T $ je kompletní.
\end{thm}

\begin{cor}
  $ \delo, \delo^+, \delo^-, \delo^\pm $ jsou všechny kompletní navzájem neekvivalentní extenze $ \delo^* $.
\end{cor}

\subsection{Axiomatizovatelnost}

\begin{defi}[Axiomatizovatelnost]
  Nechť $ K \subseteq M_L $. $ K $ je \begin{itemize}
    \item \textit{axiomatizovatelná} $ \equiv \exists T: \fce{M_L}{T} = K$,
    \item \textit{konečně axiomatizovatelná} $ \equiv \exists T: \absolute{T} \in \N \land \fce{M_L}{T} = K$,
    \item \textit{otevřeně axiomatizovatelná} $ \equiv \exists T:  \fce{M_L}{T} = K \land T$ je otevřená.
  \end{itemize}

  Teorie $ T $ je \textit{/konečně/otevřeně axiomatizovatelná} $ \equiv $ $ \fce{M_L}{T} $ je /konečně/otevřeně axiomatizovatelná.
\end{defi}

\begin{thm}
  Nechť $ K $ je axiomatizovatelná. Pak je uzavřená na elementární ekvivalenci.
\end{thm}

\begin{thm}[T14]
  Nechť má teorie libovolně velké konečné modely. Pak má i nekonečný, tedy
  třída jejích konečných modelů není axiomatizovatelná.

  \begin{proof}[Důkaz existence nekonečného modelu]
    Pro $ L $ bez rovnosti vezmeme kanonický model nějaké větve tabla pro $ F\bot $. 

    Pro $ L $ s rovností zadefinujeme $ T' = T \cup \{ c_i \neq c_j \suchthat
    i,j \in \N \} $ v jazyce s novými konstantami $ c_i $. Každá konečná část $
    T' $ má model, tedy i $ T' $ má model z kompaktnosti (\ref{PL
    kompaktnost}). Jeho $ L $-redukt je nekonečným modelem $ T $.
  \end{proof}

  \begin{proof}[Důkaz neaxiomatizovatelnosti]
    Sporem. Nechť $ M $ je třída konečných modelů $ T $. Nechť $ S $ je teorie,
    tž. $ \fce{M}{S} = M $. Pak má $ S $ libovolně velké konečné modely, tedy i
    nekonečný. Ten ale není v $ M $, tedy $ \fce{M}{S} \neq M $. $ \lightning $
  \end{proof}
\end{thm}

\begin{thm}[Konečná axiomatizovatelnost]
  Nechť $ K \subseteq M_L, \overline K = M_L \setminus K $. Pak $ K $ je
  konečně axiomatizovatelná $ \Longleftrightarrow $ $ K $ i $ \overline K $
  jsou axiomatizovatelné.

  \begin{proof}
    Nechť $ K $ je konečně axiomatizovatelná teorií $ T $. Pak $ K $ je i
    axiomatizovatelná, a pokud $ \varphi $ je negace konjungce generálních
    uzávěrů formulí z $ T $, pak $ \fce{M}{\{ \varphi \}} = \overline K $.

    Naopak, nechť $ K $ i $ \overline K $ jsou axiomatizovatelné a $ S,T $
    teorie, tž. $ \fce{M}{S} = K, \fce{M}{T} = \overline K $. Pak $ T \cup S $
    je sporná teorie. Podle věty o kompaktnosti (\ref{PL kompaktnost}) existují
    $ T', S' $ konečné, tž. $ \fce{M}{T' \cup S'} = \emptyset $. Z vlastností
    teorií platí \[
      \fce{M}{T} \subseteq \fce{M}{T'} \subseteq \overline{\fce{M}{S'}} \subseteq \overline{\fce{M}{S}} = \fce{M}{T},
    \]
    tedy $ \fce{M}{T'} = \fce{M}{T} = K $, kde $ T' $ je konečná.
  \end{proof}
  
\end{thm}

\begin{defi}[Charakteristika tělesa]
  Nechť $ \aa = \left< A, +, -, 0, \cdot, 1 \right> $ je těleso. $ \aa $ je \begin{itemize}
    \item \textit{charakteristiky $ p $} $ \equiv \sum_{i=1}^{p}1 = 0$,
    \item \textit{charakteristiky $ 0 $} $ \equiv \forall p \in \P: \sum_{i=1}^{p}1 \neq 0$,
  \end{itemize}
\end{defi}

\begin{cor}[Konečná axiomatizace charakteristiky]
  Nechť $ T $ je teorie těles. Pak třída těles charakteristiky $ p $ je
  axiomatizovatelná jako $ T \cup \{ \lnot \sum_{i=0}^{p}1 = 0 \suchthat p \in
  \P \} $, ale \textit{není konečně axiomatizovatelná.}
\end{cor}

\begin{thm}[Kritérium otevřené axiomatizovatelnosti, L19]
  Nechť $ T $ je otevřeně axiomatizovatelná. Pak $ \forall \bb \subseteq \aa:
  \aa \in \fce{M_L}T \implies \bb \in \fce{M_L}{T} $. 
\end{thm}

\section{Nerozhodnutelnost}

\begin{defi}[Rekurzivní axiomatizace]
  Nechť $ T $ je teorie. $ T $ je \textit{rekurzivně axiomatizovaná} $ \equiv $
  existuje algoritmus, který pro $ \varphi $ rozhodne, zda $ \varphi \in T $.
\end{defi}

\begin{defi}[Rozhodnutelnost]
  Nechť $ T $ je teorie. $ T $ je \begin{itemize}
    \item \textit{rozhodnutelná} $ \equiv $ existuje algoritmus, který v
      konečném čase doběhne a odpoví, zda $ T \models \varphi $,
    \item \textit{částečně rozhodnutelná} $ \equiv $ existuje algoritmus, který
      pokud $ T \models \varphi $, pak doběhne v konečném čase a odpoví
      \textquote{ano}, jinak buď nedoběhne nebo odpoví \textquote{ne}.
  \end{itemize}
\end{defi}

\begin{cor}
  Nechť $ T $ je konečně axiomatizovaná teorie. Pak \begin{itemize}
    \item $ T $ je částečně rozhodnutelná,
    \item pokud je $ T $ kompletní, pak je rozhodnutelná.
  \end{itemize}
\end{cor}

\begin{defi}[Rekurzivně spočetná kompletace]
  Nechť $ T $ je teorie. $ T $ má \textit{rekurzivně spočetnou kompletaci} $
  \equiv $ množina všech kompletních extenzí $ T $ je rekurzivně spočetná.

  Toto platí pokud existuje algoritmus, který pro $ i,j $ na vstupu vypíše $ i
  $-tý axiom $ j $-té extenze, popř. řekne, že už neexistuje.
\end{defi}

\begin{thm} \label{teorie ra rsk implikuje rozhodnutelná}
  Pokud $ T $ je rekurzivně axiomatizovaná a má rekurzivně spočetnou
  kompletaci, pak je rozhodnutelná.

  \begin{proof}
    Nechť $ T $ je rekurzivně axiomatizovatelná a má rekurzivně spočetnou
    kompletaci. Nechť $ \varphi $ je libovolná formule. Buď $ T \vdash \varphi
    $, nebo existuje kompletace $ T' $, pro kterou $ T \not\vdash \varphi $.
    Protože $ T' $ je kompletní, pak v tom případě $ T' \vdash \lnot \varphi $.
    Navíc, protože $ T $ má rekurzivně spočetnou kompletaci, pak $ T' $ po
    konečně krocích kompletačního algoritmu najdeme.

    Algoritmus na zjištění, zda $ T \models \varphi $ bude paralelně
    konstruovat tabla $ T $ s $ F\varphi $, a jejích kompetací s $ T\varphi $.
    Alespoň jedno z tabel bude sporné, a algoritmus na něj po konečně mnoha
    krocích přijde.
  \end{proof}
  
\end{thm}

\begin{defi}[Rekurzivní axiomatizovatelnost]
  Nechť $ K \subseteq M_L $. Pak $ K $ je \textit{rekurzivně axiomatizovatelná}
  $ \equiv \exists T$ otevřeně axiomatizovaná, tž. $ K = \fce{M_L}{T} $.

  Nechť $ T' $ je teorie. $ T' $ je \textit{rekurzivně axiomatizovatelná} $
  \equiv \fce{M_L}{T'} $ je rekurzivně axiomatizovatelná, neboli $ T' $ je
  ekvivalentní nějaké rekurzivně axiomatizované $ T $.
\end{defi}

\begin{prop} \label{konečná struktura konečný jazyk implikuje rekurzivně axiomatizovatelná}
  Je-li $ \aa $ konečná v konečném jazyce s rovností, pak je její teorie
  rekurzivně axiomatizovatelná.

  \begin{proof}
    Nechť $ A = \{ a_i \}_{i < n} $. Pak $ \fce{\Th}{A} $ lze axiomatizovat pomocí výroku \textquote{existuje právě $ n $ různých prvků $ a_1, \dots, a_n $ a splňují: $ \forall f \in \ff:\fce{f}{a_i} = \fce{f^{\aa}}{a_i} $, dále $ \forall R \in \rr: \{ a_i \}_i \in R: \forall \vec a \in R^\aa: \vec a \in R $}.
  \end{proof}
\end{prop}

\begin{cor}
  Je-li $ \aa $ konečná v konečném jazyce s rovností, pak je její teorie
  rozhodnutelná.

  \begin{proof}
    Nechť $ \aa $ je konečná v konečném jazyce. Pak je rekurzivně
    axiomatizovatelná podle \ref{konečná struktura konečný jazyk implikuje
    rekurzivně axiomatizovatelná}. $ \fce{\Th}{\aa} $ má navíc triviální
    rekurzivní kompletaci, protože už je kompletní. Podle \ref{teorie ra rsk
    implikuje rozhodnutelná} je tedy i rozhodnutelná.
  \end{proof}
\end{cor}

\begin{defi}[Aritmetika]
  \textit{Aritmetika} je teorie $ T $ nad jazykem $ L = \left< S, +, \cdot ,0, \geq \right> $.
\end{defi}

Tzv. standardní model aritmetiky je $ \underline \N = \left< \N, S, +, \cdot,
0, \geq \right> $. Ten ale není konečně axiomatizovaný, proto často používáme
aritmetiky, které jsou konečně axiomatizovatelné a vlastnosti standardního
modelu alespoň částečně popisují (standardní model je jedním z jejich modelů).

\begin{defi}[Robinsonova aritmetika]
  Teorie $ Q $ je \textit{Robinsonova aritmetika}, jejíž axiomy jsou \begin{enumerate}
    \item $ \lnot \fce{S}{x} = 0 $,
    \item $ \fce{S}{x} = \fce{S}{y} \to x = y $,
    \item $ x + 0 = x $,
    \item $ x + \fce{S}{y} = \fce{S}{x+y} $,
    \item $ x \cdot 0 = 0 $,
    \item $ x \cdot \fce{S}{y} = x \cdot y + x $,
    \item $  x \neq 0 \to \left( \exists y \right) \left( x = \fce{S}{y} \right)  $,
    \item $ x \leq y \leftrightarrow \left( \exists z \right) \left( z+x = y \right) $.
  \end{enumerate}
\end{defi}

\begin{defi}[Numerál]
  Numerál $ \underline n \deq \fce{S}{\dots \fce{S}{0} \dots} $.
\end{defi}

\begin{thm}[Existenční tvrzení o numerálech v $ Q $]
  Nechť $ \fce{\varphi}{x_1, \dots, x_n} $ je existenční formule, tj. v prenexním tvaru má jen existenční kvantifikátory. Dále, nechť $ a_1, \dots, a_n \in \N $. Pak \[
    Q \vdash \fce{\varphi}{x_1 \slash \underline{a_1}, \dots, x_n \slash \underline{a_n}} \Longleftrightarrow \underline \N \models \fceb{\varphi}{\fce{e}{x_1 \slash a_1, \dots, x_n\slash a_n}}.
  \]
\end{thm}

\begin{defi}[Peanova aritmetika]
  \textit{Peanova aritmetika} je teorie $ \pa $, extenze $ Q $ o schéma indukce. To znamená, že $ \forall \fce{\varphi}{x, \vec y} $ přidáme axiom \[
    \left( \fce{\varphi}{0, \vec y} \land \left( \forall x \right)\left( \fce{\varphi}{x,\vec y} \to \fce{\varphi}{\fce{S}{x}, \vec y} \right) \right)\to \left( \forall x \right)\fce{\varphi}{x, \vec y}.
  \]
\end{defi}

Cílem nyní bude dokázat, že nelze algoritmicky rozhodnout o platnosti formule v
PL. Speciálně dokážeme, že pokud bychom uměli rozhodnout o platnosti formule v
PL, pak bychom uměli rozhodnout i o jiném problému, který je nerozhodnutelný,
o tzv. Hilbertově 10. problému.

\begin{defi}[Hilbertův 10. problém]
  Nechť $ \fce{p}{x_1, \dots, x_n} $ je polynom s celočíselnými koeficienty.
  Existuje algoritmus, který rozhodne, zda existují celočíselné kořeny rovnice
  $ \fce{p}{x_1, \dots, x_n} = 0 $? (takovéto rovnici se říká Diofanická)
\end{defi}

\begin{thm}
  Problém existence celočíselného řešení Diofanické rovnice je algoritmicky
  nerozhodnutelný.
\end{thm}

\begin{cor}
  Neexistuje algoritmus, který by pro $ \fce{p}{x_1, \dots, x_n}, \fce{q}{x_1,
  \dots, x_n} $ s přirozenými koeficienty rozhodl, zda existuje přirozené
  řešení.
\end{cor}

\begin{thm}[Nerozhodnutelnost]
  Neexistuje algoritmus, který by pro vstupní formuli $ \varphi $ rozhodl, zda
  je logicky platná.
\end{thm}

\section{Neúplnost -- Gödelovy věty}

\begin{thm}[První věta o neúplnosti]
  Pro každou bezespornou rekurzivně axiomatizovanou $ T $ extenzi $ Q $
  existuje sentence $ \varphi $, tž. $ \underline \N \models \varphi \land T
  \nvdash \varphi $.
\end{thm}

\begin{cor}
  Nechť $ T $ splňuje předpoklady První věty o neúplnosti a $ \underline \N \in
  \fce{M_L}{T}$. Pak $ T $ není kompletní.
\end{cor}

\begin{cor}
  Teorie $ \fce{\Th}{\underline \N} $ není rekurzivně axiomatizovatelná.
\end{cor}

\begin{defi}[Aritmetizace dokazatelnosti]
  Nechť $ \varphi $ je výrok. Definujeme $ \lceil \varphi \rceil $ jako tzv.
  Gödelovo číslo výroku. Pak definujme relaci $ \Proof_L $, kde \[
    \left( m,n \right) \in \Proof_L \Longleftrightarrow \exists \varphi, \tau: m = \lceil \varphi \rceil \land n = \lceil \tau \rceil \land \tau \text{ je důkazem } \varphi.
  \]

  Nechť $ \fce{\Prf}{\underline m, \underline n} $ je relace v jazyce aritmetiky, vyjadřující relaci $ \Proof_L $. Pak můžeme definovat \textit{bezespornost} jako \[
    \Con_T \deq \lnot \left( \exists y \right) \fce{\Prf_T}{\underline{0 = \fce{S}{0}}, y}.
  \]
\end{defi}

\begin{thm}[Druhá věta o neúplnosti]
  Nechť $ T $ je bezesporná rekurzivně axiomatizovaná extenze $ \pa $. Pak \[
    T \nvdash \Con_T.
  \]
\end{thm}

\begin{cor}
  Existuje model $ \pa $, ve kterém platí $ \lnot \Con_{\pa} $.
\end{cor}

\begin{cor}
  Existuje bezesporná rekurzivně axiomatizovaná extenze $ \pa $, která \textquote{dokazuje svoji spornost}.
\end{cor}

\begin{cor}
  Je-li teorie množin ZFC bezesporná, pak nemůže být sentence $ \Con_{Z\!F\!C} $ dokazatelná.
\end{cor}



\end{document                </a></li>

<li><a href="https://gitlab.mff.cuni.cz/uradnikf/bc_lec/-/raw/master/2223z/kombagra/main.pdf">Kombinatorika a grafy}
\author{Filip Úradník}
\date{\today}

\input{template}
\input{czech_c}

\DeclareMathOperator*{\nolc}{NOLC}
\DeclareMathOperator*{\srr}{SRR}

\def\vec#1{\textbf{\textit{#1}}}
\def\algorithm#1#2{\fce{\texttt{#1}}{#2}}
\def\vec#1{\textbf{\textit{#1}}}
\DeclareMathOperator*{\Max}{max}
\def\deriv#1{\frac{\text{d}}{\text{d}#1}}
\def\deriv#1#2{\frac{\text{d}#1}{\text{d}#2}}
\def\pderiv#1{\frac{\partial}{\partial#1}}
\def\pderiv#1#2{\frac{\partial#1}{\partial#2}}
\def\norm#1{\absolute{\absolute{#1}}}
\def\pp{\mathcal{P}}
\def\ss{\mathcal{S}}
\def\mm{\mathcal{M}}
\def\kk{\mathcal{K}}
\def\es{E\!S}
\begin{document}
\maketitle

\section{Odhady faktoriálu}

\begin{thm}[Odhad 1]
	\[
		\forall n \in \N: n^{\frac{n}{2}} \leq n! \leq n^n.
	\]
\end{thm}

\begin{lemma}
	\[
		\forall x: x+1 \leq e^x.
	\]
	\begin{proof}
		Přes opakované derivování funkce $ \fce{f}{x} \deq e^x - \left( x+1 \right) $.
	\end{proof}

\end{lemma}

\begin{thm}[Odhad 2]
	\[
		\forall n \in \N: e \left( \frac{n}{e} \right)^{n} \leq n! \leq e n \left( \frac{n}{e} \right)^{n}.
	\]
	\begin{proof}
		Důkaz lze provést pomocí odhadu $ \int \log x \dd x $. Pomocí operací s logaritmy lze přepsat \[
			\log n! = \log n + \fce{\log}{n-1} + \dots + \log 1.
		\]

		Tato suma odpovídá obsahu obdelníků šířky $ 1 $ pod grafem $ \log x $. Tedy \[
			\int_1^{n} \log x \dd x \leq \log n! \leq \int_1^{n+1} \log x \dd x.
		\]
	\end{proof}
\end{thm}

\begin{thm}[Stirlingova formule, bez Dk]
	\[
		n! \sim \sqrt{2\pi n} \left( \frac{n}{e} \right)^n.
	\]
\end{thm}

\subsection{Odhady binomických koeficientů}

\begin{thm}[Odhad 1] Pro $ n \in \N, 0 \leq k \leq n $ platí:
	\begin{enumerate}
		\item $ \left( \frac{n}{k} \right)^k \leq \binom nk \leq n^k $,
		\item největší koeficient je pro $ k = \lceil \frac{n}{2} \rceil, \lfloor \frac{n}{2} \rfloor $.
	\end{enumerate}
\end{thm}

Při důkazech následujících odhadů se nám bude hodit číslo \[
	p \deq \frac{1 \times 3 \times \dots \times \left( 2m-1 \right)}{2 \times 4 \times \dots \times 2m}.
\]

\begin{thm}[Prostřední člen]
	\[
		\forall m \in \N: \frac{2^2m}{2 \sqrt{m}} \leq \binom {2m}m \leq \frac{2^2m}{\sqrt{2m}}.
	\]
\end{thm}

\begin{thm}[Stirlingův odhad]
	\[
		\binom{2m}m \sim \frac{2^{2m}}{\sqrt{\pi m}}.
	\]
\end{thm}

\subsection{Náhodné procházky}

\begin{defi}[Náhodná procházka v $ \mathbb Z $]
	Začínáme v počátku. V každém kroku jdeme s pravděpodobností $ \frac{1}{2} $
	doleva, jinak doprava.
\end{defi}

\begin{thm}[Návraty do počátku]
	$ \fceb{\mathbb{E}}{\# \text{ návratů}} = \infty $.
\end{thm}

\section{Vytvořující funkce}

\begin{defi}[Vytvořující funkce]
	\textit{Vytvořující funkce} posloupnosti $ \left( a_n \right)_n $ je $ \sum_{i=0}^{n} a_ix^i $.
\end{defi}

\begin{examp}[Základní vytvořující funkce] \
	\begin{enumerate}
		\item $ \left( 1,1,\dots,1,0,\dots \right) \to 1+x+\dots+x^n = \frac{1-x^{n+1}}{1-x}$,
		\item $ \left( 1,1,\dots \right) \to 1+x+x^2+\dots \stackrel{x < 1}{=} \frac{1}{1-x}$,
		\item $ \left( \binom n0,\binom n1,\dots \right) \to {n \choose 0}+{n \choose 1}x+{n \choose 2}x^2+\dots+{n \choose n}x^n = \left( 1+x \right)^n$.
	\end{enumerate}
\end{examp}

\begin{thm}
	Pokud pro $ \left( a_i \right)_i \exists k: \forall i: \absolute{a_i} < k^i$,
	pak $ \forall x \in \left( -\frac{1}{k}, \frac{1}{k} \right): \fce{a}{x} \deq
		\sum_{i=0}^{\infty} a_ix^i $ konverguje absolutně a platí \[
		a_i = \frac{\fce{a^{\left( i \right)}}{0}}{i!}.
	\]
\end{thm}

\begin{algo}[PočetZpůsobů]\ \\
	\textit{Vstup:} kombinatorický objekt s netriviálními počty způsobů.
	\begin{algorithmic}[1]
		\State Z objektu odvodíme vytvořující funkci $ \fce{a}{x} $.
		\State Rozložíme ji na známé vytvořující funkce pomocí \textsc{Operací}.
		\State Určíme koeficienty u jednotlivých funkcí.
		\State Odvodíme koeficienty u původní $ \fce{a}{x} $ pomocí \textsc{Operací}.
	\end{algorithmic}
	\textit{Výstup:} člen $ a_n $ říkající, kolika způsoby lze vybrat objekt velikosti $ n $.
\end{algo}

\begin{thm}[Operace na vytvořujících funkcích]
	Pro \[
		\fce{a}{x} \deq \sum_{i=0}^n a_ix^i, \fce{b}{x} \deq \sum_{i=0}^n b_ix^i
	\] platí:
	\begin{enumerate}
		\item sčítání: \[
			      \left( a_0+b_0, a_1+b_1, \dots \right) \to \fce{\left( a+b \right)}{x} = \fce{a}{x} + \fce{b}{x},
		      \]
		\item násobení $ \alpha $: \[
			      \left( \alpha a_0, \alpha a_1, \dots \right) \to \fce{\left( \alpha a \right)}{x} = \alpha \fce{a}{x},
		      \]
		\item posun o $ n $ pozic doprava: \[
			      \left( 0,0,\dots,0,a_0,a_1,\dots \right) \to x^n \fce{a}{x},
		      \]
		\item posun o $ n $ pozic doleva:\[
			      \left( a_n,a_{n+1},a_{n+2},\dots \right) \to \frac{\fce{a}{x} - \sum_{i=0}^{n-1} a_ix^i}{x^n},
		      \]
		\item dosazení $ \alpha x $:\[
			      \left(a_0, \alpha a_1, \alpha^2 a_2, \dots \right) \to \sum_{i=0}^{\infty} a_i\alpha^ix^i,
		      \]
		\item dosazení $  x^n $:\[
			      \left(a_0, 0,\dots,0 a_1, 0,\dots,0 a_2, 0,\dots \right) \to \sum_{i=0}^{\infty} a_ix^{in},
		      \]
		\item derivace:\[
			      \left(a_1, 2 a_2, 3 a_3,\dots \right) \to \sum_{i=1}^{\infty} ia_ix^{i-1},
		      \]
		\item integrál \[
			      \left(0, a_0, \frac{a_1}{2}, \frac{a_2}{3}, \frac{a_3}{4},\dots \right) \to \sum_{i=0}^{\infty} \frac{a_ix^{i+1}}{i+1},
		      \]
		\item násobení $ a \times b $ (konvoluce) pro $ c_i \deq \sum_{i=0}^{n} a_j b_{i-j} $: \[
			      \left( c_0, c_1, \dots \right) \to \fce{a}{x} \fce{b}{x} = \sum_{i=0}^{\infty} c_ix^i.
		      \]
	\end{enumerate}
\end{thm}

\subsection{Rozšíření kombinačních čísel}

\begin{defi}[Rozšířená kombinační čísla]
	Nechť $ r \in \R, k \in \N_0 $. Pak definujeme \[
		{r \choose k} \deq \frac{r^{\underline k}}{k!}, \; {r \choose 0} \deq 1.
	\]
\end{defi}

\begin{thm}[Zobecněná binomická věta]
	$ \forall r \in \R: $ \[
		\left( 1+x \right)^r \to \left( {r \choose 0},{r \choose 1}, {r \choose 2}, \dots \right),
	\]
	a pro $ x \in \left( -1,1 \right) $ konverguje řada \[
		\sum_{i=0}^{\infty} {r \choose i} x^i = \left( 1+x \right)^r.
	\]
\end{thm}

\begin{cor}
	$ \forall n \in \N, \forall x \in \left( -1,1 \right) $: \[
		\left( 1-x \right)^{-n} = \sum_{i=0}^{\infty} {n+i-1 \choose n-1} x^i.
	\]
\end{cor}

\subsection{Katalánova čísla}

\begin{defi}[Binární zakořeněný strom]
	BZS je struktura definovaná rekurzivně: \begin{itemize}
		\item prázdný strom,
		\item kořen a levý a pravý podstrom, což jsou nějaké BZS.
	\end{itemize}

	Definujeme číslo $ b_n \deq \# $ BZS na $ n $ vrcholech.
\end{defi}

\begin{defi}[Katalánovo číslo]
	$ n $-té Katalánovo číslo $ C_n $ je definováno jako \[
		C_n \deq \frac{1}{n+1} {2n \choose n}.
	\]
\end{defi}

\begin{thm}[Interpretace Katalánových čísel]
	$ \forall n \in \N $ platí, že $ b_n = C_n  $.
\end{thm}

\subsection{Rozklady na sčítance}

Mějme libovolné číslo $ n $. Chceme zjistit, kolika způsoby jej lze rozdělit na
sčítance (uspořádanou multimnožinu čísel $ n_i $, že $ \sum_{i}^{}n_i = n $).
Představme si $ n $ kuliček. Chceme tedy do $ n-1 $ mezer mezi nimi umístit $
	k-1 $ zarážek.

\begin{prop}
	Nechť $ n \in \N $. Rozdělit ho na kladné sčítance ho lze $ c_n $ způsoby, kde \[
		c_n \deq \sum_{k=1}^{n} {n-1 \choose k-1}.
	\]
\end{prop}

\begin{prop}[]
	Vytvořující funkce čísla $ c_n $ je rovna \[
		\fce{c}{x} = \sum_{n=0}^{\infty} c_n x^n = \frac{1-x}{1-2x}.
	\]
\end{prop}

Pokud bychom chtěli počet způsobů, jak $ n $ rozdělit na neuspořádanou
multimnožinu sčítanců, tak bohužel jednoduchý vzorec nemáme. Máme ale alespoň
vytvořující funkci.

\begin{prop}[]
	Nechť $ n \in \N $. Pak počet způsobů, jak $ n $ rozdělit na kladnou,
	neuspořádanou multimnožinu sčítanců lze vyjádřit pomocí vytvořující funkce $
		\fce{p}{x} $, kde \[
		\fce{p}{x} = \left( 1 + x + x^2 + \dots \right) \left( 1 + x^2 + x^4 + \dots \right) \dots = \prod_{i=1}^{\infty} \frac{1}{1-x^i}.
	\]
\end{prop}


\section{Konečné projektivní roviny}

\begin{defi}[Množinový systém]
	\textit{Množinový systém} je dvojice $ \left( X,\pp \right) $, kde \begin{itemize}
		\item $ X $ je množina (bodů),
		\item $ \pp \subseteq 2^X $ je množina \textquote{přímek}.
	\end{itemize}
\end{defi}

\begin{defi}[KPR]
	\textit{Konečná projektivní rovina} je množinový systém $ \left( X,\pp \right) $, kde
	\begin{enumerate}[label=(A\theenumi)]
		\item $ \forall x,y \in X\; \exists! P \in \pp: x,y \in P $,
		\item $ \forall P,Q \in \pp \;\exists! x \in X: P \cap Q = \{ x \} $,
		\item $ \exists C \subseteq X: \absolute{C} = 4, \forall P \in \pp: \absolute{C \cap P} \leq 2 $.
	\end{enumerate}
\end{defi}

Protože je přímka dvěma body jednoznačně určena, můžeme zavést značení $ \overline{xy} \equiv $ přímka z $ \pp $ určena body $ x,y \in X $.

\begin{thm}[Velikost přímek]
	Nechť $ \left( X,\pp \right) $ je KPR. Pak platí \[
		\forall P,Q \in \pp: \absolute{P} = \absolute{Q}.
	\]
\end{thm}

\begin{defi}[Řád KPR]
	\textit{Řád konečné projektivní roviny} je $ n \in \N: \forall P \in \pp: n = \absolute{P} - 1  $.
\end{defi}

\begin{thm}[Vlastnosti řádu]
	\
	\begin{enumerate}
		\item $ \forall x \in X: \absolute{\{ P \suchthat P \in \pp \land x \in P \}} = n+1$
		\item $ \absolute{X} = n^2+n+1 $
		\item $ \absolute{\pp} = n^2+n+1 $
	\end{enumerate}
\end{thm}

\begin{defi}[Duál]
	\textit{Duální množinový systém} k $ \left( X,\pp \right) $ je množinový systém $ \left( \pp, \ss \right) $, kde \[
		\ss = \{ \{ S \in \pp \suchthat x \in S\} \suchthat x \in X \}
	\]
\end{defi}

\begin{thm}
	Duálem KPR řádu $ n $ je KPR řádu $ n $.
\end{thm}

\begin{thm}[Existence KPR]
	Pokud existuje algebraické těleso s $ n $ prvky, pak existuje KPR řádu $ n $.
\end{thm}

\begin{con}
	$ \forall p \in \P, n \in \N \; \exists $ KPR řádu $ p^n $.
\end{con}

\section{Latinské čtvrece}

\begin{defi}[Latinský čtverec]
	\textit{Latinský čtverec řádu $ n $} je tabulka $ L \in \left[ n \right]^{n \times n} \equiv $ \[
		\forall i,j,k: L_{ij} \neq L_{ik}, L_{ji} \neq L_{ki}.
	\]
\end{defi}

\begin{defi}[Ortogonalita LČ]
	Latinské čtverce $ L, L' $ jsou \textit{ortogonální, $L \perp L'  \equiv $} \[
		\forall l, l' \in \left[ n \right] \; \exists i,j: L_{ij} = l, L'_{ij} = l'.
	\]
\end{defi}

\begin{cor}[Jedinečnost]
	$ \forall L, L', \; L \perp L': $ \[
		\forall l, l' \in \left[ n \right] \; \exists\textbf{!} i,j: L_{ij} = l, L'_{ij} = l'.
	\]
\end{cor}

Latinské čtverce se chovají pěkně vůči permutacím. Permutací $ \pi: \{ 1,
	\dots, n \} \to \{ 1, \dots, n \} $ Latinského čtverce $ L $ je $ \fce{\pi}{L}
$, což je opět tabulka $ n \times n $, pro kterou platí, že
$ \fce{\pi}{L}_{ij} = \fce{\pi}{L_{ij}} $ pro $ i,j \in \{ 1, \dots, n \} $.

\begin{thm}[LČ a permutace]
	Nechť $ \pi $ je permutace, $ L, L' $ jsou Latinské čtvrece a $ L \perp L' $. Pak \begin{enumerate}
		\item $ \fce{\pi}{L} $ je Latinský čtverec,
		\item $ \fce{\pi}{L} \perp L' $.
	\end{enumerate}
\end{thm}

\begin{defi}[$ \fce{\nolc}{n} $]
	\textit{Navzájem ortogonální Latinské čtverce řádu $ n $} je množina $ \fce{\nolc}{n} $, kde \begin{enumerate}
		\item $ \forall L_i \in \fce{\nolc}{n}: L_i $ je Latinský čtverec,
		\item $ \forall L_i, L_j \in \fce{\nolc}{n}, i \neq j: L_i \perp L_j $.
	\end{enumerate}
\end{defi}

\begin{thm}[$ \# \nolc $]
	$ \forall  n \in \N: $ \[
		\# \fce{\nolc}{n} \leq n-1
	\]
\end{thm}

\begin{thm}[$ \nolc $ a KPR]
	$ \forall n \geq 2 $: \[
		\exists \text{ KPR řádu $ n $ } \Longleftrightarrow \# \fce{\nolc}{n} = n-1
	\]
\end{thm}

\section{Toky}

\begin{defi}[Síť]
	\textit{Síť} je uspořádaná pětice $ \left( V, E, z, s, c \right) $, kde
	\begin{itemize}
		\item $ \left( V,E \right) $ je symetrický orientovaný graf
		\item $ z,s $ jsou zdroj a stok, $ z,s \in V $
		\item $ c $ je kapacita, funkce $ E \to \R^+_0 $
	\end{itemize}
\end{defi}

\begin{defi}[Terminologie]
	Pro funkci $ a: E \to \R^+_0 $ definujeme
	\begin{itemize}
		\item $ \fce{a^+}{v} \deq \sum_{uv \in E}^{} \fce{a}{uv}$
		\item $ \fce{a^-}{v} \deq \sum_{vw \in E}^{} \fce{a}{vw}$
		\item $ \fce{a^{\Delta}}{v} \deq  \fce{a^+}{v} - \fce{a^-}{v}$
	\end{itemize}
\end{defi}

\begin{defi}[Tok]
	\textit{Tok} je funkce $ f: E \to \R^+_0 $ splňující
	\begin{itemize}
		\item $ \forall e \in E: \fce{f}{e} \leq \fce{c}{e} $,
		\item $ \forall v \in V, v \neq z,s: \fce{f^{\Delta}}{v} = 0 $ (Kirchhoffův zákon).
	\end{itemize}

	Tok má \textit{velikost} $ \absolute{f} \deq \fce{f^{\Delta}}{s} $.
\end{defi}

\begin{defi}[Řez]
	\textit{Řez} je množina $ R \subseteq E: $ pro $ \left( V, E \setminus R
		\right) \nexists P $ cesta mezi $ z,s $.
\end{defi}

\begin{defi}[Elementární řez]
	Nechť $ A \subset V: z \in A, s \notin A $. Pak \textit{elementární řez }$ \equiv $
	\[
		R_A \deq \{ uv \suchthat uv \in E, u \in A, v \notin A \} .
	\]
\end{defi}

\begin{thm}[Elementární řez]
	$ \forall R $ řez $ \exists A: R_A \subseteq R $ je elementární řez.
\end{thm}

\begin{defi}[Do inkluze minimální řez]
	Nechť $ R $ je řez. Pak $ R $ je \textit{do inkluze minimální $ \equiv $} \[
		\forall e \in R: R \setminus e \text{ není řez.}
	\]
\end{defi}

\begin{thm}[DIM elementární řez]
	Každý do inkluze minimální řez je elementární.
\end{thm}

\begin{lemma}
	$ \forall f $ tok, $ A \subset V: z \in A, s \notin A: $ \[
		\absolute{f} = \sum_{uv \in E: u \in A, v \notin A}^{} \fce{f}{uv} - \sum_{uv \in E: v \in A, u \notin A}^{} \fce{f}{uv}.
	\]
\end{lemma}

\begin{thm}[Hlavní o tocích]
	Nechť $ \left( V, E, z, s, c \right) $ je síť. Pak $ \exists f $ maximální
	tok, a $ R $ minimální řez, a $ \fce{c}{R} = \absolute{f} $.
\end{thm}

\begin{thm}[O celočíselnosti]
	Pro síť s kapacitami $ \in \N $ se FF zastaví a vrátí celočíselný maximální tok.
\end{thm}

\begin{defi}[Vrcholové pokrytí]
	Nechť $ G = \left( V,E \right) $ je graf. Pak \textit{vrcholové pokrytí} je $ P \subseteq V: $ \[
		\forall uv \in E: u \in P \lor v \in P
	\]
\end{defi}

\begin{defi}[Párování]
	Nechť $ G = \left( V,E \right) $ je graf. Pak \textit{párování} je $
		G' $ podgraf $ G: $ \[
		\forall e, f \in \fce{E}{G'}: e \cap f = \emptyset
	\]
\end{defi}

\begin{thm}[König-Egerváry]
	Pro $ G $ bipartitní odpovídá minimální pokrytí maximálnímu párování.
	Speciálně, jejich velikosti se rovnají.
\end{thm}

\begin{defi}[Množinový systém]
	Nechť $ I,X $ jsou množiny. Pak \textit{množinový systém $ \mm \deq \left( M_i \suchthat i \in I \right)\equiv$} \[
		\forall i \in I: M_i \subseteq X.
	\]
\end{defi}

\begin{defi}[Systém různých reprezentantů ($ \srr $)]
	$ \srr $ je funkce $ f: I \to X $, t.ž. \begin{enumerate}
		\item $ f $ je prostá,
		\item $ \forall i: \fce{f}{i} \in M_i $.
	\end{enumerate}
\end{defi}

\begin{defi}[Incidenční graf]
	\textit{Incidenční graf množinového systému} je graf $ G: $ \[
		G \deq \left( X \cup I, \{ ix \suchthat i \in I, x \in X, x \in M_i \} \right).
	\]
\end{defi}

\begin{cor}[$ \srr $ pomocí IG]
	V $ \mm \;\exists \srr \Leftrightarrow $ v IG $ \exists  $ párování velikosti $ \absolute{I} $.
\end{cor}

\begin{thm}[Hallova]
	$ \mm $ má $ \srr \Longleftrightarrow$\[
		\forall J \subseteq I: \absolute{J} \leq \absolute{\bigcup_{j \in J} M_j}.
	\]
\end{thm}

\begin{cor}
	Nechť $ G = \left( X \cup Y, E \right), E \neq \emptyset, \forall x \in X, y \in Y: \fce{\deg}{x} \geq \fce{\deg}{y}. $ Pak $ \exists $ párování velikosti $ \absolute{X} $.
\end{cor}

\begin{defi}[Latinský obdelník]
	\textit{Latinský obdelník typu $ k \times n $}, je tabulka $ k \times n $, t.ž. \[
		\forall i,j,k: L_{ij} \neq L_{ik}, L_{ji} \neq L_{ki}, L_{ij} \in \left[ n \right]
	\]
\end{defi}

\begin{thm}
	$ \forall  $ Latinský obdelník $ k \times n $ lze doplnit na Latinský čtverec.
\end{thm}

\subsection{Souvislost grafů}

\begin{defi}[Hranový řez]
	Množina $ F \subseteq E $ grafu $ G = \left( V,E \right) $ je \textit{hranový
		řez} $ \equiv $ graf $ G \setminus F $ je nesouvislý.
\end{defi}

\begin{defi}[Vrcholový řez]
	Množina $ A \subseteq V $ grafu $ G = \left( V,E \right) $ je \textit{vrcholový
		řez} $ \equiv $ graf $ G \setminus A $ je nesouvislý.
\end{defi}

\begin{defi}[Hranová souvislost]
	\textit{Hranová souvislost} grafu $ G $ je \[
		\fce{k_e}{G} \deq \begin{cases}
			1                                                            & \text{ pro $ G $ isomorfní $ K_1 $, } \\
			\fcec{\min}{\absolute{F} \suchthat F \text{ je hranový řez}} & \text{ jinak.}                        \\
		\end{cases}
	\]
\end{defi}

\begin{defi}[Vrcholová souvislost]
	\textit{Vrcholová souvislost} grafu $ G $ je \[
		\fce{k_v}{G} \deq \begin{cases}
			1                                                              & \text{ pro $ G $ isomorfní $ K_1 $, }   \\
			n-1                                                            & \text{ pro $ G $ isomorfní $ K_{n} $, } \\
			\fcec{\min}{\absolute{A} \suchthat A \text{ je vrcholový řez}} & \text{ jinak.}                          \\
		\end{cases}
	\]
\end{defi}

\begin{defi}[$ k $-souvislost]
	Pro $ k \in \N_0 $ je graf $ G $ \begin{itemize}
		\item \textit{hranově $ k $-souvislý} $ \equiv \fce{k_e}{G} \geq k $,
		\item \textit{vrcholově $ k $-souvislý} $ \equiv \fce{k_v}{G} \geq k $.
	\end{itemize}
\end{defi}

\begin{lemma}
	$ \forall G $ graf, $ \forall e \in E: $ \[
		\fce{k_e}{G}-1 \leq \fce{k_e}{G - e} \leq \fce{k_e}{G}.
	\]
\end{lemma}

\begin{lemma}
	$ \forall G $ graf, $ \forall e \in E: $ \[
		\fce{k_v}{G}-1 \leq \fce{k_v}{G - e} \leq \fce{k_v}{G}.
	\]
\end{lemma}

\begin{cor}
	$ \forall G $ graf: \[
		\fce{k_v}{G} \leq \fce{k_e}{G}.
	\]
\end{cor}

\begin{thm}[Fordova-Fulkersonova]
	$ \forall G $ graf neekvivalentní $ K_1, \; t \in \N: $ \[
		\fce{k_e}{G} \geq t \Longleftrightarrow \forall u,v \in V: \# \text{ hranově disjunktních $ uv $-cest} \geq t.
	\]
\end{thm}

\begin{thm}[Mengerova]
	$ \forall G $ graf neekvivalentní $ K_1, \; t \in \N: $ \[
		\fce{k_v}{G} \geq t \Longleftrightarrow \forall u,v \in V: \# \text{ vrcholově disjunktních $ uv $-cest} \geq t.
	\]
\end{thm}

\begin{defi}[Most]
	Hranový řez velikosti jedna se nazývá \textit{most}.
\end{defi}

\begin{defi}[Artikulace]
	Vrcholový řez velikosti jedna se nazývá \textit{artikulace}.
\end{defi}

\begin{defi}[Podrozdělení hrany]
	Nechť $ G = \left( V,E \right), E \neq \emptyset $. Pak pro $ e= \{ u,v \}
		\in E $ je \textit{podrozdělení hrany $ e $} graf $ G \div e \equiv $ \[
		G \div e \deq \left( V \cup \{ w \}, \left( E \setminus \{ \{ u,v \} \} \right) \cup \{ \{ u,w \}, \{ w,v \} \} \right) .
	\]
\end{defi}

\begin{lemma}
	Nechť $ G = \left( V,E \right) $ je graf. Pak $ \forall e \in E: $ \[
		G \text{ je vrcholově $ 2 $-souvislý} \Longleftrightarrow G \div e \text{ je vrcholově $ 2 $-souvislý. }
	\]
\end{lemma}

\begin{thm}[Ušaté lemma]
	Nechť $ G = \left( V,E \right) $ je graf. Pak \[
		G \text{ je vrcholově $ 2 $-souvislý} \Longleftrightarrow G \text{ lze vytvořit z $ K_3 $ přidáváním a podrozdělováním hran.}
	\]
\end{thm}

\section{Počítání dvěma způsoby}

\subsection{Kostry}

\begin{defi}[\# koster]
	\# koster grafu $ G $ je značen $ \fce{\kk}{n} $ pro $ G = K_n, $ pro obecný graf je to $ \fce{\kk}{G} $.
\end{defi}

\begin{thm}[Cayleyho vzorec]
	Pro $ n \geq 1: $ \[
		\fce{\kk}{n} = n^{n-2}.
	\]
\end{thm}

\begin{thm}
	Pro $ n \geq 2,\, e \in \fce{E}{K_n}: $ \[
		\fce{\kk}{K_n - e} = \left( n-2 \right)n^{n-3}.
	\]
\end{thm}

\begin{defi}[Laplacián]
	Nechť $ G $ je graf. Jeho \textit{Laplacián} je matice $ \fce{L}{G} \in \R^{n \times n} $ definovaná jako \[
		\fce{L}{G}_{ij} \deq \begin{cases}
			\fce{\deg}{v_i} & \text{pro } i = j,        \\
			-1              & \text{pro } v_iv_j \in E, \\
			0               & \text{jinak.}
		\end{cases}
	\]
\end{defi}

\begin{thm}[Kirchhoffova, bez Dk]
	$ \forall G: $ \[
		\fce{\kk}{G} = \fce{\det}{\fce{L}{G}^{1,1}}.
	\]
\end{thm}

\subsection{Nezávislý systém}

\begin{defi}[Nezávislý systém]
	Systém $ \mm \subseteq 2^{\left[ n \right]} $ je \textit{nezávislý} $ \equiv $\[
		\forall A,B \in \mm: A \nsubseteq B \land B \nsubseteq A.
	\]
\end{defi}

\begin{thm}[Spernerova věta]
	Největší nezávislý systém v $ 2^{\left[ n \right]} $ má $ n \choose \lceil
		\frac{n}{2} \rceil $ prvků. Jinými slovy, nejdelší antiřetězec v Hesseho
	diagramu pro  $ \left( 2^{\left[ n \right]}, \subseteq \right) $ má délku
	právě $ {n \choose \lceil \frac{n}{2} \rceil} $.

	\begin{proof}
		Počítáme $ z = $ počet dvojic $ \left( M, R \right) $, kde $ R $ je
		nejdelší řetězec a $ M \in R $.

		Pokud zafixujeme $ M $, tak nejdelší řetězec si k ní můžu zvolit $
			\absolute{M}! \left( n-\absolute{M} \right)! $ způsoby. Pokud naopak
		zafixujeme řetězec, tak k jednomu řetězci najdu v $ \M $ nejvýše jednu $ M
		$, která se v něm vyskytuje.

		Pomocí těchto dvou způsobů dostáváme: \[
			\sum_{M \in \M}^{} \absolute{M}! \left( n- \absolute{M} \right)! = z \leq n!.
		\]

		Ještě využijeme odhadu $ {n \choose k} \leq {n \choose \lceil \frac{n}{2}
				\rceil} $ a dostáváme: \[
			1 \geq \frac{1}{n!} \sum_{M \in \M}^{} \absolute{M}! \left( n- \absolute{M} \right)! = \sum_{}^{} {n \choose \absolute M}^{-1} \geq \frac{\absolute{\M}}{{n \choose \lceil \frac{n}{2} \rceil}}.
		\]

		Po vynásobení jmenovatelem zjistíme, že $ \absolute{\M} \leq {n \choose \lceil \frac{n}{2} \rceil} $.
	\end{proof}

\end{thm}

\section{Ramseyova teorie}

\begin{defi}[Obarvení]
	\textit{$ n $-obarvení} je libovolné zobrazení $ c: X \to \left[ n \right] $.
\end{defi}

\begin{thm}[Dirichletův princip]
	Nechť $ n_1, \dots, n_r \in \N, r \in \N $. Obarvíme-li prvky $ X $ $ n $
	barvami a je-li $ \absolute{X} \geq \fce{D}{n_1, \dots, n_r, r} = 1+ \sum_{i=1}^{r}\left( n_i-1 \right), $ pak
	$\exists i: X $ obsahuje $ n_i $ prvků $ i $-té barvy.
\end{thm}

\begin{defi}[Ramsey]
	Nechť $ k,l \in \N. $ Definujeme $ \fce{R}{k,l} $ jako nejmenší $ n \in \N $,
	že $ \forall $ 2-obarvení $ K_n \; \exists K_k$ jedné barvy, nebo $ K_l $
	druhé barvy, jako podgraf $ K_n $.
\end{defi}

\begin{thm}[Ramsey]
	\[
		\forall k,l \in \N: \fce{R}{k,l} \leq {k+l-2 \choose l-1} = {k+l-2 \choose k-1}.
	\]
\end{thm}


\begin{thm}
	\[
		\forall k \geq 3: \fce{R}{k,k} \geq 2^{\frac{k}{2}}.
	\]
\end{thm}

\begin{defi}[Ramsey pro obecné $ p $]
	\textit{Ramseyovo číslo $ \fce{R_p}{n_1,\dots, n_r} $} je nejmenší $ N $, tž. \[
		\forall X: \absolute{X} \geq N, \forall \chi: {X \choose p} \to \left[ r \right]\, \exists i \in \left[ r \right], \exists Y \subseteq X: \absolute{Y} = n_i \land \forall y \in {Y \choose p}: \fce{\chi}{y} = i.
	\]
\end{defi}

\begin{thm}[Ramsey pro obecné $ p $] \label{obecramsey}
	Nechť $ p, r, n_1, \dots, n_r \in \N $. Pak $ \fce{R_p}{n_1, \dots, n_r} \in \N $.

	\begin{proof}
		Důkaz provedeme indukcí podle $ p, n_1, \dots, n_r $. Pro $ p=1 $ se jedná
		o Dirichletův princip, tedy tvrzení platí. Pokud $ p > 1 $, ale $ \exists
			i: n_i=1 $, pak tvrzení opět platí, protože $ n_i $ vyjadřuje velikost
		množiny, u které všechny $ p $-tice mají barvu $ n_i $, ale pokud $ n_i=1
		$, pak má korespondující množina velikost $ 1 $, tedy tam žádné $ p $-tice
		nejsou.

		V indukčním kroku tedy nechť $ p \geq 2 $ a $ \forall i: n_i \geq 2 $.
		Dále si zadefinujeme množinu $ m $, tž. $ \forall i \leq r: $ \[
			m_i \deq \fce{R_p}{n_{1}, \dots, n_{i-1}, n_i-1, n_{i+1}, \dots, n_r}.
		\]

		Všimneme si, že každé $ m_i $ existuje a je konečné z indukčního
		předpokladu. Dále definujme \[
			R = \fce{R_{p-1}}{m_1, \dots, m_r}.
		\]

		Toto opět existuje a je konečné z IP. Nechť množina $ X $ má velikost $
			\geq R $ a nechť $ \chi: {X \choose p} \to \{ 1, \dots, r \} $. Zvolme $ v
			\in X $. Vezmeme $ \chi': {X \setminus \{ v \} \choose p-1} \to \{ 1,
			\dots, r \} $ takové, že $ \fce{\chi'}{x} \deq \fce{\chi}{x \cup \{ v \}}
		$.

		Z definice $ R $ existuje při obarvení $ \chi' $ množina $ S \subseteq X $, že $
			\absolute{S} = m_i $ a $ \forall s \in {S \choose p-1}: \fce{\chi}{s} = i
		$. Z definice $ m_i $ ale také existuje $ j $, tž. existuje množina $ S' \subseteq S
		$, že $ \forall s \in {S' \choose p}: \fce{\chi'}{s} = j $ a $ \absolute{S}
			= n_j $, pokud $ j \neq i $ nebo $ n_i-1 $, pokud $ j=i $.

		Pokud $ j \neq i $ je $ S' $ tou požadovanou množinou. Pokud ale $ i=j $,
		tak nám jeden prvek chybí. Teď ale můžeme využít toho, že $ \forall s \in
			{S \cup \{ v \} \choose p}: \fce{\chi}{s} = i $, tedy $ v $ můžeme do $ S'
		$ přidat, a už má požadovanou velikost $ n_i $.
	\end{proof}

\end{thm}

\begin{lemma} \label{4konvexlemma}
	Každá množina pěti bodů v obecné poloze obsahuje čtyři body v konvexní poloze.
\end{lemma}

\begin{thm}[Erdösova-Szekeresova]
	$ \forall k \in \N \;\exists \fce{\es}{k} \in \N: $ každá konečná množina s $
		\geq \fce{\es}{k} $ body v obecné poloze má $ k $ bodů v konvexní poloze.

	\begin{proof}
		Nechť $ S $ má $ \fce{\es}{k} = \fce{R_4}{k,5} $ prvků. Definujme obarvení $ \chi: {S \choose 4} \to {1,2} $ tak, že: \[
			\fce{\chi}{s} \deq \begin{cases}
				1 & \text{pro $ s $ konvexní,} \\
				2 & \text{jinak.}
			\end{cases}
		\]Pak podle věty \ref{obecramsey} existuje buď 5 bodů, kde žádné 4 nejsou v
		konvexní poloze, nebo $ k $ bodů, kde každá čtveřice je v konvexní poloze,
		tedy i všechny body vůči sobě jsou v konvexní poloze. Podle lemma
		\ref{4konvexlemma} ale první případ nenastane.
	\end{proof}

\end{thm}

\begin{thm}[Nekonečný Ramsey]
	$ \forall p,r \in \N, \forall \chi: {\N \choose p} \to \left[ r \right] \; \exists i
		\in \left[ r \right], \exists A \subseteq \N $ nekonečná, tž. \[
		\forall y \in {A \choose p}: \fce{\chi}{y} = i.
	\]

	\begin{proof}
		Důkaz provedeme indukcí podle $ p $. Pro $ p=1 $ platí triviálně.

		V indukčním kroku, nechť máme dané obarvení $ \chi $. Budeme postupně
		budovat nekonečné množiny $ A_0 \supseteq A_1 \supseteq A_2 \dots $.
		Nejprve, $ A_0 = \N $. Nyní, nechť už máme $ A_i $ a chceme $ A_{i+1} $.
		Nechť $ a $ je první prvek $ A_i $, $ \chi': {A_i \setminus \{ a \}
			\choose p-1} \to \{ 1, \dots, r \} $ a platí, že $ \forall s \in {A_i
				\setminus \{ a \} \choose p-1}: \fce{\chi'}{s} = \fce{\chi}{s \cup \{ a \}}
		$. Podle IP existuje nekonečná podmnožina $ A_i \setminus \{ a \} $, kde
		jsou všechny $ \left( p-1 \right) $-tice přes $ \chi' $ obarvené stejnou
		barvou. Tato množina bude naše $ A_{i+1} $.

		Nyní vybereme posloupnost $ \left( a_i \right)_i $, kde $ a_i $ je první
		prvek množiny $ A_i $. Z ní vytvoříme posloupnost dvojic $ \left( a_i, j_i
			\right)_j $, kde $ j_i $ je barva, která se při konstrukci $ A_{i+1} $
		vyskytla u nekonečně $ \left( p-1 \right) $-tic. Opět je to nekonečná
		posloupnost, tedy alespoň jedna barva se musí vyskytovat nekonečněkrát.
		Označme ji $ j $.

		Konečně, zvolíme množinu $ S = \{ a_i \suchthat j_i = j \} $. Toto je
		požadovaná nekonečná podmnožina $ \N $, kde každá $ p $-tice má při
		obarvení $ \chi $ stejnou barvu, totiž $ j $.
	\end{proof}

\end{thm}

\section{Samoopravné kódy}

\begin{defi}[Abeceda]
	\textit{Abeceda} je konečná množina symbolů $ \Sigma $.
\end{defi}

\begin{defi}[Slovo]
	\textit{Slovo} délky $ n $ je prvek množiny $ \Sigma^n $.
\end{defi}

\begin{defi}[Hammingova vzdálenost]
	Nechť $ \vec x, \vec y \in \Sigma^n$. \textit{Hammingova vzdálenost} je
	\[
		\fce{d}{\vec x, \vec y} \deq \absolute{\{ i \in \left[ n \right] \suchthat x_i \neq y_i \}}.
	\]
\end{defi}

\begin{cor}
	$ d $ je \textit{metrika}, udává \textit{metrický prostor} $ \left( \Sigma^n,
		d \right) $.
\end{cor}

\begin{defi}[Blokový kód]
	$ C \subseteq \Sigma^n $

	Slova z $ C $ jsou \textit{kódová slova}.
\end{defi}

\begin{thm}
	Za pomoci $ C $ jsme schopni opravit $ \leq t $ chyb $ \Longleftrightarrow $ \[
		\forall \vec y \in \Sigma^n: \absolute{\{ \vec x \in C \suchthat \fce{d}{\vec x, \vec y} \leq t \}} \leq 1.
	\]
\end{thm}

\begin{defi}[Parametry kódu]
	Kód $ C $ má parametry $ \left( n,k,d \right)_q $ definované jako:
	\begin{enumerate}
		\item \textit{délka} $ n $,
		\item \textit{velikost abecedy} $ \absolute{\Sigma} = q $,
		\item \textit{dimenze} $ k \deq \log_q\absolute{C} $,
		\item \textit{vzdálenost} $ d \deq \fcec{\min}{\fce{d}{x,x'} \suchthat x,x' \in C \land x \neq x'} $,
	\end{enumerate}
\end{defi}

\begin{cor}
	Pokud má kód parametry $ \left( n,k,d \right)_q $, pak opraví $ \leq \lfloor \frac{d-1}{2} \rfloor $ chyb.
\end{cor}

\begin{cor}
	Kód pro slova z $ \Sigma^n $ nemůže opravit více než $ \lfloor \frac{n-1}{2} \rfloor $ chyb.
\end{cor}


\begin{examp}[Opakovací kód]
	\[
		C = \{ \left( a \right)_{i \in \left[ n \right]} \suchthat a \in \Sigma \}.
	\]
	parametry jsou $ \left( n,1,n \right)_q $.
\end{examp}

\begin{examp}[KPR]
	$ C $ tvoří charakteristické vektory přímek KPR, $ \subseteq \{ 0,1 \}^{\absolute{X}} $.

	Parametry mají $ \left( n^2+n+1, \fce{\log_2}{n^2+n+1}, 2n \right)_2 $.
\end{examp}

\begin{examp}[Hadamardovy kódy]
	Pomocí \textit{Hadamardovy matice} $ H \in \{ -1,1 \}^{n \times n}: $ \[
		H \times H^T = nI_n,
	\]
	tedy každý řádek se liší na $ \frac{n}{2} $ pozicích. Kód definujeme jako: \[
		C = \{ H_{i*} \}_i \cup \{ -H_{i*} \}_i,
	\]
	parametry jsou $ \left( n, 1+ \log_2n, \frac{n}{2} \right)_2 $.
\end{examp}

\begin{lemma}[Sylvestrova konstrukce]
	$ H_1 = \left( 1 \right) $, \[
		H_{2n} = \begin{pmatrix}
			H_n & H_n  \\
			H_n & -H_n
		\end{pmatrix}
	\]
\end{lemma}

\begin{prop}[Hadamardova domněnka]
	\[
		\forall k \in \N: \exists H_{4k}.
	\]
\end{prop}

\begin{defi}[Ekvivalence]
	$ C,C' $ jsou \textit{ekvivalentní} $ \equiv \exists \pi: \forall x \in \Sigma^n: $ \[
		x \in C \Longleftrightarrow \fce{\pi}{x} = \left( x_{\fce{\pi}{i}} \right)_i \in C'.
	\]
\end{defi}

\begin{defi}[Kombinatorické koule]
	\textit{Kombinatorická koule} o středu $ x $ a poloměru $ t $ je množina \[
		\fce{B}{x,t} \deq \{ y \in \Sigma^n: \fce{d}{x,y} \leq t \}.
	\]
\end{defi}

\begin{thm}
	$ \forall C $ s parametry $ \left( n,k,d \right)_q $, kde $ d = 2t+1: $\[
		\forall x,y \in C, x \neq y: \fce{B}{x,t} \cap \fce{B}{y,t} = \emptyset.
	\]
\end{thm}

\begin{defi}[Objem]
	Objem koule $ \fce{B}{x,t} $ je \[
		\fce{V}{t} \deq \absolute{\fce{B}{x,t}} = \sum_{i=0}^{t} {n \choose i} \left( q-1 \right)^i
	\]
\end{defi}
\begin{thm}[Hammingův odhad]
	$ \forall C $ s parametry $ \left( n,k,2t+1 \right)_q: $\[
		\absolute{C} \leq \frac{q^n}{\fce{V}{t}}.
	\]
\end{thm}

\begin{defi}[Perfektní kód]
	Kód $ C $ je \textit{perfektní} $ \equiv $\[
		\absolute{C} = \frac{q^n}{\fce{V}{t}}.
	\]
\end{defi}

\begin{thm}[Gilbertův–Varshamův odhad]
	$ \forall n,d,q \in \N: \exists C $ s parametry $ \left( n,\log_q \absolute{C},d \right)_q $, tž. \[
		\absolute{C} \geq \frac{q^n}{\fce{V}{d-1}}.
	\]
\end{thm}

\subsection{Lineární kódy}

\begin{defi}[Lineární kód]
	\textit{Lineární kód $ C $} je vektorový podprostor $ \K^n $, kde $ \K = \Sigma $ je konečné těleso. Značení $ \left[ n,k,d \right]_q $.
\end{defi}

\begin{cor}[Dimenze]
	Vektorový prostor lineárního kódu $ C $ má dimenzi $ k $.
\end{cor}

\begin{examp}[Lineární kódy]
	\
	\begin{enumerate}
		\item opakovací pro $ \Sigma = \Z_q $,
		\item Hadamardovy kódy získané Sylvesterovou konstrukcí jsou lineární nad $ \Z_2$.
	\end{enumerate}
\end{examp}

\begin{cor}
	$ \forall x,y,z \in C: $ \[
		\fce{d}{x,y} = \fce{d}{x+z, y+z} = \fce{d}{x-y,\vec o},
	\]
	tedy \[
		d = \fcec{\min}{\fce{d}{x,y} \suchthat x,y \in C} = \fcec{\min}{\fce{d}{x,0} \suchthat x \in C}.
	\]
\end{cor}

\begin{defi}[Generující matice]
	Nechť $ C $ je lineární kód. \textit{Generující matice} kódu $ C $ je \[
		M \in \K^{k \times n},
	\]
	kde řádky jsou vektory báze nějaké $ C $.
\end{defi}

\begin{defi}[Skalární součin slov]
	Na $ \K^n $ definujeme \textit{skalární součin} pro $ \vec x, \vec y $ jako \[
		\left< \vec x, \vec y \right> \deq \sum_{i}^{} x_i y_i.
	\]
	(neplatí $ \left< \vec a, \vec a \right> = 0 \Leftrightarrow \vec a = \vec o $)
\end{defi}

\begin{defi}[Duální kód]
	$ C^{\bot} $, \textit{duální kód} k $ C $, je \textit{ortogonální doplněk} $ C $, tedy \[
		C^\bot = \{ \vec x \in \K^n \suchthat \forall \vec y \in C:\left< \vec x,\vec y \right> = \vec o \}.
	\]
\end{defi}

Byť skalární součin, který jsme si definovali pro slova, nemá všechny
vlastnosti jako ten klasický v lineární algebře (např. průnik kódu a jeho duálu
může mít větší dimenzi než $ 0 $), tak stále platí následující tvrzení.

\begin{prop}
	Platí stále: \begin{enumerate}
		\item $ \fce{\dim}{C} + \fce{\dim}{C^\bot} = n $,
		\item $ \left( C^\bot \right)^\bot =C $.
	\end{enumerate}
\end{prop}

\begin{defi}[Kontrolní matice]
	\textit{Kontrolní matice} kódu $ C $ je $ M^\bot $, generující matice kódu $ C^\bot $.
\end{defi}

Pěkná vlastnost kontrolní matice je, že pro $ c \in C $ je $ M^\bot c = \vec o
$. To se bude hodit při kontrole a opravě chyb.

\begin{cor}
	$ C = \{ y \in \K^n \suchthat M^\bot y = \vec o \} $.
\end{cor}

\begin{lemma}
	Můžeme BÚNO předpokládat, že $ M $ je ve standardním, tj. první čtvercová
	podmatice je $ I_k $~--~kdyby ne, tak Gaussova eliminace dá kód se stejnými
	vlastnostmi.
\end{lemma}

\begin{algo}[Kódování]
	Nechť $ C = \left[ n,k,d \right]_q $. BÚNO $ M $ je ve standardním tvaru. \ \\
	\textit{Vstup:} vektor $ z \in \K^k $, zpráva pro zakódování.
	\begin{algorithmic}[1]
		\State $ x \gets M^T z $
	\end{algorithmic}
	\textit{Výstup:} Zakódovaná zpráva $ x $.
\end{algo}

\begin{lemma}
	Pokud $ M $ byla ve standardním tvaru, pak $ M^\bot $ má na posledních $ n-k $ pozicích $ I_{n-k} $.

	\begin{proof}
		Sloupce $ M^T $ jsou vektory z $ C $ a řádky $ M^\bot $ jsou vektory z $ C^\bot $. Tedy musí platit: \[
			\vec o = M^\bot M^T = -B^T I_k + I_{n-k} B^T = -B^T + B^T.
		\]
	\end{proof}
\end{lemma}

\begin{defi}[Syndrom]
	\textit{Syndrom} slova $ y $ je $ \fce{S}{y} $, kde $ S: \K^n \to \K^{n-k} $, tž \[
		\fce{S}{y} \deq M^\bot y.
	\]
\end{defi}

\begin{prop} \
	\begin{enumerate}
		\item $ C = \fce{\Ker}{S}$,
		\item $ S $ je na.
	\end{enumerate}
\end{prop}

\begin{lemma}
	$ S $ je \textit{prosté} na $ \fce{B}{0,t} $, kde $ t = \lfloor \frac{d-1}{2}
		\rfloor $, takže i bijekce, tedy má invers.
\end{lemma}

\begin{cor}[Vlastnosti] Nechť $ \fce{d}{x,y} \leq t $. Pak
	\begin{enumerate}
		\item $ \fce{S}{y} = \fce{S}{y-x} $, $ y-x $ je vyjádření chyby,
		\item $ y-x = \fce{S^{-1}}{\fce{S}{y-x}} $.
	\end{enumerate}

	\begin{proof}
		Že se jedná o jádro plyne triviálně z definice $ S $. Že $ S $ je
		\textquote{na} plyne z toho, že $ \dim C^\bot = n-k $ a $ S $ je definováno
		pomocí $ M^\bot $.
	\end{proof}
\end{cor}

Při dekódování příjemce nemusí dostat odeslané $ x $. Každopádně chce ale
dostat původí $ z $. Přitom předpokládáme, že přijaté $ y $ se od $ x $ neliší
o více, než maximální počet detekovatelných chyb.

\begin{algo}[Dekódování]\  \\
	\textit{Vstup:} přijatá zpráva $ y $.
	\begin{algorithmic}[1]
		\State $ s \gets \fce{S}{y} = M^\bot y $
		\State $ i \gets \fce{S^{-1}}{s} $, za pomoci tabulky s $ q^{n-k} $ prvky zachycující $ S^{-1} $.
		\State $ x \gets y- i $
		\State $ z \gets M^{-T}x $
	\end{algorithmic}
	\textit{Výstup:} dekódovaná zpráva $ z $.
\end{algo}

\begin{prop}
	V $ \left[ n,k,d \right]_q $ kódu je $ d = $ minimální počet lineárně závislých sloupců $ M $.
\end{prop}

\begin{examp}[Hammingovy kódy]
	Hammingovy kódy jsou perfektní, $ q=2 $, mají parametr $ r \geq 2 $.

	Generující matice $ M \in \{ 0,1 \}^{2^r-r-1 \times 2^r-1} $, kde první
	čtvercová podmatice je $ I_{2^r-r-1} $ a zbytek matice tvoří po řádcích
	nenulové vektory z $ \K^r $.

	Kontrolní matice $ M^\bot $ tentokrát končí $ I_r $, řádky zbytku $ M $ jsou
	sloupce $ M^\bot $.

	Parametry takového kódu jsou $ \left[ 2^r-1, 2^r-r-1, 3 \right]_2 $
\end{examp}





\end{document                </a></li>

<li><a href="https://gitlab.mff.cuni.cz/uradnikf/bc_lec/-/raw/master/2223z/databaze/main.pdf">Databázové systémy}
\author{Filip Úradník}
\date{\today}

\input{template}
\input{czech_c}
\usepackage{tikz}
\usetikzlibrary{positioning}

\begin{document}
\maketitle

\section{Relační algebra}

\begin{defi}[Relační algebra]
  RA je dvojice $ \left< R^*, \fce{R}{A} \right> $, kde $ R^* $ je množina $
  \absolute{A} $-tic vyjadřující hodnoty a $ \fce{R}{A} $ je množina atributů
  spolu s typovou informací.
\end{defi}

\begin{defi}[Přejmenování atributu]
  Přejmenování atributu $ a_i \in A $ na $ b_i \notin A $ je operace \[
    \fces{R^*}{a_i \to b_i} \deq \left< R^*, \fce{R}{\left( A \setminus a_i \right) \cup b_i} \right>.
  \]
\end{defi}

\begin{defi}[Množinové operace]
  Nad $ \left< R^*, \fce{R}{A} \right> $ jsou definovány \textit{množinové operace} jako \begin{itemize}
    \item $ \left< X, \fce{R}{A} \right> \cup \left< Y, \fce{R}{A} \right> \deq \left< X \cup Y, \fce{R}{A} \right> $,
    \item $ \left< X, \fce{R}{A} \right> \cap \left< Y, \fce{R}{A} \right> \deq \left< X \cap Y, \fce{R}{A} \right> $,
    \item $ \left< X, \fce{R}{A} \right> \setminus \left< Y, \fce{R}{A} \right> \deq \left< X \setminus Y, \fce{R}{A} \right> $,
    \item $ \left< X, \fce{R}{A} \right> \times \left< Y, \fce{R}{B} \right> \deq \left< X \times Y, \fce{R}{A} \sqcup \fce{R}{B} \right> $, kde nové schéma si pamatuje, odkud jaký sloupec přišel.
  \end{itemize}
\end{defi}

\begin{defi}[Projekce]
  Projekce na množinu $ B \subseteq A $ je operace \[
    \fceb{R^*}{B} \deq \left< \{ \left( x_b \in C \suchthat b \in B \right) \suchthat C \in R^* \}, \fce{R}{B} \right>.
  \]
\end{defi}

\begin{defi}[Selekce]
  Selekce podle $ \varphi $ je operace \[
    \fce{R^*}{\varphi} \deq \left< \{ C \in R^* \suchthat \fce{\varphi}{C} \}, \fce{R}{A} \right>.
  \]
\end{defi}

\begin{defi}[Natural join]
  Natural join je operace \[
    \left< R^*, \fce{R}{A} \right> \star \left< S^*, \fce{R}{B} \right> \deq \left< X^*, \fce{R}{A \cup B} \right>: X \in X^* \Leftrightarrow \fceb{X}{A} \in R^* \land \fceb{X}{B} \in S^*.
  \]
\end{defi}

\begin{defi}[Inner join]
  Inner join je operace \[
    \left< R^*, \fce{R}{A} \right> \left[ \Theta \right] \left< S^*, \fce{R}{B} \right> \deq \left< \{ a \sqcup b \suchthat a \in R^* \land b \in S^* \land \fce{\Theta}{a, b} \}, \fce{R}{A \sqcup B} \right>.
  \]
  Dále je definován semi-join, kde u strany, jejíž schéma se má ponechat, je ostrá závorka.
\end{defi}

\begin{defi}[Dělení]
  Dělení je operace definovaná pro $ B \subset A $ \[
    \left< R^*, \fce{R}{A} \right> \div \left< S^*, \fce{R}{B} \right> \deq \left< \{ x \suchthat \forall s \in S^*: x \sqcup s \in R^* \}, A-B \right>.
  \]
\end{defi}

\begin{defi}[Outer join]
  Pro každý druh joinu existuje i varianta, která řádky do výsledku přidá i pokud nenašly dvojici, a to s null hodnotami.
\end{defi}

\section{Funkční závislosti}

\begin{defi}[Funkční závislost]
  Funkční závislost relace $ \left< R^*, \fce{R}{A} \right> $ je $ a \to b $,
  kde $ a,b \subseteq A $.

  Význam funkční závislosti je: \textquote{pokud se $ x,y \in R^* $ shodují ve
  sloupcích z $ a $, shodují se i v $ b $}.

  Navíc, pro $ a, b \subseteq A $ říkáme, že \begin{itemize}
    \item $ a,b $ jsou \textit{funkčně ekvivalentní} $ \equiv $ $ a \to b, b \to a $,
    \item $ a \to b $ je \textit{elementární závislost} $ \equiv $ $ \absolute{b} = 1 $.
  \end{itemize}
\end{defi}

\begin{thm}[Armstrongovy axiomy]
  Nechť $ \left< R^*, \fce{R}{A} \right> $ je relace a $ a,b,c \subseteq A $. Pak \begin{enumerate}
    \item $ b \subseteq a \implies a \to b $,
    \item $ a \to b \land b \to c \implies a \to b $,
    \item $ a \to b \cup c \implies a \to b \land a \to c $,
    \item $ a \to b \land a \to c \implies a \to b \cup c $,
  \end{enumerate}
\end{thm}

\begin{defi}[Atributový uzávěr]
  \textit{Atributový uzávěr} pro relaci $ \left< R^*, \fce{R}{A} \right> $ za funkčních závislostí $ F $ je \begin{itemize}
    \item pro $ X \subseteq A $ množina $ X^+ : X \to X^+$ vyplývá z $ F $, 
    \item pro $ G = \{ a_i \to b_i \}_i $ množina $ G^+ \deq \left( \bigcup_i a_i \right) ^+ $.
  \end{itemize}
\end{defi}

\begin{algo}[AtributovýUzávěr]\ \\
\textit{Vstup:} množina funkčních závislostí $ F $, množina atributů $ X $.
\begin{algorithmic}[1]
  \State $ C \gets X $
  \Indent Dokud $ \exists a \to b \in F: a \subseteq C \land b \nsubseteq C $:
    \State $ C \gets C \cup b $
  \EndIndent
\end{algorithmic}
\textit{Výstup:} atributový uzávěr $ C $.
\end{algo}

\begin{algo}[VyplýváZeZávislostí]\ \\
\textit{Vstup:} množina funkčních závislostí $ F $, závislost $ a \to b $.
\begin{algorithmic}[1]
  \Indent Pokud $ b \subseteq \algorithm{AtributovýUzávěr}{F, a} $:
    \State Vracím ano.
  \EndIndent
  \State Jinak vracím ne.
\end{algorithmic}
\textit{Výstup:} Informace, jestli $ a \to b $ vyplývá z $ F $.
\end{algo}

\begin{defi}[Redundance]
  Závislost $ f \in F $ je \textit{redundandní} $ \equiv $ \[
    \left( F \setminus \{ f \} \right)^+ = F^+.
  \]

  Atribut $ a \in A $ závislosti $ A \to B $ je \textit{redundandní} $ \equiv $ \[
    \left( A \setminus \{ a \} \to B \right)^+ = \left( A \to B \right)^+.
  \]

  Pokud $ A \to B $ neobsahuje redundandní atributy, pak je redukovaná.
\end{defi}

\begin{algo}[JeRedundandníDependence]\ \\
\textit{Vstup:} množina funkčních závislostí $ F $, závislost $ f $.
\begin{algorithmic}[1]
  \State Vrátím $ \algorithm{VyplýváZeZávislostí}{F \setminus \{ f \}, f} $.
\end{algorithmic}
\textit{Výstup:} Informace, jestli $ a \to b $ je redundandní v $ F $.
\end{algo}

\begin{algo}[JeRedundandníAtribut]\ \\
\textit{Vstup:} množina funkčních závislostí $ F $, závislost $ A \to B $, atribut $ a \in A $.
\begin{algorithmic}[1]
  \State Vrátím $ \algorithm{VyplýváZeZávislostí}{F \setminus \{ A \to B \}, \left( A \setminus \{ a \} \right) \to B} $.
\end{algorithmic}
\textit{Výstup:} Informace, jestli $ a \to b $ je redundandní v $ F $.
\end{algo}

\begin{algo}[RedukceAtributů]\ \\
\textit{Vstup:} množina funkčních závislostí $ F $, závislost $ A \to B $.
\begin{algorithmic}[1]
  \State $ A' \gets A $
  \Indent Pro $ a \in A $
    \Indent Pokud $ \algorithm{JeRedundandníAtribut}{F, A' \to B, a} $ vrátí ano:
      \State $ A' \gets A' \setminus \{ a \} $
    \EndIndent
  \EndIndent
\end{algorithmic}
\textit{Výstup:} funkční závislost $ A' \to B $, která nemá redundandní atributy.
\end{algo}

\begin{defi}[Nadklíč]
  \textit{Nadklíč} pro relaci $ \left< R^*, \fce{R}{A} \right> $ za funkčních závislostí $ F $ je $ K \subseteq A $, tž. \[
    K^+ = A.
  \]
\end{defi}

\begin{defi}[Klíč]
  \textit{Klíč} pro relaci $ \left< R^*, \fce{R}{A} \right> $ za funkčních závislostí $ F $ je redukovaný nadklíč. 
\end{defi}

\begin{defi}[Pokrytí]
  \textit{Pokrytí závislostí} $ F $ je množina funkčních závislostí $ G $, tž. \[
    F^+ = G^+.
  \]

  Pokrytí je \begin{itemize}
    \item \textit{kanonické} $ \equiv \forall g \in G: g  $ je elementární,
    \item \textit{neredundandní} $ \equiv \forall g \in G: g $ neobsahuje redundandní atributy,
    \item \textit{minimální} $ \equiv $ je kanonické a neredundandní.
  \end{itemize}
\end{defi}

\begin{algo}[MinimálníPokrytí]\ \\
\textit{Vstup:} množina funkčních závislostí $ F $.
\begin{algorithmic}[1]
  \State $ F' \gets F $
  \State $ \forall f \in F: $ Rozdělíme $ f $ na elementární atributy.
  \State $ \forall f \in F: $ Odstraníme redundandní atributy z $ f $.
  \State Odstraníme redundandní závislosti z $ F' $.
\end{algorithmic}
\textit{Výstup:} minimální pokrytí $ F' $.
\end{algo}

\begin{algo}[Klíče]\ \\
\textit{Vstup:} množina funkčních závislostí $ F $.
\begin{algorithmic}[1]
  \State $ k \gets \algorithm{RedukceAtributů}{F, A \to A} $
  \State $ K \gets \{ k \} $
  \Indent Opakujeme:
    \Indent Pokud $ \exists a \to b \in F: b \cap k \neq \emptyset $:
      \State $ k' \gets \algorithm{RedukceAtributů}{F, \left( k \setminus a \right) \cup b} $
      \State Pokud $ k' \in K $, skončíme.
      \State Jinak $ K \gets K \cup \{ k' \} $.
    \EndIndent
    \State Jinak skončíme.
  \EndIndent
\end{algorithmic}
\textit{Výstup:} množina klíčů $ K $.
\end{algo}

\subsection{Normální formy}

\begin{defi}[1. normální forma]
  Schéma je \textit{v 1. normální formě} $ \equiv $ každý atribut v $ A $ je
  jedoduchého, nestrukturovaného typu.
\end{defi}

\begin{defi}[2. normální forma]
  Schéma je \textit{v 2. normální formě} $ \equiv $ je v 1. normální formě a
  $ \forall K $ klíč platí: \[
    \forall k \subset K \;\nexists x \in A: x \text{ není v žádném klíči }\land k \to x.
  \]
\end{defi}

\begin{defi}[3. normální forma]
  Schéma je \textit{v 3. normální formě} $ \equiv $ je v 1. normální formě a
  neexistuje posloupnost $ k, a, b $, kde $ k $ je klíč, $ a $ není klíč, a \[
    k \to a \to b.
  \]
\end{defi}

\begin{defi}[Boyce-Coddova normální forma]
  Schéma je \textit{v Boyce-Coddově normální formě} $ \equiv $ je v 1. normální
  formě a každá závislost je buď typu $ X \to Y $ pro $ Y \subseteq X $, nebo $
  X \to Y $, kde $ X $ je nadklíč.
\end{defi}

\section{Serializace}

\begin{defi}[ACID]
  ACID je sada omezení: \begin{itemize}
    \item Atomicita -- transakce buď proběhne celá, nebo vůbec,
    \item Konzistence -- po dokončení transakce bude db v konsistentním stavu,
    \item Isolace -- průběh operace nezávisí na ostatních,
    \item Výdrž -- jakmile proběhne commit, už se nevrátí zpět,
  \end{itemize}
\end{defi}

\begin{defi}[Rozvrh]
  Rozvrh je seznam operací tak, jak jdou za sebou, potenciálně proložených z
  různých klientů.
\end{defi}

\begin{defi}[Sériový rozvrh]
  Sériový rozvrh je rozvrh, kdy všechny transakce probíhají po sobě. Výsledek
  takového rozvrhu je obecně považován za korektní.
\end{defi}

\begin{defi}[Serializovatelný rozvrh]
  Rozvrh, jehož výsledek je ekvivalentní nějakému výsledku sériového rozvrhu.
\end{defi}

\begin{defi}[Konfliktní páry operací]
  Konfliktní páry jsou takové, kdy hrozí, že se jeden z klientů dostane do nekonzistentního stavu. Jsou to \begin{itemize}
    \item WR -- čtení necommitlých dat, dirty read,
    \item RW -- neopakovatelné čtení,
    \item WW -- zápis reálně proběhne jen ten, který má poslední commit.
  \end{itemize}
\end{defi}

\begin{defi}[Konflikt-ekvivalence]
  Rozvrhy jsou konfliktně-ekvivalentní, pokud mají stejné konfliktní páry.
\end{defi}

\begin{defi}[Konfliktně-serializovatelný rozvrh]
  Rozvrh je \textit{konfliktně-serializovatelný}, pokud je
  konfliktně-ekvivalentní s nějakým sériovým rozvrhem. Ověřuje se přes
  \textit{acyklicitu precedenčního grafu}.
\end{defi}

\begin{defi}[Pohledová ekvivalence]
  Rozvrhy jsou \textit{pohledově ekvivalentní} $ \equiv $ \begin{itemize}
    \item každá read operace dopadne stejně v obou (přečte stejnou verzi hodnoty),
    \item každá write operace dopadne stejně v obou (je nebo není finální),
  \end{itemize}
\end{defi}

\begin{defi}[Pohledová serializovatelnost]
  Rozvrh je \textit{pohledově serializovatelný}, pokud je pohledově
  ekvivalentní s nějakým sériovým.
\end{defi}

\begin{defi}[Nezotavitelný rozvrh]
  Rozvrh je \textit{nezotavitelný}, pokud se v něm nachází dirty read.
\end{defi}

\begin{defi}[2PL]
  2-fázové zamykání je protokol, který zajišťuje konfliktní serializovatelnost.
  Má 4 pravidla: \begin{itemize}
    \item READ potřebuje exkluzivní nebo sdílený zámek,
    \item WRITE potřebuje exkluzivní zámek,
    \item po prvním odemčení už nic nemůžu zamknout,
    \item na konci všechno odemknu.
  \end{itemize}
\end{defi}

\begin{defi}[S2PL]
  Striktní 2-fázové zamykání je protokol, který zajišťuje zotavitelnost. Má 3
  pravidla: \begin{itemize}
    \item READ potřebuje exkluzivní nebo sdílený zámek,
    \item WRITE potřebuje exkluzivní zámek,
    \item neodemykám, k odemčení dojde až na konci transakce najednou.
  \end{itemize}
\end{defi}

\begin{defi}[Deadlock]
  2PL může způsobit deadlock, v tom případě jednoho abortne.
\end{defi}

\begin{defi}[Phantom]
  Když umožním delete, add, tak se může stát, že se někdo vymkne ze zámku. Lze
  vyřešit pomocí index-locking, predicate-locking.
\end{defi}

\begin{defi}[SQL isolace]
  SQL databáze umí obecně \begin{enumerate}
    \item UNCOMMITED -- WR, RW, Phantom,
    \item READ COMMITED -- RW, Phantom,
    \item REPEATEBLE READ -- Phantom,
    \item SERIALIZOVATELNOST -- vše ok.
  \end{enumerate}
\end{defi}

\end{document                </a></li>

<li><a href="https://gitlab.mff.cuni.cz/uradnikf/bc_lec/-/raw/master/2223z/cpp/main.pdf">Programování v C++}
\author{Filip Úradník}
\date{\today}

\input{template}
\input{czech}


\begin{document}
\maketitle

\begin{defi}[Smart pointer]
  
\end{defi}


\end{document                </a></li>

<li><a href="https://gitlab.mff.cuni.cz/uradnikf/bc_lec/-/raw/master/2223z/ads/main.pdf">Algoritmy a datové struktury 2}
\author{Filip Úradník}
\date{\today}

\input{template}
\input{czech_c}
\usepackage{tikz}
\usetikzlibrary{positioning}

\algdef{SN}[SUBALG]{Indent}{EndIndent}{}{}%

\def\H{\mathcal{H}}
\def\NP{N\!P}
\def\Z{\mathbb{Z}}
\def\P{\mathbb{P}}
\def\substring#1#2#3{#1\! \left[ #2\!:\!#3 \right]}
\def\prefix#1#2{#1\! \left[ \;:\!#2 \right]}
\def\strindex#1#2{#1\! \left[ \;#2\; \right]}
\def\suffix#1#2{#1\! \left[ #2\!:\; \right]}
\def\ot{\leftarrow}
\def\O{\mathcal{O}}
\def\ff{\mathcal{F}}
\DeclareMathOperator{\degin}{deg^{in}}
\DeclareMathOperator{\degout}{deg^{out}}

\begin{document}
\maketitle

\section{Vyhledávání v textu}

\begin{defi}[Značení] \
  \begin{itemize}
    \item $ \Sigma $: Abeceda (konečná, rozumně velká)
    \item $ \Sigma\star $: Množina všech řetězců
    \item $ \alpha, \beta, \gamma $: Řetězce
    \item $ x,y,z $: Znaky
    \item $ \absolute{\alpha} $: Délka řetězce
    \item $ \varepsilon $: Prázdný řetězec
    \item $ \alpha \beta $: Zřetězení
    \item $ \strindex{\alpha}{i} $: $ i $-tý znak
    \item $ \substring{\alpha}{i}{j} $: Podřetězec
    \item $ \prefix{\alpha}{j} $: Prefix
    \item $ \suffix{\alpha}{i} $: Suffix
    \item $ \sigma $: Seno, $ S \deq \absolute{\sigma} $
    \item $ \iota $: Jehla, $ J \deq \absolute{\iota} $
  \end{itemize}
\end{defi}

\subsection{KMP}

\begin{algo}[Knuth, Morris, Pratt]
  Na vstupu dostaneme seno a jehlu.

  Máme zpětnou funkci, reprezentovanou tabulkou $ Z $ tak, že $ \fceb Zi $
  určuje délku největšího prefixu jehly, který je vlastním suffixem slova $
  \prefix{\iota}{i} $.

  Jinými slovy, $ \fceb Zi = j \equiv \prefix \iota {j} $ je nejdelší prefix
  jehly, který je suffixem $ \prefix \iota {i} $.
\end{algo}

\begin{algo}[Krok]\ \\
\textit{Vstup:} aktuální stav $ i $, následující znak $ x $.
\begin{algorithmic}[1]
  \Indent Dokud $ \strindex \iota i \neq x $:
    \State $ i \gets \strindex Zi $
    \Indent Pokud $ i = 0 $:
      \State Vrátíme $ 0 $.
    \EndIndent
  \EndIndent
  \State Vrátíme $ i+1 $.
\end{algorithmic}
\textit{Výstup:} následující stav.
\end{algo}

\begin{algo}[Hledej]\ \\
\textit{Vstup:} seno $ \sigma $, jehla $ \iota $.
\begin{algorithmic}[1]
  \State $ s \gets 0 $
  \Indent Pro $ i \in \{ 0, \dots, S-1 \} $:
    \State $ s \gets \algorithm{Krok}{s, \strindex \sigma i} $
    \Indent Pokud $ s = J $:
      \State Hlásím výskyt jehly na pozici $ i-J+1 $.
    \EndIndent
  \EndIndent
\end{algorithmic}
\textit{Výstup:} výskyty jehly v seně (počátky).
\end{algo}

\begin{algo}[KonstrukceAutomatu]\ \\
\textit{Vstup:} jehla $ \iota $.
\begin{algorithmic}[1]
  \State $ Z_0 \gets 0 $
  \State $ Z_1 \gets 0 $
  \State $ s \gets 0 $
  \Indent Pro $ i \in \{ 2, \dots, J \} $:
    \State $ s \gets \algorithm{Krok}{s, J_{i-1}} $
    \State $ Z_i \gets s $
  \EndIndent
  
\end{algorithmic}
\textit{Výstup:} tabulka zpětných stavů $ Z $.
\end{algo}

\begin{thm}[Správnost a čas KMP]
  KMP najde všechny výskyty jehly v seně v čase $ \fce{\Theta}{J+S} $.
\end{thm}

\subsection{Aho-Corasicková}

\begin{defi}[Pomocné značení] \
  \begin{itemize}
    \item $ \algorithm{Zpět}{i} $: kam vede zpětná hrana.
    \item $ \algorithm{Slovo}{i} $: hledaná jehla ve stavu $ i $.
    \item $ \algorithm{Dopředu}{i} $: kam vede dopředná hrana.
    \item $ \algorithm{Zkratka}{i} $: kam vede zkratka.
  \end{itemize}
\end{defi}

\begin{algo}[Krok]\ \\
\textit{Vstup:} stav $ i $, další znak $ x $.
\begin{algorithmic}[1]
  \Indent Dokud $ \algorithm{Dopředu}{i, x} = \emptyset $:
    \Indent Pokud $ i = 0 $:
      \State Vrátím $ 0 $.
    \EndIndent
    \State $ i \gets \algorithm{Zpět}{i} $
  \EndIndent
  \State Vrátím $ \algorithm{Dopředu}{i, x} $.
\end{algorithmic}
\textit{Výstup:} nový stav.
\end{algo}

\begin{algo}[Hledej]\ \\
\textit{Vstup:} seno $ \sigma $, $ J $ jehel $ \iota_i $.
\begin{algorithmic}[1]
  \State $ s \gets 0 $
  \Indent Pro $ i \in \{ 0, \dots, S-1 \} $:
    \State $ s \gets \algorithm{Krok}{s, \strindex \sigma i} $
    \State $ t \gets s $
    \Indent Pokud $ \algorithm{Slovo}{t} \neq \emptyset $:
      \State Ohlásím $ \algorithm{Slovo}{t} $.
    \EndIndent
    \Indent Dokud $ \algorithm{Zkratka}{t} \neq \emptyset $:
      \State $ t \gets \algorithm{Zkratka}{t} $
      \State Ohlásím $ \algorithm{Slovo}{t} $.
    \EndIndent
  \EndIndent
\end{algorithmic}
\textit{Výstup:} všechny výskyty všech jehel.
\end{algo}

\begin{algo}[KonstrukceAutomatu]\ \\
\textit{Vstup:} množina jehel $ \{ \iota_i \}_i $.
\begin{algorithmic}[1]
  \State Vybuduji trii stavů z jehel.
  \State Očísluji trii po hladinách (kořen má $ 0 $).
  \State Všechny funkce vrací defaultně $ \emptyset $.
  \Indent Pro $ t $ stav nějakého vrcholu trie:
    \State Pro $ x $ syny toho vrcholu, se stavem $ s $ nastavím $ \algorithm{Dopředu}{t, x} \gets s $.
  \EndIndent
  \State Pro $ p $ stavy synů kořene nastavím $ \algorithm{Zpět}{p} \gets 0 $.
  \Indent Pro $ v $ stav (postupně, opět po hladinách, bez kořene):
    \Indent Pro $ s $ syny vrcholu trie reprezentovaným $ v $:
      \State Nechť $ s $ má stav $ i $ a je označen znakem $ x $.
      \State $ \algorithm{Zpět}{i} \gets \algorithm{Krok}{\algorithm{Zpět}{t},x} $
      \Indent Pokud na $ s $ končí jehla:
        \State $ \algorithm{Slovo}{i} \gets $ index končící jehly.
      \EndIndent
      \Indent Pokud $ \algorithm{Slovo}{\algorithm{Zpět}{i}} \neq \emptyset $:
        \State $ \algorithm{Zkratka}{i} \gets \algorithm{Zpět}{i} $
      \EndIndent
      \State Jinak $ \algorithm{Zkratka}{i} \gets \algorithm{Zkratka}{\algorithm{Zpět}{i}} $
    \EndIndent
  \EndIndent
\end{algorithmic}
\textit{Výstup:} funkce $ \algorithm{Dopředu}{}, \algorithm{Zpět}{}, \algorithm{Slovo}{}, \algorithm{Zkratka}{} $.
\end{algo}

\begin{thm}[Hledej]
  $ \algorithm{Hledej}{} $ běží v $ \fce{\O}{S + \# \text{ výskytů}} $.
\end{thm}

\begin{thm}[Konstrukce]
  $ \algorithm{KonstrukceAutomatu}{} $ běží v $ \fce{\O}{\sum_i J_i} $
\end{thm}

\subsection{Rabin-Karp}

\begin{defi}[Hešovací funkce Rabin-Karp]
  Nechť $ \iota $ má délku $ J $. Nechť $ \H \deq \Z_H $ pro $ H \in \P $ Zadefinuji hešovací funkci $ h: \Sigma^J \to \H $: \[
    \fce{h}{x_0,\dots,x_{J-1}} \deq \sum_{i=0}^{J-1} x_i r^{J-1-i} \mod H  
  \]
\end{defi}

\begin{cor}
  Pro posunuté $ \vec x $ platí: \[
    \fce{h}{x_1,\dots,x_{J}} = r\fce{h}{x_0,\dots,x_{J-1}} + x_J - x_0r^J
  \]
  což zvládnu přepočítat v $ \fce{\O}{1} $
\end{cor}

\begin{algo}[RabinKarp]\ \\
\textit{Vstup:} seno $ \sigma $, jehla $ \iota $.
\begin{algorithmic}[1]
  \State Zvolíme $ H $.
  \State Zvolíme $ r $ náhodně z $ \{ 0, \dots, H-1 \} $.
  \State Předpočítáme $ r^{J-1} $.
  \State $ j \gets \sum_{i=0}^{J-1} r^i \iota_{J-i-1} \mod H $ 
  \State $ h \gets \sum_{i=0}^{J-1} r^i \sigma_{J-i-1} \mod H $
  \State $ i \gets 0 $
  \Indent Dokud $ i < S-J $:
    \Indent Pokud $ h = j $:
      \State Zkontroluji, jestli na $ i $ začíná výskyt jehly, pokud ano, ohlásím ho.
    \EndIndent
    \State $ h \gets \left( h - r^{J-1}\sigma_i \right) r + \sigma_{i+J} \mod H $
    \State $ i \gets i+1 $
  \EndIndent
\end{algorithmic}
\textit{Výstup:} všechny výskyty jehly v seně.
\end{algo}

\begin{lemma}
  Pro polynom $ \fce{P}{x} \deq \sum_{i=0}^{n-1} p_i x^i$ a $ \fce{Q}{x} $
  polynom bez kořenů platí, že pokud $ x_{1,\dots, k} $ jsou všechny kořeny,
  pak \[
      \fce{P}{x} = \left( x-x_1 \right) \left( x-x_2 \right) \dots \left( x-x_k \right) \fce{Q}{x}
    \]
\end{lemma}

\begin{cor}
  Nenulový polynom stupně $ d $ má maximálně $ d $ kořenů.
\end{cor}

\begin{lemma}
  Nechť $ \fce{P}{x}, \fce{Q}{x} $ jsou polynomy stupně $ < n $ a $ x_{1, \dots, n} $ navzájem různá čísla. Pak platí \[
    \forall i \fce{P}{x_i} = \fce{Q}{x_i} \implies \fce{P}{x} \equiv \fce{Q}{x}
  \]
\end{lemma}


\begin{thm}[Složitost RK]
  Složitost algoritmu je 
  \begin{itemize}
    \item režie + počítání hešů: $ \fce{\O}{S} $,
    \item skutečné výskyty: $ \fce{\O}{JV} $,
    \item falešné výskyty (pro ideální hešovací funkci: $ \fce{P}{\text{faleš}} = \frac{1}{H} $) v průměru: \[
        \fce{\O}{\frac{SJ}{H}} \stackrel{H \geq J}{\longrightarrow} \fce{\O}{S}.
    \]
  \end{itemize}
\end{thm}

\begin{thm}[Reálná pravděpodobnost falešných výskytů]
  Pro $ h $ platí, že $ \fce{P}{\text{faleš}} \leq \frac{J}{H} $.
\end{thm}

\section{Toky}

\begin{defi}[Síť]
  \textit{Síť} je uspořádaná pětice $ \left( V, E, z, s, c \right) $, kde
  \begin{itemize}
    \item $ \left( V,E \right) $ je symetrický orientovaný graf
    \item $ z,s $ jsou zdroj a stok, $ z,s \in V $
    \item $ c $ je kapacita, funkce $ E \to \R^+_0 $
  \end{itemize}
\end{defi}

\begin{defi}[Terminologie]
  Pro funkci $ a: E \to \R^+_0 $ definujeme
  \begin{itemize}
    \item $ \fce{a^+}{v} \deq \sum_{uv \in E}^{} \fce{a}{uv}$
    \item $ \fce{a^-}{v} \deq \sum_{vw \in E}^{} \fce{a}{vw}$
    \item $ \fce{a^{\Delta}}{v} \deq  \fce{a^+}{v} - \fce{a^-}{v}$
  \end{itemize}
\end{defi}

\begin{defi}[Tok]
  \textit{Tok} je funkce $ f: E \to \R^+_0 $ splňující
  \begin{itemize}
    \item $ \forall e \in E: \fce{f}{e} \leq \fce{c}{e} $,
    \item $ \forall v \in V, v \neq z,s: \fce{f^{\Delta}}{v} = 0 $ (Kirchhoffův zákon).
  \end{itemize}

  Tok má \textit{velikost} $ \absolute{f} \deq \fce{f^{\Delta}}{s} $.
\end{defi}

\begin{defi}[Rezerva]
  \textit{Rezerva} hrany $ uv \in E $ pro tok $ f $ je funkce $ r $ definována jako \[
    \fce{r}{uv} = \fce{c}{uv} - \fce{f}{uv} + \fce{f}{vu}
  \]
\end{defi}

\subsection{Ford-Fulkerson}

\begin{algo}[FordFulkerson]\ \\
\textit{Vstup:} síť $ \left( V,E,z,s,c \right) $.
\begin{algorithmic}[1]
  \State $ f \gets $ nulový tok.
  \Indent Dokud existuje zlepšující cesta $ P $:
    \State $ \varepsilon \gets \fcec{\min}{\fce{r}{e} \suchthat e \in P} $
    \Indent Pro $ uv \in P $:
      \State $ \delta \gets \fce{\min}{\fce{f}{uv}, \varepsilon} $
      \State $ \fce{f}{vu} \gets \fce{f}{vu} - \delta $
      \State $ \fce{f}{uv} \gets \fce{f}{uv} - \delta + \varepsilon $
    \EndIndent
  \EndIndent
\end{algorithmic}
\textit{Výstup:} maximální tok $ f $.
\end{algo}

\begin{thm}[Konečnost FF]
  Pro $ c: E \to \mathbb{Q}^+_0 $ se algoritmus zastaví. Obecně se zastaví jen
  když vybíráme vždy nejkratší cestu (toto bez Dk). Pro $ c \in \N $ to bude v $ \fce{\O}{m \absolute{t}} $.
\end{thm}

\begin{thm}[FF s nejkratšími cestami]
  Při výběru vždy nejkratších cest je čas $ \fce{\O}{n^2m} $, protože je $ \fce{\O}{n} $ fází - cesty se zkracují.
\end{thm}


\begin{defi}[Elementární řez]
  Nechť $ \fce{E}{A,B} \deq \{ uv \suchthat u \in A, v \in B \} $. Pak
  \textit{elementární řez} je $ \fce{E}{A,B} $, kde $ A \subseteq V, B = V
  \setminus A, z \in A, s \in B $.

  Dále definujeme tok přes řez následovně: 
  \begin{itemize}
    \item $ \fce{f}{A,B} \deq \sum_{e \in \fce{E}{A,B}}^{} \fce{f}{e} $
    \item $ \fce{f^{\Delta}}{A,B} \deq \fce{f}{A,B} - \fce{f}{B,A} $
  \end{itemize}
\end{defi}

\begin{cor}
  \[
    \fce{f^{\Delta}}{A,B} = \absolute{f}
  \]
\end{cor}

\begin{lemma}
  $ \forall f $ tok, $ \forall \fce{E}{A,B} $ řez: \[
    \absolute{f} \leq \fce{c}{A,B}
  \]
\end{lemma}

\begin{cor}
  Pokud $ \absolute{f} = \fce{c}{A,B} $, je $ f $ maximální a $ \fce{E}{A,B} $ minimální.
\end{cor}

\begin{cor}
  FF opravdu najde maximální tok.
\end{cor}

\begin{thm}[Hlavní o tocích]
  Následující jsou ekvivalentní: \begin{enumerate}
    \item $ f $ je maximální tok,
    \item neexistuje zlepšující cesta,
    \item $ \exists A,B $ řez, tž. $ \fce{c}{A,B} = \absolute{f} $.
  \end{enumerate}
  
\end{thm}


\subsection{Dinicův algoritmus}

\begin{defi}[Čistý tok]
  \textit{Čistý tok} $ f^* $ k toku $ f $ je \[
    \fce{f^*}{uv} = \fce{f}{uv} - \fce{f}{vu}.
  \]
\end{defi}

\begin{cor} \label{cistytokcor} \
  \begin{enumerate}
    \item $ \fce{f^*}{uv} = -\fce{f^*}{vu} $
    \item $ \fce{c}{vu} \leq \fce{f^*}{uv} \leq \fce{c}{uv} $
    \item $ \forall v \in V, v \neq z,s: \fce{f^\Delta}{v} \deq \sum_{uv \in E}^{}\fce{f^*}{uv} = 0 $
  \end{enumerate}
\end{cor}

\begin{thm}
  $ \forall g $ funkce splňující \ref{cistytokcor} $ \exists f $ tok: $ g = f^* $.
\end{thm}

\begin{defi}[Síť rezerv]
  K síti $ S = \left( V, E, z, s, c \right) $ a toku $ f $ definujeme \textit{síť rezerv} $ \fce{R}{S, f} \deq \left( V,E,z,s,r \right) $
\end{defi}

\begin{lemma}[O zlepšování]
  Nechť $ f $ je tok v síti $ S $ a $ g $ je tok v síti $ \fce{R}{S,f} $. Pak $ \exists f' $ tok v $ S $, tž. \[
    \absolute{f'} = \absolute{f} + \absolute{g},
  \]
  a $ f' $ lze sestrojit v $ \fce{\O}{m} $.
\end{lemma}

\begin{defi}[Blokující tok]
  Tok $ g $ je \textit{blokující} $ \equiv \forall P $ cesty ze $ z $ do $ s \; \exists u \in P: \fce{g}{u} = \fce{c}{u} $.
\end{defi}

\begin{defi}[Pročištěná síť]
  Síť je \textit{pročištěná} (vrstevnatá) $ \equiv \forall v \in V, e \in E$ leží na nejkratších cestách ze $ z $ do $ s $.
\end{defi}

\begin{algo}[Dinic]\ \\
\textit{Vstup:} síť $ S = \left( V,E,z,s,c \right) $.
\begin{algorithmic}[1]
  \State $ f \gets  $ nulový tok.
  \Indent Opakujeme:
    \State $ R \gets $ síť rezerv $ S $ při $ f $
    \State Pročistíme $ R $.
    \State Pokud neexistuje cesta mezi $ z $ a $ s $, skončíme.
    \State $ g \gets $ nulový tok.
    \Indent Dokud existuje zlepšující cesta mezi $ z $ a $ s $ v $ R $:
      \State Zlepšíme $ g $ o minimum zlepšení na cestě.
      \State Dočistíme síť.
    \EndIndent
    \State $ f \gets f + g $
  \EndIndent
\end{algorithmic}
\textit{Výstup:} maximální tok $ f $.
\end{algo}

\begin{lemma}[Korektnost]
  Když se \textsc{Dinic} zastaví, vrátí maximální tok.
\end{lemma}

\begin{algo}[Čištění]\ \\
\textit{Vstup:} síť $ S = \left( V,E,z,s,c \right) $.
\begin{algorithmic}[1]
  \State Pomocí \textsc{Bfs} rozmístíme vrcholy do vrstev od $ z $.
  \State Smažeme vrcholy ve větší vrstvě než $ s $.
  \State Smažeme hrany, které jdou mezi vrstvami, nebo zpět.
  \State $ F \gets $ fronta, ve které jsou vrcholy s $ \degout v = 0 $ kromě $ s $.
  \Indent Dokud je $ F $ neprázdná:
    \State $ v \gets $ vyjmeme vrchol z fronty.
    \State Smažeme $ v $.
    \Indent Pro $ uv \in E $:
      \State Pokud $ \degout u = 0 $, přidáme $ u $ do $ F $.
    \EndIndent
  \EndIndent
\end{algorithmic}
\textit{Výstup:} pročištěná síť $ S $.
\end{algo}

\begin{lemma}[Složitost]
  \texttt{Dinic} má každou fázi až na hledání blokujícího toku $ \fce{\O}{m} $,
  hledání blokujícího toku bez čištění je $ \fce{\O}{mn} $, čištění je v každé
  fázi celkem až $\fce{\O}{m}$, celková složitost fáze je tedy $\fce{\O}{mn}$.
\end{lemma}

\begin{lemma}[Délka cest]
  Po každé fázi vzroste $ l $ alespoň o $ 1 $, tedy $ \# $ fází je nejvýše $ n $.

  \begin{proof}
    Nové cesty mají délku alespoň $ l+2 $.
  \end{proof}
  
\end{lemma}

\begin{thm}[Dinic]
  \texttt{Dinic} najde maximální tok v čase $ \fce{\O}{n^2m} $.
\end{thm}

\subsection{Goldbergův algoritmus}

\begin{defi}[Vlna]
  Vlna v síti je funkce $ f $, která splňuje kapacity hran, ale může mít kladné přebytky ve
  vrcholech, tedy platí \begin{enumerate}
    \item $\forall e \in E: \fce{f}{e} \leq \fce{c}{v} $
    \item $ \forall v \in V \setminus \{ z,s \}:\fce{f^\Delta}{v} \geq 0 $
  \end{enumerate}
\end{defi}

\begin{defi}[Převedení přebytku]
  Nechť v síti vede hrana z $ v $ do $ w $ taková, že \begin{enumerate}
    \item $ \fce{f}{vw} < \fce{c}{vw} $, tj. $ \fce{r}{vw} > 0 $,
    \item $\fce{f^\Delta}{v} > 0$,
    \item $\fce{h}{v} > \fce{h}{w} $. 
  \end{enumerate}

  Pak \textit{převedení přebytku} z $ v $ do $ w $ je operace, která upraví $ f
  $ tak, že \[
    \fce{f^*}{vw} \gets \fce{f^*}{vw} + \fce{\min}{\fce{r}{vw}, \fce{f^\Delta}{v}}
  \]

  Převedení rozlišujeme \begin{itemize}
    \item \textit{nasycená} $ \equiv $ po převedení je $ \fce{r}{vw} = 0 $,
    \item \textit{nenasycená} $ \equiv $ po převedení je $ \fce{r}{vw} \geq 0 $ (tedy $ \fce{f^{\Delta}}{v} $ klesne na $ 0 $).
  \end{itemize}
  
\end{defi}

\begin{algo}[Goldberg]\ \\
\textit{Vstup:} síť $ \left( V,E,z,s,c \right) $.
\begin{algorithmic}[1]
  \State $ f \gets $ nulový tok.
  \State Pro $ v \in V: \fce{h}{v} \gets 0 $
  \State $ \fce{h}{z} \gets n $
  \State Pro $ zv \in E $ nastavíme $ \fce{f}{zv} \gets \fce{c}{zv} $.
  \Indent Dokud $ \exists v \neq s: \fce{f^\Delta}{v} > 0 $:
    \Indent Pokud $ \exists vu: \fce{h}{u} < \fce{h}{v} \land \fce{r}{vu} > 0 $:
      \State Převedeme vlnu po $ vu $.
    \EndIndent
    \State Jinak $ \fce{h}{v} \gets \fce{h}{v} +1 $.
  \EndIndent
  

\end{algorithmic}
\textit{Výstup:} maximální tok $ f $.
\end{algo}

\begin{invar}[Základní]
  \ \begin{enumerate}
    \item $ f $ je vlna,
    \item $ \fce{h}{v} $ neklesá $ \forall v $,
    \item $ \fce{h}{z} = n, \fce{h}{s} = 0 $,
    \item $ \forall v \neq z: \fce{f^{\Delta}}{v} \geq 0 $.
  \end{enumerate}
\end{invar}

\begin{invar}[Spád]
  \textit{Spád} pro hranu $ uv $ je $ \fce{h}{u} - \fce{h}{v} $. Platí, že \[
    \forall uv \in E: \fce{r}{uv} > 0 \implies \fce{h}{u} - \fce{h}{v} \leq 1.
  \]
\end{invar}

\begin{lemma}[Korektnost]
  Když se algoritmus zastaví, je $ f $ maximální tok.
\end{lemma}

\begin{invar}[Cesta]
  Pokud $ \exists u \neq z,s: \fce{f^{\Delta}}{u} > 0 $, pak $ \exists P $ nenasycená cesta z $ u $ do $ z $.
\end{invar}

\begin{invar}[Výška]
  $ \forall v: \fce{h}{v} \leq 2n $.
\end{invar}

\begin{lemma}[Zvednutí]
  \# zvednutí $ \leq 2n^2 $
\end{lemma}

\begin{lemma}[Syté]
  \# nasycených převedení $ \leq mn $.
\end{lemma}

\begin{lemma}[Nenasycené]
  \# nenasycených převedení je $ \fce{\O}{mn^2} $.
\end{lemma}

\begin{lemma}[Implementace]
  Pro rychlou implementaci si udržujeme \begin{itemize}
    \item $ S \deq $ seznam $ v \neq z,s: \fce{f^{\Delta}}{v} > 0 $,
    \item $ \forall v: \fce{H}{v} \deq $ seznam $ vw \in E :
      \fce{r}{vw} > 0 \land \fce{h}{v} - \fce{h}{w} \geq 1 $.
  \end{itemize}
\end{lemma}

\begin{thm}[Složitost]
  Goldberg běží v $ \fce{\O}{mn^2} $.
\end{thm}

\begin{thm}[Složitost']
  Když vybíráme vždy nejvyšší vrchol, běží Goldberg v $ \fce{\O}{n^3} $.
\end{thm}

\section{Paralelní algoritmy}

\begin{defi}[Hradlová síť]
  \textit{Hradlová síť} je DAG, kde $ \forall v \in V: v$ je \begin{itemize}
    \item \textit{ vstup} $ \equiv \fce{\degin}{v} = 0 $,
    \item \textit{výstup} $ \equiv \fce{\degin}{v} = 1 $,
    \item \textit{hradlo} $ \equiv \fce{\degin}{v} = k \geq 0,\,
      \fce{\degout}{v} > 0 $, kde $ k $ je \textit{parita} hradla, je
      rozlišováno pořadí vstupů.
  \end{itemize}
  
  Arita $ k \leq K \; \forall v $ hradla, kde $ K $ je nějaká pevná konstanta. $
  \forall K \geq 2 $ lze vyjádřit stejné algoritmy, jen s konstantně více
  hradly a vrstvami.
\end{defi}

\begin{defi}[Výpočet]
  \textit{Výpočet} v hradlových sítích probíhá po \textit{taktech $ t $}, kde \begin{itemize}
    \item $ t=0 \equiv$ vstupy vydají svůj výstup,
    \item $ t=i \equiv$ všechny vrcholy, které mají k disposici všechny svoje vstupy.
  \end{itemize}
  Výpočet končí, když všechny výstupní vrcholy dostanou svoje vstupy.

  Výpočet rozdělí vrcholy na \textit{vrstvy $ V_i $}, kde \[
    v \in V_i \equiv v \text{ vydal svůj výstup poprvé v taktu } t = i.
  \]
\end{defi}

\begin{cor}
  Každý vrchol v konečném čase vydá výstup, a tento výstup se už nezmění.
\end{cor}

\begin{defi}[Složitost]
  V hradlových sítích definujeme složitost \begin{itemize}
    \item \textit{časovou} $ \equiv \fce{\max}{t} $,
    \item \textit{prostorovou} $ \equiv \absolute{V} $.
  \end{itemize}
\end{defi}

\subsection{Sčítání}

\begin{thm}[Chování bloku]
  Nechť mám dvě čísla zapsaná binárně $ x_{n-1,\dots,0}, y_{n-1,\dots,0} $,
  která sčítám. Blok je podmnožina $ x_{i,\dots,j}, y_{i,\dots,j} $ Pak chování
  bloku je funkce $ f: \{ 0,1 \} \to \{ 0,1 \} $, která říká, jaký výstupní
  přenos dostanu pro zadaný vstupní přenos. 

  Chování 1-bit bloku může být buď konstantní $ 0,1 $, nebo kopírování (značeno
  $ < $). Chování složení bloků lze jednoduše odvodit. Lze zakódovat binárně
  jako $ p,q $, kde $ p $ říká, jestli kopírujeme, a pokud ne, tak $ q $ říká
  konstantu. Pak pro blok $ B = HL $ je 
  \begin{enumerate}
    \item $ p_B = p_H \land p_L $,
    \item $ q_B = \left( p_H \land q_L \right) \lor \left( \lnot p_H \land q_H \right) $.
  \end{enumerate}
\end{thm}

\begin{algo}[Sčítání]
  Nejprve spojujeme bloky z $ 1 $-bitových až po jeden velký, pak z toho různým
  spojováním spočítáme přenosy všech bitů, nakonec uděláme všem $ XOR $. Toto
  nám zabere čas $ \fce{\O}{\log n} $ a prostor $ \fce{\O}{n} $.
\end{algo}

\subsection{Třídící síť}

\begin{defi}[Komparátor]
  \textit{Komparátor} je hradlo, které na vstupu dostane dvě čísla $ x,y $ a na
  výstupu vrátí $ \fce{\max}{x,y}, \fce{\min}{x,y} $.
\end{defi}

\begin{defi}[Bitonická posloupnost]
  Posloupnost $ \left( x_i \right)_{i<n} $ je \textit{bitonická} $ \equiv $ \[
    \exists i,j: \forall k < l: \left( \left( k,l \leq j \implies x_{i+k} < x_{i+l} \right) \land \left( k,l \geq j \implies x_{i+k} > x_{i+l} \right) \right)  \mod n .
  \]
\end{defi}

\begin{defi}[Separátor]
  Pro $ n = 2^k $ je \textit{separátor} řádu $ n $, značen $ S_n $, je obvod,
  který pro bitonickou posloupnost na vstupu, vrátí $ 2 $ bitonické
  posloupnosti velikosti $ \frac{n}{2} $, mezi kterými platí ostrá nerovnost.
\end{defi}

\begin{algo}[Separátor]
  Separátor má hloubku $ \fce{\O}{1} $ a velikost $ \fce{\O}{n} $. Je to síť,
  která má $ n $ vstupů, a $ i $-tý vstup je spojen komparátorem s $ \left( i+
  \frac{n}{2} \right) $-tým.
\end{algo}


\begin{algo}[Mergesort]
  Definuji binomickou třídíčku $ B_n $, která pro bitonický vstup velikosti $ n
  $ setřídí pomocí separátorů. Slévačka $ M_n $ pak ze dvou rostoucích
  posloupností dělá jednu setřízenou tak, že tu druhou otočí a předá $ B_n $. 

  Pak \textit{Mergesort} dělá to, že se na vstup dívá jako na jednotlivé prvky,
  a postupně je slévá dohromady pomocí $ M_n $. Velikost je $ \fce{\Theta}{n
  \log^2 n} $, hloubka $ \fce{\Theta}{\log^2 n} $.
\end{algo}

\section{Rychlá Fourierova transformace}

\begin{defi}[Polynom]
  Polynom $ \fce{P}{x} \equiv $\[
    \fce{P}{x} \deq \sum_{j=0}^{n-1} p_j x^j.
  \]

  K polynomu definujeme \begin{itemize}
    \item \textit{velikost} $ \equiv $ $ n $,
    \item \textit{stupeň} $ \equiv \fce{\deg}{\fce{P}{x}} \deq
      \fcec{\max}{j \suchthat p_j = 0} $, nebo $ -1 $ pro $ \fce{P}{x} \equiv 0
      $.
  \end{itemize}
\end{defi}

\begin{defi}[Normalizace]
  $ \fce{P}{x} $ je \textit{normalizovaný} $ \equiv p_{n-1} \neq 0$.
\end{defi}

\begin{defi}[Násobení]
  Pro polynomy $ \fce{P}{x}, \fce{Q}{x} $ je \[
    \fce{P}{x} \fce{Q}{x} \deq \left( \sum_{j=0}^{n-1} p_jx^j \right) \left( \sum_{j=0}^{m-1} q_jx^j \right) = \sum_{t=0}^{m+n-2} \left( \sum_{j=0}^{t} p_j q_{t-j} \right) x^t
  \]
\end{defi}

\begin{defi}[Rovnost]
  Pro polynomy $ \fce{P}{x}, \fce{Q}{x} $ lze definovat rovnost jako \begin{itemize}
    \item $ \equiv $, tedy stejné koeficienty po normalizaci,
    \item $ \forall x: \fce{P}{x} = \fce{Q}{x} $.
  \end{itemize}
\end{defi}

\begin{lemma}[Rovnost]
  Pro $ \fce{P}{x}, \fce{Q}{x} $ platí \[
    \fce{P}{x} \equiv \fce{Q}{x} \Longleftrightarrow \forall x: \fce{P}{x} = \fce{Q}{x}.
  \]
\end{lemma}

\begin{lemma}
  Pro $ \fce{P}{x}, \fce{Q}{x}: \fce{\deg}{\fce{P}{x}} \leq d, \;
  \fce{\deg}{\fce{Q}{x}} \leq d$ a $ x_0, \dots, x_d $ navzájem různá,
  platí \[
    \left( \forall j: \fce{P}{x_j} = \fce{Q}{x_j} \right) \implies \fce{P}{x} \equiv \fce{Q}{x}
  \]
\end{lemma}


\begin{defi}[Reprezentace]
  Polynom $ \fce{P}{x} $ lze reprezentovat jako
  \begin{itemize}
    \item koeficienty $ \left( p_0, \dots, p_{n-1} \right) $,
    \item graf, neboli body $ \left( \fce{P}{x_0}, \dots,
      \fce{P}{x_{n-1}} \right) $ pro navzájem různé $ x_i $.
  \end{itemize}
\end{defi}

\begin{defi}[Primitivní odmocnina]
  Číslo $ \omega $ je \textit{primitivní $ n $-tá odmocnina $ 1 \equiv $} \[
    \omega^n = 1 \land \forall k \leq n: \omega^k \neq 1.
  \]
\end{defi}

\begin{thm}[Vlastnosti primitivních odmocnin]
  Nechť $ \omega $ je primitivní $ n $-tá odmocnina $ 1 $. Pak platí \begin{enumerate}
    \item $ \forall j,k: 0 \leq j < k < n:\omega^j \neq \omega^k $,
    \item $ n $ sudé $ \implies w^{\frac{n}{2}} = -1$,
    \item $ \omega^2 $ je primitivní $ \frac{n}{2} $-tá odmocnina $ 1 $.
  \end{enumerate}
\end{thm}

\begin{algo}\
  $ \algorithm{FFT}{n, \omega, \left( p_0,\dots,p_{n-1} \right)} $

  $ n = 2^k, \omega = \sqrt[n]{-1} $ primitivní, $ \left( p_0,\dots,p_{n-1}
  \right) $ koecifienty polynomu $ P $. Vrací $ \left( r_0, \dots, r_{n-1} \right), r_j =\fce{P}{w^j} $.
\begin{algorithmic}[1]
  \If{$ n = 1 $}
    \State \Return $ p_0 $
  \EndIf
  \State $ \left( s_0, s_1, \dots, s_{\frac{n}{2}-1} \right) \gets \algorithm{FFT}{\frac{n}{2}, \omega^2, \left( p_0, p_2, \dots, p_{n-2} \right)} $
  \State $ \left( l_0, l_1, \dots, l_{\frac{n}{2}-1} \right) \gets \algorithm{FFT}{\frac{n}{2}, \omega^2, \left( p_1, p_3, \dots, p_{n-1} \right)} $

  \For{$ j \in \left[ \frac{n}{2} \right] $}
    \State $ r_j \gets s_j + w^j l_j $
    \State $ r_{\frac{n}{2}+j} \gets s_j - w^j l_j $
  \EndFor

  \State \Return $ r_0, \dots r_{n-1} $
\end{algorithmic}
\end{algo}

\begin{thm}[FFT]
  $ \algorithm{FFT}{} $ běží v $ \fce{\O}{n\log n} $.
\end{thm}

\begin{defi}[Diskrétní Fourierova transformace]
  \textit{DFT} je zobrazení $ \ff: \C^n \to \C^n $, tž. \[
    \fce{\ff}{\vec x} = \vec y: y_j = \sum_{j=0}^{n-1} x_k \omega^{jk},
  \]
  kde $\omega $ je pevná primitivní $ n $-tá odmocnina z $ 1 $.
\end{defi}

\begin{cor}
  $ \algorithm{FFT}{} $ počítá DFT pro vektor koeficientů polynomu.
\end{cor}

\begin{cor}[Linearita]
  DFT je \textit{lineární} zobrazení, popsatelné Vandermondovou maticí $ \Omega: $ \[
    \Omega_{jk} = \omega^{jk}.
  \]
\end{cor}

\begin{cor}[Inverze]
  Pro $ \Omega $ reprezentaci $ \ff $ platí: \[
    \Omega^{-1} = \frac {1} n \overline \Omega.
  \]
  Tedy $ \ff_\omega^{-1} = \frac{1}{n} \ff_{\overline \omega} $.
\end{cor}

\begin{thm}[Symetrie]
  Nechť $ \vec x \in \R^n, \; \vec y = \fce{\ff}{\vec x} $. Pak \[
    \forall j \in \left[ n \right]:y_j = \overline {y_{n-j}}.
  \]
\end{thm}

\section{Geometrie}

\subsection{Konvexní obal}

\begin{defi}[Konvexní obal]
  \textit{Konvexní obal konečné množiny} $ x_1, \dots, x_n $ je konvexní mnohoúhelník s vrcholy v některých $ x_i $.
\end{defi}

\begin{defi}[Zatáčení]
  Posloupnost $ x,y,z $ zatáčí \begin{itemize}
    \item \textit{doprava} $ \equiv \fce{\det}{y-x \;\;\; z-y} \leq 0 $,
    \item \textit{doleva} $ \equiv \fce{\det}{y-x \;\;\; z-y} \geq 0 $.
  \end{itemize}
  
\end{defi}

\begin{algo}\
$ \algorithm{KonvexniObal}{x_1, \dots, x_n} $
\begin{algorithmic}[1]
  \State setřídíme lexikograficky $ \to y_1, \dots, y_n $
  \State $ H \gets y_1 $
  \State $ D \gets y_1 $
  \For{$ i \in \left[ n \right] $}
    \While{$ \absolute{H} \geq 2 \land \fceb H{-2} \fceb H{-1} y_i $ zatáčí doleva}
      \State odebereme $ \fceb H{-1} $ 
    \EndWhile
    \While{$ \absolute{D} \geq 2 \land \fceb D{-2} \fceb D{-1} y_i $ zatáčí doprava}
      \State odebereme $ \fceb D{-1} $ 
    \EndWhile
    \State přidáme $ x_i $ na konec $ D, H $
  \EndFor
  
\end{algorithmic}
\end{algo}

\subsection{Průsečíky úseček}

\begin{algo}\
  $ \algorithm{Pruseciky}{x_1, \dots, x_n} $
\begin{algorithmic}[1]
  \State průřez $ P \gets \emptyset $ (BVS s uspořádanými úsečkami jako klíči)
  \State kalendář (BVS podle $ y $) $ C \gets $ začátky a konce úseček
  \While{$ \absolute{C} \neq 0 $}
    \State $ e \Leftarrow C $ (nejbližší událost)
    \If{$ e \equiv $ začátek}
      \State zařadím úsečku do průřezu
    \EndIf
    \If{$ e \equiv $ konec}
      \State vyřadím úsečku z průřezu
    \EndIf
    \If{$ e \equiv $ průsečík}
      \State hlásím průsečík
      \State prohodím úsečky v průřezu
    \EndIf
    \State $ \forall  $ změněnou sousednost přeplánuji průsečíky
  \EndWhile
\end{algorithmic}
\end{algo}

\begin{cor}
  Algoritmus běží v čase $ \fce{\Theta}{\left( n+p \right)\log n} $, kde $ p $ je \# průsečíků.
\end{cor}

\section{Převody a P/NP}

\begin{defi}[Rozhodovací problém]
  \textit{Rozhodovací problém} je funkce $ f: \{ 0,1 \}^* \to \{ 0,1 \} $.
\end{defi}

\begin{defi}[Převod]
  Problém $ A $ lze \textit{převést} na $ B \left( A \to B \right) \equiv
  \exists f : \{ 0,1 \}^* \to \{ 0,1 \}^*$ spočítatelná v polynomiálním čase,
  tž. \[
    \forall x \in \{ 0,1 \}^*:\fce{A}{x} = \fce{B}{\fce{f}{x}}.
  \]
\end{defi}

\begin{lemma}
  Pokud $ L $ je polynomiálně řešitelné a $ M \to L $, pak $ M $ je
  polynomiálně řešitelné.
\end{lemma}


\noindent
\begin{minipage}{\textwidth}
  \begin{thm}
Následující problémy jsou převoditelné:
\begin{center}
  \begin{tikzpicture}[thick]
    \node (SAT) {SAT};
    \node (OSAT) [left=of SAT]{O-SAT};
    \node (3SAT) [right=of SAT] {3-SAT};
    \node (nzmna) [below=of 3SAT] {NzMna};
    \node (klika) [left=of nzmna] {klika};
    \node (33sat) [right=of 3SAT] {3,3-SAT};
    \node (3dpair) [above=of 3SAT] {3D-párování};

    \draw[<->] (SAT) to (3SAT);
    \draw[<->] (3SAT) to (33sat);
    \draw[<->] (klika) to (nzmna);

    \draw[->] (3SAT) to (nzmna);
    \draw[->] (nzmna) to (SAT);
    \draw[->] (OSAT) to (SAT);

    \draw[->] (33sat) to[bend right] (3dpair);
    \draw[->] (3dpair)[bend right] to (SAT);
  \end{tikzpicture}
\end{center}
\end{thm}
\end{minipage}

\begin{defi}[P]
  Třída $ P $ je \textit{třída problémů řešitelných v polynomiálním čase}. 

  Tedy $ L \in P \equiv \exists A $ algoritmus, $ p $ polynom, tž. $ \forall x \in \{ 0,1 \}^*: A $ dokončíme do $ \fce{p}{\absolute{x}} $ kroků a $ \fce{A}{x} = \fce{L}{x}. $
\end{defi}

\begin{defi}[NP]
  Třída $ \NP $ je \textit{třída problémů certifikovatelných v polynomiálním čase}. 

  Tedy $ L \in \NP \equiv \exists V
  \in P, \;\exists  q $ polynom, tž. \[
    \forall x \in \{ 0,1 \}^*: \fce{L}{x} = 1 \Longleftrightarrow \exists y \in \{ 0,1 \}^*: \absolute{y} \leq \fce{q}{\absolute{x}} \land \fce{V}{x,y} = 1.
  \]
\end{defi}

\begin{defi}[NP-těžkost]
  $ P $ je \textit{NP-těžký} $ \equiv \forall L \in \NP: L \to P $.
\end{defi}

\begin{defi}[NP-úplnost]
  $ P $ je \textit{NP-úplný} $ \equiv \forall L \in \NP: L \to P \land P \in \NP $.
\end{defi}

\begin{thm}
  SAT je NP-úplný.
\end{thm}

\section{Optimalizační problémy}

\begin{defi}[Optimalizační problém]
  Problém je \textit{optimalizační} $ \equiv $ \begin{itemize}
    \item $ \exists R $ množina přípustných řešení,
    \item $ \exists c: R \to \R $ ohodnocující řešení,
    \item chci najít nějaké $ x^* \in R: \fce{c}{x^*} $ je maximální, tj. optimální řešení.
  \end{itemize}
\end{defi}

\begin{defi}[Poměrová chyba]
  Nechť problém $ P $ má cenu optimálního řešení $ c^* $, nechť $ c $ je cenová
  funkce problému $ P $. Algoritmus $ g $ na řešení $ P $ má \textit{poměrovou
  chybu $ \fce{\rho}{n} \equiv $} \[
    \forall x : \absolute{x} = n \implies \fce{\max}{\frac{\fce{c}{\fce{g}{x}}}{\fce{c^*}{x}}, \frac{\fce{c^*}{x}}{\fce{c}{\fce{g}{x}}}} \leq \fce{\rho}{n}.
  \]
\end{defi}

\begin{defi}[Relativní chyba]
  Nechť problém $ P $ má cenu optimálního řešení $ c^* $, nechť $ c $ je cenová
  funkce problému $ P $. Algoritmus $ g $ na řešení $ P $ má \textit{relativní
  chybu $ \fce{\varepsilon}{n} \equiv $} \[
    \forall x : \absolute{x} = n \implies \absolute{\frac{\fce{c}{\fce{g}{x}} - \fce{c^*}{x}}{\fce{c^*}{x}}} \leq \fce{\varepsilon}{n}.
  \]
\end{defi}

\begin{prop}
  $ \forall P, \varepsilon, \rho: $ \[
    \fce{\varepsilon}{n} \leq \fce{\rho}{n}-1,
  \]
  navíc pokud je problém maximalizační, pak \[
    \fce{\varepsilon}{n} = \frac{\fce{\rho}{n}-1}{\fce{\rho}{n}}.
  \]
\end{prop}

\begin{defi}[Aproximační schéma]
  Aproximační schéma pro optimalizační problém je algoritmus, který se vstupem
  dostává i $ \varepsilon $ a počítá s relativní chybou $ \varepsilon. $

  Aproximační schéma je \begin{itemize}
    \item \textit{polynomiální} $ \equiv $ pro pevné $ \varepsilon $ běží polynomiálně v $ n $,
    \item \textit{úplně polynomiální} $ \equiv $ běží polynomiálně v $ \frac{1}{\varepsilon}, n $.
  \end{itemize}
\end{defi}

\begin{examp}[Aproximační schéma]
  Hric: \begin{itemize}
    \item $ 2 $-aproximační algoritmus pro vrcholové pokrytí,
    \item $ 2 $-aproximační algoritmus pro obchodního cestujícího na úplném grafu s trojúhelníkovou nerovností,
    \item $ \nexists $ polynomiální aproximační schéma pro obecného obchodního cestujícího,
    \item úplně polynomiální aproximační schéma pro obecného obchodního cestujícího,
  \end{itemize}
  
\end{examp}


\section{Pravděpodobnostní algoritmy}

\begin{defi}[Typ pravděpodobnostního algoritmu]
  Pravděpodobnostní algoritmus může být typu \begin{itemize}
    \item \textit{Las Vegas} $ \equiv $ vždy správně, jen náhodně dlouho běží,
    \item \textit{Monte Carlo} $ \equiv $ může dát špatný výsledek, ale čím déle běží, tím přesnější je.
  \end{itemize}
\end{defi}

\begin{thm}[Malá Fermatova]
  Nechť $ p \in \P, a < p $. Pak \[
    a^{p-1} \equiv 1 \mod p.
  \]
\end{thm}

\begin{thm}
  Nechť \[
    T = \{ \left( k,n \right) \suchthat \left( k ^{n-1} \not\equiv 1 \mod n \right) \lor \left( \exists i: \frac{n-1}{2^i} \in \Z \land k^{\frac{n-1}{2^i}} \not\equiv \pm1 \mod n \right) \}.
  \]

  Pak $ n $ je složené, právě když $ \exists k: \left( n,k \right) \in T $, a pokud je složené, pak $ \exists \frac{n-1}{2} $ takových $ k $.
\end{thm}

\begin{algo}\
$ \algorithm{RabinMiller}{n, m \in \N} $
\begin{algorithmic}[1]
  \Indent Opakuji $ m $-krát:
    \State Vyberu $ k \in \left[ n \right] $ náhodně.
    \Indent Pokud $ \left( k,n \right) \in T $:
      \State Ohlásím, že $ n \notin \P $.
    \EndIndent
  \EndIndent
  
  \State Ohlásím, že $ n \in \P $.
\end{algorithmic}
\end{algo}

\begin{thm}[Chybovost Rabin-Miller]
  Pokud odpoví $ n $ složené, je to správně, ale pokud prvočíslo, pak je $ \fce{P}{\text{chyba}} \leq \left( \frac{1}{2} \right)^m $.
\end{thm}

\section{Šifrování}

\begin{defi}[Eulerova funkce]
  Eulerova funkce $ \fce{\phi}{n} $ je \# čísel menších než $ n $ nesoudělných s $ n $.
\end{defi}

\begin{thm}
  Pro $ p \in \P $ je $ \fce{\phi}{p} = p-1 $, pro $ n = pq: p,q \in \P $ je $ \fce{\phi}{n} = \left( p-1 \right)\left( q-1 \right) $.
\end{thm}

\begin{thm}[Eulerova]
  Pro $ a,n $ nesoudělené je \[
    a^{\fce{\phi}{n}} \equiv 1 \mod n.
  \]
\end{thm}


\begin{algo}\
$ \algorithm{RSA}{} $
\begin{algorithmic}[1]
  \State Vyberu $ p, q \in \P $.
  \State $ n \gets pq $
  \State $ r \gets \fce{\phi}{n} = \left( p-1 \right)\left( q-1 \right) $
  \State Vyberu liché $ e $ nesoudělné s $ r $.
  \State $ d \gets e^{-1} \mod r$
  \State Vrátím $ \left( e,n \right) $ veřejný klíč a $ \left( d, n \right) $ privátní klíč.
\end{algorithmic}
\end{algo}

\begin{thm}[Korektnost RSA]
  Privátní a veřejný klíč definují inverzní operace na $ \Z_n $.
\end{thm}

\begin{algo}\
$ \algorithm{Umocnění}{a,b,n} $
\begin{algorithmic}[1]
  \Indent Pokud $ b = 1 $,
    \State vrátíme $ a $.
  \EndIndent
  \Indent Pokud $ b \equiv 0 \mod 2 $,
    \State vrátíme $ \algorithm{Umocnění}{a \times a, \frac{b}{2}, n-1} $.
  \EndIndent
  \State Jinak vrátíme $ a \times \algorithm{Umocnění}{a, b-1, n} $.
\end{algorithmic}
\end{algo}

\begin{thm}
  Pro $ n $-bitová čísla běží $ \algorithm{Umocnění}{} $ v $ \fce{\O}{n^3} $.
\end{thm}

\begin{algo}\
$ \algorithm{Euklid+}{a,b} $
\begin{algorithmic}[1]
  \Indent Pokud $ b = 0 $:
    \State Vrátíme $ \left( a, 1, 0 \right) $.
  \EndIndent
  \State $ d, x, y \gets \algorithm{Euklid+}{b,\; a \mod b} $
  \State Vrátíme $ \left( d,\; y, \;\left( x - \lfloor \frac{a}{b} \rfloor y \right) \right) $.
\end{algorithmic}
\end{algo}

\begin{thm}
  Pro $ n $-bitová čísla běží $ \algorithm{Euklid+}{} $ v $ \fce{\O}{n^3} $.
\end{thm}

\end{document                </a></li>

            </li>


            <li>2022/2023 summer
                <li><a href="https://gitlab.mff.cuni.cz/uradnikf/bc_lec/-/raw/master/2223l/temno/main.pdf">Teorie množin}
\author{Filip Úradník}
\date{\today}

\input{template}
\input{color}
\input{czech}
\usepackage{mathtools}

\def\allsets{\mathcal{V}}
\def\Q{\mathbb{Q}}
\def\po{\circ}
\def\hlid#1{\left( \impliedby, {#1} \right]}
\def\usp#1{\leq_{#1}}
\def\ousp#1{<_{#1}}
\def\funcs#1#2{^{#1}#2}
\def\countable#1{#1 \moheq \omega}
\def\trans#1{\fce {\mathcal T}{#1}}
\def\ordin{\mathbb On}

\begin{document}
\maketitle
% https://kam.mff.cuni.cz/~kyncl/temno

\begin{examp}[Russelův paradox]
	Nechť $ a = \left\{ x \suchthat x \in x \right\} $. Je pravda, že $ a \in a $?
\end{examp}

\begin{examp}[Berryho paradox]
	Nechť $ m $ je nejmenší přirozené číslo, které nelze definovat méně než 100 znaky.
	Předchozí věta má méně než 100 znaků, a přesto definuje číslo $ m $.
\end{examp}

\begin{defi}[Jazyk teorie množin]
	Budeme používat dvě úrovně jazyka: jazyk \emph{teorie} a \emph{metajayzk}.

	Pro množiny budeme používat typicky malá písmena, případně indexovaná.
	Dále budeme používat $ = $, binární predikátový symbol se stejným významem jako v logice.
	Z logiky využijeme i logické spojky, kvantifikátory a závorky.
	K tomu definujeme symbol $ \in $, náležení.

	Ze symbolů budeme skládat formule.
\end{defi}

\begin{defi}[Rozšíření jazyka]
	K jazyku teorie množin zavedeme: \begin{itemize}
		\item $ x \neq y \equiv \lnot \left( x = y \right) $,
		\item $ x \notin y \equiv \lnot \left( x \in y \right) $,
		\item $ x \subseteq y \equiv \left( \forall z \right) \left( z \in x \rightarrow z \in y \right) $,
		\item $ x \subset y \equiv x \subseteq y \land x \neq y $,
		      % \item $ \left( \forall x \in y \right)\varphi \equiv \left( \forall x \right) \left( x \in y \rightarrow \varphi \right) $,
		\item a další...
	\end{itemize}
\end{defi}

Intuitivně budeme používat axiomy logiky.

\begin{defi}[Axiomy teorie množin]
	Zermelo-Frankeova teorie množin má následující axiomy: \begin{axioms}
		\item axiom \emph{existence množiny}: $ \left( \exists x \right) x = x $,
		\item axiom \emph{extenzionality}: $ \left( \forall z \right)\! \left( z \in x \iff z \in y \right) \rightarrow x = y $,
		\item \label{ax3} schéma axiomů \emph{vydělení}: je-li $ \fce{\varphi}{x} $ bez volné $ z $, pak $ \left( \forall a \right)\! \left( \exists z \right)\! \left( \forall x \right)\!\bigl( x \in z \iff \left( x \in a \land \fce{\varphi}{x} \right) \bigr) $ je axiom.
		\item \label{ax4} axiom \emph{dvojice}: $ \left( \forall a \right)\! \left( \forall b \right)\! \left( \exists z \right)\!\left( \forall x \right)\!\left( x \in z \iff \left( x = a \lor x = b \right) \right) $,
		\item \label{ax5} axiom \emph{sumy}: $ \left( \forall a \right)\!\left( \exists z \right)\!\left( \forall x \right)\!\left( x \in z \iff \left( \exists y \right)\!\left( x \in y \land y \in a \right) \right) $,
		\item \label{ax6} axiom \emph{potence}: $ \left( \forall a \right)\!\left( \exists z \right)\!\left( \forall x \right)\!\left( x \in z \iff x \subseteq a \right) $,
		\item \label{ax7} schéma axiomů \emph{nahrazení}: je-li $ \fce{\psi}{u,v} $ formule bez volných $ w,z $, pak \[
			\left( \forall u \right)\! \left( \forall v \right)\! \left( \forall w \right)\!  \left( \left( \fce{\psi}{u,v} \land \fce{\psi}{u,w} \right) \implies v = w \right) \implies \left( \forall a \right)\! \left( \exists z \right)\! \left( \forall v \right)\! \left( v \in z \iff \left( \exists u \right)\! \left( u \in a \land \fce{\psi}{u,v} \right) \right)
		\] je axiom,
		\item \label{ax8} axiom \emph{fundovanosti}: $ \left( \forall a \right)\! \left( a \neq \emptyset \implies  \left( \exists x \right)\! \left( x \in a \land x \cap a = \emptyset \right) \right) $.
		\item \label{ax9} axiom \emph{nekonečna}: $ \left( \exists w \right)\! \left( \emptyset \in w \land \left( \forall v \in w \right)\! \left( v \cup \left\{ v \right\} \in w \right) \right) $,
		\item \label{ax10} axiom \emph{výběru}: $ \left( \forall x \right)\! \left( \exists f: \left( x \setminus \left\{ \emptyset \right\} \right) \implies \bigcup x \right)\! \left( \forall y \in \dom f \right)\! \left( \fce fy \in y \right) $.
	\end{axioms}
\end{defi}

\begin{cor}[Značení z \ref{ax3}]
	Značení $ \left\{ x \suchthat x \in a \land \fce{\varphi}{x} \right\} $, případně zkráceně $ \left\{ x \in a \suchthat \fce{\varphi}{x} \right\} $ je korektní.
\end{cor}

\begin{defi}[Průnik \ref{ax3}]
	\emph{Průnik} množin $ a $ a $ b $ je $ a \cup b \deq \left\{ x \suchthat x \in a \land x \in b \right\} $.
\end{defi}

\begin{note}[]
	\[
		\bigcap \emptyset = \allsets.
	\]
\end{note}


\begin{defi}[Rozdíl \ref{ax3}]
	\emph{Rozdíl} množin $ a $ a $ b $ je $ a \setminus b \deq \left\{ x \suchthat x \in a \land x \notin b \right\} $.
\end{defi}

\begin{defi}[Prázdná množina \ref{ax3}]
	Prázdná množina je $ \emptyset \deq \left\{ x \suchthat x \in a \land x \neq x \right\} $ pro libovolnou $ a $.
\end{defi}

\begin{cor}[Značení z \ref{ax4}]
	Značení $ \left\{ a,b \right\} $, neuspořádaná dvojice, respektive
	dvouprvková množina (pokud $ a \neq b $), případně $ \left\{ a \right\} =
		\left\{ a,a \right\} $, jednoprvková množina, je korektní.
\end{cor}

\begin{defi}[Uspořádaná dvojice \ref{ax4}]
	\emph{Uspořádaná dvojice} je $ \left< a,b \right> \deq \left\{ \left\{ a \right\}, \left\{ a,b \right\} \right\} $.
\end{defi}

\begin{lemma}[]
	$ \left( \forall x \right)\!\left( \forall y \right)\!\left( \forall a \right)\!\left( \forall b \right)\! :$
	\[
		\left< x,y \right> = \left< a,b \right> \iff \left( x = a \land y = b \right).
	\]
\end{lemma}

\begin{defi}[Uspořádaná $ n $-tice \ref{ax4}]
	Nechť $ a_1, \dots, a_n $ jsou množiny.
	Pak \emph{(uspořádaná) $ n $-tice} je $ \left< a_1, \dots, a_n \right> $, definovaná rekurzivně: \begin{itemize}
		\item $ \left< a_1 \right> = a_1 $,
		\item $ \left< a_1, \dots, a_k \right> = \left< \left< a_1, \dots, a_{k-1} \right>, a_k \right> $.
	\end{itemize}
\end{defi}

\begin{lemma}[Meta-lemma $ \forall n $]
	$ \left( \forall a_1 \right)\dots \left( \forall a_n \right)\!\left( \forall b_1 \right)\dots\left( \forall b_n \right):$
	\[
		\left< a_1,\dots, a_n \right> = \left< b_1, \dots,b_n \right> \iff \left( a_1 = b_1 \land \dots \land a_n = b_n \right).
	\]
\end{lemma}

\begin{cor}[Značení z \ref{ax5}]
	Značení $ \bigcup a $, suma, s významem \textquote{$ \left\{ x \suchthat \left( \exists y \right)\!\left( x \in y \land y \in a \right) \right\} $}, je korektní.
\end{cor}

\begin{defi}[Sjednocení]
	Pro $ a = \left\{ b,c \right\} $ je $ b \cup c \deq \bigcup a $.
\end{defi}

\begin{defi}[Neuspořádaná $ n $-tice]
	Nechť $ a_1, \dots, a_n $ jsou množiny. Pak \emph{neuspořádaná $ n $-tice} je množina $ \left\{ a_1, \dots, a_n \right\} \deq \left\{ a_1, \dots, a_{n-1} \right\} \cup \left\{a_n\right\} $.
\end{defi}

\begin{defi}[Potenční množina]
	Nechť $ a $ je množina. Pak \emph{potenční množina} je $ \pot a $ s významem \textquote{$ \left\{ x \suchthat x \subseteq a \right\} $}.
\end{defi}

\section{Třídy}

\begin{defi}[Třída]
	Nechť $ \fce{\varphi}{x} $ je fle. Pak v meta-jazyce je $ \left\{ x \suchthat \fce{\varphi}{x} \right\} $ je \emph{třída} množin, určená $ \fce{\varphi}{x} $.
	Zároveň, pokud $ \fce{\varphi}{x} = x \in a \land \fce{\psi}{x} $, pak výsledkem je množina podle \ref{ax3}.
\end{defi}

Každá množina je i třída, a to přes $ y = \left\{ x \suchthat x \in y \land x = x \right\} $.

\begin{defi}[Vlastní třída]
	\emph{Vlastní třída} je třída, která není množina.
\end{defi}

Od teď můžeme zavést rozšíření jazyka, kde jako volné proměnné připustíme i \emph{třídy}, značené výhradně velkými písmeny, např. $ X,Y $.
Atomické formule budou moci také obsahovat třídy, např. $ x \in X $, $ x = X $.

Rozdíl je, že třídy \emph{nelze kvantifikovat}!

\begin{defi}[Eliminace třídových termů]
	Pro $ x,y,z$ množiny, $ X = \left\{ x \suchthat \fce{\varphi}{x} \right\}, Y
		= \left\{ x \suchthat \fce{\psi}{x} \right\} $ třídy, pro $ \varphi, \psi $
	formule základního jazyka: \begin{itemize}
		\item $ z \in X $ zachycuje $ \fce{\varphi}{z} $,
		\item $ z = X $ zachycuje $ \left( \forall x \right)\! \left( x \in z \iff \fce{\varphi}{x} \right) $,
		\item $ X \in Y $ zachycuje $ \left( \exists u \right)\! \left( \left( \forall x \right)\! \left( x \in u \iff \fce{\varphi}{x} \right) \land \fce{\psi}{u} \right) $,
		\item $ X \in y $ zachycuje $ \left( \exists u \right)\! \left( \left( \forall x \right)\! \left( x \in u \iff \fce{\varphi}{x} \right) \land u \in y \right) $,
		\item $ X = Y $ zachycuje $ \left( \forall x \right)\! \left( \fce{\varphi}{x} \iff \fce{\psi}{u} \right) $.
	\end{itemize}
\end{defi}

Nyní také můžeme definovat operace na třídách.
Také můžeme definovat třídu všech množin:

\begin{defi}[Třída všech množin]
	\emph{Třída všech množin} je $ \allsets \deq \left\{ x \suchthat x = x \right\} $.
\end{defi}

Dále můžeme definovat relace jako podmnožina, resp. podtřída, část.

\begin{defi}[Kartézský součin tříd]
	Nechť $ A,B $ jsou třídy. Pak \emph{kartézský součin} je \[
		A \times B \deq \left\{ \left< a,b \right> \suchthat a \in A, b \in B \right\} = \left\{ x \suchthat \left( \exists a,b \right)\! \left( x = \left< a,b \right> \land a \in A \land b \in B \right) \right\}.
	\]
\end{defi}

\begin{lemma}[]
	Jsou-li $ x,y $ množiny, pak $ x \times y $ je množina.

	\begin{proof}
		Dokážeme $ x \times y \subseteq \pot {\pot {x \cup y}} $.
	\end{proof}
\end{lemma}

Lze také definovat $ X^n $, a díky definici $ n $-tic to vychází tak, že výsledek je přesně množina všech $ n $-tic.

\section{Relace}

\begin{defi}[Relace]
	Třída $ R $ je \emph{$ n $-ární relace} $ \equiv R \subseteq \allsets^n $.
\end{defi}

Relace budeme často značit $ xRy \deq \left< x,y \right> \in R $.

\begin{defi}[Vlastnosti relace]
	Nechť $ R \subseteq \allsets \times \allsets $ je relace.
	$ R $ je na $ A $ \begin{enumerate}
		\item \emph{reflexivní} $ \equiv $ $ \left( \forall x \in A \right)\! \left( xRx \right) $,
		\item \emph{antireflexivní} $ \equiv $ $ \left( \forall x \in A \right)\! \left( \lnot xRx \right) $,
		\item \emph{antisymetrická} $ \equiv $ $ \left( \forall x \in A \right)\!\left( \forall y \in A \right)\! \left( \lnot xRy \lor \lnot yRx \right) $,
		\item \emph{slabě antisymetrická} $ \equiv $ $ \left( \forall x \in A \right)\!\left( \forall y \in A \right)\! \left( \left( x \neq y \right) \implies \left( \lnot xRy \lor \lnot yRx \right) \right) $,
		\item \emph{trichotomická} $ \equiv $ $ \left( \forall x \in A \right)\!\left( \forall y \in A \right)\! \left( xRy \lor yRx \lor x=y \right)  $, \label{df trichotomie}
		\item \emph{transitivní} $ \equiv $ $ \left( \forall x \in A \right)\!\left( \forall y \in A \right)\! \left( \forall z \right)\!  \left( \left( xRy \land yRz \right) \implies xRz \right)  $.
	\end{enumerate}
\end{defi}

\begin{cor}[]
	Vlastnosti jsou dědičné, tedy pokud platí na třídě, pak platí na každé její podtřídě.
	Je to tak díky tomu, že jsou kvantifikovány jen obecnými kvantifikátory.
\end{cor}

\begin{defi}[Definiční obor]
	\emph{Definiční obor} třídy $ X $ je třída \[
		\fce{\dom}{X} \deq \left\{ u \suchthat \left( \exists v \right)\! \left( \left< u,v \right> \in x \right) \right\}.
	\]
\end{defi}

\begin{defi}[Obor hodnot]
	\emph{Obor hodnot} třídy $ X $ je třída \[
		\fce{\rng}{X} \deq \left\{ v \suchthat \left( \exists u \right)\! \left( \left< u,v \right> \in x \right) \right\}.
	\]
\end{defi}

\begin{defi}[Obraz]
	Nechť $ Y $ je třída. \emph{Obraz} třídy $ X $ je třída \[
		\fceb XY \deq \left\{ z \suchthat \left( \exists y \in Y \right)\! \left( \left< y,z \right> \in X \right) \right\}.
	\]
\end{defi}

Obraz je někdy značen $ X"Y \equiv \fceb XY $.

\begin{defi}[Zúžení]
	\emph{Zúžení} třídy $ X $ na třídu $ Y $ je třída \[
		\restrict XY \deq \left\{ \left< y,z \right> \suchthat y \in Y \land \left< y,z \right> \in X \right\}.
	\]
\end{defi}

\begin{lemma}[]
	Nechť $ x $ je množina, $ Y $ třída. Pak $ \dom x, \rng x, \fceb xY, \restrict xY $ jsou množiny.

	\begin{proof}
		Dokážeme, že platí $ \fce{\dom}{x} \subseteq \bigcup \left( \bigcup x \right) $. Pak už lemma pro $ \dom $ platí z axiomu \ref{ax5}.

		$ u \in \fce{\dom}{x} \Implies \left( \exists v \right)\! \left( \left< u,v \right> \in x \right) $, z definice $ \dom $.
		Z definice $ \left< x,y \right> $ pak tvrzení platí. Podobně platí i pro $ \rng $.

		Nakonec, $ \restrict XY \subseteq X $ a $ \fceb XY \subseteq \rng X $.
	\end{proof}
\end{lemma}

\begin{defi}[Invers]
	Nechť $ R $ je relace. Pak \[
		R^{-1} \deq \left\{ \left< u,v \right> \suchthat \left< v,u \right> \in R \right\}.
	\]
\end{defi}

\begin{defi}[Skládání]
	Nechť $ R,S $ jsou relace. Pak \[
		R \po S \deq \left\{ \left< u,w \right> \suchthat \left< u,v \right> \in R \land \left< v,w \right> \in S \right\}.
	\]
\end{defi}

\subsection{Funkce}

\begin{defi}[Funkce]
	Nechť $ F $ je relace.
	F je \emph{funkce/zobrazení} $ \equiv  $ \[
		\left( \forall u \right)\!\left( \forall v \right)\! \left( \forall w \right)\!  \left( \left( \left< u,v \right> \in F \land \left< u,w \right> \in F \right) \implies v = w \right).
	\]
\end{defi}

\begin{defi}[Zobrazení mezi třídami]
	Nechť $ A,B $ jsou třídy.
	Nechť $ F $ je relace.
	Pak $ F $ je \emph{zobrazením $ X $ do $ Y $} $ \equiv  $ \[
		\dom F = X \land \rng F \subseteq Y.
	\]
	Zapisujeme $ F: X \to Y $.
\end{defi}

\begin{defi}[Zobrazení na třídy]
	Nechť $ A,B $ jsou třídy.
	Nechť $ F $ je relace.
	Pak $ F $ je \emph{zobrazením $ X $ na $ Y $} $ \equiv  $ \[
		\dom F = X \land \rng F = Y.
	\]
\end{defi}

\begin{defi}[Prosté zobrazení]
	Nechť $ F $ je zobrazení.
	$ F $ je \emph{prosté} $ \equiv $ \[
		\left( \forall u \right)\! \left( \forall v \right)\! \left( \forall w \right)\! \left( \left( \fce{F}{u} = w \land \fce{F}{v} = w \right) \implies v = u \right).
	\]
\end{defi}

\begin{cor}[]
	Nechť $ F $ je prosté zobrazení.
	Pak $ F^{-1} $ je také prosté zobrazení.
\end{cor}

\begin{notation}[]
	Nechť $ A $ je třída.
	Nechť $ \varphi $ je formule.
	Pak \begin{enumerate}
		\item $ \left( \exists x \in A \right)\! \varphi $ je zkratka za $ \left( \exists x \right)\! \left( x \in A \land \varphi \right) $,
		\item $ \left( \forall x \in A \right)\! \varphi $ je zkratka za $ \left( \forall x \right)\! \left( x \in A \implies \varphi \right) $,
	\end{enumerate}
\end{notation}

\begin{defi}[Třída všech zobrazení]
	Nechť $ A $ je třída.
	Nechť $ a $ je množina.
	Pak\footnote{Zápis je korektní z axiomu \ref{ax7}.} \[
		\funcs aA \deq \left\{ f \suchthat f: a \to A \right\}.
	\]
\end{defi}

Nelze definovat i pro $ a $ třídu, protože by pak všechny její prvky nebyly množiny.

\begin{cor}[]
	$ \funcs \emptyset Y = \left\{ \emptyset \right\} $ a $ \funcs x \emptyset = \emptyset $ pro $ Y $ třídu a $ x \neq \emptyset $.
\end{cor}

\begin{lemma}[]
	Nechť $ x \neq \emptyset $ je množina.
	Nechť $ A $ je třída.
	Pak $ \funcs xA $ je vlastní třída $ \Iff $ $ A $ je vlastní třída.

	\begin{proof}[Důkaz $ \Rightarrow $]
		Obměnou.
		Nechť $ f: x \to y $.
		Pak $ f \subseteq x \times y $.
		Tedy $ f \in \pot {x \times y} $.
		Proto $ \funcs xy \subseteq \pot {x \times y} $.
	\end{proof}

	\begin{proof}[Důkaz $ \Leftarrow $]
		Nechť $ A $ je vlastní třída.
		Definujme $ \left( \forall a \in A \right)\! \left( K_a : x \to A \right) $, tž. $ \fce{K_a}{x} = a $.
		Definujeme $ K \deq \left\{ K_a \suchthat a \in A \right\} $. $ K \subseteq \funcs xA $.
		Sporem.
		Kdyby $ \funcs xA $ byla množina, pak $ K $ je množina.
		Definujeme $ F: K \to A $, tž. $ \fce{F}{K_a} = a $.
		Z tohoto by plynulo, že $ \rng K = A $ by byla množina. $ \lightning $
	\end{proof}
\end{lemma}

\subsection{Uspořádání}


\begin{defi}[Uspořádání]
	Nechť $ R \subseteq \allsets \times \allsets $ je relace.
	$ R $ je \emph{(neostré) uspořádání} na $ A $ $ \equiv  $ je na $ A $ \emph{reflexivní, slabě antisymetrická a transitivní}.
\end{defi}

\begin{defi}[Porovnatelnost]
	Nechť $ R \subseteq \allsets \times \allsets $ je uspořádání.
	Pak $ x $ a $ y $ jsou \emph{porovnatelné} $ \equiv xRy \lor yRx $.
\end{defi}

Uspořádání budeme značit $ x \usp R y $, značící $ xRy $.

\begin{defi}[Lineární uspořádání]
	Nechť $ R \subseteq \allsets \times \allsets $ je uspořádání.
	$ R $ je \emph{lineární} $ \equiv $ $ R $ je trichotomická relace (\ref{df trichotomie}).
\end{defi}

\begin{defi}[Ostré uspořádání]
	Nechť $ R \subseteq \allsets \times \allsets $ je uspořádání.
	\emph{Ostré uspořádání} je $ R' \deq R \setminus \id $.
\end{defi}

Ostrá uspořádání budeme značit $ x \ousp {R'} y $.

\begin{defi}[]
	Nechť $ R \subseteq A \times A $ je uspořádání na třídě $ A $.
	Nechť $ X \subseteq A $.
	Pak $ a \in A $ je \begin{enumerate}
		\item \emph{majordanta} třídy $ X $ (horní závora, horní mez) $ \equiv \left( \forall x \in X \right)\! \left( x \usp R a \right) $,
		\item \emph{maximální\footnote{Anglicky \emph{maximal}.} prvek} třídy $ X $ $ \equiv \left( \forall x \in X \right)\! \left( \lnot a \ousp R x \right) \land a \in X $,
		\item \emph{největší\footnote{Anglicky \emph{maximum}.} prvek} třídy $ X $ $ \equiv \left( \forall x \in X \right)\! \left( x \usp R a \right) \land a \in X $,
		\item \emph{supremum} třídy $ X $ $ \equiv $ je nejmenším prvkem třídy všech majordant.
	\end{enumerate}
	Analogicky \emph{minoranta, minimální prvek, nejmenší prvek, infimum}.
\end{defi}

\begin{prop}[]
	Je-li prvek největší, pak je i maximální.
\end{prop}

Pokud je $ R $ lineární, pak platí i opačná implikace, a takový prvek existuje nejvýše jeden.

\begin{prop}[]
	Největší prvek a supremum je nejvýše jeden/jedno.
\end{prop}

Díky jednoznačnosti můžeme zavést následující značení:

\begin{notation}[]
	Nechť $ R \subseteq A \times A $ je uspořádání na třídě $ A $.
	Pak $ a \in A $ je \begin{itemize}
		\item \emph{největší prvek} $ \equiv  a = \fce{\max_R}{X} $,
		\item \emph{supremum} $ \equiv  a = \fce{\sup_R}{X} $,
		\item \emph{nejmenší prvek} $ \equiv  $ $ a = \fce{\min_R}{X} $,
		\item \emph{infimum} $ \equiv  a = \fce{\inf_R}{X} $.
	\end{itemize}
\end{notation}

\begin{notation}[Moje značení navíc]\
	\begin{enumerate}
		\item \emph{minimální prvky} $ \equiv $ $ \fce{\mini}{X} $,
		\item \emph{maximální prvky} $ \equiv $ $ \fce{\maxi}{X} $.
	\end{enumerate}
\end{notation}


\begin{defi}[]\label{df:omezenost}
	Nechť $ A $ je třída.
	$ A $ je \emph{shora/zdola omezená} $ \equiv  $ má majordantu/minorantu.
\end{defi}

\begin{defi}[]
	Nechť $ A $ je třída.
	Nechť $ X \subseteq A $.
	$ X $ je \emph{dolní množina/část} v $ A $ $ \equiv  $ \[
		\left( \forall x \in X \right)\! \left( \forall y \in A \right)\! \left( y \usp R x \implies y \in X \right).
	\]
\end{defi}

\begin{notation}[]
	Nechť $ A $ je třída.
	Nechť $ x \in A $.
	Pak \emph{hlavní ideál/}dolní množina \emph{určená} prvkem $ x $ je \[
		\hlid x \deq \left\{ y \in A \suchthat y \leq x \right\}.
	\]
\end{notation}

\begin{prop}[]
	Nechť $ A $ je třída.
	Nechť $ R \subseteq A \times A $ je uspořádání na třídě $ A $.
	Pak \[
		x \usp R y \iff \hlid x \subseteq \hlid y.
	\]
\end{prop}

\begin{note}[Řezy]
	Díky předchozímu tvrzení se dají z $ \Q $ definovat $ \R $ tzv. \emph{metodou řezů}.
\end{note}

\begin{defi}[Dobré uspořádání\footnote{Anglicky well-ordering.}] \label{def:well-ordering}
	Nechť $ R \subseteq A \times A $ je uspořádání na třídě $ A $.
	$ R $ je \emph{dobré} $ \equiv $ každá neprázdná podmnožina $ u \subseteq A $ má nejmenší prvek vzhledem k $ R $.
\end{defi}

\begin{cor}[]
	Nechť $ R \subseteq A \times A $ je dobré uspořádání na třídě $ A $.
	Nechť $ X \subseteq A $.
	Pak $ R $ je dobré i na $ X $.
\end{cor}

\begin{cor}[]
	Nechť $ R \subseteq A \times A $ je dobré uspořádání na třídě $ A $.
	Pak $ R $ je i lineární na třídě $ A $.
\end{cor}

\subsection{Ekvivalence}

\begin{defi}[Ekvivalence]
	Nechť $ R \subseteq \allsets \times \allsets $ je relace.
	$ R $ je \emph{ekvivalence} $ \equiv $ \begin{itemize}
		\item je \emph{reflexivní},
		\item je \emph{symetrická},
		\item je \emph{transitivní}.
	\end{itemize}

\end{defi}

\section{Mohutnost}

\def\moh{\mohlt}

\begin{defi}[Mohutnost]
	Nechť $ x,y $ jsou množiny.
	\begin{itemize}
		\item $ x,y $ mají \emph{stejnou mohutnost}, jsou \emph{ekvivalentní}, $ x \moheq y $ $ \equiv  $ existuje bijekce mezi $ x $ a $ y $,
		\item $ x $ má mohutnost \emph{menší nebo rovnou} $ y $, $ x $ je subvalentní $ y $, $ x \mohle y $ $ \equiv  $ existuje prosté zobrazení z $ x $ \emph{do} $ y $,
		\item $ x $ má mohutnost \emph{menší} než $ y $, $ x \moh y $ $ \equiv  $ existuje prosté zobrazení z $ x $ \emph{do} $ y $, ale ne \emph{na}.
	\end{itemize}
\end{defi}

\begin{cor}[]
	Nechť $ x,y $ jsou množiny.
	Pak \begin{enumerate}
		\item $ x \subseteq y \implies x \mohle y $,
		\item $ x \subset y \implies x \mohle y $,
		\item $ x \mohle y \land y \mohle x \implies x \moheq y $ (viz \ref{thm:cantor-bernstein}),
		\item $ x \moheq y \implies x \mohle y $.
	\end{enumerate}
\end{cor}

\begin{lemma}[]
	Relace mohutnosti je ekvivalence. Relace subvalence je kvazi-uspořádání\footnote{Neplatí slabá antisymetrie.}.
\end{lemma}

\begin{defi}[Monotonie k inkluzi]
	Nechť $ x $ je množina.
	Pak zobrazení $ h: \pot x \to \pot x $ je \emph{monotónní vzhledem k inkluzi} $ \equiv  $ \[
		\left( \forall u,v \subseteq x \right)\! \left( u \subseteq v \implies \fce{h}{u}\subseteq \fce{h}{v} \right).
	\]
\end{defi}

\begin{lemma}[O pevném bodě]
	Nechť $ h: \pot x \to \pot x $ je monotónní vzhledem k inkluzi. Pak $ h $ má pevný bod, tj. \[
		\left( \exists c \subseteq x \right)\! \left( \fce{h}{c} = c \right).
	\]
\end{lemma}

\begin{thm}[Cantor-Bernstein]\label{thm:cantor-bernstein}
	Nechť $ x \mohle y $ a $ y \mohle x $. Pak $ x \moheq y $.
\end{thm}

\begin{cor}[]
	Nechť $ x,y,z $ jsou množiny, $ 2 = \left\{ \emptyset, \left\{ \emptyset \right\} \right\} $.
	\begin{enumerate}
		\item $ x \times y \moheq y \times x $,
		\item $ \left( x \times y \right) \times z \moheq x \times \left( y \times z \right)$,
		\item $ x \moheq x_1 \land y \moheq y_1 \implies x \times y \moheq x_1 \times y_1 $,
		\item $ x \moheq y \implies \pot x \moheq \pot y $,
		\item $ \pot x \moheq {}^x2 $.
	\end{enumerate}
\end{cor}

\begin{defi}[Konečná množina]
	Množina $ x $ je \emph{konečná} $ \equiv  $\[
		\left( \forall u \subseteq \pot x \right)\!  \left( u \neq \emptyset \implies \exists \maxi_\subseteq u \right).
	\]
\end{defi}

\begin{cor}[]
	Nechť $ x $ je konečná množina.
	Pak \[
		\left( \forall u \subseteq \pot x \right)\!  \left( u \neq \emptyset \implies \exists \mini_\subseteq u \right).
	\]
\end{cor}

\begin{defi}[Dedekindovská konečnost]
	Nechť $ x $ je množina.
	Pak $ x $ je \emph{dedekindovsky konečná} $ \equiv $ \[
		\left( \forall a \subset x \right)\! \left( a \moh x \right)
	\]
\end{defi}

\begin{lemma}[]
	Nechť $ x $ je konečná množina.
	Pak $ x $ je i dedekindovsky konečná.
\end{lemma}

\begin{note}[]
	V ZF nelze dokázat druhou implikaci.
\end{note}

\begin{note}[Ekvivalentní definice konečnosti]
	\
	\begin{itemize}
		\item $ \exists  $ dobré lineární uspořádání, jehož invers je také dobrý.
		\item $ \exists  $ lineární uspořádání a každá dvě lineární uspořádání jsou isomorfní.
		\item $ \pot {\pot x} $ je dedekindovsky konečná.
	\end{itemize}

\end{note}

\begin{thm}[O částečném uspořádání na konečných množinách]
	Nechť $ a $ je konečná.
	Nechť $ \leq $ je uspořádání na $ a $.
	Pak \[
		\left( \forall b \subseteq a \right)\! \left( b \neq \emptyset \implies \left( \exists \mini_\leq b \land \exists  \maxi_\leq b \right) \right).
	\]
\end{thm}

\begin{cor}[]
	Každé lineární uspořádání na konečné množině je dobré.
\end{cor}

\begin{defi}[Isomorfismus]
	Nechť $ A,B $ jsou třídy.
	Nechť $ F: A \to B $.
	Nechť $ R_1, R_2 $ jsou relace.
	$ F $ je \emph{isomorfismus $ A $ na $ B $ vzhledem k $ R_1, R_2 $} $ \equiv $ \begin{enumerate}
		\item $ F $ je bijekce,
		\item $ \left( \forall x,y \in A \right)\! \left( xR_1y \iff \fce{F}{x}R_2 \fce{F}{y} \right) $.
	\end{enumerate}
\end{defi}

\begin{note}[]
	Pokud $ F $ není bijekce a platí jen $ \implies $, pak je to \emph{homomorfismus}.
\end{note}

\begin{defi}[Počátkové vnoření]
	Nechť $ a,b $ jsou množiny.
	Nechť $ a $ je uspořádaná pomocí $ R $.
	Nechť $ b $ je uspořádaná pomocí $ S $.
	Pak $ F $ je \emph{počátkové vnoření $ a $ do $ b $} $ \equiv $ \begin{enumerate}
		\item $ a_1 = \dom F $ je dolní množina $ a $,
		\item $ b_1 = \rng F $ je dolní množina $ b $,
		\item $ F $ je isomorfismus mezi $ a_1 $ a $ b_1 $ vzhledem k $ R,S $.
	\end{enumerate}
\end{defi}

\begin{lemma}[]
	Nechť $ a,b $ jsou množiny.
	Nechť $ \leq_a, \leq_b $ jsou dobrá uspořádání na $ a,b $.
	Nechť $ f,g $ jsou počátková vnoření $ a $ do $ b $.
	Pak $ f \subseteq g $, nebo $ g \subseteq f $.
\end{lemma}

\begin{thm}[Porovnávání dobrých uspořádání]
	Nechť $ a,b $ jsou množiny.
	Nechť $ \leq_a, \leq_b $ jsou dobrá uspořádání na $ a,b $.
	Pak existuje právě jeden isomorfismus $ a $ a dolní množiny $ b $, nebo $ b $ a dolní množiny $ a $.
\end{thm}

\begin{thm}[]
	Nechť $ a $ je konečná.
	Pak každá dvě lineární uspořádání jsou isomorfní.
\end{thm}

\begin{lemma}[]
	\
	\begin{enumerate}
		\item $ \left( \fin x \land y \subseteq x \right) \implies \fin y $,
		\item $ \left( \fin x \land y \moheq x \right) \implies \fin y $,
		\item $ \left( \fin x \land y \mohle x \right) \implies \fin y $.
	\end{enumerate}
\end{lemma}

\begin{lemma}[]
	Nechť $ x,y $ jsou konečné množiny.
	Pak $ x \cup y $ je konečná.
\end{lemma}

\begin{defi}[]
	Třída konečných množin je \[
		\fin \deq \left\{ x \suchthat \fin x \right\}.
	\]
\end{defi}

\begin{thm}[Indukce pro konečné množiny]
	Nechť $ X $ je třída.
	Nechť $ \emptyset \in X $ a \[
		x \in X \implies x \cup \left\{ y \right\} \in X.
	\]
	Pak $ \fin \subseteq X $.
\end{thm}

\begin{lemma}[]
	Nechť $ a $ je konečná.
	Pak $ \pot a $ je konečná.
\end{lemma}


\begin{lemma}[]
	Nechť $ a,b $ jsou konečné.
	Pak $ a \times b $ je konečná.
\end{lemma}

\begin{lemma}[]
	Nechť $ a $ je konečná a $ a \subseteq \fin $.
	Pak $ \bigcup a $ je konečná.
\end{lemma}

\begin{cor}[Dirichlet pro nekonečné množiny]
	Nechť $ a $ je konečná, nechť $ x = \bigcup a $ není.
	Pak $ \left( \exists b \in a \right)\! \left( b \notin \fin \right) $.
\end{cor}

\begin{lemma}[]
	Nechť $ x $ je konečná.
	Pak \[
		\left( \forall y \right)\! \left( x \mohle y \lor y \mohle x \right).
	\]
\end{lemma}

\section{Přirozená čísla}

\begin{defi}[Induktivní množina]
	$ w $ je \emph{induktivní množina} $ \equiv $ \[
		\emptyset \in w \land \left( \forall v \in w \right)\! \left( v \cup \left\{ v \right\} \in w \right).
	\]
\end{defi}

Existence induktivní množiny plyne z axiomu nekonečna \ref{ax9}.

\begin{defi}[Množina přirozených čísel]
	Množina \emph{přirozených čísel} je \[
		\omega \deq \bigcap \left\{ w \suchthat \emptyset \in w \land \left( \forall v \in w \right)\! \left( v \cup \left\{ v \right\} \in w \right) \right\}.
	\]
\end{defi}

\begin{cor}[]
	$ \omega $ je nejmenší induktivní množina.
\end{cor}

\begin{defi}[Přirozené číslo]
	\emph{Přirozená čísla} jsou prvky $ \omega $.
\end{defi}

\begin{defi}[Následník]
	Funkce \emph{následníka} je \[
		s: \omega \to \omega: n \mapsto n \cup \left\{ n \right\}.
	\]
\end{defi}

\begin{thm}[Slabá indukce pro $ \omega $]
	Nechť $ X \subseteq \omega $.
	Nechť $ 0 \in X \land \left( \forall x \in X \right)\! \left( \fce{s}{x} \in X \right) $.
	Pak $ X = \omega $.
\end{thm}

\begin{lemma}[$ \in $ je ostré uspořádání]
	Na $ \omega $ platí \begin{enumerate}
		\item $ n \in \omega \implies n \subseteq \omega $,
		\item $ m \in n \implies m \subseteq n $,
		\item $ n \notin n $.
	\end{enumerate}
\end{lemma}

\begin{lemma}[]
	\[
		\left( \forall n \in \omega \right)\! \left( \fin n \right).
	\]
\end{lemma}

\begin{thm}[]
	$ \omega $ je nekonečná.
\end{thm}


\begin{thm}[]
	Nechť $ x $ je množina.
	Pak \[
		\fin x \iff \left( \exists n \in \omega \right)\! \left( x \moheq n \right).
	\]
\end{thm}

\begin{lemma}[Linearita $ \in $]
	Nechť $ m,n \in \omega $.
	Pak \begin{enumerate}
		\item $ m \in n \iff m \subset n $,
		\item $ m \in n \lor n \in m \lor n = m $.
	\end{enumerate}
\end{lemma}

\begin{thm}[]
	$ \in $ je na $ \omega $ dobré supořádání (\ref{def:well-ordering}).
\end{thm}

\begin{thm}[Charakterizace $ \in $ na $ \omega $]
	Nechť $ a \notin \fin $ a existuje $  < $ lineární ostré uspořádání na $ a $. Pak \[
		\left( \forall u \in a \right)\! \left( \fin \hlid u_a^< \right) \implies \left( < \text{je dobré} \land \left< a, < \right> \isomorph \left< \omega, \in \right> \right).
	\]
\end{thm}

\begin{defi}[]
	Množina $ x $ je \begin{itemize}
		\item \emph{spočetná} $ \equiv $ $ x \moheq \omega $,
		\item \emph{nejvýše spočetná} $ \equiv $ $ \fin x \lor x \moheq \omega $,
		\item \emph{nespočetná} $ \equiv $ není nejvýše spočetná.
	\end{itemize}
\end{defi}

\begin{thm}[]
	Nechť $ u \subseteq \omega $.
	Pak \begin{enumerate}
		\item $ u $ je shora omezená $ \implies \fin u $ (\ref{df:omezenost}),
		\item $ u $ je shora neomezená $ \implies $ $ \countable u $.
	\end{enumerate}
\end{thm}

\begin{cor}[]
	Každá podmnožina spočetné množiny je nejvýše spočetná.
\end{cor}

\begin{examp}[Lexikografické uspořádání na $ \omega \times \omega $]
	Lexikografické uspořádání je $ <_L $ definované jako \[
		\left< m,n \right> <_L \left< k,l \right> \equiv \left( m \in k \right) \lor \left( m = k \land n \in l \right).
	\]
\end{examp}

\begin{cor}[]
	Lexikografické uspořádání je dobré na $ \omega \times \omega $.
\end{cor}


\begin{examp}[Maximo-lexikografické uspořádání na $ \omega \times \omega $]
	Maximo-lexikografické uspořádání je $ <_{ML} $ definované jako \[
		\left< m,n \right> <_{ML} \left< k,l \right> \equiv \fce \max {m,n} \in \fce \max {k,l} \lor \left( \fce \max {m,n} = \fce \max {k,l} \land \left< m,n \right> <_L \left< k,l \right> \right).
	\]
\end{examp}

\begin{cor}[]
	$ \left< \omega \times \omega, <_{ML} \right> \isomorph \left< \omega, \in \right> $.
\end{cor}

\begin{note}[]
	Bez AC nelze dokázat \[
		\left( A \moheq \omega \land \left( \forall a \in A \right)\! \left( a \moheq \omega \right) \right) \implies \bigcup A \moheq \omega.
	\]
\end{note}

\begin{thm}[]
	\[
		\left( a \moheq \omega \land b \moheq \omega \right) \implies \left( a \times b \moheq \omega \land a \cup b \moheq \omega \right).
	\]
\end{thm}

\begin{notation}
	\[
		\potfin a \deq \pot a \cap \fin.
	\]
\end{notation}

\begin{thm}[Markov]
	Neexistuje zobrazení $ f: x \to \pot x $, které je \emph{na}.
\end{thm}

\begin{cor}[]
	\[
		x \mohlt \pot x.
	\]
\end{cor}


\begin{cor}[]
	$ \pot \omega $ je nespočetná.
\end{cor}

\begin{cor}[]
	$ \allsets $ není množina.
\end{cor}

\begin{thm}[]
	\[
		\pot \omega \moheq \R \moheq \left[ 0,1 \right].
	\]
\end{thm}

\begin{lemma}[]
	Množina algebraických čísel je spočetná.
\end{lemma}

\begin{prop}[Hypotéza kontinua]
	\[
		\left( \forall x \subseteq \R \right)\! \left( x \moheq \R \lor x \mohle \omega \right).
	\]
\end{prop}

\section{Axiom výběru}

\begin{defi}[Princip výběru]
	$ \forall r $ rozklad $ X $: \[
		\left( \exists v \subseteq X \right)\! \left( \forall u \in r \right)\! \left( \exists x \right)\! \left( v \cap r = \left\{ x \right\} \right).
	\]
\end{defi}

\begin{defi}[Selektor]
	Nechť $ x $ je množina.
	Nechť $ f: \left( x \setminus \left\{ \emptyset \right\} \right) \to x $.
	Pak $ f $ je \emph{selektor} $ \equiv $ \[
		\left( \forall y \in X \right)\! \left( \fce fy \in y \right).
	\]
\end{defi}

\begin{prop}[]
	Následující tvrzení jsou ekvivalentní:
	\begin{itemize}
		\item axiom výběru,
		\item $ \forall x $ je dobře uspořádaná,
		\item $ \mohle $ je trichotomická,
		\item princip maximality.
	\end{itemize}
\end{prop}

\begin{cor}[Axiom výběru]
	\
	\begin{itemize}
		\item Každý vektorový prostor má bázi.
		\item $ \prod $ kompaktních prostorů je kompaktní.
		\item Princip kompaktnosti.
	\end{itemize}
\end{cor}

\begin{defi}[Indexovaný soubor množin]
	\emph{Indexovaný soubor množin} je \[
		\left< F_j \suchthat j \in J \right>,
	\]
	kde $ J $ je indexová třída.
	Indexovaný soubor množin definuje zobrazení $ F: j \mapsto F_j $.
\end{defi}

\begin{defi}[]
	Nechť $ \left< F_j \suchthat j \in J \right> $ je indexovaný soubor množin.
	Pak \[
		\bigcup_{j \in J} F_j \deq \left\{ x \suchthat \left( \exists j \in J \right)\! \left( x \in F_j \right) \right\}.
	\]
\end{defi}

\begin{defi}[]
	Nechť $ \left< F_j \suchthat j \in J \right> $ je indexovaný soubor množin.
	Pak \[
		\bigcap_{j \in J} F_j \deq \left\{ x \suchthat \left( \forall j \in J \right)\! \left( x \in F_j \right) \right\}.
	\]
\end{defi}

\begin{defi}[]
	Nechť $ \left< F_j \suchthat j \in J \right> $ je indexovaný soubor množin.
	Pak \[
		\bigtimes_{j \in J} F_j \deq \left\{ f \suchthat f: J \to \bigcup_{j \in J} F_j \land \left( \forall j \in J \right)\! \left( \fce fj \in F_j \right) \right\}.
	\]
\end{defi}

\begin{lemma}[]
	Nechť $ J = \omega $. Pak $ f: j \mapsto F_j $ je nekonečná posloupnost.
\end{lemma}

\begin{lemma}[]
	Nechť $ J $ je množina.
	Pak $ \bigtimes_j F_j $ je množina.
\end{lemma}

\begin{lemma}[]
	Nechť $ \left( \forall j \in J \right)\! \left( F_j = Y \right) $ pro libovolnou $ Y $.
	Pak $ \bigtimes_j F_j = {\funcs JY} $.
\end{lemma}

\begin{lemma}[]
	Jsou ekvivalentní:
	\begin{enumerate}
		\item axiom výběru,
		\item princip výběru,
		\item $ \forall S $ relaci existuje funkce $ f \subseteq S: \dom f = \dom S $,
		\item $ \left( I \neq \emptyset \land \left( \forall i \in I \right)\! \left( F_i \neq \emptyset \right) \right) \implies \bigtimes_{i \in I} F_i \neq \emptyset $.
	\end{enumerate}
\end{lemma}

\begin{lemma}[]
	Sjednocení (nejvýše) spočetně mnoha (nejvýše) spočetných množin je (nejvýše) spočetné.
\end{lemma}

\begin{defi}[Řetězec]
	Nechť $ A $ je množina uspořádaná $ \leq $.
	$ B \subseteq A $ je \emph{řetězec} $ \equiv $ $ B $ je lineárně uspořádaná $ \leq $.
\end{defi}

Následující věta je ekvivalentní axiomu výběru.

\begin{thm}[Princip Maximality, PM]
	Nechť $ A $ je částečně uspořádaná $ \leq $.
	Nechť každý řetězec má horní mez.
	Pak \[
		\left( \forall a \in A \right)\! \left( \exists b: \maxi A \right)\! \left( b \geq a \right).
	\]
\end{thm}

\begin{thm}[Princip Maximality pro supremum, PMS]
	Nechť $ A $ je částečně uspořádaná $ \leq $.
	Nechť každý řetězec má suprémum.
	Pak \[
		\left( \forall a \in A \right)\! \left( \exists b: \maxi A \right)\! \left( b \geq a \right).
	\]
\end{thm}

\begin{cor}[]
	PMS $ \Iff $ PM (v ZF).
\end{cor}

Další ekvivalentní tvrzení je následující:

\begin{thm}[Trichotomie]
	\[
		\left( \forall x,y \right)\! \left( x \mohle y \lor y \mohle x \right).
	\]
\end{thm}

\begin{cor}[]
	$ \left( \forall x \notin \fin \right)\! \left( \omega \mohle x \right) $.
	Jinými slovy, existuje spočetná podmnožina každé nekonečné množiny.
\end{cor}


\begin{lemma}[S Dk]
	PM $ \Rightarrow $ Trichotomie.
\end{lemma}

Další ekvivalentní tvrzení je následující:

\begin{thm}[Princip dobrého uspořádání, WO, Zermelova]
	$ \forall x $ existuje dobré uspořádání.
\end{thm}

\begin{lemma}[S Dk]
	WO $ \Rightarrow $ AC.
\end{lemma}

\section{Ordinální čísla}

\begin{defi}[Transitivní třída]
	Nechť $ X $ je třída.
	$ X $ je \emph{transitivní} $ \equiv $ \[
		x \in X \implies x \subseteq X.
	\]
\end{defi}

\begin{notation}[]
	Transitivní třídy $ X $ budu značit $ \trans X $.
\end{notation}

\begin{lemma}[]
	$ \trans X \iff \bigcup X \subseteq X $.
\end{lemma}

\begin{lemma}[]
	\
	\begin{itemize}
		\item $ \trans X, \trans Y \implies \trans {X \cap Y}\land \trans {X \cup Y} $,
		\item $ \left( \forall x \in X \right)\! \trans x \implies \left( \trans {\bigcup X} \land \trans {\bigcap X} \right) $.
	\end{itemize}
\end{lemma}

\begin{lemma}[]
	Nechť $ X $ je transitivní.
	Pak $ \in $ je transitivní na $ X $ $ \iff $ $ \left( \forall x \in X \right)\! \trans x $.
\end{lemma}

\begin{defi}[Ordinální číslo]
	Množina $ x $ je \emph{ordinální číslo, ordinál} $ \equiv $ \[
		\trans x \land \text{$ \in $ je dobré, ostré uspořádání na $ x $.}
	\]
\end{defi}

\begin{notation}
	Třídu ordinálů budeme značit $ \ordin $.
\end{notation}

\begin{cor}[]
	$ \omega \in \ordin \land \omega \subseteq \ordin \land \omega \cup \left\{ \omega \right\} \in \ordin $.
\end{cor}

\begin{lemma}[]
	$ \trans \ordin $.
\end{lemma}

\begin{cor}[]
	$ \in $ je transitivní na $ \ordin $.
\end{cor}

\begin{lemma}[]
	Nechť $ x,y \in \ordin $.
	Pak \begin{enumerate}
		\item $ x \notin x $,
		\item $ x \cap y \in \ordin $,
		\item $ x \in y \iff x \subset y $.
	\end{enumerate}
\end{lemma}

\begin{thm}[]
	$ \in $ je dobré, ostré uspořádání na $ \ordin $.
\end{thm}

\begin{notation}
	Ordinály budeme značit $ \alpha, \beta, \gamma,\dots $.
	Místo $ \in $ budeme používat $ < $.
	Dále budeme používat:
	\[
		\alpha \leq \beta \equiv \alpha < \beta \lor \alpha = \beta.
	\]
\end{notation}


\begin{cor}[]
	$ \ordin $ není množina.
\end{cor}

\begin{cor}[]
	Nechť $ X  $ je vlastní třída, transitivní, $ \in $ je dobré, ostré uspořádání na $ X $.
	Pak $ X = \ordin $.
\end{cor}

\begin{lemma}[]
	Nechť $ x \subseteq \ordin $ je množina.
	Pak \[
		x \in \ordin \iff \trans x.
	\]
\end{lemma}

\begin{lemma}[]
	Nechť $ A \subseteq \ordin, A \neq \emptyset $.
	Pak $ \bigcap A = \min_< A $.
\end{lemma}

\begin{lemma}[]
	Nechť $ a \subseteq \ordin $ je množina.
	Pak $ \bigcup a \in \ordin \land \bigcup a = \sup_< a $.
\end{lemma}

\begin{cor}[]
	$ \omega = \sup_< \omega $.
\end{cor}

\begin{cor}[]
	$ \left( \forall a \in \ordin \right)\! \left( \fin a \iff a \in \omega \right) $.
\end{cor}

\begin{lemma}[]
	Nechť $ \alpha \in \ordin $.
	Pak $ \alpha \cup \left\{ \alpha \right\} $ je nejmenší ordinál větší než $ \alpha $.
\end{lemma}

\begin{defi}[]
	Nechť $ \alpha \in \ordin $.
	Pak $ \alpha \cup \left\{ \alpha \right\} $ je \emph{následník} $ \alpha $ a $ \alpha $ je \emph{předchůdce} $ \alpha \cup \left\{ \alpha \right\}. $
\end{defi}

\begin{defi}[]
	$ \alpha $ je \emph{izolované} $ \equiv $ $ \alpha = 0 $ nebo má předchůdce.
	Jinak je \emph{limitní}.
\end{defi}

\begin{thm}[O typu dobrého uspořádání]
	Nechť $ a $ je dobře uspořádaná relací $ r $.
	Pak existuje právě jedno $ \alpha \in \ordin $ a právě jeden isomorfismus, tž. \[
		\left< \alpha, \in \right> \isomorph \left< a, r \right>.
	\]
\end{thm}

Říkáme, že $ \alpha $ je \emph{typ uspořádání $ r $}.

\begin{thm}[Transfinitní indukce]
	Nechť $ A \subseteq \ordin $ a $ \left( \forall \alpha \in \ordin \right)\! \left( \alpha \subseteq A \implies \alpha \in A \right) $.
	Pak \[
		A = \ordin.
	\]
\end{thm}

\begin{thm}[Transfinitní indukce 2]
	Nechť $ A \subseteq \ordin $.
	Nechť $ 0 \in A \land \left( \forall \alpha \in \ordin \right)\! \left( \alpha \in A \implies \alpha \cup \left\{ \alpha \right\} \in A \right) $.
	Dále, nechť $ \forall \alpha \in \ordin $ limitní platí $ \left( \alpha \subseteq A \implies \alpha \in A \right) $.
	Pak \[
		A = \ordin.
	\]
\end{thm}

\begin{thm}[O konstrukci transfinitní rekurze]
	Nechť $ G: \allsets \to \allsets $.
	Pak existuje právě jedna funkce $ F: \ordin \implies \allsets $, tž. \[
		\left( \forall \alpha \in \ordin \right)\! \left( \fce F\alpha = \fce G{F \restriction \alpha} \right).
	\]
\end{thm}

\begin{cor}[]
	AC $ \implies $ WO.
\end{cor}

\end{document}
                </a></li>

<li><a href="https://gitlab.mff.cuni.cz/uradnikf/bc_lec/-/raw/master/2223l/sem_coopgt/main.pdf">Seminář z kooperativní teorie her}
\author{Filip Úradník}
\date{\today}

\input{template}
\input{czech}

\def\kk{\mathcal{K}}
\def\ss{\mathcal{S}}
\def\I{\mathcal{I}}
\def\cc{\mathcal{C}}

\begin{document}
\maketitle

\section{Kooperativní hry}

\begin{defi}[Kooperativní hra]
  \emph{Kooperativní hra} je dvojice $ \left( N, v \right) $, kde \begin{itemize}
    \item $ N = \left\{ 1, \dots, n \right\} $ je množina \emph{hráčů},
    \item $ v: 2^N \to \R $ je \emph{charakteristická funkce}, kde $ \fce{v}{\emptyset} = 0 $.
  \end{itemize}

  Množina všech her o $ n $ hráčích je $ \Gamma^n $.
\end{defi}

\begin{defi}[Koalice]
  \emph{Koalice} je množina $ C \subseteq N $.
\end{defi}

\begin{defi}[Třídy]
  Hra $ \left( N,v \right) $ je \begin{itemize}
    \item \emph{monotonní} $ \equiv $ $ \left( \forall S \subseteq T \subseteq N \right)\! \left( \fce{v}{S} \leq \fce{v}{T} \right) $,
    \item \emph{superaditivní} $ \equiv $ $ \left( \forall S,T \subseteq N: S \cap T = \emptyset \right)\! \left( \fce{v}{S} + \fce{v}{T} \leq \fce{v}{S \cup T} \right) $,
    \item \emph{konvexní} $ \equiv $ $ \left( \forall S,T \subseteq N \right)\! \left( \fce{v}{S} + \fce{v}{T} \leq \fce{v}{S \cap T} + \fce{v}{S \cup T} \right) $.
  \end{itemize}
\end{defi}

\begin{defi}[Výplatní vektor]
  Nechť $ \left( N,v \right) $ je kooperativní hra. \emph{Výplatní vektor} je $
  x \in \R^n $, kde $ x_i $ je výplata hráče $ i $. Vektor je \begin{itemize}
    \item \emph{eficientní} $ \equiv $ $ \fce{x}{N} \deq \sum_{i \in N}^{} x_i = \fce{v}{N} $,
    \item \emph{individuálně racionální} $ \equiv $ $ \left( \forall i \right)\! \left( x_i \geq \fce{v}{i} \right) $.
  \end{itemize}
  S ohledem na vlastnosti vektorů definujeme množiny 
  \begin{itemize}
    \item preimputace $ \fce{\I^*}{v} \deq \left\{ x \in \R^n \suchthat \fce{x}{N} = \fce{v}{N} \right\} $,
    \item imputace $ \fce{\I}{v} \deq \left\{ x \in \fce{\I^*}{v} \suchthat \left( \forall i \right)\! \left( x_i \geq \fce{v}{i} \right) \right\} $.
  \end{itemize}
\end{defi}

\begin{defi}[Koncept řešení]
  Nechť $ \left( N,v \right) $ je hra. \emph{Koncept řešení} je funkce $ \ss: \Gamma^n \to 2^{\R^n} $.
\end{defi}


\begin{defi}[Jádro]
  Nechť $ \left( N,v \right) $ je kooperativní hra. \emph{Jádro} je více-bodový koncept řešení definován jako \[
    \fce{\cc}{v} \deq \left\{ x \in \fce{\I}{v} \suchthat \left( \forall S \subseteq N \right)\! \left( \fce{x}{S} \geq \fce{v}{S} \right) \right\}
  \]
\end{defi}

\begin{defi}[Shapleyho hodnota]
  Nechť $ \left( N,v \right) $ je kooperativní hra. \emph{Shapleyho hodnota} pro hráče $ i $ je jednobodový koncept řešení definován jako \[
    \fce{\phi_i}{v} \deq \sum_{S \subseteq N \setminus \left\{ i \right\}}^{} \frac{s! \left( n-s-1 \right)!}{n!} \left( \fce{v}{S \cup i} - \fce{v}{S} \right).
  \]
\end{defi}


% * základní definici modelu
% * čím se liší od kooperativní hry
% * co je to C-extenze
% * upper a lower game
% * aproximace solution conceptu

\section{Neúplné hry}

\begin{defi}[Neúplná hra]
  \emph{Neúplná hra} je hra, ve které nejsou známy hodnoty všech koalic. Formálně je to trojice $ \left( N, \kk, v \right) $, kde \begin{itemize}
    \item $ N = \left\{ 1, \dots, n \right\} $ je množina \emph{hráčů},
    \item $ \kk \subseteq 2^N $ je množina \emph{koalic se známými hodnotami $ v $}, $ \emptyset \in \kk $,
    \item $ v: \kk \to \R $ je \emph{charakteristická funkce}, $ \fce{v}{\emptyset} = 0 $.
  \end{itemize}

  Neúplná hra je \emph{minimální} $ \equiv $ $ \kk = \left\{ N \right\} \cup \bigcup_i \left\{ i \right\} $.
\end{defi}

\begin{defi}[$ C $-extenze]
  Nechť $ C \subseteq \Gamma^n $ je třída kooperativních her o $ n $ lidech.
  Kooperativní hra $ \left( N, w \right) $ je \emph{$ C $-extenzí} hry $ \left(
  N, \kk, v \right) \equiv \forall S \in \kk: \fce{v}{S} = \fce{w}{S}$.

  Množina všech $ C $-extenzí hry $ \left( N, \kk, v \right) $ je $ \fce{C}{v}
  $. Pokud je $ \fce{C}{v} $ neprázdná, pak je hra $ \left( N, \kk, v \right) $
  \emph{$ C $-extenzibilní}. Množinu všech $ C $-extenzibilních
  neúplných her s pevným $ \kk $ značíme $ \fce{C}{\kk} $.
\end{defi}

\begin{defi}[Horní/dolní hra $ C $-extenzí]
  Nechť $ C \subseteq \Gamma^n $ je třída kooperativních her, $ \left( N,\kk,v
  \right) $ je $ C $-extenzibilní neúplná hra. \emph{Horní hra} je hra $ \left(
  N, \overline v \right) $, tž. \[
    \left( \forall w \in \fce{C}{v} \right)\! \left( \forall S \subseteq N \right)\! \left( \fce{w}{S} \leq \fce{\overline v}{S} \right),
  \]
  navíc však $ \left( \forall S \right)\! \left( \exists w \in \fce{C}{v} \right)\! \left( \fce{w}{S} = \fce{\overline v}{S} \right) $.
  Identicky lze definovat i \emph{dolní hru $ \left( N, \underline v \right) $}.
\end{defi}

\begin{defi}[Slabé řešení]
  Nechť $ \left( N,\kk, v \right) $ je neúplná hra. 
  \begin{itemize}
    \item \emph{Slabé řešení} je funkce \[
      \fce{\fce{\cup \ss}{C, \kk}}v \deq \bigcup_{w \in \fce{C}{v}} \fce{\ss}{w}.
    \]
    \item \emph{Silné řešení} je funkce \[
      \fce{\fce{\cap \ss}{C, \kk}}v \deq \bigcap_{w \in \fce{C}{v}} \fce{\ss}{w}.
    \]
  \end{itemize}
\end{defi}

\section{Markov Decision Process}

\begin{defi}[MDP]
  MDP je $ \left< \varphi, \Sigma, \tau, r \right> $, kde \begin{itemize}
    \item $ \varphi \subseteq \R^k $ je množina \emph{stavů},
    \item $ \Sigma $ je množina \emph{akcí},
    \item $ \tau: \varphi \times \Sigma \to \varphi $ je \emph{transition function},
    \item $ r: \varphi \times \varphi \times \Sigma \to \R $ je \emph{reward function}.
  \end{itemize}
\end{defi}

\def\dist{\Delta}

\begin{defi}[Policy]
  \emph{Policy} je $ \pi : \varphi \to \dist^{\absolute{\fce{\Omega}{s}}} $.
\end{defi}

\begin{defi}[Return]
  \emph{Return} je $ R_T \deq \sum_{t=1}^{T}r_t $.
\end{defi}

Předpokládáme, že za $ T $ kroků hra končí. Lze to rozšířit i na nekonečné hry.
Chceme najít $ \pi \in \argmax \E_\pi R_T $.
Nejde o to, aby v každém kroku se zvýšil reward optimálně, ale aby po celkovém hraní celé hry byl reward co největší.

\begin{defi}[POMDP]
  POMDP je MDP, kde ale máme observation funkci $ o: \varphi \to \R^l $, která
  nám předá jen částečnou informaci o stavu, kterou můžu pozorovat.
\end{defi}

\begin{defi}[Value funkce]
  Nechť jsme ve stavu $ s' $, do kterého jsme se dostali v čase $ t' $.
  Chceme odhadnout, jaký return dostaneme při aktuální policy $ \pi $.
  Proto definujeme tzv. value funkci jako \[
    \fce \mu {s'} \deq \fceb {\E_\pi} {\sum_{t=t'}^{T} r_t}
  \]
\end{defi}

Algoritmus se bude snažit vylepšovat policy tak, že pro zvolenou akci bude minimalizovat \[
  \alpha = \left( R_T - \mu \right) \frac{\pi_i}{\pi_{i,old}}
\]

\begin{defi}[$ q $-value]
  Nechť $ \tau $ je tranistion funkce.
  Nechť $ \mu $ je value funkce.
  Chceme-li ve stavu $ s $ udělat akci $ a $, předpokládaná hodnota pak bude tzv.
  $ q $-value: \[
    \fce{q}{s,a} \deq \sum_{s'}^{} \fce{P}{\fce{\tau}{s, a} = s'} \fce{\mu}{s'}.
  \]
\end{defi}


\end{document                </a></li>

<li><a href="https://gitlab.mff.cuni.cz/uradnikf/bc_lec/-/raw/master/2223l/past/main.pdf">Pravděpodobnost a statistika 1}
\author{Filip Úradník}
\date{\today}

\input{template}
\input{color}
\input{czech}

\def\ff{\mathcal{F}}
\def\Pto{\xrightarrow{P}}
\def\vybPrum{\overline X_n}
\def\vybRozp{\hat S^2_n}
\DeclareMathOperator{\var}{var}
\DeclareMathOperator{\ber}{Ber}
\DeclareMathOperator{\geo}{Geo}
\DeclareMathOperator{\bin}{Bin}
\DeclareMathOperator{\hyper}{Hyper}
\DeclareMathOperator{\pois}{Pois}
\DeclareMathOperator{\cov}{cov}
\DeclareMathOperator{\Exp}{Exp}
\DeclareMathOperator{\Mix}{Mix}
\DeclareMathOperator{\mse}{MSE}
\def\mix#1#2{\fce {\Mix_{\left( #1 \right)}}{#2}}

\begin{document}
\maketitle
% https://api.socrative.com/rc/AhrYBB
% https://iuuk.mff.cuni.cz/~samal/vyuka/PSt1/

\begin{defi}[Elementární jevy]
	\textit{Množina elementárních jevů} (sample space) je množina $ \Omega $.
\end{defi}

\begin{defi}[Prostor jevů]
	\textit{Prostor jevů} je $ \ff \subseteq \pot {\Omega} \equiv $ \begin{itemize}
		\item $ \emptyset \in \ff $,
		\item $ A \in \ff \implies \Omega \setminus A \in \ff $,
		\item $ A_1, A_2, \dots \in \ff \implies \bigcup_i A_i \in \ff $.
	\end{itemize}
\end{defi}

\begin{defi}[Pravděpodobnost]
	\textit{Pravděpodobnost} je $ P: \ff \to \left[ 0,1 \right] \equiv  $ \begin{enumerate}
		\item $ \fce{P}{\Omega} = 1 $,
		\item pro $ J \moheq \N, \left( \forall j \in J \right)A_j \in \ff $ disjunktních je $ \fce{P}{\bigcup_{j \in J} A_j} = \sum_{j \in J}^{} \fce{P}{A_j} $.
	\end{enumerate}
\end{defi}

\begin{prop}
	\
	\begin{itemize}
		\item $ \fce{P}{\emptyset} = 0 $,
		\item $ \fce{P}{A_1 \cup A_2} = \fce{P}{A_1} + \fce{P}{A_2} $ pro disjunktní $ A_1, A_2 $.
	\end{itemize}
\end{prop}

\begin{defi}[Pravděpodobnostní prostor]
	\textit{Pravděpodobnostní prostor} je trojice $ \left< \Omega, \ff, P \right>
	$, kde \begin{enumerate}
		\item $ \emptyset \neq \Omega $ je \textit{množina elementárních jevů},
		\item $ \ff $ je \textit{prostor jevů},
		\item $ P $ je \textit{pravděpodobnost}.
	\end{enumerate}
\end{defi}

\begin{defi}[Názvosloví]
	Jev $ A $ je
	\begin{itemize}
		\item \textit{jistý} $ \equiv $ $ \fce{P}{A} = 1 $,
		\item \textit{nemožný} $ \equiv $ $ \fce{P}{A} = 0 $.
	\end{itemize}
	Dále $ \compl A \deq \Omega \setminus A $.
\end{defi}

\begin{thm}
	Nechť $ A, B \in \ff $. Pak \begin{itemize}
		\item $ \fce{P}{A} + \fce{P}{\compl A} = 1 $,
		\item $ B \subseteq A \implies \fce{P}{A \setminus B} = \fce{P}{A} - \fce{P}{B} $,
		\item $ B \subseteq A \implies \fce{P}{A} \geq \fce{P}{B} $,
		\item $ \fce{P}{A \cup B} = \fce{P}{A} + \fce{P}{B} - \fce{P}{A \cap B} $,
		\item $ \fce{P}{\bigcup_i A_i} \leq \sum_{i}^{} \fce{P}{A_i} $.
	\end{itemize}
\end{thm}

\begin{examp}[Klasický PP]
	$ \Omega $ je konečná, $ \ff = \pot \Omega $, $ \fce{P}{A} \deq \frac{\absolute{A}}{\absolute{\Omega}} $.
\end{examp}

\begin{examp}[Diskrétní PP]
	$ \Omega \mohle \N $, $ \ff = \pot \Omega $, máme $ p: \Omega \to
		\left[ 0,1 \right] $, kde $ \sum_{\omega \in \Omega}^{} \fce{p}{\omega} = 1 $
	a \[
		\fce{P}{A} \deq \sum_{\omega \in A}^{} \fce{p}{\omega}.
	\]
\end{examp}

\begin{examp}[Geometrický PP]
	Nechť $ d \in \N $. $ \Omega \subseteq \R^d $, $ \ff $ je třída množin $ X
		\subseteq \Omega $, které mají objem $ \fce {V_d}X $. Pravděpodobnost je definována jako \[
		\fce{P}{A } \deq \frac{\fce{V_d}{A}}{\fce{V_d}{\Omega}}.
	\]
\end{examp}

\begin{examp}[Vážený geometrický PP]
	Nechť $ d \in \N $. $ \Omega \subseteq \R^d $. Navíc mějme funkce $ f: \Omega
		\to \R^+_0 $, tž. $ \int_{\Omega} \fce{f}{x} \dd x = 1 $. $ \ff $ nechť je
	třída množin $ X $, tž. $ \int_X f $ existuje. Pravděpodobnost je definována
	jako \[
		\fce{P}{A} \deq \int_A \fce{f}{x} \dd x.
	\]
\end{examp}

\begin{defi}[Podmíněná pravděpodobnost]
	Nechť $ A, B \in \ff, \fce{P}{B} > 0 $. \textit{Podmíněná pravděpodobnost} $
		A $ za předpokladu $ B $ je \[
		\fce{P}{A \mid B} \deq \frac{\fce{P}{A \cap B}}{\fce{P}{B}}.
	\]
\end{defi}

\begin{cor}[]
	\[
		\fce{P}{A \mid \Omega} = \fce{P}{A}.
	\]
\end{cor}

\begin{cor}[]
	\[
		\fce{P}{A \cap B} = \fce{P}{B} \fce{P}{A \mid B}.
	\]
\end{cor}

\begin{thm}[]
	Nechť $ B \in \ff $ a $ \fce{P}{B} > 0 $. Definujme \[
		\fce{Q}{A} = \fce{P}{A \mid B}.
	\]
	Pak $ \left< \Omega, \ff, Q \right> $ je pravděpodobnostní prostor.
\end{thm}

\begin{thm}[Zřetězené podmiňování]
	Mějme $ A_1, \dots, A_n \in \ff $ a $ \fce{P}{\bigcap_{i=1}^{n-1} A_i} \neq 0 $. Pak \[
		\fce{P}{\bigcap_{i=1}^n A_i} = \prod_{i=1}^n \fce{P}{A_i \mid \bigcap_{j = 1}^{i-1} A_j}.
	\]
\end{thm}

\begin{thm}[O rozboru případů]
	Nechť $ A \in \ff , I \mohle \N $.
	Nechť $ \bigdisjcup_{i\in I} B_i = \Omega $ a $ \left( \forall i \in I \right)\! \left( B_i \in \ff \land \fce P{B_i} > 0 \right) $. Pak \[
		\fce{P}{A} = \sum_{i \in I} \fce{P}{B_i} \fce{P}{A \mid B_i}.
	\]
\end{thm}

\begin{thm}[Bayesova]
	Nechť $ A \in \ff , I \mohle \N $.
	Nechť $ \bigdisjcup_{i\in I} B_i = \Omega $ a $ \left( \forall i \in I \right)\! \left( B_i \in \ff \land \fce P{B_i} > 0 \right) $. Pak \[
		\left( \forall j \in I \right)\fce{P}{B_j \mid A} = \frac{\fce{P}{B_j} \fce{P}{A \mid B_j}}{\sum_{i \in I}^{} \fce{P}{B_i} \fce{P}{A \mid B_i}}.
	\]
\end{thm}

\begin{defi}[Nezávislé jevy]
	Nechť $ A, B \in \ff $. $ A $ a $ B $ jsou \emph{nezávislé} $ \equiv $ \[
		\fce{P}{A \cap B} = \fce{P}{A} \fce{P}{B}.
	\]
\end{defi}

\begin{cor}[]
	Nechť $ \fce PB > 0 $.
	Pak $ A $ a $ B $ jsou nezávislé $ \Iff $ \[
		\fce{P}{A \mid B} = \fce{P}{A}.
	\]
\end{cor}

\begin{defi}[Nezávislá množina jevů]
	Jevy $ A_1, \dots, A_n $ jsou \emph{nezávislé} $ \equiv  $ \[
		\left( \forall J \subseteq \left[ n \right] \right)\! \left( \fce{P}{\bigcap_{j \in J} A_j} = \prod_{j \in J} A_j \right).
	\]
\end{defi}

\section{Diskrétní náhodné veličiny}

\begin{defi}[Diskrétní náhodná veličina]
	\emph{Diskrétní náhodná veličina} je $ X: \Omega \to \R $, tž. \begin{enumerate}
		\item $\rng X \mohle \N$,
		\item $ \left( \forall x \in \R \right)\! \left( \left\{ \omega \in \Omega \suchthat \fce{X}{\omega} = x \right\} \in \ff \right) $.
	\end{enumerate}
\end{defi}

\begin{defi}[Pravděpodobnostní funkce]
	\emph{Pravděpodobnostní funkce} je $ p_X $, tž. \[
		\fce{p_X}{x} \deq \fce{P}{\left\{ \omega \in \Omega \suchthat \fce{X}{\omega} = x \right\}}.
	\]
	Občas se používá zkrácený zápis jako $ \fce{p_X}{x} \deq \fce{P}{X = x} $.
\end{defi}

\begin{cor}[]
	\[
		\sum_{x \in \R}^{} \fce{p_X}{x} = 1.
	\]
\end{cor}

\begin{defi}[Distribuce náhodné veličiny]
	Nechť $ X $ je diskrétní náhodná veličina.
	Pak její \emph{distribuce} je pravděpodobnostní prostor $ \left< \Omega', \pot {\Omega'}, R \right> $, kde \begin{itemize}
		\item $ \Omega' = \rng X $,
		\item $ \fce R{\left\{ x \right\}} \deq \fce {p_X}{x} $.
	\end{itemize}
\end{defi}

\begin{cor}[]
	Distribuce diskrétní náhodné veličiny je diskrétní pravděpodobnostní prostor.
\end{cor}


\begin{examp}[Bernoulliho rozdělení]
	\ \begin{itemize}
		\item $ \fce \ber p \sim X: \Omega \to \left\{ 0,1 \right\} $,
		\item $ \fce P{X=1} = p $, $ \fce P{X=0} = 1-p $,
		\item $ \E X = p $,
		\item $ \var X = p \left( 1-p \right) $,
	\end{itemize}
\end{examp}

\begin{defi}[Indikátorová náhodná veličina]
	\emph{Indikátorová náhodná veličina} pro $ A \in \ff $ je \[
		\fce{I_A}{\omega} \deq \begin{cases}
			1 & \omega \in A, \\ 0 & \omega \notin A.
		\end{cases}
	\]
\end{defi}

\begin{examp}[Geometrické rozdělení]
	\ \begin{itemize}
		\item \textquote{první úspěch v $ k $ s pravděpodobností úspěchu $ p $},
		\item $ \fce \geo p \sim X: \Omega \to \left\{ 1,2,\dots \right\} $,
		\item $ \fce P{X=k} = \left( 1-p \right)^{k-1} p $,
		\item $ \E X = \frac 1p $,
		\item $ \var X = \frac{\left( 1-p \right)}{p^2} $,
	\end{itemize}
\end{examp}

\begin{examp}[Binomické rozdělení]
	\ \begin{itemize}
		\item \textquote{\# úspěchů z $ n $ pokusů při pravděpodobnosti úspěchu $ p $},
		\item $ \fce \bin {n,p} \sim X: \Omega \to \left\{ 0,1,\dots,n \right\} $,
		\item $ \fce P{X=k} = \binom nk p^k \left( 1-p \right)^{n-k} $,
		\item $ \E X = pn $,
		\item $ \var X = n p \left( 1-p \right) $,
	\end{itemize}
\end{examp}

\begin{examp}[Hypergeometrické rozdělení]
	\ \begin{itemize}
		\item \textquote{počet červených z $ N $ míčků, z toho $ K $ červených, při tahání a nevracení zpět},
		\item $ \fce \hyper {N,K,n} \sim X: \Omega \to \left\{ 0,1 \right\} $,
		\item $ \fce P{X=k} = \frac {\binom Kk \binom{N-K}{n-k}} {\binom Nn} $,
		\item $ \E X = n\frac KN $,
		\item $ \var X = n\frac{K}{N} \left( 1 - \frac{K}{N} \right) \frac{N-n}{N-1} $,
	\end{itemize}
\end{examp}

Pro $ n \llless N $ se Hypergeometrické rozdělení blíží Binomickému.

\begin{examp}[Poissonovo rozdělení]
	\ \begin{itemize}
		\item $ \fce \pois \lambda \sim X: \Omega \to \left\{ 0,1,\dots \right\} $,
		\item $ \fce P{X=k} = e^{-\lambda} \frac {\lambda^k}{k!} $,
		\item $ \E X = \lambda $,
		\item $ \var X = \lambda $,
	\end{itemize}
\end{examp}

Poissonovo rozdělení počítá aproximaci pro $ \fce{\bin}{n, \frac{\lambda}{n}} $ pokud $ n \to \infty $.

\subsection{Střední hodnota}

\begin{defi}[Střední hodnota]
	Nechť $ X $ je diskrétní náhodná veličina. Střední hodnota $ X $ je \[
		\E X \deq \sum_{x \in \rng X}^{} \fce{P}{X = x} \cdot x.
	\]
\end{defi}

\begin{cor}[]
	Nechť $ \Omega \mohle \N $. Pro $ X $ diskrétní náhodnou veličinu je \[
		\E X = \sum_{\omega \in \Omega}^{} \fce{X}{\omega} \fce{P}{\omega}.
	\]
\end{cor}

\begin{prop}[]
	Nechť $ g $ je funkce, $ X $ diskrétní náhodná veličina. 
	Pak $ g \po X $ je také diskrétní náhodná veličina.
\end{prop}

\begin{thm}[Pravidlo naivního statistika]
	Nechť $ g $ je funkce, $ X $ diskrétní náhodná veličina. Nechť $ Y \deq \fce{g}{X} $. Pak \[
		\E Y = \sum_{x \in \rng X}^{} \fce{g}{x} \fce{P}{X = x},
	\]
	pokud má suma smysl.
\end{thm}

\begin{thm}[Vlastnosti $ \E $]\label{thm:linearita n stuff}
	Nechť $ X,Y $ jsou diskrétní náhodné veličiny. Pak \begin{enumerate}
		\item $ \fce{P}{X \geq 0} = 1 \implies \E X \geq 0 $,
		\item $ \fce{P}{X \geq 0} = 1 \land \E X = 0 \implies \fce{P}{X = 0} = 1 $,
		\item $ \E X \geq 0 \implies \fce{P}{X \geq 0} > 0 $,
		\item $ \fce{\E}{aX + b} = a \E X + b $,
		\item $ \fce{\E}{X + Y} = \E X + \E Y $.
	\end{enumerate}
\end{thm}

\begin{defi}[Podmíněná střední hodnota]
	Nechť $ X $ je diskrétní náhodná veličina. Nechť $ \fce{P}{B} > 0 $. \emph{Podmíněná střední hodnota} je \[
		\fce{\E}{X \mid B} \deq \sum_{x \in \R}^{} x \fce{P}{X = x \mid B}.
	\]
\end{defi}

\begin{thm}[O rozboru případů]
	Pokud $ B_1, B_2, \dots, B_n $ tvoří $ \Omega $, pak \[
		\E X = \sum_{i: \fce{P}{B_i} > 0}^{} \fce{P}{B_i} \fce{\E}{X \mid B_i}.
	\]
\end{thm}

\begin{thm}[]
	Nechť $ X $ je diskrétní náhodná veličina, $ \rng X \subseteq \N_0 $. Pak \[
		\E X = \sum_{n = 0}^{\infty} \fce{P}{X > n}.
	\]
\end{thm}

\subsection{Rozptyl}

\begin{defi}[Rozptyl]
	Nechť $ X $ je diskrétní náhodná veličina.
	\emph{Rozptyl} na $ X $ je \[
		\var X \deq \fce{\E}{\left( X- \E X \right)^2}.
	\]
\end{defi}

\begin{thm}[]\label{thm:var jako soucet ctvercu}
	Nechť $ X $ je diskrétní náhodná veličina.
	Pak \[
		\var X = \fce{\E}{X^2} - \left( \E X \right)^2.
	\]
\end{thm}

\begin{cor}[]
	\[
		\fce{\E}{X^2} \geq \left( \E X \right)^2.
	\]
\end{cor}

\begin{cor}[]
	\[
		\var X = \fce{\E}{X \left( X-1 \right)} + \E X- \left( \E X \right)^2.
	\]
\end{cor}

\begin{prop}[]
	Nechť $ X $ je diskrétní náhodná veličina.
	Pak \[
		\var X = 0 \iff \fce{P}{X = \E X} = 1.
	\]
\end{prop}

\begin{thm}[]
	Nechť $ X $ je diskrétní náhodná veličina.
	Nechť $ a,b \in \R $.
	Pak \[
		\fce{\var}{aX + b} = a^2 \var X.
	\]
\end{thm}

\begin{defi}[Směrodatná odchylka]
	Nechť $ X $ je diskrétní náhodná veličina.
	Pak \emph{Směrodatná odchylka} je \[
		\sigma_X \deq \sqrt{\var X}.
	\]
\end{defi}

\subsection{Náhodné vektory}

\begin{defi}[Sdružená pravděpodobnostní funkce]
	Nechť $ X,Y $ jsou diskrétní náhodné veličiny.
	Pak \emph{sdružená pravděpodobnostní funkce} veličin $ X $ a $ Y $ je pro $ \left\{ X=x, Y=y \right\} \in \ff $ \[
		\fce{p_{X,Y}}{x,y} \deq \fce{P}{X = x \land Y = y}.
	\]
\end{defi}

\begin{thm}[O marginálních pravděpodobnostech]
	Nechť $ X,Y $ jsou diskrétní náhodné veličiny.
	Nechť $ p_{X,Y} $ je jejich sdružená pravděpodobnostní funkce.
	Pak \[
		\fce{p_X}{x} = \sum_{y \in \rng Y}^{} \fce{p_{X,Y}}{x,y}.
	\]
\end{thm}

\begin{note}[]
	Druhý směr neplatí, tj. z $ p_X $ a $ p_Y $ nelze obecně získat $ p_{X,Y} $, protože z nich nezjistíme vzájemný vztah hodnot jednotlivých diskrétních náhodných veličin.
	Ovšem tento směr funguje, pokud jsou $ X $ a $ Y $ nezávislé, protože tam \textquote{automaticky\footnote{Z definice nezávislosti.}} vztahy mezi hodnotami známe.
\end{note}


\begin{defi}[Nezávislost náhodných veličin]
	Diskrétní náhodné veličiny $ X_1, \dots, X_n $ jsou \emph{nezávislé} $ \equiv $ \[
		\left( \forall \vec x \in \prod_{i=1}^n \rng X_i \right)\! \Bigl( \left\{ X_1 = x_1 \right\}, \left\{ X_2 = x_2 \right\}, \dots, \left\{ X_n = x_n \right\} \text{ jsou nezávislé jevy.} \Bigr)
	\]
\end{defi}

\begin{prop}[]
	Pro nezávislé náhodné veličiny lze zjistit sdruženou funkci jako \[
		\fce {p_{X,Y}}{x,y} = \fce {p_X}x \fce {p_Y}y.
	\]
\end{prop}

\begin{examp}[]\label{multinomicke}
	Hodíme $ n $-krát kostkou, kdy $ p_i $ je pravděpodobnost, že padlo $ i $.
	Označme $ X_i \deq $ počet hodů, kdy padlo $ i $.
	Pak \[
		\fce P{X_1 = k_1 \land \dots \land X_6 = k_6} = \binom n{k_1,\dots,k_6} p_1^{k_1} \dots p_6^{k_6},
	\]
	kde $ \binom n{k_1, \dots, k_6} \deq \frac{n!}{k_1! \dots k_6!} $.
\end{examp}

Toto je tzv. \emph{multinomické rozdělení}.

\begin{prop}[]
	Nechť $ A \subseteq \R^2 $.
	Nechť $ X,Y $ jsou diskrétní náhodné veličiny.
	Pak \[
		\fce{P}{\left< X,Y \right> \in A} = \sum_{\left< x,y \right> \in A}^{} \fce{p_{X,Y}}{x,y}.
	\]
\end{prop}

\begin{defi}[Funkce náhodného vektoru]
	\emph{Funkce náhodného vektoru} $ X,Y $ je funkce \[
		g: \dom X \times \dom Y \to \R.
	\]
\end{defi}

\begin{thm}[]
	Nechť $ X,Y $ jsou diskrétní náhodné veličiny.
	Nechť $ g $ je funkce náhodného vektoru $ X,Y $.
	Pak $ Z = \fce g{X,Y} $ je diskrétní náhodná veličina a \[
		\fce{p_Z}{z} = \sum_{}^{} \left\{ \fce{p_{X,Y}}{x,y} \suchthat x \in \rng X \land y \in \rng Y \land \fce{g}{x,y} = z \right\}.
	\]
\end{thm}

\begin{cor}[Konvoluční vzorec]
	Nechť $ Z = X+Y $. Pak
	\[
		\fce {p_Z}z = \sum_{x \in \rng X} \fce {p_{X,Y}}{x,z-x}.
	\]
\end{cor}

\begin{thm}[Pravidlo naivního statistika]
	Nechť $ X,Y $ jsou diskrétní náhodné veličiny.
	Nechť $ g $ je funkce náhodného vektoru $ X,Y $. Pak \[
		\E \fce g{X,Y} = \sum_{x \in \rng X}^{} \sum_{y \in \rng Y}^{} \fce{g}{x,y} \fce{P}{X = x \land Y = y}.
	\]
\end{thm}

\begin{cor}[Linearita střední hodnoty]
	Pomocí předchozí věty lze dokázat linearitu střední hodnoty (\ref{thm:linearita n stuff}).
\end{cor}

\begin{cor}[]
	Nechť $ X,Y $ jsou \emph{nezávislé} diskrétní náhodné veličiny.
	Pak \[
		\fce{\E}{XY} = \E X \cdot \E Y.
	\]
\end{cor}

\begin{note}
	Dokonce platí $ \fce{\E}{\fce{f}{X} \fce{h}{Y}} = \fce{\E}{\fce{f}{X}} \fce{\E}{\fce{h}{Y}} $.
\end{note}

\begin{examp}[]
	Nechť $ X \sim \fce \bin {m,p}, Y \sim \fce \bin {n,p} $ jsou nezávislé.
	Pak $ X+Y \sim \fce \bin {n+m, p} $.
\end{examp}


\subsection{Kovariance}

Kovariance nám říká informaci o rozdělení dvou diskrétních náhodných veličin vůči sobě.
Vlastně spojuje informace, které jsou zakódované v pravděpodobnostním rozdělení těchto veličin.
Podobnou funkci má rozptyl na jednu náhodnou veličinu.

\begin{defi}[Kovariance]
	Nechť $ X,Y $ jsou diskrétní náhodné veličiny.
	Pak \emph{kovariance} $ X $ a $ Y $ je \[
		\fce{\cov}{X,Y} \deq \fce{\E}{\left( X - \E X \right) \left( Y - \E Y \right)}.
	\]
\end{defi}

\begin{prop}[]\
	\begin{enumerate}
		\item $ \fce{\cov}{X,X} = \var X $,
		\item pro $ X,Y $ nezávislé je $ \fce{\cov}{X,Y} = 0 $,
		\item $ \absolute{\fce{\cov}{X,Y}} \leq \sqrt{\var X \var Y} $, \footnote{Cauchyho nerovnost.}
		\item $ \fce{\cov}{X, aY+bZ+c} = a\fce{\cov}{X,Y} + b \fce{\cov}{X,Z} $.
	\end{enumerate}
\end{prop}

\begin{defi}[Korelace]
	Nechť $ X,Y $ jsou diskrétní náhodné veličiny.
	Jejich \emph{korelace} je \[
		\fce{\rho}{X,Y} = \frac{\fce{\cov}{X,Y}}{\sqrt{\var X \var Y}}.
	\]
\end{defi}

\begin{cor}[]
	Korelace je vždy mezi $ -1 $ a $ 1 $.
\end{cor}

\begin{thm}[]
	Nechť $ X,Y $ jsou diskrétní náhodné veličiny.
	Pak \[
		\fce{\cov}{X,Y} = \fce{\E}{XY} - \E X \cdot \E Y.
	\]
\end{thm}

\begin{thm}[]
	Nechť $ X_1, \dots, X_n $ jsou diskrétní náhodné veličiny.
	Pak \[
		\fce{\var}{\sum_i X_i} = \sum_{i,j}^{} \fce{\cov}{X_i, X_j}.
	\]

	Navíc, pokud jsou $ X_i $ nezávislé, pak \[
		\fce{\var}{\sum_i X_i} = \sum_{i}^{} \var X_i.
	\]
\end{thm}

\begin{defi}[Podmíněná pravděpodobnostní funkce]
	Nechť $ X $ je diskrétní náhodná veličina.
	Nechť $ A \subseteq \Omega $.
	Nechť $ x \in \R $.
	\emph{Podmíněná pravděpodobnostní funkce} je \[
		\fce{p_{X \mid A}}{x} \deq \fce{P}{X = x \mid A}.
	\]
	Nechť také $ Y $ je diskrétní náhodná veličina.
	Pak \[
		\fce{p_{X \mid Y}}{x \mid y} = \fce{P}{X=x \mid Y=y} = \frac{\fce{p_{X,Y}}{x,y}}{\fce{p_Y}{y}}.
	\]
\end{defi}

\section{Obecné náhodné veličiny}

\begin{defi}[Náhodná veličina]
	Nechť $ S = \left< \Omega, \ff, P \right> $ je pravděpodobnostní protor.
	Pak \emph{náhodná veličina} na pravd. prostoru $ S $ je \[
		X: \Omega \to \R,
	\]
	tž. $ \left( \forall x \in \R \right)\! \left( \left\{ X \leq x \right\} \deq \left\{ \omega \in \Omega \suchthat \fce{X}{\omega} \leq x \right\} \in \ff \right) $.

	Dále definujeme (kumulativní) distribuční funkci náhodné veličiny $ X $ jako \[
		\fce{F_X}{x} \deq \fce{P}{X \leq x}.
	\]
\end{defi}

\begin{thm}[Vlastnosti $ F_X $, bez Dk]\label{vlastnosti F_X}
	\
	\begin{enumerate}
		\item $ F_X $ je neklesající,
		\item $ \fce{F_X}{-\infty} \deq \lim_{x \to -\infty} \fce {F_X}x = 0 $,
		\item $ \fce{F_X}{\infty} \deq \lim_{x \to \infty} \fce {F_X}x = 1 $,
		\item $ F_X  $ je zprava spojitá: $ \fce{F_X}{x} = \lim_{y \to x+} \fce{F_X}{y} $.
	\end{enumerate}
\end{thm}

\begin{defi}[Spojitá náhodná veličina]
	Spojitá náhodná veličina $ X $ je taková náhodná veličina, že $ \left( \exists f_X: \R \to \R \right)\!  $ \[
		\fce{F_X}{x} = \int_{-\infty}^x \fce{f_X}{t} \dd t.
	\]
	Tato funkce $ f_X $ je \emph{hustota $ X $}.
\end{defi}

\begin{thm}[]
	Nechť $ X $ je spojitá náhodná veličina s hustotou $ f_X $.
	Pak \begin{enumerate}
		\item $ \left( \forall x \right)\! \left( \fce{P}{X = x} = 0 \right) $,
		\item $ \fce{P}{a \leq X \leq b} = \int_a^b \fce{f_X}{t} \dd t $.
	\end{enumerate}

	\begin{proof}
		Nechť $ B = \left\{ X \leq b \right\} $ a $ A = \left\{ X \leq a \right\} $.
		Pak $ \fce{P}{a < X \leq b} = \fce{P}{B \setminus A} = \fce{P}{B} - \fce{P}{A} = \int_{a}^b \fce{f_X}{t} \dd t $.

		Nyní, $ \lim_{\varepsilon \to 0} \fce{P}{x - \varepsilon < X \leq x} = 0 = \fce{P}{X = x} $.

		Navíc ale podle předchozího je nyní $ \fce{P}{X = a} = 0 $, tj. $  \fce{P}{a \leq X \leq b} = \fce{P}{a < X \leq b} = \int_{a}^b \fce{f_X}{t} \dd t $.
	\end{proof}
\end{thm}

Díky této větě je složité samplovat SNV, protože můžeme udělat jen konečně pozorování, a ty jsou diskrétní.

\begin{defi}[Střední hodnota spojité veličiny]
	Nechť $ X $ je spojitá náhodná veličina s hustotou $ f_X $.
	Pak \[
		\E X = \int_{-\infty}^{+\infty} x \fce{f_X}{x} \dd x,
	\]
	pokud má hodnota na pravo smysl.
\end{defi}

\begin{thm}[Pravidlo naivního statistika]
	Nechť $ X $ je spojitá náhodná veličina s hustotou $ f_X $.
	Pak \[
		\fce{\E}{\fce{g}{X}} = \int_{-\infty}^{+\infty} \fce{g}{x} \fce{f_X}{x} \dd x.
	\]
\end{thm}

\begin{defi}[Rozptyl]
	Nechť $ X $ je spojitá náhodná veličina s hustotou $ f_X $.
	Pak \emph{rozptyl} je \[
		\var X = \int_{-\infty}^{+\infty} \left( x - \E X \right)^2 \fce{f_X}{x} \dd x.
	\]
\end{defi}

\begin{cor}[Bez Dk]
	Věty o linearitě střední hodnoty (\ref{thm:linearita n stuff}) a úpravě rozptylu (\ref{thm:var jako soucet ctvercu}) platí i pro spojité náhodné veličiny.
\end{cor}

\begin{examp}[Uniformní rozdělení]
	Nechť $ X $ je spojitá náhodná veličina s hustotou $ f_X $.
	$ X $ má \emph{uniformní rozdělení na intervalu $ \left[ a,b \right] $}, $ X \sim \fce{U}{a,b} $ $ \equiv $ \[
		\fce{f_X}{x} = \begin{cases}
			\frac{1}{b-a} & \text{pro } x \in \left[ a,b \right], \\
			0             & \text{jinak.}
		\end{cases}
	\]
	Distribuční funkce $ X $ je pak \[
		\fce{F_X}{x} = \begin{cases}
			0               & \text{pro } x < a,                    \\
			\frac{x-a}{b-a} & \text{pro } x \in \left[ a,b \right], \\
			1               & \text{pro } x > b.
		\end{cases}
	\]
	Střední hodnota $ X $ je \[
		\E X = \frac{a+b}{2}.
	\]
	Rozptyl $ X $ je \[
		\var X = \frac{(b-a)^2}{12}.
	\]
\end{examp}

\begin{examp}[Exponenciální rozdělení]
	Nechť $ X $ je spojitá náhodná veličina s hustotou $ f_X $.
	$ X $ má \emph{exponenciální rozdělení}, $ X \sim \fce{\Exp}{\lambda} $ $ \equiv $ \[
		\fce{f_X}{x} = \begin{cases}
			\lambda e^{-\lambda x} & \text{pro } x \geq 0, \\
			0                      & \text{jinak.}
		\end{cases}
	\]
	Distribuční funkce $ X $ je pak \[
		\fce{F_X}{x} = \begin{cases}
			0                  & \text{pro } x < 0,    \\
			1 - e^{-\lambda x} & \text{pro } x \geq 0.
		\end{cases}
	\]
	Střední hodnota $ X $ je \[
		\E X = \frac{1}{\lambda}.
	\]
	Rozptyl $ X $ je \[
		\var X = \frac{1}{\lambda^2}.
	\]
\end{examp}

\begin{cor}[]
	Zaokrouhlením exponenciální náhodné veličiny vznikne geometricky-rozdělená diskrétní náhodná veličina.
\end{cor}

\begin{examp}[Standardní normální rozdělení]
	Nechť $ X $ je spojitá náhodná veličina s hustotou $ \varphi $ a distribuční funkcí $ \Phi $.
	$ X $ má \emph{standardní normální rozdělení}, $ X \sim \fce{N}{0,1} $ $ \equiv $ \[
		\fce{\varphi}{x} = \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}}.
	\]
	Střední hodnota $ X $ je \[
		\E X = 0.
	\]
	Rozptyl $ X $ je \[
		\var X = 1.
	\]
\end{examp}

\begin{examp}[Normální rozdělení]
	Nechť $ Z $ je spojitá náhodná veličina, $ Z \sim \fce{N}{0,1} $.
	Nechť $ \mu, \sigma \in \R $.
	Nechť $ X $ je spojitá náhodná veličina s hustotou $ f_X $.
	Pak $ X $ má \emph{normální rozdělení}, $ X \sim \fce{N}{\mu,\sigma^2} $ $ \equiv $ $ X = \mu + \sigma \cdot Z $, tedy \[
		\fce{f_X}{x} = \frac{1}{\sigma\sqrt{2\pi}} e^{-\frac{(x-\mu)^2}{2\sigma^2}} = \frac{1}{\sigma} \fce{\varphi}{\frac{x-\mu}{\sigma}}.
	\]
	Střední hodnota $ X $ je \[
		\E X = \mu.
	\]
	Rozptyl $ X $ je \[
		\var X = \sigma^2.
	\]
\end{examp}

Normální rozdělení je dobrá aproximace pro součet mnoha nezávislých náhodných proměnných.
Jeho zajímavá vlastnost je tzv. odolnost proti součtu.

\begin{prop}[]
	Nechť $ X_1 \dots, X_n \sim \fce{N}{0,1} $ jsou navzájem nezávislé spojité náhodné veličiny.
	Pak \[
		\sum_{i}^{}X_i \sim \fce{N}{\mu, \sigma^2},
	\]
	kde $ \mu = \sum_{i}^{}\mu_i $ a $ \sigma^2 = \sum_{i} \sigma^2_i $
\end{prop}

\begin{examp}[Cauchyho rozdělení]
	Nechť $ X $ je spojitá náhodná veličina, která má Cauchyho rozdělení.
	Pak hustota $ \fce{f}{x} = \frac{1}{\pi \left( 1+x \right)^2} $ a distribuční funkce je \[
		\fce{F}{X} = \int_{-\infty}^x \fce{f}{t} \dd t = \frac{1}{\pi} \arctan x + \frac{1}{2}.
	\]
\end{examp}

\begin{cor}[]
	Cauchyho rozdělení nemá střední hodnotu.
\end{cor}

\begin{thm}[]
	Nechť $ X $ je náhodná veličina.
	Nechť $ B_1, \dots \in \ff $, $ \Omega = \bigdisjcup_i B_i $.
	Pak \[
		\fce{F_X}{x} = \sum_{i}^{} \fce{P}{B_i} \fce{F_{X \mid B_i}}{x},
	\]
	kde $ \fce{F_{X \mid B_i}}{x} \deq \fce{P}{X \leq x \mid B_i} $.
\end{thm}

\begin{thm}[]
	Nechť $ X $ je spojitá náhodná veličina.
	Nechť $ B_1, \dots \in \ff $, $ \Omega = \bigdisjcup_i B_i $.
	Pak \[
		\fce{f_X}{x} = \sum_{i}^{} \fce{P}{B_i} \fce{f_{X \mid B_i}}{x},
	\]
	kde $ \int_{-\infty}^x\fce{f_{X \mid B_i}}{t} \dd t = \fce{P}{X \leq x \mid B_i} $.
\end{thm}

\begin{note}[]
	Náhodná veličina nemusí být ani spojitá ani diskrétní.
\end{note}

\begin{defi}[Smíšená náhodná veličina]
	Nechť $ X_1, \dots X_n $ jsou náhodné veličiny, $ X_i $ má rozdělení $ R_i $.
	Nechť $ X $ je náhodná veličina definovaná jako $ X = X_i $ s pravděpodobností $ p_i $, tž. $ \sum_{i} p_i = 1 $.
	Pak říkáme, že $ X $ je \emph{smíšená náhodá veličina} s rozdělením \[
		\mix {p_1, \dots, p_n} {R_1, \dots, R_n}.
	\]
\end{defi}

\begin{cor}[]
	Nechť $ X \sim \mix {p_1, \dots, p_n} {R_1, \dots, R_n} $.
	Pak \[
		\E X = \sum_{i=1}^{n} p_i \E X_i.
	\]
\end{cor}

\subsection{Kvantilová funkce}

\begin{defi}[Kvantilová funkce]\label{df:kvantilova funkce}
	Nechť $ X $ je náhodná veličina.
	\emph{Kvantilová funkce} je $ Q_X: \left( 0,1 \right) \to \R $, tž. \[
		\fce {Q_X}p \deq \fcec{\min}{x \in \R \suchthat p \leq \fce{F_X}{x}}.
	\]
\end{defi}

\begin{cor}[]
	Pokud $ F_X $ je spojitá a rostoucí, pak $ Q_X = F^{-1}_X $.
\end{cor}

\begin{cor}[] \label{kvantilova funkce iff}
	Obecně platí pro libovolnou $ X $: \[
		\fce{Q_X}{p} \leq x \iff p \leq \fce{F_X}{x}.
	\]
\end{cor}

\begin{notation}
	Nechť $ X $ je náhodná veličina. \begin{itemize}
		\item \emph{$ k $-tý kvartil} je $ \fce {Q_X}{\frac k4} $.
		\item \emph{$ k $-tý decil} je $ \fce {Q_X}{\frac k{10}} $.
		\item \emph{$ k $-tý percentil} je $ \fce {Q_X}{\frac k{100}} $.
		\item \emph{Medián} je $ \fce {Q_X}{\frac 12} $.
	\end{itemize}
\end{notation}

\begin{thm}[]
	Nechť $ X $ je spojitá náhodná veličina s rostoucí distribuční funkcí $ F_X $.
	Pak $ \fce{F_X}{X} \sim \fce{U}{0,1} $.
\end{thm}

\begin{thm}[]
	Nechť $ U \sim \fce{U}{0,1} $.
	Nechť $ F $ je funkce typu distribuční funkce (tj. splňující vlastnosti z \ref{vlastnosti F_X}).
	Nechť $ Q $ je odpovídající kvantilová funkce pro $ F $ podle \ref{df:kvantilova funkce}.
	Pak $ \fce QU $ je náhodná veličina s distribuční funkcí $ F $.
\end{thm}

\subsection{Náhodné vektory}

\begin{defi}[Sdružená distribuční funkce]
	Nechť $ X,Y $ jsou náhodné veličiny.
	Definujeme jejich \emph{sdruženou distribuční funkci} $ F_{X,Y} $ jako \[
		\fce{F_{X,Y}}{x,y} = \fce{P}{\left\{ \omega \in \Omega \suchthat \fce{X}{\omega} \leq x \land \fce{Y}{\omega} \leq y \right\}}.
	\]
\end{defi}

\begin{defi}[Sdružená hustota]
	Pokud existuje funkce $ f_{X,Y} $, pro kterou
	\[
		\fce{F_{X,Y}}{x,y} = \int_{-\infty}^x\int_{-\infty}^y \fce{f_{X,Y}}{t,u} \dd t \dd u,
	\]
	nazýváme ji \emph{sdružená hustota}.
\end{defi}

\begin{note}[]
	Identicky lze definovat i pro více náhodných veličin.
\end{note}

\begin{thm}[]
	Nechť $ X,Y $ jsou náhodné veličiny.
	Nechť $ F = F_{X,Y} $ je jejich sdružená distribuční funkce.
	Pak \[
		\fce{P}{X \in \left( a,b \right] \land Y \in \left( c,d \right]} = \fce{F}{b,d} - \fce{F}{a,d} - \fce{F}{b,c} + \fce{F}{a,c}.
	\]
\end{thm}

\begin{thm}[Pravidlo naivního statistika]
	Nechť $ X,Y $ jsou spojité náhodné veličiny.
	Pak platí \[
		\fce{\E}{\fce{g}{X,Y}} = \int_{-\infty}^{\infty}\int_{-\infty}^{\infty} \fce{g}{x,y} \fce{f_{X,Y}}{x,y} \dd x \dd y.
	\]
\end{thm}

\begin{thm}[Marginální hustota]
	Nechť $ X,Y $ jsou náhodné veličiny, $ f_{X,Y} $ jejich sdružená hustota.
	Pak \[
		\fce {f_X}x = \int_{-\infty}^\infty \fce {f_{X,Y}}{x,y} \dd y.
	\]
\end{thm}

\begin{defi}[Nezávislost]
	Nechť $ X,Y $ jsou náhodné veličiny.
	$ X,Y $ jsou \emph{nezávislé} $ \equiv $ jevy $ \left\{ X \leq x \right\} $ a $ \left\{ Y \leq y \right\} $ jsou nezávislé.
\end{defi}

\begin{cor}[]
	$ X,Y $ jsou nezávislé, právě když $ \fce {F_{X,Y}}{x,y} = \fce {F_X}x \fce {F_Y}y $.
\end{cor}


\begin{thm}[]
	Nechť $ X,Y $ jsou náhodné veličiny a existuje sdružená hustota $ f_{X,Y} $.
	Pak $ X $ a $ Y $ jsou nezávislé, právě když \[
		\fce{f_{X,Y}}{x,y} = \fce{f_X}{x} \fce{f_Y}{y}.
	\]
\end{thm}

\begin{defi}[Podmíněná hustota]
	Nechť $ X,Y $ jsou spojité náhodné veličiny.
	\emph{Podmíněná hustota $ X $ na $ Y $} je \[
		\fce{f_{X \mid Y}}{x \mid y} \deq \frac{\fce{f_{X,Y}}{x,y}}{\fce{f_Y}{y}},
	\]
	pokud $ \fce{f_Y}{y} > 0 $, jinak ji nedefinujeme.
\end{defi}

\begin{thm}[Konvoluce]
	Nechť $ X,Y $ jsou nezávislé náhodné veličiny s hustotami $ f_{X}, f_Y $.
	Pak $ Z = X+Y $ je také náhodná veličina s hustotou \[
		\fce{f_Z}{z} = \int_{-\infty}^{\infty} \fce{f_X}{x} \fce{f_Y}{z-x} \dd x.
	\]
\end{thm}

\begin{examp}[]
	Pomocí $ Z = \left< Z_1, \dots, Z_n \right> $, kde $ Z_i \sim \fce N{0,1} $ lze generovat uniformně náhodný vektor na $ n $-dimenzionálním kruhu jako \[
		\frac Z{\norm Z}.
	\]
\end{examp}

\begin{note}[Obecné vícerozměrné náhodné veličiny]
	Obecné vícerozměrné náhodné veličiny mají hustotu $ \fce ft = e^{-Q \left( t-\mu \right)} $, kde \begin{itemize}
		\item $ \mu \in \R^n $ je vektor \textquote{středu},
		\item $ Q $ je \emph{pozitivně semi-definitní matice}.
	\end{itemize}
\end{note}


\section{Nerovnosti}

\begin{thm}[Markovova nerovnost]
	Nechť $ X $ je náhodná veličina.
	Nechť $ X \geq 0 $.
	Nechť $ a \in \R^+ $.
	Pak \[
		\fce{P}{X \geq a} \leq \frac{\E X}{a}.
	\]
\end{thm}

\begin{thm}[Čebyševova nerovnost]
	Nechť $ X $ je náhodná veličina, která má střední hodnotu $ \mu $ a rozptyl $ \sigma^2 $.
	Nechť $ a \in \R^+ $.
	Pak \[
		\fce{P}{\absolute{X-\mu} \geq a \cdot \sigma} \leq \frac{1}{a^2}.
	\]
\end{thm}

\begin{thm}[Chernoffova nerovnost, bez Dk]
	Nechť $ \left( \forall i \in \range n \right)\! X_i $ jsou nezávislé náhodné veličiny nabývající hodnot $ \pm 1 $ s pravděpodobností $ \frac{1}{2} $.
	Nechť $ X = \sum_{i}^{}X_i $.
	Nechť $ t > 0 $.
	Pak \[
		\fce{P}{\absolute X \geq t} \leq e^{-t^2/2n}.
	\]
\end{thm}

\begin{defi}[Výběrový průměr]
	\emph{Výběrový průměr} náhodných veličin $ X_1, \dots, X_n $ je \[
		\vybPrum \deq \frac {X_1 + \dots + X_n}{n}.
	\]
\end{defi}

\begin{cor}[]
	Nechť $ X_1, \dots, X_n $ jsou nezávislé, stejně rozdělené, s průměrem $ \mu $ a rozptylem $ \sigma^2 $. Pak
	\[
		\E \vybPrum = \mu,\qquad \var \vybPrum = \frac {\sigma^2}n .
	\]
\end{cor}


\begin{thm}[Silný zákon velkých čísel]
	Nechť $ X_1, X_2, \dots $ jsou nezávislé náhodné veličiny se stejným rozdělením, střední hodnotou $ \mu $ a rozptylem $ \sigma^2 $.
	Pak platí \emph{skoro jistě} (tj. s pravděpodobností 1) \[
		\lim_{n \to \infty} \vybPrum = \mu.
	\]
\end{thm}

\begin{thm}[Slabý zákon velkých čísel]
	Nechť $ X_1, X_2, \dots $ jsou nezávislé náhodné veličiny se stejným rozdělením, střední hodnotou $ \mu $ a rozptylem $ \sigma^2 $.
	Pak $ \left( \forall \varepsilon > 0 \right)\!  $ \[
		\lim_{n \to \infty} \fce{P}{\absolute{\vybPrum - \mu} > \varepsilon} = 0.
	\]
	Říkáme, že $ \vybPrum $ konverguje k $ \mu $ \emph{v pravděpodobnosti}, $ \vybPrum \Pto \mu $.
\end{thm}

\begin{prop}[]
	Ve skutečnosti máme explicitní odhad: \[
		\fce{P}{\absolute{\vybPrum - \mu} > \varepsilon} \leq \frac{\sigma^2}{n\varepsilon^2}.
	\]
\end{prop}

\begin{thm}[Centrální limitní]
	Nechť $ X_1, X_2, \dots $ jsou nezávislé náhodné veličiny se stejným rozdělením, střední hodnotou $ \mu $ a rozptylem $ \sigma^2 $.
	Nechť $ F_n $ je distribuční funkce náhodné veličiny $ Y_n :$ \[
		Y_n \deq \frac{\left( \sum_{i \in \range n} X_i \right) - n \mu}{\sigma \sqrt n }.
	\]
	Pak \[
		\left( \forall x \right)\! \left( \lim_{n \to \infty} \fce {F_n} x = \fce \Phi x \right).
	\]
	Říkáme, že posloupnost $ Y_n $ konverguje k $ \fce N{0,1}  $ \emph{v distribuci}.
\end{thm}

\section{Statistika}

Zatím jsme studovali, co se stane -- jaká je pravděpodobnost nějakého jevu, v závislosti na daném modelu.
Statistika naopak bere data, která se stala, a snaží se zjistit informace o modelu, který je vytvořil.

\begin{note}[Druhy statistiky]
	\
	\begin{itemize}
		\item Explorační analýza dat -- popis.
		\item Matematická/inferenční -- prozkoumávání souvislostí.
	\end{itemize}
\end{note}

My se budeme zabývat inferenční statistikou.

\begin{note}[Úlohy inferenční statistiky]
	(Inferenční) statistika se zabývá \begin{itemize}
		\item \emph{bodovými odhady} -- odhadujeme hodnoty \textquote{v celé populaci},
		\item \emph{intervalovými odhady} -- hledáme interval, ve kterém daný parametr bude ležet s pstí $ x \% $,
		\item \emph{testováním hypotéz} -- zjišťujeme, zda data potvrzují, nebo vyvrací, naši hypotézu,
		\item \emph{regresí} -- hledáme vztahy mezi dvěma měřenými hodnotami.
	\end{itemize}
\end{note}

\begin{defi}[Náhodný výběr]
	\emph{Náhodný výběr s rozsahem $ n $} je posloupnost $ X_1, X_2, \dots, X_n $ nezávislých náhodných veličin se stejným rozdělením.
	Pokud distribuční funkce všech veličin náhodného výběru je $ F $, píšeme $ X_1, \dots, X_n \sim F $.
\end{defi}

\begin{defi}[Parametrický model]
	\emph{Parametrický model} je model, který má distribuční funkci $ F_\vartheta $, z množiny $ \left\{ F_\vartheta \suchthat \vartheta \in \Theta \right\} $.
	$ \vartheta $ je \emph{parametr}, a $ \Theta $ je množina \emph{možných hodnot parametru}.
\end{defi}

\begin{defi}[Statistika]
	\emph{Statistika} je libovolná funkce náhodného výběru.
\end{defi}

\subsection{Bodové odhady}
\def\supposing{;}
\def\psupposing#1#2#3{\fce {p_{#1}}{#3 \supposing #2}}
\def\fsupposing#1#2#3{\fce {f_{#1}}{#3 \supposing #2}}
\def\likelihood#1#2#3{\fce {L_{#1}}{#3 \supposing #2}}

\begin{defi}[Bodový odhad]
	\emph{Bodový odhad} je libovolná statistika $ \hat\Theta_n $.
\end{defi}

\begin{defi}[Vlastnosti bodového odhadu]
	Nechť $ X_1, \dots, X_n \sim F_\vartheta $ je náhodný výběr.
	Nechť $ g $ je funkce, kterou chceme aproximovat/zkoumat.
	Nechť $ \hat\Theta_n $ je bodový odhad $ g $.
	Pak $ \hat\Theta_n $ je \begin{enumerate}
		\item \emph{nevychýlený} $ \equiv $ $ \E \hat\Theta_n = \fce g\vartheta $,
		\item \emph{asymptoticky nevychýlený} $ \equiv $ $ \lim_{n \to \infty} \E \hat\Theta_n = \fce g\vartheta $,
		\item \emph{konzistentní} $ \equiv $ $ \hat\Theta_n \Pto \fce g\vartheta $.
	\end{enumerate}
\end{defi}

\begin{notation}[Bodové odhady]
	Značíme \begin{itemize}
		\item $ \vybPrum \deq \frac 1n \sum_{i=0}^n X_i $, výběrový průměr,
		\item $ \vybRozp \deq \frac 1{n-1} \sum_{i=0}^n \left( X_i - \vybPrum \right)^2 $, výběrový rozptyl.
	\end{itemize}
\end{notation}

\begin{prop}[]
	Nechť $ X_1, \dots, X_n $ je náhodný výběr.
	Pak \begin{itemize}
		\item $ \vybPrum $ je konzistentní, nevychýlený odhad $ \mu $,
		\item $ \vybRozp $ je konzistentní, nevychýlený odhad $ \sigma^2 $.
	\end{itemize}
\end{prop}

\begin{defi}[Střední kvadratická odchylka]
	MSE statistiky $ \hat\Theta_n $ aproximující $ g $ je \[
		\fce \mse {\hat\Theta_n} \deq \fce \E {\left( \hat\Theta_n - \fce g\vartheta \right)^2}
	\]
\end{defi}

\begin{defi}[Věrohodnost]
	Mějme nějaký náhodný výběr s parametrem $ \vartheta $ diskrétní náhodné veličiny.
	Nechť $ x $ je realizace výběru.
	Pak \[
		\psupposing X \vartheta x = \prod_{i=1}^n \psupposing {X_i} \vartheta {x_i}
	\]
	je sdružená pravděpodobnostní funkce výběru $ X = \left< X_1, \dots, X_n \right> $, za předpokladu, že parametr je $ \vartheta $.
	Pro spojité náhodné veličiny definujeme stejně sdruženou hustotu: \[
		\fsupposing X \vartheta x = \prod_{i=1}^n \fsupposing {X_i} \vartheta {x_i}.
	\]
	Abychom nemuseli rozlišovat tyto dva případy, definujeme \emph{věrohodnost/likelihood} jako \[
		\likelihood X\vartheta x.
	\]
\end{defi}

\begin{defi}[Metoda maximální věrohodnosti]
	Mějme náhodný výběr $ X $, jeho realizaci $ x $. Chceme určit parametr $ \vartheta $.
	Toho docílíme jako \[
		\vartheta^* = \argmax_{\vartheta} \likelihood X \vartheta x.
	\]
\end{defi}

\subsection{Intervalové odhady}

\begin{defi}[Intervalový odhad]
	Nechť $ T_1 \leq T_2 $ jsou dvě statistiky.
	$ T_1, T_2 $ určují \emph{intervalový odhad/konfidenční interval} $ \fce g\vartheta $ o spolehlivosti $ 1-\alpha $ $ \equiv $ \[
		\fce P{T_1 \leq \fce g\vartheta \leq T_2} \geq 1-\alpha.
	\]
\end{defi}

\begin{thm}[IO pro NNV]
	Nechť $ X_1, \dots, X_n $ je náhodný výběr z $ \fce N{\vartheta, \sigma^2} $.
	Nechť $ \sigma $ je známé.
	Nechť $ \alpha \in \left( 0,1 \right) $.
	Nechť navíc $ z_{\frac \alpha 2} $ je takové, že $ \fce \Phi {z_{\frac \alpha 2}} = 1- \frac \alpha 2 $.
	Označme \[
		C_n \deq \left[ \vybPrum - \delta, \vybPrum + \delta \right],\quad \delta =  z_{\frac \alpha 2}\cdot \frac\sigma {\sqrt n}.
	\]
	Pak \[
		\fce P{\vartheta \in C_n} = 1- \alpha.
	\]
\end{thm}

\begin{thm}[IO pomocí CLV]
	Nechť $ X_1, \dots, X_n $ je náhodný výběr se střední hodnotou $ \vartheta $ a se známým rozptylem $ \sigma^2 $.
	Nechť $ \alpha \in \left( 0,1 \right) $.
	Nechť navíc $ z_{\frac \alpha 2} $ je takové, že $ \fce \Phi {z_{\frac \alpha 2}} = 1- \frac \alpha 2 $.
	Označme \[
		C_n \deq \left[ \vybPrum - \delta, \vybPrum + \delta \right],\quad \delta =  z_{\frac \alpha 2}\cdot \frac \sigma {\sqrt n}.
	\]
	Pak \[
		\lim_{n \to \infty} \fce P{\vartheta \in C_n} = 1- \alpha.
	\]
\end{thm}

\begin{defi}[Studentovo rozdělení]
	Nechť $ X_1, \dots, X_n \sim \fce N{\vartheta, \sigma^2} $ jsou nezávislé náhodné veličiny.
	Pak \emph{Studentovo $ t $-rozdělení s $ n-1 $ stupni volnosti} je rozdělení náhodné veličiny \[
		\frac{\vybPrum - \mu}{\hat S_n \slash\sqrt{{n}}}.
	\]
	Jeho distribuční funkce se značí $ \Psi_{n-1} $.
\end{defi}

\begin{obs}[]
	Studentovo rozdělení nezávisí na rozdělení $ X_i $, jen na $ n $.
\end{obs}

\begin{thm}[]
	Nechť $ X_1, \dots, X_n \sim \fce N{\vartheta, \sigma^2} $ jsou nezávislé náhodné veličiny.
	Pak \[
		\lim_{n \to \infty} \Psi_{n-1} = \Phi.
	\]
\end{thm}

\begin{thm}[$ T $-test]
	Nechť $ X_1, \dots, X_n \sim \fce N{\mu, \sigma^2} $ je náhodný výběr.
	Nechť $ \vartheta = \left< \mu, \sigma \right> $, chceme ale zjistit jen $ \mu $.
	Mějme $ \alpha \in \left( 0,1 \right) $.
	Mějme navíc $ t_{\alpha \slash 2} $, tž. $ \fce {\Psi_{n-1}}{t_{\alpha \slash 2}} = 1- \frac \alpha2 $.
	Definujme interval \[
		C'_n \deq \left[ \vybPrum - \delta, \vybPrum + \delta \right] \qquad \delta = t_{\alpha \slash 2} \cdot \frac{\hat S_n}{\sqrt{n}}.
	\]
	Pak \[
		\fce P{\mu \in C'_n} = 1 - \alpha.
	\]
\end{thm}

\subsection{Testování hypotéz}

\begin{defi}[Hypotézy]
	\emph{Hypotéza} vyjadřuje, že platí nějaký model.
	Při testování hypotéz pak máme $ H_0, H_1 $, kde \begin{itemize}
		\item $ H_0 $ je \emph{nulová hypotéza}, značící konzervativní model, tj. výsledek, který by nás nepřekvapil,
		\item $ H_1 $ je \emph{alternativní hypotéza}, značící alternativní, zajímavý model.\footnote{Alternativních hypotéz může být více.}
	\end{itemize}
	Důležité je, že musí platit vždy právě jedna z hypotéz.
\end{defi}

\begin{defi}[Chyby]
	Rozlišujeme dva druhy chyb: \begin{itemize}
		\item \emph{chyba 1. druhu}: zamítneme $ H_0 $, přestože platí (\textquote{trapas}),
		\item \emph{chyba 2. druhu}: přijmeme $ H_0 $, přestože neplatí (\textquote{promarněná příležitost}).
	\end{itemize}
\end{defi}

\begin{algo}[Testování hypotéz]\ \\
	\AlgIn Hypotézy $ H_0, H_1 $.
	\begin{algorithmic}[1]
		\State Vybereme vhodný statistický model.
		\State Vybereme \emph{hladinu významnosti} $ \alpha \in \left( 0,1 \right) $. \Comment Pak budeme chtít $ \prt{chyba 1. druhu} = \alpha$
		\State Určíme \emph{testovou statistiku} $ T = \fce h{X_1, \dots, X_n}$.
		\State Určíme \emph{kritický obor} $ W \subseteq \rng T $, tj. množinu, pro kterou zamítneme $ H_0 $.
		\State Naměříme $ x_1, \dots, x_n $.
		\State Spočítáme $ t = \fce T{  x_1, \dots, x_n } $.
		\State Pokud $ t \in W $, zamítneme $ H_0 $, jinak ji přijmeme.
	\end{algorithmic}
	\AlgOut Odpověď, která hypotéza platí. \begin{itemize}
		\item $ \prt{chyba 1. druhu} = \alpha \deq \fce P{\fce TX \in W \suchthat H_0} $,
		\item $ \prt{chyba 2. druhu} = \beta \deq \fce P{\fce TX \notin W \suchthat H_1} $.
	\end{itemize}
\end{algo}

\begin{defi}[Síla testu]
	\emph{Síla testu} je $1-\beta.$
\end{defi}

\begin{defi}[$ p $-hodnota]
	Po provedení testování můžeme určit \emph{$ p $-hodnotu} jako \[
		p \deq \fce {\argmin_{\alpha \in \left( 0,1 \right)}}{\text{ s hladinou významnosti $ \alpha $ bychom $ H_0 $ zamítli }}.
	\]
\end{defi}

\begin{defi}[Testy podle počtu samplů]
	\
	\begin{itemize}
		\item 1-sample test: máme jeden náhodný výběr, testujeme jeho parametry.
		\item 2-sample test: máme dva náhodné výběry, testujeme podobnost mezi nimi.
	\end{itemize}
\end{defi}

\begin{examp}[1-sample]
	Nechť $ X_1, \dots, X_n \sim \fce N{\vartheta, \sigma^2} $ je náhodný výběr.
	Testujeme $ H_0: \vartheta = \mu $.
	To provedeme pomocí $ Z = \frac {\vybPrum - \mu}{\sigma \slash \sqrt n} $.
	Zvolíme $ W = \left\{ x \suchthat \absolute x > z_{\alpha \slash 2} \right\} $, kde $ z_{\alpha \slash 2} = \fce {\Phi^{-1}}{1- \frac \alpha2} $.
	Pak je pravděpodobnost chyby 1. druhu $ \alpha $.
\end{examp}

\begin{defi}[Testy podle předpokladů]
	Mějme $ X_1, \dots, X_n \sim \fce N{\vartheta, \sigma^2} $. Testujeme $ \vartheta $ pomocí Studentova rozdělení.
	\begin{itemize}
		\item Z-test: známe $ \sigma^2 $, testujeme $ \vartheta $.
		\item T-test: neznáme $ \sigma^2 $, pomůžeme si $ \vybRozp $.
	\end{itemize}
\end{defi}

\begin{examp}[2-sample, Z-test]
	Mějme $ X_1, \dots X_n \sim \fce N{\vartheta_X, \sigma^2} $,
	$ Y_1, \dots Y_m \sim \fce N{\vartheta_Y, \sigma^2} $.
	Testujeme $ H_0: \vartheta_X = \vartheta_Y $.
	To provedeme pomocí \[
		Z = \frac {\vybPrum - \overline Y_m}{\sigma \sqrt {\frac 1n + \frac 1m}}.
	\]
	Zvolíme $ W = \left\{ x \suchthat \absolute x > z_{\alpha \slash 2} \right\} $, kde $ z_{\alpha \slash 2} = \fce {\Phi^{-1}}{1- \frac \alpha2} $.
\end{examp}

\begin{examp}[1-sample, T-test]
	Nechť $ X_1, \dots, X_n \sim \fce N{\vartheta, \vartheta_\sigma^2} $ je náhodný výběr.
	Testujeme $ H_0: \vartheta = \mu $.
	To provedeme pomocí \[
		T = \frac {\vybPrum - \mu}{\hat S_n \slash \sqrt n}.
	\]
	Zvolíme $ W = \left\{ x \suchthat \absolute x > t_{\alpha \slash 2} \right\} $, kde $ t_{\alpha \slash 2} = \fce {\Psi_{n-1}^{-1}}{1- \frac \alpha2} $.
	Pak je pravděpodobnost chyby 1. druhu $ \alpha $.
\end{examp}

\begin{defi}[]
	Mějme $ p_1, \dots, p_k \geq 0 $, tž. $ \sum_i p_i = 1 $.
	Opakuji $ n $-krát pokus s $ k $ možnostmi, každá má pravděpodobnost $ p_i $.
	Označím $ X_i \deq \# i. $
	Pak $ \left( X_1, \dots, X_k \right) $ má \emph{multinomické rozdělení} (\ref{multinomicke}) s parametry $ n, \left( p_1, \dots, p_k \right) $.
\end{defi}

\begin{prop}[]
	Víme, že \[
		\fce P{X_1 = x_1, X_2 = x_2, \dots, X_k = x_k} = \binom n{x_1, \dots, x_k} p_1^{x_1} \dots p_k^{x_k}.
	\]
\end{prop}

\begin{defi}[Test dobré shody]
	Při \emph{testu dobré shody} jsou pravděpodobnosti $ p_i $ neznámé, určujeme $ \vartheta = \left( \vartheta_1, \dots, \vartheta_k \right) $.
	Předpokládáme hodnotu $ \vartheta^* $, testujeme hypotézu $ H_0: \vartheta = \vartheta^* $.
\end{defi}

\begin{defi}[Test podílem věrohodnosti, G-test]
	Mějme $ \vartheta $ s maximální věrohodností, $ \vartheta^* $ je z $ H_0 $.
	\emph{Test podílem věrohodnosti} je test dobré shody porovnáním věrohodností.
	Speciálně chceme posuzovat podíl $ \likelihood X\vartheta x \slash \likelihood X{\vartheta^*}x $.
	Z technických důvodů upravíme na \[
		G = 2 \log \frac {\likelihood X\vartheta x}{\likelihood X{\vartheta^*}x}.
	\]
\end{defi}

\begin{examp}[G-test pro multinomické rozdělení]
	Mějme multinomické rozdělení.
	Pak \[
		G = 2 \log \prod_{i=1}^k \frac {\left( x_i \slash n \right)^{x_i}}{\left( \vartheta_i^* \right)^{x_i}} = 2 \sum_{i=1}^k x_i \log \frac {x_i}{n\vartheta^*_i}.
	\]
	Přeznačíme na $ G = 2 \sum_{i=1}^k O_i \log \frac {O_i}{E_i} $.
\end{examp}

\begin{examp}[$ \chi^2 $-test pro multinomické rozdělení]
	Mějme multinomické rozdělení.
	$ \chi^2 $ je aproximace $ G $ pomocí Taylora.
	Pak \[
		G \doteq \chi^2 = \sum_{i=1}^k \frac {\left( E_i - O_i \right)^2}{E_i}.
	\]
\end{examp}

\begin{cor}[Zvolení kritického oboru]
	Opět chceme najít $ \gamma $ tak, aby $ \fce P{T >\gamma \supposing H_0} = \alpha $ pro zvolené $ \alpha $.
	To můžeme udělat buď exaktně, nebo pomocí tzv. $ \chi $-kvadrát rozdělení.

	$ \chi $-kvadrát rozdělení s $ k-1 $ stupni volnosti je rozdělení veličiny \[
		Q = Z_1^2 + \dots + Z_{k-1}^2,
	\]
	kde $ Z_i $ mají rozdělení $ \fce N{0,1} $.
	Pro velká $ n $ je rozdělení statistiky $ \chi^2 $ blízké rozdělení $ Q $.
	Můžeme tedy zvolit $ \gamma = \fce {Q_Q}{1-\alpha} $.
\end{cor}

\subsection{Regrese}

\begin{defi}[Lineární regrese]
	Hledáme $ a,b $ parametry funkce $ \fce fx = ax+b $, tž. pro náhodný výběr $ X $, tž. $ X_i = \left< x_i, y_i \right> $ je minimální \[
		\fce \mse{y, \fce fx}.
	\]
\end{defi}

\begin{note}[]
	Lineární regresi lze použít buď na tvorbu modelu, nebo na otestování závislosti.
\end{note}

\begin{note}
	MSE se používá hlavně proto, že se s ní dobře hledá minimum.
\end{note}

\subsection{Neparametrická statistika}

\begin{defi}[Empirická distribuční funkce]
	\emph{Empirická distribuční funkce} náhodného výběru $ X $ je \[
		\fce {\hat F_n}x = \frac{\absolute{\left\{ i \suchthat X_i \leq x \right\}}}n.
	\]
\end{defi}

EDF se hodí, když nevíme, jaké rozdělení máme zvolit.
Také se pomocí EDF dá testovat, že předpokládáme správné rozdělení.

\begin{thm}[]
	Nechť $ \E X_i $ je konečná $ \forall i $.
	Definujeme $ \varepsilon \deq \sqrt{\frac 1{2n} \log \frac 2\alpha} $.
	Pak \[
		\fce P{\fce {\hat F_n}x - \varepsilon \leq \fce Fx \leq \fce{\hat F_n}x +\varepsilon} \geq 1-\alpha.
	\]
\end{thm}

\subsection{Přístupy statistiky}

\emph{Frekventistická statistika} vnímá pravděpodobnost jako objektivní vlastnost světa, parametry jsou neznámé konstanty.

\emph{Bayesovská statistika} vnímá pravděpodobnost jako míru důvěry v něco, např. i v parametry modelu.
V Bayesovské statistice se tedy počítá i s parametry modelu jako s náhodnými veličinami, pracuje se pak s jejich distribucí atd.

\subsection{Generování náhodných veličin}

\begin{algo}[Rejection Sampling]\ \\
	\AlgIn hustota $ f $, kterou chceme, $ g $, kterou umíme; $ c: \left( \forall x \right)\! \left( \fce fx \leq c \fce gx \right) $.
	\begin{algorithmic}[1]
		\Indent Opakujeme:
		\State $ x \gets $ náhodná hodnota s hustotou $ g $.
		\State $ u \gets $ náhodná hodnota s $\fce U{0,1} $.
		\State Pokud $ u \cdot c \cdot \fce gx \leq \fce fx $, vrátíme $ x $.
		\EndIndent

	\end{algorithmic}
	\AlgOut $ x $ s hustotou $ f $.
\end{algo}

\end{document                </a></li>

<li><a href="https://gitlab.mff.cuni.cz/uradnikf/bc_lec/-/raw/master/2223l/neproc/main.pdf">Neprocedurální programování}
\author{Filip Úradník}
\date{\today}

\input{template}
\input{czech_c}

\def\plp{\;\texttt{:\!-}\;}
\def\pld{\texttt{.}}


\begin{document}
\maketitle
% moodle (5223)
% zápočet potřeba na zkoušku
% zápočtový program

\begin{defi}[Neprocedurální programování]
  Nemá přiřazovací příkaz.
\end{defi}

\begin{defi}[Přístupy]
  \
  \begin{itemize}
    \item \textit{logické} -- řešení pomocí matematické logiky,
    \item \textit{funkcionární} -- řešení pomocí funkcí v matematickém smyslu -- bez vedlejších efektů.
  \end{itemize}
  
\end{defi}

\section{Logické programování}

\begin{defi}[Prolog]
  Interpretovaný jazyk založený na Hornovských formulích.

  Program složen z klauzulí končících tečkou. Klauzule mohou být \begin{itemize}
    \item \textit{fakta}: term ukončený tečkou,
    \item \textit{procedury}: posloupnost klauzulí se stejným hlavním funktorem.
  \end{itemize}
  
  Pro výuku je určen \textit{SWI Prolog}.
\end{defi}

\begin{defi}[Warren Abstract Machine]
  Abstraktní stroj definován architekturou paměti a  % TODO: implement later.
\end{defi}

\begin{defi}[Term]
  Term může být \begin{itemize}
    \item \textit{konstanta}, neboli atom,
    \item \textit{funktory} určeny jménem a aritou.
  \end{itemize}
\end{defi}

\begin{defi}[Predikát]
  Funkce vracející hodnotu \verb+bool+.
\end{defi}

\begin{defi}[Dotaz]
  Dotaz je konjungce predikátů, může mít proměnnou, ta pak začíná velkým
  písmenem. Proměnná může být anonymní, \verb+_+. 
\end{defi}

\begin{defi}[Unifikace]
  Základní operace na termech. Dva termy lze unifikovat $ \equiv $ \begin{itemize}
    \item jsou \emph{identické}, nebo
    \item existuje vhodná \emph{substituce}, která je unifikuje.
  \end{itemize}
  
  V prologu existuje operátor neunifikovatelnosti \verb+\=+.
\end{defi}

\begin{algo}[Splňování cíle]\ \\
\emph{Vstup:} program $ P = \left\{ S_i \right\}_i $, seznam klauzulí; cíle $ \left\{ C_j \right\}_j $.
\begin{algorithmic}[1]
  \State Pokud je seznam cílů prázdný, vrátíme \emph{ano}.
  \State $ C \gets C_1 $
  \Indent Dokud $ P $ obsahuje nepoužité $ S_i $:
    \State $S = H \plp T_1, \dots, T_n \gets S_i $, první zatím nepoužitá klauzule. 
    \State Přejmenujeme všechny proměnné v $ S $.
    \Indent Pokud $ \exists \pi $ unifikace $ H $ a $ C $:
      \State $ N \gets \left\{ \fce{\pi}{T_j} \right\}_j \cup \left\{ \fce{\pi}{C_i} \right\}_{i > 1} $
      \State Pokud $ \algorithm{Splňování cíle}{P, N} $ vrátí \emph{ano}, vrátíme \emph{ano}.
    \EndIndent
  \EndIndent
  \State Vrátíme \emph{ne}.
  
\end{algorithmic}
\emph{Výstup:} \emph{ano/ne} jestli lze cíle splnit.
\end{algo}

V Prologu používáme \emph{pravidla}, která mají význam formulí: 

\begin{defi}[Pravidlo]
  Pravidlo $ p \plp \varphi \pld $ je vyjádření skutečnosti, že platí formule $ \varphi \to p $, pro $ p $ term a $ \varphi $ výrok složený z konjungcí pomocí \verb+,+ a disjunkcí pomocí \verb+;+.
\end{defi}

Splňování cíle toto chápe jako \textquote{ke splnění $ p $ je ještě potřeba splnit všechno z $ \varphi $}.
Pravidla tedy mohou korektně logicky popisovat skutečnosti, ale algoritmus splňování cíle nedoběhne..

\begin{defi}[Správnost programu]
  Program je \begin{itemize}
    \item správný \emph{deklarativně} $ \equiv $ nemůže dát nesprávný výsledek, ovšem může se zacyklit,
    \item správný \emph{procedurálně} $ \equiv $ dá správný výsledek a vždy skončí (při správném použití).
  \end{itemize}
  
\end{defi}

\subsection{Výpočet}

\begin{defi}[Strukturální rekurze]
  \emph{Strukturální rekurze} je rekurzivní definice řízena strukturou
  argumentů.
\end{defi}

\begin{defi}[Koncová rekurze]
  \emph{Koncová rekurze} je rekurzivní procedura, která má rekurzivní krok jako
  poslední a celá procedura je deterministická. Taková rekurze je efektivní a
  lze ji převést na iteraci.
\end{defi}

\begin{defi}[Směr výpočtu]
  \emph{Směr výpočtu} je konvence, která určuje, jaké argumenty by pro
  zachování efektivity výpočtu měly být \begin{itemize}
    \item \emph{+} $ \equiv $ vstupní,
    \item \emph{--} $ \equiv $ výstupní,
    \item \emph{?} $ \equiv $ vstupní nebo výstupní.
  \end{itemize}
\end{defi}

\begin{defi}[Determinismus]
  Procedura v Prologu může být \begin{itemize}
    \item \emph{deterministická} $ \equiv $ při neúspěchu není nutný návrat,
    \item \emph{nedeterministická} $ \equiv $ program si může
      \textquote{vybrat}, což může někdy selhat.
  \end{itemize}
\end{defi}

\begin{defi}[Seznam]
  \emph{Seznam} je definován \emph{hlavou} a \emph{tělem}, což může být další seznam.
\end{defi}

Řez se například dá použít na vynucení determinismu predikátu.

\begin{defi}[Neúplně definovaná DS]
  NDDS je DS, která obsahuje volné proměnné.
\end{defi}

\begin{examp}[Rozdílový seznam]
  Rozdílový seznam je \texttt{[a,b,c|S]}. Lze použít na zřetězení v $
  \fce{\O}{1} $: \texttt{zretez(A-B, B-C, A-C).}. Použití:
  \texttt{zretez([a,b,c|S]-S, [d,e|T]-T, Z).}.

  Obyčejný seznam lze na rozdílový převést rekurzivně, ovšem v $ \fce{\O}{n} $,
  proto se často vyplatí používat od začátku rozdílové. Pomocí RS lze například
  zefektivnit Quicksort.
\end{examp}

\begin{defi}[Řez]
  \emph{Řez} je nulární predikát \texttt{!}, který vždy uspěje, ale pokud
  nějaká klauzule za ním selže, způsobí okamžité selhání splňovaného cíle.
  Řez je \begin{itemize}
    \item \emph{červený} $ \equiv $ mění deklarativní význam programu,
    \item \emph{zelený} $ \equiv $ mění jen procedurální význam programu -- osekává větve.
  \end{itemize}
\end{defi}

\begin{defi}[Negace]
  Negace je \texttt{$ \backslash $+}, dá se implementovat pomocí \texttt{not(X)\plp{}C, !, \emph{fail}.}.

  Negace v prologu neodpovídá negaci v matematice. Říká jen, že se negovaný
  výrok nedá splnit. \textquote{Předpoklad uzavřeného světa}.
\end{defi}

\begin{defi}[Větvení]
  Řez se také dá použít na \textquote{větvení}: \texttt{test, !, telo.}. Další
  použití řezu jsou \textquote{cykly}: \texttt{forall(Podminka, Cil)}, a
  opravdové podmínky: \texttt{If -> Then ; Else}.
\end{defi}

\begin{defi}[Aritmetika]
  Aritmetické výrazy jsou v Prologu řešeny pomocí operátoru \texttt{is}.
  Porovnání na rovnost/nerovnost je řešeno přes \texttt{=:=}, resp.
  \texttt{=/=}.
\end{defi}

\begin{defi}[Testování typu]
  Predikáty \texttt{var, atom, atomic, int, float,}...
\end{defi}


\begin{defi}[Rozbor termu]
  Operátor \texttt{univ}, definován jako \texttt{T $ \backslash $.. [X|Y]}, pak
  bude mít \texttt{X} hlavní funktor a \texttt{Y} seznam argumentů termu
  \texttt{T}.
\end{defi}

\begin{defi}[Shromáždění výsledků]
  Pomocí predikátů \texttt{bagof}, \texttt{setof}, \texttt{findall}.
\end{defi}

\end{document                </a></li>

<li><a href="https://gitlab.mff.cuni.cz/uradnikf/bc_lec/-/raw/master/2223l/linpr/main.pdf">Lineární programování a kombinatorická optimalizace}
\author{Filip Úradník}
\date{\today}

\input{template}
\input{color}
\input{czech}

\DeclareMathOperator\aff{aff}
\DeclareMathOperator\ext{ext}
\DeclareMathOperator\conv{conv}

\begin{document}
\maketitle

\section{Úvod}

\begin{defi}[Optimalizační problém]
	\textit{Optimalizační problém} je čtveřice \begin{itemize}
		\item \textit{instancí}, tedy vstupů,
		\item \textit{přístupných řešení}, tedy výstupů,
		\item \textit{účelové funkce},
		\item \textit{zadání} maximalizovat/minimalizovat.
	\end{itemize}
\end{defi}

\begin{defi}[Úloha LP v kanonickém tvaru]
	\textit{Úloha lineárního programu} v \textit{kanonickém tvaru} je je dána \begin{itemize}
		\item maticí $ A \in \R^{m \times n} $,
		\item vektorem $ b \in \R^m $,
		\item vektorem $ c \in \R^n $ udávajícím účelovou funkci $ c^Tx $.
	\end{itemize}

	Cílem je maximalizovat $ c^Tx $ přes $ x \in \R^n $, aby $ Ax \leq b $.
\end{defi}

\begin{defi}[Úloha LP v rovnicovém tvaru]
	\textit{Úloha lineárního programu} v \textit{rovnicovém tvaru} je je dána \begin{itemize}
		\item maticí $ A \in \R^{m \times n} $,
		\item vektorem $ b \in \R^m $,
		\item vektorem $ c \in \R^n $ udávajícím účelovou funkci $ c^Tx $.
	\end{itemize}

	Cílem je maximalizovat $ c^Tx $ přes $ x \in \left( \R^+_0 \right)^n $, aby $ Ax = b $.
\end{defi}

\begin{defi}[Vlastnosti úlohy]
	Úloha lineárního programu je \begin{itemize}
		\item \textit{nepřípustná} $ \equiv $ neexistuje přípustné $ x $,
		\item \textit{neomezená} $ \equiv $ neexistuje optimální $ x $, funkce $ c^Tx $ je neomezená.
	\end{itemize}

	Jinak může mít jedno či více optimálních řešení.
\end{defi}

\begin{defi}[Úloha celočíselného LP]
	\textit{Úloha celočíselného LP} je úloha LP s podmínkou na $ x \in \Z^n $. Do
	celočíselného LP lze převést NP-těžké problémy, nejsou tedy efektivně
	řešitelné.
\end{defi}

\subsection{Převody}

\begin{algo}
	Mějme rovnici $ Ax = b $. Odpovídající nerovnice je \[
		\begin{pmatrix}
			A \\ -A
		\end{pmatrix}
		x  \leq \begin{pmatrix}
			b \\ -b
		\end{pmatrix}.
	\]
\end{algo}

\begin{algo}
	Mějme nerovnici $ Ax \leq b $. Odpovídající rovnice je \[
		Ax + z = b,
	\]
	kde $ z \geq 0 $.
\end{algo}

\begin{algo}
	$ x \geq 0 $ je ekvivalentní $ x \in \R $, s podmínkami $ x \geq 0 $.
\end{algo}

\begin{algo}
	$ x \in \R $ je ekvivalentní $ x^+, x^- \geq 0 $.
\end{algo}

\begin{examp}[Nejkratší cesta]\ \\
	\textit{Vstup:} orientovaný $ G = \left( V, E \right) $, $ s,t \in V $, $ c: E \to \R $.
	\begin{itemize}
		\item cíl: $ \fce{\min}{\sum_{e \in E}^{}x_ec_e} $,
		\item proměnné: $ x_e = 1 \leftrightarrow e \in E $, $ x_e = 0 \leftrightarrow e \notin E $,
		\item podmínky: $ \forall v \in V:  $ \[
			      \sum_{vu \in E}^{} x_{vu} - \sum_{uv \in E}^{}x_{uv} = \begin{cases}
				      1  & v = t         \\
				      -1 & v = s         \\
				      0  & \text{jinak.}
			      \end{cases}
		      \]
	\end{itemize}
	\textit{Výstup:} lineární program řešící nejkratší cestu.
\end{examp}

\begin{examp}[Nejkratší cesta]\ \\
	\textit{Vstup:} orientovaný $ G = \left( V, E \right) $, $ s,t \in V $, $ c: E \to \R $. \begin{itemize}
		\item cíl: $ \fce{\max}{y_i - y_s} $,
		\item proměnné: $ y_i \in \R $,
		\item podmínky: $ \forall uv \in \E: y_v - y_u \leq c_{uv} $.
	\end{itemize}
	\textit{Výstup:} lineární program řešící nejkratší cestu.
\end{examp}

\begin{examp}[Dopravní problém]\ \\
	\textit{Vstup:} orientovaný bipartitní $ G = \left( A \cup B, E \right) $, $
		A $ jsou zdroje, $ B $ cíle, $ c: E \to \R $ cena přepravy, $ a_i $ kapacity,
	$ b_j $ požadavky. \begin{itemize}
		\item cíl: $ \fce{\max}{\sum_{ij}^{}c_{ij}x_{ij}} $,
		\item proměnné: $ x_i \in \R $,
		\item podmínky: \begin{itemize}
			      \item $ x_{ij} \geq 0 $,
			      \item $ \forall j \in A: \sum_{j}^{} x_{ij} \leq a_i $,
			      \item $ \forall i \in B: \sum_{i}^{} x_{ij} \geq b_j $,
		      \end{itemize}
	\end{itemize}
	\textit{Výstup:} lineární program řešící nejkratší cestu.
\end{examp}

\begin{examp}[Perfektní párování minimální ceny v bipartitním $ G $]\ \\
	\textit{Vstup:} orientovaný bipartitní $ G = \left( A \cup B, E \right) $, $
		\absolute{A} = \absolute{B} = n $, $ c: E \to \R^+_0 $. \begin{itemize}
		\item cíl: $ \fce{\min}{\sum_{ij}^{}c_{ij}x_{ij}} $,
		\item proměnné: $ \left( \forall e \in \E \right)\!\left( x_e \in \left\{ 0,1 \right\} \right) $,
		\item podmínky: \begin{itemize}
			      \item $ \left( \forall a \in A \right)\!\left( \sum_{b}^{}x_{ab} = 1 \right)  $,
			      \item $ \left( \forall b \in B \right)\!\left( \sum_{a}^{}x_{ab} = 1 \right)  $.
		      \end{itemize}
	\end{itemize}
	\textit{Výstup:} celočíselný program na perfektní párování.
\end{examp}

\begin{examp}[Perfektní párování minimální ceny v bipartitním $ G $]\label{examp bip g lp}\ \\
	\textit{Vstup:} orientovaný bipartitní $ G = \left( A \cup B, E \right) $, $
		\absolute{A} = \absolute{B} = n $, $ c: E \to \R^+_0 $. \begin{itemize}
		\item cíl: $ \fce{\min}{\sum_{ij}^{}c_{ij}x_{ij}} $,
		\item proměnné: $ x \in \left( \R^+_0 \right)^m $,
		\item podmínky: \begin{itemize}
			      \item $ \left( \forall a \in A \right)\!\left( \sum_{b}^{}x_{ab} = 1 \right)  $,
			      \item $ \left( \forall b \in B \right)\!\left( \sum_{a}^{}x_{ab} = 1 \right)  $.
		      \end{itemize}
	\end{itemize}
	\textit{Výstup:} lineární program na perfektní párování s neceločíselnými řešeními.
\end{examp}

\begin{thm}[Existence celočíselného optima]
	Mějme optimum z \ref{examp bip g lp}. Pak existuje celočíselné řešení se stejným optimem.
\end{thm}

\section{Afinní prostory, konvexní množiny a mnohostěny}

\subsection{Afinní prostory}


\begin{defi}[Afinní prostor]
	Množina $ L \subseteq \R^n $ je \emph{Afinní prostor} $ \equiv $ $ L = \vec x + V $ pro $ x \in \R^n $ a $ V $ vektorový prostor.
\end{defi}

\begin{defi}[Dimenze afinního prostoru]
	\emph{Dimenze} $ L $ je $ \dim L \deq \dim V $. Zvlášť definujeme $ \dim \emptyset \deq -1 $.
\end{defi}

\begin{defi}[Afinní obal]
	\emph{Afinní obal} množiny $ X $ je $ \aff X \deq \bigcap \left\{ L \suchthat X \subseteq L \land L \text{ je afinní prostor} \right\} $.
\end{defi}

\begin{defi}[Afinní kombinace]
	\emph{Afinní kombinace} bodů z $ X $ je \[
		\sum_{i}^{} x_i \alpha_i ;\; \sum_{i}^{} \alpha_i = 1 \land \forall i: x_i \in X.
	\]
\end{defi}

\begin{thm}[]
	Afinní obal množiny $ X $ je \emph{afinním prostorem} a je roven množině afinních kombinací bodů z $ X $, tj \[
		\aff X = \left\{ \sum_{i}^{} x_i \alpha_i \suchthat \sum_{i}^{} \alpha_i = 1 \land \alpha_i \geq 0 \land \forall i: x_i \in X \right\}.
	\]
\end{thm}

\begin{defi}[Afinní nezávislost]
	Body $ x_1, \dots, x_k$ jsou \emph{afinně nezávislé} $ \equiv $ $ \forall \alpha_1, \dots, \alpha_k \in \R: $\[
		\left( \sum_{i}^{}\alpha_i x_i = 0 \land \sum_{i}^{}\alpha_i = 0 \right) \to \left( \forall i \right)\! \left( \alpha_i = 0 \right).
	\]
\end{defi}

\begin{obs}[]
	$ x_0, \dots, x_k $ jsou afinně nezávislé $ \leftrightarrow $ $ \left( x_1 - x_0 \right), \left( x_2 - x_0 \right), \dots \left( x_k - x_0 \right) $ jsou lineárně nezávislé.
\end{obs}


\begin{defi}[Dimenze množiny]
	\emph{Dimenze} množiny $ X $ je $ \dim X \deq \dim \aff X $.
\end{defi}

\begin{obs}[]
	$ \dim X = k \leftrightarrow $ maximální počet afinně nezávislých bodů v $ X $ je roven $ k+1 $.
\end{obs}

\subsection{Konvexní množiny}

\begin{defi}[Konvexní množina]
	Množina $ X $ je \emph{konvexní množina} $ \equiv $ \[
		\left( \forall x,y \in X \right)\! \left( \forall t \in \left[ 0,1 \right] \right)\! \left( tx + \left( 1-t \right)y \in X \right).
	\]
\end{defi}

\begin{defi}[Konvexní obal]
	$ \conv X $ je \emph{konvexní obal} množiny $ X $ $ \equiv $ \[
		\conv X \deq \bigcap \left\{ C \suchthat X \subseteq C \land C \text{ je konvexní} \right\}.
	\]
\end{defi}

\begin{defi}[Konvexní kombinace]
	\emph{konvexní kombinace} bodů z $ X $ je $ \sum_{i}^{} \alpha_i x_i $ $ \equiv  $ \[
		\sum_{i}^{} \alpha_i = 1 \land \left( \forall i \right)\! \left( \alpha_i \in \left[ 0,1 \right] \right) \land  \left( \forall i \right)\!  \left( x_i \in X \right).
	\]
\end{defi}

\begin{prop}[]
	Nechť $ Y \subseteq \conv X $. Pak $ \conv Y \subseteq \conv X $.
\end{prop}

\begin{prop}[]
	Nechť $ C $ je konvexní a $ X \subseteq C $. Pak $ \conv X \subseteq C $.
\end{prop}

\begin{prop}[]
	Nechť $ \left( \forall x \in X \right)\! \left( a^Tx \leq b \right) $.
	Pak platí \begin{enumerate}
		\item $ \left( \forall y \in \conv X \right)\! \left( a^Ty \leq b \right) $,
		\item $ \left( \forall x \in X \right)\! \left( a^T < b \right) \to \left( \forall y \in \conv X \right)\! \left( a^Ty < b \right) $,
		\item $ \left( \forall y = \sum_{i}^{}\alpha_i x_i \in \conv X \right)\! \left( \left( \exists i \right)\! \left( a^Tx_i < b \land \alpha_i \neq 0 \right) \to a^Ty < b \right) $.
	\end{enumerate}
\end{prop}

\begin{thm}[Carathéodory]
	Nechť $ X \subseteq \R^n $, $ \dim X = d \geq 0 $.
	Pak \[
		\conv X = \left\{ \sum_{i=0}^d \alpha_i a_i \suchthat \left( \forall i \in \range d \right)\! \left( a_i \in X \land \alpha_i \geq 0 \right) \land \sum_i \alpha_i = 1 \right\}.
	\]
\end{thm}

\subsection{Mnohostěny}

\begin{defi}[Nadrovina]
	Nechť $ a \in \R^n, b \in \R $. \emph{Nadrovina} v $ \R^n $ je \[
		\left\{ x \in \R^n \suchthat a^T x = b \right\}.
	\]
\end{defi}

\begin{defi}[Poloprostor]
	Nechť $ a \in \R^n, b \in \R $. \emph{Poloprostor} v $ \R^n $ je \[
		\left\{ x \in \R^n \suchthat a^T x \leq b \right\}.
	\]
\end{defi}

\begin{defi}[Konvexní mnohostěn]
	\emph{Konvexní mnohostěn}, polyhedr, je průnik konečně mnoha poloprostorů.
\end{defi}

\begin{defi}[Omezený konvexní mnohostěn]
	\emph{Omezený konvexní mnohostěn}, polytop, je konvexní mnohostěn, který je omezený.
\end{defi}

\begin{thm}[O oddělování] \label{oddel}
	Nechť $ C,D $ jsou konvexní, uzavřené, disjunktní mnohostěny. Nechť $ C $ je navíc omezená. Pak \[
		\left( \exists b \in \R \right)\! \left( \exists a \in \R^n \right)\! \left( C \subseteq \left\{ x \in \R^n \suchthat a^T x < b \right\} \land D \subseteq \left\{ x \in \R^n \suchthat a^T x > b \right\} \right).
	\]

	\begin{proof}
		Najdeme $ c,d = {\argmin_{c \in C, d \in D}}{\norm{c - d}} $. Definujeme $
			a \deq d-c $, a $ b \deq a^T \frac{c+d}{2} $.

		Teď už jen ověříme, že $ C \subseteq \left\{ x \in \R^n \suchthat a^T x < b
			\right\} $ a $ D \subseteq \left\{ x \in \R^n \suchthat a^T x > b \right\}
		$. Chceme $ a^Td > b: $ \begin{align*}
			a^T d                                               & > b = a^T \frac{c+d}{2} \\
			a^T \left( \frac{d-c}{2} \right)                    & > 0                     \\
			\frac{1}{2} \left( d-c \right)^T \left( d-c \right) & > 0
		\end{align*}
		Toto platí z disjunktnosti.

		Dále taky chceme říci, že pokud by pak existoval bod $ c' \in C $, že by tu nerovnost splňoval \textquote{méně ostře}, pak by to vedlo ke sporu s tím, že $ c $ je nejblíže $ D $.
	\end{proof}
\end{thm}

\begin{thm}[Minkowski-Weyl]
	Nechť $ X \subseteq \R^n $. Pak $ X $ je konvexní omezený mnohostěn $ \Longleftrightarrow $ \[
		\left( \exists V \subseteq \R^n, V \text{ konečná} \right)\! \left( X = \conv V \right).
	\]

	\begin{proof}[Důkaz \textquote{$ \Rightarrow $}.]
		Indukcí podle dimenze $ X $. Pro $ \dim X = -1 $, tj $ X = \emptyset $, platí, stejně jako $ \dim X = 0 $.

		Nechť $ X $ je konvexní, omezený, $ \dim X = d $. Nechť tedy $ X = \left\{ x \in \R^n \suchthat A x \leq b \right\} $ pro nějaké $ A, b $. Mějme \[
			P_i \deq \left\{ x \suchthat A_{i*}x \leq b_i \right\},  R_i \deq \left\{ x \suchthat A_{i*} x = b_i \right\}, X_i \deq X \cap R_i.
		\]
		Nakonec, mějme $ L $, afinní obal $ X $. Definujeme $ M \deq \left\{ i \suchthat X_i \neq X \right\} $. Pak \[
			i \notin M \Leftrightarrow X \subseteq R_i \Leftrightarrow L \subseteq R_i.
		\]
		Tedy naopak \[
			i \in M \Leftrightarrow L \nsubseteq R_i \Leftrightarrow \fce{\dim}{L \cap R_i} < d.
		\]

		Z IP $ \left( \forall i \in M \right)\! \left( \exists V_i \right)\! \left( X_i = \conv V_i \right) $. Zadefinujeme $ V \deq \bigcup_i V_i $.

		Chceme $ X \subseteq \conv V $. Vezmeme $ x \in X $, zvolíme přímku $ p
			\deq \left\{ x + \alpha t \suchthat \alpha \in \R \right\} $, tž. $ p
			\subseteq L $ ($ t $ je z prostoru vzniklého posunutím $ L $ do
		počátku). \[
			p \cap X = \fce{\bigcap_{P_i}}{p \cap P_i}.
		\]
		Takový průnik musí být úsečka. Tedy existují krajní body, přes poloprostory $ P_i, P_j $, tž. \[
			p \cap X = P_i \cap P_j.
		\]
		Body $ p \cap R_i \in X_i, p \cap R_j \in X_j $. Stačí udělat afinní kombinaci těchto bodů a máme bod $ x $.
	\end{proof}
	\begin{proof}[Důkaz \textquote{$ \Leftarrow $}.]
		$ Q \deq $ množina lineárních nerovnic splněných všemi body z $ V $. Budeme nerovnici $ a^Tx \leq b $ reprezentovat vektorem $ \begin{pmatrix}
				a \\ b
			\end{pmatrix}
		$

		Tedy $ Q \deq \left\{ \begin{pmatrix}
				a \\ b
			\end{pmatrix}
			\suchthat \left( \forall x \in V \right)\! \left( a^Tx \leq b \right) \land b \in \left[ -1, 1 \right] \land \left( \forall i \right)\! \left( a_i \in \left[ -1,1 \right] \right) \right\} $. $ V $ je konečná, tedy $ Q $ je konvexní mnohostěn, omezený. Vezmu $ W $ podle $ \Rightarrow $, tž. $ Q = \conv W $. Označím $ Y \deq \left\{ x \suchthat \left( \forall \begin{pmatrix}
					a \\ b
				\end{pmatrix}
			\in W \right)\! \left( a^Tx \leq b \right) \right\} $. Chci ukázat $ Y = \conv V $. $ V \subseteq Y $, z definice $ Y $, tedy $ \conv V \subseteq Y $.

		Nyní, nechť $ x \notin \conv V $. Podle věty o oddělování (\ref{oddel}) existuje $ a,b \in Q: a^Tx > b $. Musí existovat i nerovnice $ \in W $, tedy není v $ Y $.
		% TODO: edit.
	\end{proof}

\end{thm}

\begin{defi}[Tečná nadrovina]
	Nechť $ P \subseteq \R^n $ je konvexní mnohostěn. \emph{Tečná nadrovina}
	mnohostěnu $ P $ je $ R = \left\{ x \suchthat ax = b \right\} $ pro $ a \in
		\R^n, b \in \R $, tž. \[
		\left( \forall x \in P \right)\! \left( ax \leq b \right) \land \left( \exists x \in P \right)\! \left( ax = b \right).
	\]
\end{defi}

\begin{defi}[Stěna mnohostěnu]
	Nechť $ P \subseteq \R^n $ je konvexní mnohostěn.
	Jeho \emph{stěna}\footnote{Anglicky \emph{face}.} je $ P \cap R $ pro $ R $ jeho tečnou nadrovinu, nebo $ P $, nebo $ \emptyset $.
	\emph{Vlastní stěna} je stěna, která není $ P $ ani $ \emptyset $.
\end{defi}

\begin{defi}[Vrchol]
	\emph{Vrchol} mnohostěnu $ P $ je stěna o $ \dim 0 $.
\end{defi}

\begin{defi}[Hrana]
	\emph{Hrana} mnohostěnu $ P $ je stěna o $ \dim 1 $.
\end{defi}

\begin{defi}[Faseta]
	\emph{Faseta} mnohostěnu $ P $ je stěna o $ \fce{\dim}{\dim P-1} $.
\end{defi}

\begin{thm}[]
	Nechť $ P \subseteq \R^n $ je konvexní mnohostěn, $ V $ jeho vrcholy,
	$ V_{\ext} \deq \left\{ x \in \R^n \suchthat x \notin \fce{\conv}{P \setminus \left\{ x \right\}} \right\}. $
	Pak $ V = V_{\ext} $.

	\begin{proof}[Důkaz pro omezené mnohostěny.]
		Vezmeme $ V_0 $ minimální na inkluzi, tž. $ P = \fce{\conv}{V_0} $.

		Nejprve dokážeme $ V \subseteq V_{\ext} $.
		Z definice stěny máme jeden vrchol $ v \in V: av = b $, pro zbytek $ x \in P: ax < b $.
		Pro konvexní kombinaci $ P \setminus \left\{ v \right\} $ taky tedy všude platí $ ax < b $.
		Tedy $ v \notin \fce{\conv}{P \setminus v} $.

		Dále nahlédneme $ V_{\ext} \subseteq V_0 $.

		Nakonec, $ V_0 \subseteq V $. Nechť $ v \in V_0 $.
		Pro $ V_1 \deq V_0 \setminus \left\{ v \right\} $ je $ \conv V_1 \neq P $.
		Speciálně, $ v \notin V_1 $.
		Z věty o oddělování najdeme $ a,b $: \[
			\left( \forall w \in V_1 \right)\! \left( ax < b \right) \land av > b.
		\]
		Pro $ \overline b \deq a^Tv $ je $ R = \left\{x \suchthat ax = \overline b \right\} $ tečná nadrovina.
	\end{proof}
\end{thm}

\begin{thm}[]\label{thm prunik sten je stena}
	Průnik dvou stěn $ P $ je stěnou $ P $.

	\begin{proof}
		Nechť $ E,F \subseteq P $ jsou stěny.
		Pokud jsou to nevlastní stěny (alespoň jedna z nich), věta platí.
		Pokud $ E \cap F = \emptyset $, věta opět platí.

		Nechť z definice $ E = \left\{ x \suchthat ax \leq b \right\} \cap P $, $ F = \left\{ x \suchthat cx \leq d \right\} \cap P $.
		Chceme další nadrovinu, která definuje $ E \cap F $.

		Podíváme se na $ \left( a+c \right)x \leq b+d $.
		Víme, že $ \left( \forall x \in P \right)\! \left( \left( a+c \right)x \leq b+d \right) $.
		Dále, $ \left( \forall x \in E \cap F \right)\! \left( \left( a+c \right)x = b+d \right) $.
		Nakonec, $ \left( \forall x \in P \setminus \left( E \cap F \right) \right)\! \left( \left( a+c \right)x < b+d \right) $.
		Poslední lze ukázat z rozboru případů $ x $ v závislosti na $ E,F $.
	\end{proof}
\end{thm}

\begin{thm}[Stěna stěny je stěna]\label{thm stena steny je stena}
	Nechť $ F \subseteq P $ je stěna $ P $,
	$ E \subseteq F $.
	Pak $ E $ je stěna $ F \Longleftrightarrow E $ je stěna $ P $.

	\begin{proof}[Důkaz pro omezené mnohostěny, \textquote{$ \Leftarrow $}.]
		Pro nevlastní stěny platí triviálně.
		Můžeme tedy předpokládat že $ E $ je vlastní stěna $ P $.
		Máme tedy $ R $ tečnou nadrovinu z definice stěny $ E $ pro $ P $,
		tž. $ E = P \cap R $.

		Dokážeme, že $ E = F \cap R $.
		Tedy chceme, že $ R $ je i tečná nadrovina $ E $.
		To platí, protože $ E \subseteq F $ a $ F \subseteq P $.
	\end{proof}

	\begin{proof}[Důkaz pro omezené mnohostěny, \textquote{$ \Rightarrow $}.]
		Opět pro nevlastní platí.
		Můžeme tedy předpokládat že $ E $ je vlastní stěna $ F $.
		Máme tedy $ R $ tečnou nadrovinu z definice stěny $ E $ pro $ F $,
		tž. $ E = F \cap R $.
		Ale může se stát, že $ P \cap R $ prochází vnitřkem $ P $.

		Rovinu $ R $ chceme otočit kolem $ E $ aby $ R' \cap P = E $.
		Nechť $ F = \left\{ x \in P \suchthat ax = b \right\} $,
		$ E = \left\{ x \in F \suchthat cx = d \right\} $.
		Chceme nadrovinu $ F $ použít s větší váhou než nadrovinu $ E $.
		Tedy chceme $ t > 0: $ \[
			\left( \forall x \in E \right)\! \left( \left( ta+c \right)x = tb+d \right) \land \left( \forall x \in P \setminus E \right)\! \left( \left( ta+c \right)x < tb+d \right).
		\]
		Označme $ S = \left\{ x \in P \suchthat \left( ta+c \right)x = tb+d \right\} $.
		Určitě $ E \subseteq S $.

		Chceme \[
			\left( \forall x \in P \right)\! \left( \left( ta+c \right)x \leq tb+d \land \left( x \notin E \implies \left( ta+c \right)x < tb+d \right) \right).
		\]
		Pro $ x \in F $ platí.
		Pro $ x \notin F, x \in P $ je $ ax < b $, o druhé nevíme nic,
		ale pro pevné $ x $ to dokážeme dostatečně velkým $ t $ splnit.
		Vezmeme $ t $, které funguje pro všechny vrcholy (těch je konečně mnoho).
		Navíc, pro vrcholy $ v_i \notin F $ vezmeme takové, aby nerovnice platila ostře.
		Vidíme, že $ \left( \forall x \in E \right)\!  $ platí rovnost,
		$ \left( \forall x \in F \setminus E \right)\!  $ platí ostrá nerovnost, stejně jako všude jinde.
		Vyplývá to z toho, že každé $ x $ lze vyjádřit jako konvexní kombinaci vrcholů.
		Tedy $ S $ definuje $ E $ jako stěnu $ P $.
	\end{proof}
\end{thm}

\begin{defi}[Minimální mnohostěn]
	Nechť $ P \subseteq \R^n $ je konvexní mnohostěn daný podmínkami $ A'x = b' $ a $ Ax \leq b $.
	Toto je \emph{minimální popis $ P $} $ \equiv $ beze změny $ P $ nelze vynechat jednu rovnici/nerovnici, popř. změnit nerovnici na rovnici.
\end{defi}

\begin{prop}[]
	Nechť $ P = \left\{ x \suchthat A'x = b' \right\} \neq \emptyset $, pro $ A' \in \R^{m \times n} $.
	$ P $ je minimální $ \Longleftrightarrow m = \rank A' $.
\end{prop}

\begin{lemma}[]
	Nechť $ \emptyset \neq P \subseteq \R^n $ je konvexní mnohostěn daný podmínkami $ A'x = b' $ a $ Ax \leq b $.
	Nechť $ z \in P $ a $ Az < b $.
	Pak $ \dim P = n - \rank A' $.
	Navíc, je-li popis minimální, pak takové $ z $ existuje.

	\begin{proof}[Důkaz dimenze.]
		Mějme $ z $. Nechť $ L = \left\{ x \suchthat A'x = b' \right\} $.
		Pak určitě $ \dim L = n - \rank A' $.
		Definujeme \[
			\fce{B}{z,\varepsilon} \deq \left\{ x \in L \suchthat \norm{x-z} < \varepsilon \right\}.
		\]
		Zvolme $ \varepsilon $ takové, aby všechny nerovnice v $ \fce{B}{z, \varepsilon} $ zůstaly splněny.
		Nechť $ b_1, \dots, b_{\dim L} $ je báze $ L $.
		Když k $ z $ přičtu nějakou lineární kombinaci $ b_i $ s malými koeficienty $ \delta_i $, pak se vejdu do $ \fce{B}{z, \varepsilon} $, tedy stále splňují všechny nerovnice.
		Tedy $ \left( \forall i \right)\! \left( z+\delta_ib_i \in P \right) $.
		Tedy $ \dim P = \dim L $.
	\end{proof}

	\begin{proof}[Důkaz existence $ z $.]
		Nechť popis $ P $ je minimální.
		Pokud nejsou nerovnice, pak triviálně platí.
		Jinak, mějme $ z_i: z_i \in P \land A_{i*} z_i < b_i $.
		Toto $ z_i $ lze získat, protože kdyby neexistovalo pro nějaké $ i $, pak popis $ P $ není minimální.
		Nechť \[
			z = \frac{\sum_{1 \leq i \leq n}^{}z_i}{n}.
		\]
		Pro toto $ z $ vše platí.
	\end{proof}
\end{lemma}

\begin{thm}[]
	Nechť $ \emptyset \neq P \subseteq \R^n $ je konvexní mnohostěn daný minimálním popisem $ A'x = b' $ a $ Ax \leq b $.
	Pak v minimálním popisu $ P $ odpovídají vzájemně jednoznačně nerovnice fasetám $ P $.
	Navíc, každá vlastní stěna je stěnou nějaké fasety.

	\begin{proof}[Důkaz faset vs nerovnic.]
		Nechť $ R_k = \left\{ x \suchthat A_{k*} x = b_k \right\} $.
		Nechť $ F_k = R_k \cap P $.
		Chceme $ F_k \neq \emptyset $, tedy hledáme bod.
		Nechť $ y $ splňuje všechny ostře, z předchozího lemma.
		Nechť $ \overline y $ splňuje všechny ostře až na $ A_{k*} $.
		Takové existuje, protože když vynechám $ A_{k*} $, pak mi určitě něco přibyde.
		Na přímce mezi $ y $ a $ \overline y $ někde nastává rovnost.
		Tedy $ F_k \neq \emptyset $.
		Navíc ale $ y_k \notin F_i $ pro $ i \neq k $, z volby $ y $, tedy všechny $ F_k $ jsou různé.
		$ F_k $ má popis s $ m'+1 $ rovnicemi a $ m-1 $ nerovnicemi.
		Možná nějaké nerovnice půjdou vynechat, ale rovnice určitě ne, protože $ F_k \subset P $ a opět je to afinní prostor, tedy musí mít menší dimenzi.
		Tedy $ \dim F_k = n - m' - 1 = \dim P - 1 $.
	\end{proof}

	\begin{proof}[Důkaz vlastních stěn.]
		Nechť $ E $ je vlastní stěna $ P $.
		Nechť $ \dim E \leq \dim P - 1 $.
		Nechť $ E \nsubseteq F_k $, tedy \[
			\left( \exists y_k \in E \right)\! \left( A_{k*} y_k < b_k \right).
		\]
		Pokud by takové $ y_k $ existovalo $ \forall k $, pak by $ E \ni y = \frac{\sum_{}^{}y_k}{n} $ bylo uvnitř $ P $, tedy by $ E $ nebyla vlastní stěna.
		Tedy $ E \subseteq F_k $ pro nějaké $ k $.
		Podle věty \ref{thm stena steny je stena} je to i stěna $ F_k $.
	\end{proof}
\end{thm}

\begin{cor}[]
	Je-li $ \dim P = n $, pak je minimální popis jednoznačný až na škálování.

	\begin{proof}
		Faseta má dimenzi $ n-1 $, tedy je to nadrovina, tedy jednoznačně určuje svou \textquote{dělící} nadrovinu, kterou jen můžeme přeškálovat.
	\end{proof}
\end{cor}

\begin{cor}[]
	Každá stěna $ P $ je průnikem faset.

	\begin{proof}
		Plyne z předchozí věty a z věty \ref{thm stena steny je stena} a \ref{thm prunik sten je stena}.
		Postupně měním nerovnice na rovnice až dostanu hledanou stěnu.
		Tyto změněné nerovnice odpovídají hledaným fasetám.
	\end{proof}
\end{cor}

\section{Simplexová metoda}

\begin{defi}[Bázické přípustné řešení]
	\emph{Bázické přípustné řešení} $ x \in \R^n $ je takové přípustné řešení, že
	$ n $ podmínek LP platí s rovností, ať už rovnice, těsné nerovnice, nebo
	těsné podmínky na nezápornost.
\end{defi}

Pro úlohy v rovnicovém tvaru bude báze množina indexů $ B \subseteq \left\{ 1, \dots, n \right\} $, tž.
$ A_B \deq A_{*B} $ je regulární.

Pomocí Gaussovy eliminace můžeme soustavu rovnic $ Ax=b $ přetvořit na \[
	A_B^{-1}b = A_B^{-1} Ax = x_B + A_B^{-1}A_Nx_N,
\]
z toho $ x_B = A^{-1}_B b - A^{-1}_B A_Nx_N $.

Z toho bázické řešení odpovídající $ B $ je řešení $ Ax=b $, tž $ x_N = \vec o $.
Báze je \emph{přípustná} $ \equiv $ bázické řešení je přípustné.

\begin{lemma}[]
	Nechť $ x $ je přípustné řešení LP.
	Nechť $ K = \left\{ i \suchthat x_i \neq 0 \right\} $.
	Pak $ x $ je bazické $ \Longleftrightarrow $ sloupce $ A_K $ jsou nezávislé.
\end{lemma}

\begin{lemma}[]
	Přípustná bázická řešení jsou přesně vrcholy mnohostěnu přípustných řešení LP.
\end{lemma}

\begin{defi}[Simplexová tabulka]
	Nechť $ B $ je báze.
	Nechť $ \rank A = m $.
	Nechť $ b \geq 0 $.
	\emph{Simplexová tabulka} je soustava $ m+1 $ rovnic, která má stejná řešení jako $ Ax=b $, plus dolů přidaná rovnice $ z = c^Tx $,
	a navíc sloupce odpovídající $ B $ tvoří $ I_n $, s nulovým řádkem u $ z $.
\end{defi}

Simplexovou tabulku zapisujeme ve tvaru \begin{align*}
	x_B & = p + Qx_N     \\
	z   & = z_0 + r^Tx_N
\end{align*}
Zde $ p = A^{-1}_B b $, $ Q = - A^{-1}_B A_N $, $ z_0 = c^T_Bx_B $.

\begin{lemma}[]
	Nechť $ B $ je báze.
	$ B $ je přípustná $ \Longleftrightarrow $ $ p \geq 0 $.
	Navíc, pokud $ p \geq 0 $ a $ r \leq 0 $, pak je bázické řešení optimální.
\end{lemma}

\begin{algo}[Pivotovací krok]\ \\
	\AlgIn Simplexová tabulka.
	\begin{algorithmic}[1]
		\State Vybereme $ l_t \in N $, tž. $ r_{t} > 0 $.
		\State Pokud $ l_t $ neexistuje, ohlásíme \emph{optimum}.
		\State $ l_t $ \emph{vstoupí do báze}.
		\State Vybereme $ j_s \in B $, tž. $ q_{st} < 0 \land -\frac{p_s}{q_{st}} = \min \left\{ -\frac{p_i}{q_{it}} \suchthat i \in B \land q_{it} < 0 \right\} $.
		\State Pokud neexistuje, pak ohlásíme \emph{úloha neomezená}.
		\State Přepočítáme tabulku.
	\end{algorithmic}
	\AlgOut Upravená Simplexová tabulka.
\end{algo}

\begin{defi}[Pivotovací pravidla]
	\ \begin{enumerate}
		\item Preferovat $ r_{t} $ maximální -- lze obejít. (Danzig)
		\item Preferovat co největší zvýšení $ z_0 $ -- špatně se počítá.
		\item Preferovat co nejstrmější hranu (viz skripta).
		\item Lexikografické pravidlo\footnote{Dokazatelně necyklí.}: $ l_t $ libovolné, $ j_s $ vybíráme tak, že
		      $ \left( \frac{q_{si}}{q_{st}} \right)_i $ je lexikograficky nejmenší.
		\item Bluntovo pravidlo\footnote{První dokazatelně necyklící.}: $ l_t $ co nejmenší, pak $ j_s $ co nejmenší.
	\end{enumerate}
\end{defi}

Prvotní přípustné řešení najdeme pomocí \emph{pomocné úlohy.}

\begin{defi}[Pomocná úloha]
	Mějme LP v rovnicovém tvaru $ Ax = b $, $ x \geq 0 $, $ \rank A = m $.
	\emph{Pomocná úloha} je úloha LP vycházející z té původní.
	Přidáme proměnné $ x_{n+1}, \dots, x_{n+m} \geq 0 $, maximalizujeme $ \sum_{i}^{}x_{n+i} $.
\end{defi}

\begin{cor}[]
	Řešení $ \left( 0, \dots, 0, b_1, \dots, b_m \right) $ je bázické řešení pomocné úlohy.
\end{cor}

\begin{cor}[]
	Každé řešení $ \left( x_1, \dots, x_n, 0, \dots, 0 \right) $ má odpovídající řešení původní úlohy.
\end{cor}

\begin{cor}[]
	Může se stát, že optimum PU bude mít nějaké nové proměnné stále v bázi.
	Tyto proměnné ale můžeme vyměnit za původní proměnné tak, že dostaneme opět bázi (z hodnosti matice).
\end{cor}

\begin{lemma}[]
	Optimum pomocné úlohy $ = 0 $ $ \Longleftrightarrow $ původní úloha je přípustná.
\end{lemma}

\section{Další možnosti řešení LP}

Existují i jiné algoritmy než Simplexová metoda.
Narozdíl od SM o některých můžeme i dokázat, že jsou polynomiální v délce vstupu.
Zatím ale nemáme \emph{silně polynomiální}, tj. takový, který potřebuje polynomiální počet aritmetických operací.
\footnote{Gaussova eliminace je jedním z takových. Tu je naopak těžké udělat polynomiálně, protože při špatné volbě pivotů vznikají dlouhá čísla.}

Dává vůbec smysl uvažovat nad polynomiálními algoritmy? Umíme napsat řešení v polynomiálním čase?

\begin{lemma}[]
	Nechť LP je zadán maticí s rozměry $ n \times m $.
	Nechť $ L $ je celková délka vstupu v bitech.
	Pak délka výstupu je polynomiální v $ L, n,m $.

	\begin{proof}
		$ L $ je cca součet délek čísel, případně dvojnásobek pro racionální -- čitatel + jmenovatel.
		Víme, že bázické řešení je vrchol, a každý vrchol je průnikem $ n $ rovnic z $ A,b $, případně jedničky pro boundy na proměnné.
		Z Cramerova pravidla je $ x_i = \frac{\det A_i}{\det A} $.
		Determinant má délku $ \leq \log n! + nL = n \log n + nL $, což je polynomiální.
	\end{proof}

\end{lemma}

Některé algoritmy jsou užitečnější pro praxi, jiné spíše pro teorii.

\begin{note}
	Při analýzy polynomiality můžeme zapomenout na účelovou funkci.
	Můžeme ji omezit, přidat podmínku $ c^Tx \leq d $ pro nějaké $ d $, a pak podle $ d $ binárně vyhledávat.
\end{note}


\begin{algo}[Elipsoidová metoda]\ \\
	\AlgIn $ Ax \leq b $ definující $ P $. Mějme kouli, která mnohostěn obsahuje. Dále, nechť mnohostěn řešení je buď $ \emptyset $ nebo obsahuje kouli o vel. $ \varepsilon $ polynomiální v $ m,n,L $ -- to nám zaručuje plnou dimenzi.\footnote{
		Kouli opatříme tak, že položíme $ Ax \leq b + \delta $, pro $ \delta $ podstatně menší než bit. sl. řešení. Tím v $ \delta $-okolí stále splňujeme všechny nerovnice, a zároveň nedostáváme nové řešení.
	}
	\begin{algorithmic}[1]
		\State $ E_i \gets $ elipsoid obsahující $ P $.
		\Indent \emph{krok}: je $ e_i $, střed $ E_i $ přípustný?
		\State Pokud ano, vrátíme \emph{přípustná}.
		\Indent Pokud ne:
		\State Najdeme nadrovinu odděl. $ e_i $ a $ P $.
		\State Posuneme nadrovinu do $ x_i $ a uděláme elipsoid $ E_{i+1} $, který opisuje půlku $ E_i $ rozpůleného nadrovinou, ve které leží $ P $.
		\State Opakujeme \emph{krok} dokud je $ E_{i+1} $ menší než $ \varepsilon $, pak případně vrátíme \emph{nepřípustná}.
		\EndIndent
		\EndIndent

	\end{algorithmic}
	\AlgOut Přípustnost LP, který definuje $ P $.
\end{algo}

\begin{cor}[]
	\[
		\fce{V}{E_i} > \fce{V}{E_{i+1}}.
	\]
\end{cor}

To vychází z toho, že elipsoid je jen přeškálovaná koule, a pro normální kouli to platí, a poměr objemů zůstává zachován.

Problém je, že při opisování menšího elipsoidu odmocňujeme. Abychom nedostali iracionální čísla, \textquote{zaokrouhlíme} na menší racionální číslo.
Navíc, můžou vznikat velká čísla.

\begin{cor}[]
	$ E $ se zmenšuje dostatečně rychle na to, aby EM byla polynomiální.
\end{cor}

Krok EM je tzv. \emph{separační orákulum} -- lze ho využít i na jiné, obecnější problémy.
Např. pokud u LP je $ m \gg n $, tak může existovat lepší separační orákulum, které povede na řešení polynomiální jen v $ n,L $.
Jediná podmínka použití separačního orákula je konvexita.

U \emph{metod vnitřního bodu} hledáme řešení nejprve uvnitř $ P $.
Pak pomocí metod numerické matematiky (speciálně metody podobné Newtonově metodě) konvergujeme k řešení.
Tady je problém s tím, že se neumíme držet v boundech.
Vyřešíme ho tak, že k $ c^T $ přičteme funkci v řádu logaritmu, která je uvnitř $ P $ kladná a venku hodně rychle hodně záporná.
Výsledné řešení zaokrouhlíme k nejbližšímu vrcholu.
Tyto postupy se ukazují užitečné v praxi, navíc ale o některých umíme i dokázat polinomialitu.

\section{Dualita}

Sčítáním nerovnic s různými koeficienty lze dostat horní odhad.
Když máme maximum, můžeme dostat takové koeficienty u nerovnic, aby se horní odhad rovnal maximu.
Tím tedy můžeme dokázat maximalitu řešení.
Tyto koeficienty získáváme jako řešení tzv. duálního LP.

Nejprve budeme zkoumat jen dualitu, která ignoruje $ c^Tx $, jen se zabývá existencí řešení.

\begin{lemma}[Farkasovo pro nerovnice]
	Nechť $ A \in \R^{m \times n}, b \in \R^m $.
	Pak $ Ax \leq b $ má řešení $ \Longleftrightarrow  \nexists y \geq 0: A^Ty = 0 \land b^Ty < 0 $.
\end{lemma}

\begin{lemma}[Farksovo pro rovnice]
	Nechť $ A \in \R^{m \times n}, b \in \R^m $.
	Pak $ Ax = b $ má nezáporné řešení $ \Longleftrightarrow \nexists y: A^Ty \geq 0 \land b^Ty < 0 $.
\end{lemma}

\begin{thm}[]
	Nechť $ A \in \R^{m \times n}, b \in \R^m $.
	Nechť $ Ax \leq b $ má řešení.
	Pak \[
		\left( \forall x \right)\! \left( Ax \leq b \to c^Tx \leq \delta \right) \Longleftrightarrow \left( \exists y \geq 0 \right)\! \left( y^TA = c^T \land y^Tb \leq \delta \right).
	\]
\end{thm}

\begin{thm}[Slabá dualita]
	Nechť $ P $ je program lin. prog., maximalizující $ c^Tx $ za podmínek $ Ax \leq b $.
	Nechť $ D $ je program lin. prog., minimalizující $ b^Tx $ za podmínek $ Ax = c $.
	Pak $ c^Tx \leq b^Ty $ pro $ x,y $ přípustné.
\end{thm}

\begin{thm}[Dualita]
	Nechť $ P $ je program lin. prog., maximalizující $ c^Tx $ za podmínek $ Ax \leq b $.
	Nechť $ D $ je program lin. prog., minimalizující $ b^Tx $ za podmínek $ Ax = c $.
	Pak platí právě jedna možnost: \begin{enumerate}
		\item $ P $ i $ D $ jsou nepřípustné.
		\item Jeden je nepřípustný, jeden neomezený.
		\item Oba mají optimum $ x^*, y^* $. Pak $ c^Tx^* = b^Ty^* $.
	\end{enumerate}
\end{thm}

\begin{thm}[Duál duálu]
	Nechť $ P $ je lineární program, $ D $ k němu duální.
	Pak duální problém k problému $ D $ je zase $ P $.
\end{thm}


\begin{thm}[Komplementarita]
	Nechť $ P $ je LP maximalizující $ c^Tx $ pro $ x \in \R^n $, za podmínek $ Ax \leq b $.
	Nechť $ D $ je LP minimalizující $ b^Ty $ pro $ y \geq 0 $ za $ A^Ty = c $.
	Nechť $ x $ a $ y $ jsou přípustná řešení $ P $ a $ D $.
	Pak jsou obě optimální, právě když \[
		\left( \forall j \in \range m \right)\! \left( y_j = 0 \lor A_{j*} x = b_j \right).
	\]
\end{thm}

\begin{thm}[Komplementarita]\label{thm:Komplementarita}
	Nechť $ P $ je LP maximalizující $ c^Tx $ pro $ x \geq 0 $, za podmínek $ Ax \leq b $.
	Nechť $ D $ je LP minimalizující $ b^Ty $ pro $ y \geq 0 $ za $ A^Ty \geq c $.
	Nechť $ x $ a $ y $ jsou přípustná řešení $ P $ a $ D $.
	Pak jsou obě optimální, právě když \[
		\left( \forall j \in \range m \right)\! \left( y_j = 0 \lor A_{j*} x = b_j \right)
	\]
	a \[
		\left( \forall i \in \range n \right)\! \left( x_i = 0 \lor \sum_j A_{ij}y_j = c_j \right).
	\]
\end{thm}

\section{Perfektní párování}

\subsection{Bipartitní grafy}

\begin{notation}[]
	Mějme neorientovaný $ G $, $ v \in \fce VG $, vektor $ x $ a množinu indexů $ I $.
	Definujeme \begin{itemize}
		\item $ \fce{\delta}{v} \deq \left\{ vu \in E \right\} $,
		\item $ \fce \gamma S = \left\{ e \suchthat e \subseteq S \right\} $,
		\item $ \fce{x}{I} \deq \sum_{i \in I}^{} x_{i} $.
	\end{itemize}
\end{notation}

\begin{defi}[LP Perfektního párování minimální ceny v bipartitních grafech]
	\
	\begin{enumerate}
		\item $ \min \sum_{e \in E} c_e x_e $
		\item $ \left( \forall e \in E \right) x_e \geq 0 $
		\item podmínky: \begin{itemize}
			      \item $ \left( \forall v \in V \right)\! \left( \fce x {\fce \delta v} = 1 \right) $
		      \end{itemize}
	\end{enumerate}
\end{defi}

\begin{defi}[Duální LP Perfektního párování minimální ceny v bipartitních grafech]
	\
	\begin{enumerate}
		\item $ \max \sum_{v \in V} y_e $
		\item $ \left( \forall v \in V \right) y_e \in \R $
		\item podmínky: \begin{itemize}
			      \item $ \left( \forall uv \in E \right)\! \left( y_u + y_v \leq c_e \right) $
		      \end{itemize}
	\end{enumerate}
\end{defi}

Pro dané $ y $ definujeme hrany přípustné pro duál: \[
	E_= \deq \left\{ uv \in E \suchthat y_u + y_v = c_{uv} \right\}.
\]

\begin{defi}[Strom]
	\emph{Strom} grafu $ G $ je trojice $ \left< \fce{V}{T}, \fce{E}{T}, r \right> $, kde $ r $ je kořen.
	Dále, $ \fce{V}{T} = \fce{A}{T} \cup \fce{B}{T} $, kde $ A $ jsou v liché vzdálenosti od $ r $, a $ B $ v sudé.
\end{defi}

\begin{defi}[Střídavý strom]
	Nech $ T $ je strom.
	Nechť $ M \subseteq E $ je řez.
	$ T $ je \emph{střídavý strom} $ \equiv $ \[
		\left( \forall u \in \fce{A}{T} \right)\! \left( {\fce{\delta_T}{u}} = \left\{ v \right\} \land uv \in M \right).
	\]
\end{defi}

\begin{cor}[]
	Nechť $ T $ je střídavý strom. Pak $ \absolute {\fce{B}{T}} = \absolute{\fce{A}{T}}+1 $.
\end{cor}

\begin{algo}[Perfektní párování minimální ceny v bipartitních grafech]\ \\
	\AlgIn Bipartitní graf $ G $.
	\begin{algorithmic}[1]
		\State $ y \gets 0, M \gets \emptyset $

		\Indent Inicializace stromu:
		\State Pokud $ M $ je perfektní párování, vrátíme $ M $.
		\Indent Jinak
		\State $ r \gets $ libovolný vrchol z $ V $ nespárovaný v $ M $.
		\State $ T \gets \left< \left\{ r \right\}, \emptyset, r \right> $.
		\EndIndent
		\EndIndent

		\Indent Budování stromu:
		\State $ vw \gets e \randin E_= $, tž. $ v \in \fce{B}{T}, w \notin \fce{V}{T} $
		\State Pokud neexistuje, pokračujeme \emph{změnou $ y $}.
		\Indent Pokud $ wz \in M $:
		\State Přidáme $ vw, wz $ do $ M $.
		\State Pokračujeme \emph{inicializací stromu}.
		\EndIndent
		\Indent Jinak:
		\State Zvětšíme párování pomocí střídavé cesty z $ r $ do $ w $.
		\State Pokračujeme \emph{inicializací stromu}.
		\EndIndent
		\EndIndent

		\Indent Změna $ y $:
		\State $ \varepsilon \gets \fcec{\min}{c_{vw} - y_v - y_w \suchthat vw \in E, v \in \fce{B}{T}, w \notin \fce{V}{T}} $
		\State Pokud $ \varepsilon = \infty $, vrátíme \emph{neexistuje perfektní párování}.
		\State Aktualizujeme $ y $: \[
			y_v \gets \begin{cases}
				y_v + \varepsilon & v \in \fce{B}{T},    \\
				y_v - \varepsilon & v \in \fce{A}{T},    \\
				y_v               & v \notin \fce{V}{T}, \\
			\end{cases}
		\]
		\State Pokračujeme \emph{budováním stromu}.
		\EndIndent

	\end{algorithmic}
	\AlgOut Perfektní párování $ M $.
\end{algo}

\begin{thm}[]
	Algoritmus nalezne perfektní párování minimální ceny v polynomiálním čase.
\end{thm}

\subsection{Obecné grafy}

\def\contr{\slash}
\begin{defi}[Kontrakce]
	Nechť $ C \subseteq V $. Pak $ G' = G \contr C $ je graf, kde \begin{enumerate}
		\item $ \fce{V}{G'} = \fce{V}{G} \setminus C \cup c $, kde $ c $ je nový vrchol,
		\item $ \fce{E}{G'} = \fce{E}{G} \setminus \left\{ vu \suchthat v \in C \right\} \cup \left\{ cu \suchthat u \in \fce{V}{G'} \land \left( \exists v \in  C \right)\! \left( vu \in \fce{E}{G} \right) \right\} $.
	\end{enumerate}
\end{defi}

\def\lc#1{\fce{\mathcal L}{#1}}
\begin{notation}[Moje navíc]
	Množina lichých cyklů na $ G $ je $ \lc G $.
\end{notation}

\begin{lemma}[]
	Nechť $ C \in \lc G $.
	Nechť $ M' $ je perfektní párování v $ G \contr C $.
	Pak $ \exists M \supseteq M' $ perfektní párování v $ G $.
\end{lemma}

\begin{algo}[Blossom algorithm]\ \\
	\AlgIn graf $ G $.
	\begin{algorithmic}[1]
		\State $ M \gets \emptyset $
		\State Začneme \emph{inicializací stromu}.

		\Indent Inicializace stromu:
		\State Pokud neexistuje nespárovaný $ r $, vrátíme $ M $.
		\State $ T \gets $ nový prázdný strom s nespárovaným $ r $ jako kořenem.

		\EndIndent

		\Indent Budování stromu:
		\Indent Dokud $ \left( \exists uv \in E \right)\! \left( u \in \fce{B}{T}, v \notin T \right) $:
		\State Pokud $ v $ není spárovaný, zvětšíme $ M $ a přejdeme na \emph{inicializaci stromu}.
		\State Jinak přidáme $ uv $ a $ vw $ do $ T $, kde $ w $ je vrchol spárovaný s $ v $.
		\EndIndent
		\EndIndent

		\Indent Kontrakce cyklu:
		\Indent Pokud $ \left( \exists uv \in E \right)\! \left( u,v \in \fce{B}{T} \right) $:
		\State $ P_u, P_v \gets $ cesty ke spol. předchůdci.
		\State $ C \gets P_u \cup P_v \cup \left\{ uv \right\} $
		\State $ G \gets G \contr C $
		\State $ T \gets T \contr C $
		\State $ M \gets M \contr C $
		\State Pokračujeme \emph{budováním stromu.}
		\EndIndent
		\State Jinak vrátíme \emph{perfektní párování neexistuje.}
		\EndIndent
	\end{algorithmic}
	\AlgOut perfektní párování $ M $.
\end{algo}

\begin{cor}[]
	$ \algorithm{Blossom algorithm}{G} $ lze naimplementovat v $ \fce{\O}{mn \log n} $.
\end{cor}

Nyní chceme přidat cenu jako v algoritmu pro bipartitní grafy, ale to nedává správné řešení -- obecně nemusí být ekvivalentní celočíselné optimum.
Pro opravu přidáme podmínky na každý lichý řez v $ G $.

\begin{defi}[Lichý řez]
	$ D \subseteq E $ je \emph{lichý řez} $ \equiv $ \[
		D = \fce{\delta}{S}: S \subseteq V \land \absolute{S} = 2k+1.
	\]
\end{defi}

\def\lichrez#1{{\mathcal{D}}_{#1}}
\begin{notation}
	Navíc budu značit množinu lichých řezů $ \lichrez G $.
\end{notation}

K původnímu primárnímu programu tedy přidáme podmínky $ \fce{x}{D} \geq 1 $ pro liché řezy $ D $.
Z toho vyplývá, že duál dostane nové proměnné $ Y_D $ pro liché řezy $ D $.

\begin{defi}[LP Perfektního párování minimální ceny]
	\
	\begin{enumerate}
		\item $ \min \sum_{e \in E} c_e x_e $
		\item $ \left( \forall e \in E \right) x_e \geq 0 $
		\item podmínky: \begin{itemize}
			      \item $ \left( \forall v \in V \right)\! \left( \fce x {\fce \delta v} = 1 \right) $
			      \item $ \left( \forall D \in \lichrez G \right)\! \left( \fce xD \geq 1 \right) $
		      \end{itemize}
	\end{enumerate}
\end{defi}

\begin{defi}[Duální LP Perfektního párování minimální ceny]
	\
	\begin{enumerate}
		\item $ \max \sum_{v \in V} y_e + \sum_{D \in \lichrez G} Y_D $
		\item proměnné: \begin{itemize}
			      \item $ \left( \forall v \in V \right) y_e \in \R $
			      \item $ \left( \forall D \in \lichrez G \right) Y_D \geq 0 $
		      \end{itemize}
		\item podmínky: \begin{itemize}
			      \item $ \left( \forall uv \in E \right)\! \left( y_u + y_v + \sum_{D \in \lichrez G: uv \in D} Y_D \leq c_e \right) $
		      \end{itemize}
	\end{enumerate}
\end{defi}

\def\redcena#1{\fce{\overline c_{#1}}{y, Y}}
\begin{defi}[Redukovaná cena]
	\emph{Redukovaná cena} je \[
		\redcena {uv} \deq c_{uv} - y_u - y_v - \sum_{D \in \lichrez G} Y_D.
	\]
\end{defi}

Pro dané $ y, Y $ definujeme hrany přípustné pro duál: \[
	E_= \deq \left\{ e \in E \suchthat \redcena e = 0 \right\}.
\]

\begin{lemma}
	Z podmínek komplementarity (\ref{thm:Komplementarita}) vychází \begin{enumerate}
		\item $ uv \in M \to \redcena {uv} = 0 $,
		\item $ Y_D > 0 \to \fce xD = 1 $.
	\end{enumerate}
\end{lemma}

\begin{algo}[Perfektní párování minimální ceny]\ \\
	\AlgIn $ G $ graf, $ c: \fce EG \to \R^+_0 $.
	\begin{algorithmic}[1]
		\State $ M \gets \emptyset $
		\State $ \left( \forall e \in E \right)\! \left( y_e \gets 0 \right) $
		\State $ \left( \forall D \in \lichrez D \right)\! \left( Y_D \gets 0 \right) $
		\State Začneme \emph{inicializací stromu}.

		\Indent Inicializace stromu:
		\State Pokud neexistuje nespárovaný $ r $, vrátíme $ M $.
		\State $ T \gets $ nový prázdný strom s nespárovaným $ r $ jako kořenem.
		\EndIndent

		\Indent Budování stromu:
		\Indent Dokud $ \left( \exists uv \in E_= \right)\! \left( u \in \fce{B}{T}, v \notin T \right) $:
		\State Pokud $ v $ není spárovaný, zvětšíme $ M $ a přejdeme na \emph{inicializaci stromu}.
		\State Jinak přidáme $ uv $ a $ vw $ do $ T $, kde $ w $ je vrchol spárovaný s $ v $.
		\EndIndent
		\EndIndent

		\Indent Kontrakce cyklu:
		\Indent Pokud $ \left( \exists uv \in E_= \right)\! \left( u,v \in \fce{B}{T} \right) $:
		\State $ P_u, P_v \gets $ cesty ke spol. předchůdci.
		\State $ C \gets P_u \cup P_v \cup \left\{ uv \right\} $
		\State $ G \gets G \contr C $\Comment $ z $ je nový vrchol z kontrakce.
		\State $ T \gets T \contr C $
		\State $ M \gets M \contr C $
		\Indent Pro $ uv \in E: u \in C \land v \notin C $
		\State $ c_{zv} \gets c_{uv} - y_u $ \Comment $ \redcena {uv} $ bude stejná jako $ \redcena {zv} $
		\State Přestaneme uvažovat proměnnou $ y_u $.
		\EndIndent
		\State Přidáme proměnnou $ y_z \gets 0 $. \Comment Odpovídá proměnné $ Y_{\fce \delta C} $ v původním grafu.
		\State Pokračujeme \emph{budováním stromu.}
		\EndIndent
		\EndIndent

		\Indent Expanze cyklu:
		\Indent Pokud $ z \in \fce AT, z $ je pseudovrchol, $ y_z = 0 $:
		\State Expanduji $ z $ na původní $ C $.
		\State $ zv \in M $ změním na původní $ uv $.
		\State Zkonstruuji párování tak, aby bylo platné.
		\State Polovinu cyklu do stromu vůbec nepřidám.
		\EndIndent
		\EndIndent

		\Indent Změna $ y $:
		\State $ \varepsilon_1 \gets \fcec{\min}{\redcena {uv} \suchthat u \in \fce BT \land v \notin \fce VT} $
		\State $ \varepsilon_2 \gets \fcec{\min}{\frac {\redcena {uv}}2 \suchthat u,v \in \fce BT} $
		\State $ \varepsilon_3 \gets \fcec{\min}{z \suchthat z \text{ je pseudovrchol}, z \in \fce AT} $
		\State $ \varepsilon \gets \fce \min {\varepsilon_1, \varepsilon_2, \varepsilon_3} $
		\State Aktualizujeme $ y $: \[
			y_v \gets \begin{cases}
				y_v + \varepsilon & v \in \fce{B}{T},    \\
				y_v - \varepsilon & v \in \fce{A}{T},    \\
				y_v               & v \notin \fce{V}{T}. \\
			\end{cases}
		\]
		\State Pokračujeme \emph{budováním stromu}. % TODO: not done.
		\EndIndent

	\end{algorithmic}
	\AlgOut
\end{algo}

\begin{thm}[]
	Algoritmus pracuje v poly čase.
	Kontrakcí a expanzí bude $ \fce \O{n^2} $ za celou dobu běhu algoritmu.
\end{thm}


\begin{notation}
	Budu značit pro $ F \subseteq E $ vektor $ x^F $ jako \[
		x^F_e = \begin{cases}
			1 & e \in F,    \\
			0 & e \notin F.
		\end{cases}
	\]
\end{notation}

\def\ppp{\mathcal{P}_p}
\def\pzpp{\mathcal{P}_{zp}}
\def\pp{\mathcal{P}}

\begin{defi}[Polytop perfektních párování]
	Nechť $ G $ je graf.
	Pak \emph{polytop perfektních párování} na $ G $ je
	\[
		\ppp^G \deq \fce{\conv}{\left\{ x^M \suchthat M \text{ je perfektní párování} \right\}}.
	\]
\end{defi}

\begin{thm}[]
	$ \ppp $ je dán podmínkami LP pro perfektní párování.
\end{thm}

\begin{defi}[Polytop zlomkových perfektních párování]
	Nechť $ G $ je graf.
	Pak \emph{polytop zlomkových perfektních párování} na $ G $ je $ \pzpp^G $, dán podmínkami LP, ale bez podmínky o řezech.
\end{defi}

\begin{thm}[]
	Nechť $ y \in \pzpp $.
	Pak $ y $ je vrcholem $ \Longleftrightarrow $
	$ \left( \forall e \right)\! \left( y_e \in \left\{ 0, \frac 12, 1 \right\} \right) $ a $ \left\{ e \suchthat y_e = \frac 12 \right\} $ tvoří liché cykly.
\end{thm}

\begin{thm}[Alternativní podmínka LP]\label{pp alter}
	$ \ppp $ je také dán podmínkami \begin{enumerate}
		\item $ x_e \geq 0 $,
		\item $ \fce{x}{\fce \delta v} = 1 $,
		\item $ \left( \forall S \subseteq V: \absolute{S} = 2k+3 \right)\! \left( \fce x{\fce \gamma S} \leq \frac {\absolute S - 1}2 \right) $.
	\end{enumerate}
\end{thm}

\begin{lemma}[]
	Původní podmínka 3 je ekvivalentní současné 2 a 3.
\end{lemma}


\begin{thm}[]
	Navíc lze definovat \emph{polytop párování} $ \pp $, jako splňující \begin{enumerate}
		\item $ x_e \geq 0 $,
		\item $ \fce{x}{\fce \delta v} \leq 1 $,
		\item $ \left( \forall S \subseteq V: \absolute{S} = 2k+3 \right)\! \left( \sum_{uv \in E: uv \subseteq S} x_{uv} \leq \frac {\absolute S - 1}2 \right) $.
	\end{enumerate}
\end{thm}

\begin{lemma}[]
	\[
		\dim \pp = \absolute E.
	\]
\end{lemma}

\begin{lemma}[]
	$ \ppp $ je stěna $ \pp $ (ne nutně faseta).
\end{lemma}

\begin{lemma}[]
	$ \left( \forall e \right)\! x_e = 0 $ definuje fasetu.
\end{lemma}

\begin{lemma}[]
	$ \fce x {\fce \delta v} \leq 1 $ není faseta, pokud \begin{itemize}
		\item $ \deg v = 1 \land \deg w > 1 $ pro $ vw \in E $,
		\item $ \deg v = 2 $ a jeho sousedi nejsou spojeni hranou.
	\end{itemize}
\end{lemma}

\section{Totální unimodularita}

\begin{defi}[Totální unimodularita]
	Nechť $ A \in \R^{m \times n} $.
	$ A $ je \emph{totálně unimodulární} $ \equiv $ $ \left( \forall I \subseteq \range m \right)\! \left( \forall J \subseteq \range n \right)\!  $
	\[
		\det A^{IJ} \in \left\{ 0, 1, -1 \right\}.
	\]
\end{defi}

\begin{cor}[]
	Každá totálně unimodulární matice je z $ \left\{ 0, -1, 1 \right\}^{m \times n} $.
\end{cor}

\begin{thm}[]
	Nechť $ A \in \R^{m \times n} $ je totálně unimodulární.
	Nechť $ b \in \Z^m $.
	Pak $ \left\{ x \suchthat Ax = b \land x \geq 0 \right\} $ a $ \left\{ x \suchthat Ax \geq b \land x \geq 0 \right\} $ mají všechny vrcholy celočíselné.
\end{thm}

\begin{cor}[]
	Pokud má odpovídající lineární program pro libovolné $ c $ optimum, pak má i celočíselné optimum.
\end{cor}

\begin{prop}[]
	Totální unimodularita se nezmění \begin{itemize}
		\item transpozicí,
		\item permutací řádků/sloupců,
		\item vynásobením řádku/sloupce $ -1 $,
		\item přidáním/odstraněním řádku/sloupce s nejvýš 1 jedničkou, nulami jinde.
	\end{itemize}
\end{prop}

\begin{thm}[]
	Nechť $ A \in \left\{ 0,1,-1 \right\}^{m \times n} $ má v každém sloupci nejvýše dva nenulové prvky, a pokud jsou dva, pak si nejsou rovny.
	Pak $ A $ je totálně unimodulární.
\end{thm}

\begin{thm}[]
	Nechť $ A $ má v každém sloupci $ \leq 2 $ nenuly.
	Pak $ A $ je totálně unimodulární, právě když vynásobením některých řádků $ -1 $ lze dostat tvar z předchozí věty.
\end{thm}

\begin{thm}[]
	Matice incidence orientovaných grafů jsou totálně unimodulární.
\end{thm}

\begin{thm}[]
	Matice incidence neorientovaných grafů jsou totálně unimodulární, právě když graf je bipartitní.
\end{thm}

\begin{cor}
	TU nám může pomoci s větou o celočíselnosti toků a duality max. toku a min. řezu.
\end{cor}

\section{Matroidy}

\begin{defi}[Matroid]
	Nechť $ S $ je konečná množina, \textit{universum}.
	Nechť $ I \subseteq \pot S $.
	Pak $ \left< S, I \right> $ je \emph{matroid} $ \equiv $ \begin{itemize}
		\item $ \emptyset \in I $,
		\item $ \left( \forall J' \subseteq J \right)\! \left( J \in I \to J' \in I \right) $.
		\item $ \left( \forall A \subseteq S \right)\! \left( \forall J,J' \subseteq A \right)\! \left( J,J' = \fce {\maxi_\subseteq} {I \cap \pot A} \to \absolute J = \absolute {J'} \right) $.
	\end{itemize}
\end{defi}

K matroidům se váže následující názvosloví:
\begin{enumerate}
	\item \emph{nezávislá množina} $ \equiv $ prvek $ I $,
	\item \emph{báze} $ \equiv $ nezávislá množina maximální vůči inkluzi.
\end{enumerate}

\begin{examp}[]
	Nechť $ X $ je vektorový prostor.
	Nechť $ Y \subseteq X $ je množina nezávislých vektorů.
	Pak $ \left< X,Y \right> $ je matroid.
\end{examp}

\begin{examp}[]
	Nechť $ G $ je graf.
	Nechť $ F \subseteq \fce EG $ je množina acyklických množin hran.
	Pak $ \left< \fce EG,F \right> $ je matroid.
\end{examp}

\begin{examp}[]\label{matroid sqcup}
	Nechť $ S = S_1 \disjcup S_2 \disjcup \dots \disjcup S_n $.
	Nechť $ I \subseteq \pot S: $ \[
		x \in I \leftrightarrow \left( \forall i \right)\! \absolute {X \cup S_i} \leq 1.
	\]
	Pak $ \left< S,I \right> $ je matroid.
\end{examp}

\begin{examp}[]\label{matroid bip graf}
	Nechť $ G $ je bipartitní graf, kde $ \fce LG $ a $ \fce RG $ jsou jeho partity.
	Nechť \[
		I = \left\{ F \subseteq \fce EG \suchthat \left( \forall v \in \fce LG \right)\! \deg_F v \leq 1 \right\}.
	\]
	Pak $ \left< \fce EG, I \right> $ je matroid.
\end{examp}

\begin{obs}[]
	\ref{matroid bip graf} je speciální případ \ref{matroid sqcup}.
\end{obs}

\begin{defi}[Rank]
	Nechť $ \left< S,I \right> $ je matroid.
	Nechť $ A \subseteq S $.
	Pak \[
		\rank A \deq \absolute J : J = \fce {\maxi_\subseteq} {I \cap \pot A}.
	\]
\end{defi}

\begin{thm}[O výměně]
	Nechť $ S $ je konečná.
	$ B \subseteq \pot S $ je systém bází nějakého matroidu $ \left< I,S \right> $ $ \leftrightarrow $ \[
		B \neq \emptyset \land \left( \forall B_1, B_2 \in B \right)\! \left( \forall b_1 \in B_1 \setminus B_2 \right)\! \left( \exists b_2 \in B_2 \setminus B_1 \right)\! \left( B_1 \setminus \left\{ b_1 \right\} \cup \left\{ b_2 \right\} \in B \right). \]
\end{thm}

\begin{algo}[NzMna max ceny hladově]\ \\
	\AlgIn $ \left< S,I \right> $ matroid, $ c: S \to \R $.
	\begin{algorithmic}[1]
		\State $ J \gets \emptyset $
		\Indent Opakujeme, dokud to jde:
		\State $ s \gets \fcec \argmax {\fce cs \suchthat s \in S \setminus J \land J \cup s \in I \land \fce cs > 0} $
		\State $ J \gets J \cup \left\{ s \right\} $
		\EndIndent
	\end{algorithmic}
	\AlgOut $J = \argmax_{J \in I} \fce c J $.
\end{algo}

\begin{obs}[]
	Nechť $ S = \left\{ s_1, \dots, s_n \right\} $, tak, že $ \left( \forall i < j \right)\! \left( \fce c{e_i} \geq \fce c{e_j} \right) $.
	BÚNO nechť $ \left( \forall i \right)\! \left( s_i \geq 0 \right) $.
	Pak \[
		\left( \forall k \leq n \right)\! \left( \absolute {\left\{ s_i \right\}_{i \leq k} \cap J} = \rank \left\{ s_i \right\}_{i \leq k} \right).
	\]
\end{obs}

\begin{thm}[]
	$ J $ je optimální.
\end{thm}

\begin{defi}[Polytop matroidu]
	Nechť $ \left< S,I \right> $ je matroid.
	Pak \emph{polytop matroidu} je \[
		\left\{ x \in \R^{\absolute S} \suchthat \left( \forall s \in S \right)\! \left( x_s \geq 0 \right) \land \left( \forall A \subseteq S \right)\! \left( \fce xA \geq \rank A \right) \right\}.
	\]
\end{defi}

\begin{thm}[]
	Polytop matroidu je celočíselný.
\end{thm}

\begin{thm}[Bez Dk]
	Nechť $ \left< S, I_1 \right>, \left< S, I_2 \right> $ jsou matroidy.
	Nechť $ M $ je množina charakteristických vektorů $ \forall J \in I_1 \cap I_2 $.
	Pak $ \conv M $ je průnik polytopů matroidů, neboli \[
		\left\{ x \in \R^{\absolute S} \suchthat \left( \forall s \in S \right)\! \left( x_s \geq 0 \right) \land \left( \forall A \subseteq S \right)\! \left( \fce xA \leq \rank_{I_1} A \land \fce xA \leq \rank_{I_2} A \right) \right\}.
	\]
\end{thm}

\begin{examp}[]
	Nechť $ G $ je souvislý.
	Pak \[
		\left\{ x \in \R^{\absolute E} \suchthat \left( \forall e \right)\! \left( x_e \geq 0 \right) \land \left( \forall W \subseteq V \right)\! \left( \sum_{e \in \fce EW} x_e \leq \absolute W - 1 \right) \right\}
	\]
	definuje polytop matroidu acyklických podgrafů.
\end{examp}

\section{Celočíselné programování}

\begin{defi}[Platný řez]
	Nechť $ P = \left\{ x \in \R^n \suchthat x \geq 0 \land Ax \geq b \right\} $. Nechť $ Z = P \cap \Z^n $.
	Nechť $ \alpha x \leq \beta $ platí $ \forall x \in P $.
	Pak $ \lfloor \alpha \rfloor x \leq \lfloor \beta \rfloor $ je \emph{platný řez}.
\end{defi}

\begin{obs}[]
	Nechť $ \alpha x \leq \beta $ je platný řez.
	Pak \[
		\left( \forall x \in Z \right)\! \left( \alpha x \leq \beta \right).
	\]
\end{obs}

\begin{lemma}[]
	Mějme $ \alpha \in \Z^n, \beta \in \Z $.
	Pak $ \alpha x \leq \beta $ je platný řez $ \Leftrightarrow $ \[
		\left( \exists y \geq 0 \right)\! \left( \exists u \in \Z^n: u \leq \lfloor A^Ty \rfloor \right)\! \left( \alpha = u^T \land \beta = \lfloor b^Ty \rfloor \right).
	\]
\end{lemma}

\begin{obs}[]
	Poslední podmínka u alternativních podmínek PPP (\ref{pp alter}) je platný řez.
\end{obs}

\begin{thm}[Universalita metody řezu]
	Nechť $ P = \left\{ x \in \R^n \suchthat x \geq 0 \land Ax \geq b \right\} $. Nechť $ Z = P \cap \Z^n $.
	Nechť $ \alpha x \leq \beta $ je platná v $ Z $.
	Pak $ \alpha x \leq \beta $ lze odvodit ze soustvy $ Ax \geq b $ postupným přidáváním platných řezů.
\end{thm}

\end{document}                </a></li>

<li><a href="https://gitlab.mff.cuni.cz/uradnikf/bc_lec/-/raw/master/2223l/introcrypt/main.pdf">Intro to cryptography}
\author{Filip Úradník}
\date{\today}

\input{template}
\input{color.tex}
\input{english.tex}
\newtheorem{attack}[equation]{Attack}

\def\randin{\in_R}
\def\ss{\mathcal{S}}
\def\hh{\mathcal{H}}
\def\kk{\mathcal{K}}
\def\bit{b}
\DeclareMathOperator{\hmac}{HMAC}
\DeclareMathOperator{\sign}{sign}
\def\keys{\mathcal{K}}
\def\plaintexts{\mathcal{X}}
\def\ciphertexts{\mathcal{Y}}
\newcounter{saveenum}

\begin{document}
\maketitle

\section{Cryptographic Primitives}

\begin{defi}[Kerckhoff's principle]
	A cryptosystem should be secure even if everything about the system, except
	the key, is public knowledge.
\end{defi}

\begin{defi}[Encryption function]
	\textit{Encryption function} is a function $ E: \plaintexts \times
		\keys \to \ciphertexts $, where \begin{itemize}
		\item $ \plaintexts $ is the set of plaintexts, typically $ \left\{ 0,1 \right\}^n $,
		\item $ \ciphertexts $ is the set of ciphertexts, typically $ \ciphertexts = \plaintexts $,
		\item $ \keys $ is the keyspace, or the set of possible keys.
	\end{itemize}
\end{defi}

\begin{defi}[Decryption function]
	\emph{Decryption function} is a funcion $ D: \ciphertexts \times \keys \to \plaintexts $.
\end{defi}

\begin{notation}
	When talking about functions parametrised by a key $ k $, we will usually denote them by $ E_k $, that is \[
		\fce {E_k}X \equiv \fce E{k, X}.
	\]
\end{notation}

\begin{notation}[Strings]
	When describing strings, we will always use $ x \concat y $ as concatenation.
\end{notation}

\begin{defi}[Confidentiality]
	A protocol preserves \emph{confidentiality} $ \equiv $ no unintended party can get any information about the messages other than its size.
\end{defi}

\begin{defi}[Integrity]
	A protocol preserves \emph{integrity} $ \equiv $ no unintended party can modify messages sent using it (or such modifications will be detected).
\end{defi}



\subsection{Symmetric Encryption}

\begin{defi}[Symmetric encryption]
	In \textit{symmetric encryption}, the same key is used for encryption and decryption.
\end{defi}

\begin{defi}[Correctness property]
	$ E,D $ are \emph{correct} $ \equiv $ \[
		\left( \forall x \in \plaintexts \right)\! \left( \forall k \in \keys \right)\! \left( \fce D{\fce E{x,k}, k} = x \right).
	\]
\end{defi}

\begin{defi}[Security]
	Then $ E $ is \emph{secure} $ \equiv $ with a random key $ k $, the function $ E_k $ looks like\footnote{By \textquote{looks like}, we mean \textquote{within reasonable amount of time, we cannot tell it from a random function}.} a random permutation on the plaintexts.
\end{defi}

\subsection{Asymmetric Encryption}

\begin{defi}[Asymmetric encryption]
	In \textit{asymmetric encryption}, the keyspace is a set of pairs $ k_D, k_E $.
\end{defi}

\begin{defi}[Correctness]
	The cipher is \emph{correct} $ \equiv $ \[
		\left( \forall \left< k_E, k_D \right> \in \keys \right)\! \left( \forall x \in \plaintexts \right)\! \left( \fce D{\fce E{x, k_E}, k_D} = x \right).
	\]
	Furthermore, one key of the pair cannot be derivable from the other one.
\end{defi}

\begin{defi}[Detached signature scheme]
	In a \textit{detached signature scheme}, we create signatures of the hash of
	the plaintext, instead of the plaintext itself.
\end{defi}

\begin{defi}[Symmetric signatures]
	In a \textit{symmetric signature scheme}, we hash the message concatenated
	with the key.
\end{defi}

\begin{defi}[Hybrid cipher]
	In a hybrid cipher, we use a symmetric cipher to encrypt the plaintext with a
	random key, and then we encrypt the key of the symmetric cipher with an
	asymmetric cipher.
\end{defi}

\begin{defi}[Challenge-response authentication]
	In \textit{challenge-response authentication}, the server sends a random
	challenge to the client, and the client has to send a response, which is a
	hash of the challenge concatenated with the password. The server then checks,
	if the response is correct.
\end{defi}

\subsection{Hash Functions}

\begin{defi}[Hash function]
	\textit{Hash function} is a function $ h: \left\{ 0,1 \right\}^* \to \left\{
		0,1 \right\}^k $.
\end{defi}

\begin{defi}[Properties of hash functions]
	In cryptography, we require different properties from hash funcions than in other parts of computer science.
	Specifically, we want the hash function to be \begin{itemize}
		\item \emph{non-invertible} $ \equiv $ we cannot easily derive (any) input from a given output,
		\item \emph{collision resistant} $ \equiv $ we cannot easily find $ x,y: \fce hx = \fce hy $.
	\end{itemize}
\end{defi}

\subsection{Random Generators}

\begin{defi}[Random generator]
	\textit{Random generator} is a source of an infinite sequence of random bits.
\end{defi}

\begin{defi}[Properties of RNGs]
	A random generator should be \begin{itemize}
		\item \emph{non-predictable} $ \equiv $ we cannot predict the next bit, even if we know the algorithm and its full history,
		\item \emph{non-influencable}\footnote{This is a problem mainly for hardware implementations.} $ \equiv $ we cannot make the generator prefer some sequences of bits over others.
	\end{itemize}
\end{defi}

\subsection{Attacks}

\begin{defi}[Attack model]
	The most common attack models include:
	\begin{itemize}
		\item \emph{known ciphertext} $ \equiv $ the attacker tries to recover the plaintext,
		\item \emph{known plaintext} $ \equiv $ the attacker tries to recover the key,
		\item \emph{chosen plaintext} $ \equiv $ the attacker tries to recover the key, when the other party encrypts plaintexts of the attacker's choice,
		\item \emph{distinguishing attack} $ \equiv $ the attacker tries to distinguish between classes of plaintexts.
	\end{itemize}
\end{defi}

\begin{defi}[Security level]
	The security level of the protocol is $ b $ bits $ \equiv $ the attacker
	requires $ \geq 2^b $ operations\footnote{The term operation is not precisely
		defined, we will generally require $ b $ to be so big, that it doesn't really
		matter what exactly we mean by an operation.} to break the protocol.
\end{defi}

\begin{thm}[Birthday attacks]
	Let's assume that in a given protocol, we use a random nonce, which has $ b $ bits.
	After $ 2^{\frac b2} $ runs, the attacker has a probability of $ \frac{1}{2} $, that a nonce has been repeated, which he can use to break the protocol.
	That means, that the security level of the protocol is $ \frac b2$ bits.
\end{thm}

\begin{defi}[Side channel]
	A \emph{side channel} is an additional source of information available to the attacker.
\end{defi}


\section{Information-Theoretic Security}

Also called Shanon security.

\subsection{One-time Pad}


\begin{examp}[One-time Pad, Vernam's Cipher]
	\emph{One-time pad} is a symmetric cipher, where $ \keys = \plaintexts = \ciphertexts = \left\{ 0,1 \right\}^n $.  \begin{itemize}
		\item the \emph{encryption function} is $ \fce {E_k}x \deq x \xor k $,
		\item the \emph{decryption function} is $ \fce {D_k}y \deq y \xor k = \left( x \xor K \right) \xor K = x $.
	\end{itemize}
\end{examp}

\begin{examp}[General One-time Pad]
	Let $ \left< G, +, 0, - \right> $ be a group.
	The \emph{General One-time Pad} is a symmetric cipher, where $ \keys = \plaintexts = \ciphertexts = \left\{ 0,1 \right\}^n $.
	\begin{itemize}
		\item the \emph{encryption function} is $ \fce {E_k}x \deq x + k $,
		\item the \emph{decryption function} is $ \fce{D_k}{y} \deq y - k = \left( x + k \right) - k = x $.
	\end{itemize}
\end{examp}

\begin{prop}[Properties of the OTP]
	\
	\begin{itemize}
		\item We cannot repeat keys.
		\item Flipping bits in ciphertext flips bits in plaintext.
	\end{itemize}
\end{prop}


\begin{defi}[Perfect security]
	A cipher is \emph{perfectly secure} $ \equiv $ \[
		\left( \forall x \in \plaintexts \right)\! \left( \forall y \in \ciphertexts \right)\! \left( \exists c \right)\! \left( \forall k \in \keys \right)\! \left( \fceb {\Pr} {\fce{E}{x,k} = y} = c \right).
	\]
\end{defi}

\begin{cor}[]
	The (General) One-time Pad is perfectly secure.
\end{cor}

\begin{thm}[]
	Suppose a cipher keeps the message length.
	Then, if $ \keys \mohlt \plaintexts $, then the cipher is not perfectly secure.
\end{thm}

\subsection{Secret Sharing}

\begin{defi}[Secret sharing/splitting]
	Let $ \ss $ be a secret of known size. We want to split it into $ k $ shares
	$ S_1, \dots, S_k $, such that with all the shares, we can recover the
	secret, but with any subset of them missing, we can recover nothing about the
	secret.
\end{defi}

\begin{examp}[]
	$ S_1 \randin \left\{ 0,1 \right\}^n $, $ S_2 \deq \ss \xor S_1 $.
\end{examp}

\begin{examp}[]
	$ S_1, \dots, S_{k-1} \randin \left\{ 0,1 \right\}^n $, $ S_{k} \deq \ss \xor \bigoplus_{i=1}^k S_i $.
\end{examp}

\begin{defi}[$ \left( k,l \right) $-treshold scheme]
	Let $ k,l \in \N $. We want to split $ \ss $ into $ k $ shares, such that \begin{itemize}
		\item with any $ l $ shares, we can recover the secret,
		\item with any $ < l $ shares, we can recover nothing about the secret.
	\end{itemize}
\end{defi}

\begin{examp}[$ \left( k,2 \right) $]
	Let $ \F $ be a finite field, $ y \randin \F $. Let \[
		\fce{f}{x} \deq \ss + \left( y - \ss \right) x.
	\]
	Then $ S_i \deq \left( i, \fce{f}{i} \right) $. The secret can be reconstructed
	by reconstructing $ f $ and then evaluating $ \fce{f}{0} $.
\end{examp}

\begin{examp}[$ \left( k,l \right) $]
	Let $ \F $ be a finite field. We can define $ \fce{p}{i} $ of degree $ < l $, such that \[
		\fce{p}{i} \deq \begin{cases}
			\ss        & i = 0     ,                                        \\
			\randin \F & 0 < i < l,                                         \\
			\fce pi    & \text{defined uniquely by the first $ l $ points.}
		\end{cases}
	\]
	Then, $ S_i \deq \left( i, \fce{p}{i} \right) $ for $ i \in \left\{ 1, \dots, k \right\} $.
\end{examp}

\section{Block Ciphers}

\begin{defi}[Block cipher]
	A \emph{Block cipher} $ \left< D,E,b \right> $ is a symmetric cipher, where $ \ciphertexts = \plaintexts = \left\{ 0,1 \right\}^b $.
\end{defi}

\begin{prop}[]
	If the block size is small, the ciphertext can be analysed statistically to guess information about the key, and then the plaintext.
\end{prop}

Now, let's try to say something about the security level of a block cipher.

\begin{defi}[Verifier]
	A \emph{verifier} is a randomised algorithm, that gets either a sequence of blocks encrypted by our block cipher, with a random key, or a sequence of fully random blocks.
	It has to say whether its input is random, or the cipher.
	We want its probability of being correct to be $ > \frac 12 $.
\end{defi}

\begin{defi}[Block cipher security]
	A block cipher's \emph{security level} is $ b $
	bits $ \equiv  $ every verifier requires $ \geq 2^{b} $ steps.
\end{defi}

With real-world ciphers, we can't really prove that they satisfy such
definition. In fact, we don't know how to design strong ciphers. But we do know
how to design weak ones, and then repeat them to make them stronger:

\begin{defi}[Key schedule]
	A \emph{key schedule} is an algorithm $ K $, parametrized by a \emph{key},
	and an \emph{iv}, that generates other keys.
\end{defi}

The key schedule can for example just select a subset of its bits and permutate them somehow.
It can however also do something non-trivial.

\begin{defi}[Iterated cipher design]
	An \emph{iterated cipher} is $ \left< B,K,n,\left\{ R_i \right\}_{i=1}^n \right> $, where
	\begin{itemize}
		\item $ B $ is a (weak) \emph{block cipher},
		\item $ n $ is the \emph{number of rounds},
		\item $ R_i $ are the \textquote{round functions}\footnote{Usually, they are all the same, but sometimes, the first and last rounds can be a little different.},
		\item $ K $ is a \emph{key schedule}.
	\end{itemize}
	The round functions utilize the encryption function of the original block cipher.
	The encryption function works in rounds: $ X_0 = X $, $ X_i = \fce {R_i}{X_i, \fce K{k,i}} $.
	Finally, \[
		\fce {E_k}{X} = X_n.
	\]
\end{defi}

\begin{defi}[Substitution-Permutation Network]\ \\
	An \emph{SPN} is an iterated cipher, where the round functions work as follows:
	\begin{algorithmic}[1]
		\State XOR the input with the key. \Comment This is the only place where we use the key.
		\State Split the input into parts.
		\State Run each part through an \emph{S-box}. \Comment This is the, potentially weak, block cipher function.
		\State Concatenate the parts back together.
		\State Run the result through a \emph{P-box}. \Comment A P-box does a permutation on the bit positions.
	\end{algorithmic}
\end{defi}

When this cipher is used iteratively, the last round usually replaces the last
permutation with a XOR of another (new) round key.

\begin{obs}
	Decryption is also an SPN\footnote{That is easier to implement in hardware.}, as permutation and XOR are commutative, as long as we also run the key through the P-box.
\end{obs}

\begin{obs}[]
	Because we xor with the key at the start, an attacker has no way to influence the input to the S-boxes.
	This disables many chosen plaintext attacks.
\end{obs}

\begin{defi}[Fiestel Network]
	Let $ f $ be any function, potentially non-invertible, parametrized by a key, so called Fiestel function.
	A Fiestel Network is an iterated cipher, where $ n = 2m $, and in place of the block cipher, we have $ f $.
	Let $ i = 2k $. Rounds $ i $ and $ i+1 $ for input $ I $ look like this:
	\begin{algorithmic}[1]
		\State Split $ I $ into halves $ I_1, I_2 $.
		\State $ k_1 \gets \fce K{k,i} $
		\State $ k_2 \gets \fce K{k,i+1} $
		\State $ O_2 \gets \fce{f}{k_1, I_1} \xor I_2 $
		\State $ O_1 \gets \fce{f}{k_2, O_2} \xor I_1 $
		\State The output is $ O_1 \cdot O_2 $.
	\end{algorithmic}
	Alternatively, we can define only one round and then switch sides:
	\begin{algorithmic}[1]
		\State Split $ I $ into halves $ I_1, I_2 $.
		\State $ k_r \gets \fce K{k,i} $
		\State $ O \gets \fce{f}{k_r, I_1} \xor I_2 $
		\State The output is $ O \cdot I_1 $.
	\end{algorithmic}
\end{defi}

\begin{cor}[]
	The inverse of a Fiestel Network is again a Fiestel Network, only you reverse round keys.
\end{cor}

\begin{examp}[DES]
	DES is a Fiestel Network with $ 64b $ blocks, $ 56b $ keys and $ 16 $ rounds.
	The key schedule just selects a subset of $ 48 $ bits and permutates them.
	The Fiestel function looks like this:
	\begin{algorithmic}[1]
		\Indent Expand the $ 32b $ input to $ 48b $:
		\State Split the input to $ 8 $ parts.
		\State Prepend and append the neighbouring bits to each part (wrap around for first and last).
		\State Put the parts back together.
		\EndIndent
		\State XOR the expanded input with the round key.
		\State Split the expanded input to $ 8 \times 6\bit $.
		\State Run each part through an S-box (outputs only $ 4\bit $).
	\end{algorithmic}
	At the start end end of the whole encryption, additional P-boxes are used.
\end{examp}

\begin{prop}[Problems of DES]
	\
	\begin{itemize}
		\item Small blocksize, keysize.
		\item For $ k = 0 $, $ E = D $.
		\item There are (about 18) \textquote{weak keys of DES} -- for example, with all zeros, $ E = D $.
		\item $ \fce{E_{\overline k}}{\overline X} = \overline {\fce{E_k}{X}} $.
	\end{itemize}
\end{prop}

\begin{note}
	Since DES used to be the only well-studied cipher, people wanted to just tweak it to make it stronger.
	2-DES just runs DES twice (btw adding 1 bit of security),
	3-DES is a bit more interesting, its encryption function looks like \[
		\fce{E_{k_1}}{\fce{D_{k_2}}{\fce{E_{k_3}}{X}}},
	\]
	where $ E,D $ are the encryption functions of DES. That about doubles the
	security level, plus it's quite easy to implement in hardware.
\end{note}

After a while, in 1997, there was the AES competition:

\begin{examp}[AES]
	AES is an SPN with additional linear transform, $ 128b $ blocks, $ 128/192/256b $ keys, $ 10/12/14 $ rounds.
	\begin{algorithmic}[1]
		\State Turn the input into a $ 4 \times 4 $ state matrix of bytes.
		\State ByteSub: Apply S-boxes to all bytes (view them as elements of a field). \Comment S,
		\State ShiftRow: Permute bytes within rows, independently of each oter. \Comment P,
		\State MixColumn: Look at each column as a 4D vector, apply some linear map on it. \Comment Linear transform.
		\State XOR round key to the state.
	\end{algorithmic}
\end{examp}

\begin{cor}[]
	Again, the decryption is the same as encryption.
\end{cor}

\begin{prop}[Problems of AES]
	\
	\begin{itemize}
		\item Simple algebraic structure -- might be broken by advances in algebra.
		\item Small number of rounds -- specifically, small gap from the number of rounds for which an attack is known.
		\item Byte-aligned -- restricts variance in output\footnote{This does, however, make it much faster in software implementations.}.
		\item Short key -- quantum attack by Grover's algorithm in $ 2^{64} $ steps.
		\item Small block size -- expected collision at $ 2^{64} $ blocks\footnote{Fixes by re-keying every couple of billion blocks}.
	\end{itemize}
\end{prop}

A problem of block ciphers is, that you usually don't have your data exactly of the size of a multiple of blocksize. That's why we use padding.

\begin{defi}[Padding scheme]
	A \emph{padding sheme} is a \emph{reverteble} function turning any-sized data
	into a data of size divisible by blocksize.
\end{defi}

\begin{cor}[]
	You always need to add at least one byte of padding, as without it you won't
	be able to tell the padding from the message.
\end{cor}

\begin{defi}[Block cipher mode]
	\emph{Block cipher mode} is a policy on encrypting multiple blocks.
\end{defi}

\begin{examp}[ECB]
	Electronic Code Book is a BCM that encrypts the blocks using the same cipher and the same key.
\end{examp}

\begin{prop}[Properties of ECB]
	\
	\begin{itemize}
		\item It can be parallelized.
		\item $ X_1 = X_2 \to \fce E{X_1} = \fce E{X_2} $.
		\item Manipulating $ \fce E{X_i} $ leaves the rest of the ciphertext in tact.
		\item Flipping blocks in ciphertexts flips them in the plaintext.
	\end{itemize}
\end{prop}

\begin{examp}[CBC]
	Cipher Block Chaining is a BCM, that, before encrypting a block, XORs the ciphertext of the previous block to it.
	First block gets XORed to an IV.
\end{examp}

\begin{prop}[Properties of CBC]
	\
	\begin{itemize}
		\item Encryption cannot be parallelized, but decryption still can.
		\item Manipulation with a block of ciphertext destroys it and its successor; the rest of successors are destroyed predictibly.
	\end{itemize}

\end{prop}

\begin{cor}[Information leak of CBC]
	Let $ Y_i $ be the encrypted $ X_i $ after XOR. \[
		Y_i = Y_j \implies \fce{E_K}{X_i \xor Y_{i-1}} = \fce{E_K}{X_j \xor Y_{j-1}} \implies X_i \xor Y_{i-1} = X_j \xor Y_{j-1} \implies X_i \xor X_j = Y_{i-1} \xor Y_{j-1},
	\]
	But the attacker can compute $ Y_{i-1} \xor Y_{j-1} $.
\end{cor}

\begin{cor}[]
	After $ 2^{\frac{b}{2}} $ blocks, CBC leaks approx. $ b $ bits of information (after that, it starts leaking quite a lot more).
\end{cor}


\begin{examp}[CTR]
	Counter is a BCM for stream ciphers, which uses block ciphers to create the keystream.
	The $ n $-th block of a keystream is $ \fce{E_K}{IV + n} $. The keystream is XORed to the plaintext.
\end{examp}

\begin{cor}[]
	Blocks never repeat in a keystream.
\end{cor}

\begin{cor}[]
	If $ Y_i = Y_j $, then $ X_i \xor S_i = X_j \xor S_j $, so $ X_i \xor X_j = S_i \xor S_j \neq 0 $, so that means that $ X_i \neq X_j $.
\end{cor}

\begin{defi}[Padding oracle]
	A \emph{padding oracle} is a function that tells you, whether the message is correctly padded.
\end{defi}

A padding oracle can be the server itself, for example when it explicitly tells you.
Or, you can measure the response time, and from that deduce, whether it was correctly padded, or rejected.

\begin{attack}[CBC] \label{attack:cbc}
	Let's assume we have a padding oracle.
	We can flip bits in a given block of ciphertext.
	\begin{algorithmic}[1]
		\State We keep flipping bits until we change the last byte to $ 1 $. \Comment That is also a validly padded message.
		\State Now, we have $ P $, the number of bytes in padding.
		\State We flip all $ P $s to be $ P+1 $.
		\State Now, the only way to make it valid, the last byte of the message itself must also be $ P+1 $.
		\State From the flipped bits we recover a byte of the message.
		\State Repeat for all the bytes in the last block.
	\end{algorithmic}
	This way, we can recover the message, one byte at a time. This can be extended to all blocks except the first one (not unless we know the IV).
\end{attack}

\section{Stream Ciphers}

\begin{defi}[Keystream]
	A \emph{keystream} is a pseudo-RNG parametrized by a \emph{key} and an \emph{initialization vector}, which then generates a stream of (pseudo-)random bits.
\end{defi}


\begin{defi}[Stream cipher]
	A \emph{stream cipher} $ \left< E, D, K \right> $ is a symmetric cipher, defined by a \emph{key stream} $ K $.
	In its most basic form, it looks like this: \[
		\fce{E_{k,i}}{X} \deq X \xor \fce{K}{k, i}.
	\]
\end{defi}

\begin{cor}[Basic properties of stream ciphers]
	Stream ciphers have the following properties: \begin{itemize}
		\item $ E = D $,
		\item $ \fce{E}{\overline X} = \overline {\fce{E}{X}} $.
		\item repeating the IV is not secure,
		\item the attacker can flip bits,
		\item encryption is commutative.
	\end{itemize}
\end{cor}

\begin{defi}[LFSR]
	Linear Feedback Shift Register is a keystream generator.

	\AlgIn $ b $, $ I \subseteq \left[ b \right] $ -- parameters of LFSR.
	\begin{algorithmic}[1]
		\State Initialize $ B $ to be a $ b $-bit register.
		\Indent Repeat:
		\State Shift out the last bit of the register to the output.
		\State $ n \gets \bigoplus \left\{ B_i \right\}_{i \in I} $
		\State Insert $ n $ as the new first bit of the register.
		\EndIndent
	\end{algorithmic}
	\AlgOut A stream of pseudo-random bits.
\end{defi}

\begin{prop}[Properties of LFSR]
	\
	\begin{itemize}
		\item Periodic, but the period can be $ 2^b - 1 $ bits.
		\item Next bit is a dot product of the \textquote{key} and the current register -- easy to break.
	\end{itemize}
\end{prop}

\begin{prop}[Better LFSRs]
	\
	\begin{itemize}
		\item Introduce a non-linear function (replace one XOR with AND for ex.) -- less breakable, but also harder to prove the period length.
		\item Take many of LFSRs, combine outputs with non-linear function.
		\item Use output of one LFSR as a clock to another LFSR (almost impossible to prove anything :D).
	\end{itemize}
\end{prop}

\begin{defi}[Trivium] \emph{Trivium} is a stream cipher mainly for IoT devices.
	\begin{itemize}
		\item Designed for devices that don't have much computing power.
		\item LSFR with added non-linearities.
		\item $ 80b $ security level.
	\end{itemize}

\end{defi}

Another example of a stream cipher is RC4, but that is broken.

\begin{examp}[ChaCha20]
	\emph{ChaCha20} is a stream cipher with \begin{itemize}
		\item $ 256\bit $ key,
		\item $ 64\bit $ IV,
		\item $ 64\bit $ counter,
		\item 20 rounds.
	\end{itemize}
	\begin{algorithmic}[1]
		\State $ S \gets $ a $ 4 \times 4 $ matrix of $ 32\bit $ numbers -- initially the key, IV and \emph{counter}.
		\State $ S_0 \gets S $
		\Indent For each 2 rounds:
		\State $ S \gets $ ARX on rows. \Comment Addition, rotation, XOR.
		\State $ S \gets $ ARX on diagonals.
		\EndIndent
		\State $ S \gets S + S_0 $ \Comment Breaks simple attacks.
	\end{algorithmic}
\end{examp}

There are more stream ciphers, for example \emph{Serpert} or \emph{Twofish}, but they are slow.

\section{Hash functions}

\begin{defi}[Hash function]
	A \emph{hash function} is \[
		h: \left\{ 0,1 \right\}^* \to \left\{ 0,1 \right\}^b.
	\]
\end{defi}

In cryptography, we have the following requirements for hash functions: \begin{enumerate}
	\item \emph{collision resistance}: cannot find $ x,y: x \neq y \land \fce{h}{x} = \fce{h}{y} $.\label{collision res}
	\item \emph{second preimage resistance}: $ \forall x $ cannot find $ x' \neq x: \fce{h}{x} = \fce{h}{x'} $.\label{second preim res}
	\item \emph{first preimage resistance}: $ \forall y $ cannot find $ x: \fce{h}{x} = y $.\label{first preim res}
\end{enumerate}

\begin{cor}[]
	We can see, that (\ref{first preim res}) $ \Rightarrow $ (\ref{second preim res}) $ \Rightarrow $ (\ref{collision res}).
\end{cor}

\begin{defi}[Compression function]
	A \emph{compression function} is \[
		f: \left\{ 0,1 \right\}^b \times \left\{ 0,1 \right\}^b \to \left\{ 0,1 \right\}^b.
	\]
\end{defi}

\begin{algo}[Merkle-Demgård construction, $ h $]\ \\ \label{m-d construction}
	\AlgIn $ X $, a long message.
	\begin{algorithmic}[1]
		\State Split $ X $ into $ X_1, \dots, X_n $ blocks of size $ b $.
		\State Pad if necessary.
		\State $ R \gets $ initialization vector. \Comment A known constant.
		\Indent For $ X_i $:
		\State $ R \gets \fce{f}{R,X_i} $
		\EndIndent
		\State $ R \gets \fce{f}{R , n} $
	\end{algorithmic}
	\AlgOut A hash of $ X $.
\end{algo}

\begin{thm}[]
	If $ f $ is colision resistant, then so is $ h $.
\end{thm}

\begin{attack}[Length Extension]
	Let $ X $ be a secret mesage. Suppose we know $ \fce{h}{X} $.
	\begin{algorithmic}[1]
		\State Append $ X' $, such that it starts with the padding of $ X $ and $ n $.
		\State Compute $ \fce h {\fce hX \concat X'} $.
	\end{algorithmic}
\end{attack}

\begin{prop}[]
	Because of birthday attacks, and because we require collision resistance, we consider the security level to be $ \frac{b}{2} $.
\end{prop}


\begin{attack}[Birthday]
	Generating $ 2^{\frac{b}{2}} $ we expect to find a collision.
\end{attack}

The problem is, we need to keep all the hashes in memory.

\begin{attack}[Tortoise \& Hare]\
	\begin{algorithmic}[1]
		\State Pick a starting point.
		\Indent Traverse the graph of hashes:
		\State Hare travels $ 2 $ hashes per unit of time.
		\State Tortoise travels 1 hash per unit of time.
		\EndIndent
		\State When they meet, remove Hare and add Turtle also with speed 1.
		\State When they meet, we have a collision.
	\end{algorithmic}
\end{attack}

\begin{cor}[]
	T \& H take $ \fce \O{2^{\frac b2}} $ time to find a collision, with $ \fce \O 1 $ memory.
\end{cor}

\begin{cor}[]
	Suppose we have a parametrized message with $ b $ parameters.
	We can use T\&H again, just replacing the hash function with \[
		\fce{h'}{x_1, \dots, x_b} = \fce{h}{\fce{M}{x_1, \dots, x_b}}.
	\]
\end{cor}

\begin{attack}[Innocent and evil]\
	\begin{algorithmic}[1]
		\State Generate parametrized evil messages.
		\State Generate parametrized innocent messages.
		\State After both sets are $ \fce \O{2^{\frac b2}} $ big, they collide.
	\end{algorithmic}
\end{attack}

\begin{attack}\
	\begin{algorithmic}[1]
		\State Find $ a_1, b_1: \fce{f}{IV, a_1} = \fce{f}{IV, b_1} = y_1 $.
		\Indent Repeat $ k $ times:
		\State Find $ a_i, b_i: \fce{f}{y_{i-1}, a_{i-1}} = \fce{f}{y_{i-1}, b_{i-1}} = y_i $.
		\EndIndent
	\end{algorithmic}
	With this, if we can find one colision in $ T $, we have $ 2^k $ collisions in just $ \fce{\O}{k T} $.
\end{attack}

\begin{cor}[]
	Concatinating the results of two hash functions, given at least one of them is a M-D construction, doesn't increase the security level very much.
\end{cor}

\begin{examp}[Davies-Meyer construction]\ \\
	Let $ \left< E,D,b \right> $ be a block cipher.
	\[
		\fce{f}{a,b} \deq \fce{E_a}{b} \xor b.
	\]
\end{examp}

\begin{prop}[Properties of D-M]
	\
	\begin{itemize}
		\item Without the XOR, it is broken (decryption gives us collisions).
		\item If the block cipher is DES, then \[
			      \fce{f}{\overline a, \overline b} = \fce{E_{\overline a}}{\overline b} \xor \overline b = \fce{f}{a,b}.
		      \]
	\end{itemize}
\end{prop}

\begin{thm}[No proof]
	If $ E $ is an ideal block cipher, then $ f $ is \emph{collision resistant.}
\end{thm}

\begin{examp}[MD5\footnote{\textquote{the DES of hash functions.}}]
	It has $ 128b $ output. Since 2004 we can find collisions with a chosen prefix.
\end{examp}

\begin{examp}[SHA-1, NSA]
	$ 160b $ output, it's fast. In 2015, found collision in the compression function, in 2017, full collisions.
\end{examp}

\begin{examp}[SHA-2]
	A family of functions, $ 224, 256, 384, 512b $, not broken yet.
\end{examp}

\begin{note}
	SHA-1s and 2s are built from the SHACAL block cipher.
\end{note}

\begin{defi}[Sponge construction]
	A \emph{sponge} is a datastructure parametrized by $ r,c,m $ and $ \pi $, where \begin{itemize}
		\item $ \pi $ is the \emph{sponge function} -- a \emph{permutation on blocks} of size $ w = r+c $,
		\item $ r $ is the \emph{rate} (also the size of the blocks of input/output),
		\item $ c $ is the \emph{capacity}.
	\end{itemize}
	The sponge keeps internal state $ x $ also of size $ w $.
	It works in two phases -- absorbing and squeezing.
	\begin{algorithmic}[1]
		\State $ x^0 \gets 0^w $ \Comment IV, defined in the standard to be all zeros.
		\Indent For all $ n $ blocks of the input:\Comment Absorbing.
		\State $ \hat x^{i+1}_{1 \dots r} \gets x^i_{1 \dots r} \xor b_i $
		\State $ x^{i+1} \gets \fce{\pi}{\hat x} $
		\EndIndent
		\Indent For all $ m $ blocks of the desired output: \Comment Squeezing.
		\State $ o_i \gets x^i_{1 \dots r} $
		\State $ x^{i+1} \gets \fce{\pi}{x^i}  $
		\EndIndent
	\end{algorithmic}
\end{defi}

\begin{prop}[Security against BF]
	Suppose $ \pi $ is a random permutation.
	\begin{itemize}
		\item The output repeats every $ 2^{r \slash 2} \bit $.
		\item By birthday paradox, in $ 2^{c \slash 2} $ steps, there will be a collision in the internal states (and the non-internal states are under our control).
		\item The security level of sponge is $ \fce {\min}{\frac c2, \frac r2} $ bits.
	\end{itemize}
\end{prop}

\begin{examp}[SHA-3] % TODO: implement later.
	Again, a winner of a competition.
	SHA-3 is a sponge construction based on Keccak (perm. on $ 1600b $ blocks).

	\begin{itemize}
		\item \textit{(SHA3-$ k $, the output length: $ r = 1600-2k, c = 2k $)}
		\item SHA3-224: $ r = 1152, c = 448 $,
		\item SHA3-512 $ r = 576, c = 1024 $,
		\item SHAKE-128 $ r = 1344, c = 256 $,
		\item SHAKE-256 $ r = 1088, c = 512 $,
	\end{itemize}
\end{examp}

\begin{note}[]
	The SHAKEs are so-called Extensible-output functions, they have lower security, but they can be used to generate a random sequence of arbitrary size from absorbing the input.
\end{note}


\begin{defi}[Merkle tree]
	A \emph{Merkle tree} is a tree, that has the blocks of the input in its leaves, and in all internal vertices, it has the hashes of its children.
	Its final output, hash of the leaves, is in its root.
\end{defi}

\begin{cor}[Properties of Merkle trees]
	\
	\begin{itemize}
		\item Nodes in one layer can be computed in parallel.
		\item If a single block is changed, we only need to recompute the path from it to the root.
	\end{itemize}

\end{cor}

\begin{attack}
	If we know the root hash, we can compute the hashes of all extensions of the message.
\end{attack}

\begin{cor}[Fixes]\
	\begin{itemize}
		\item Add additional information to the hash, for example, whether or not the current vertex is root.
		\item Use \emph{Sakura coding}, which encodes the shape of the tree in the hash.
	\end{itemize}

\end{cor}

\section{Signatures}

\subsection{Message Authentication Codes}

\begin{defi}[MAC]
	A \emph{Message Authentication Code} is a signature scheme, where both parties share a secret key.
\end{defi}


\begin{defi}[CPA on signatures]
	\emph{Chosen plaintext attack} assumes that attacker has access to the signing oracle, and can sign arbitrary messages.
	\begin{algorithmic}[1]
		\State The attacker has the oracle sign $ x_1 \dots, x_n $.
		\State The attacker produces forged signature for $ x $ without the oracle.
	\end{algorithmic}
\end{defi}


\begin{examp}[KMAC]
	Let $ h $ be the hash function of SHA-3. The signature for a given key $ K $ and message $ x $ is just $ \fce{h}{K \cdot x} $.
\end{examp}

\begin{prop}[]
	For M-D construction hashes (\ref{m-d construction}), the KMAC construction is not secure, because of extensibility.
\end{prop}

\begin{prop}[]
	Even if we do $ \fce h{x \concat K} $, M-D is not very secure, because for $ \absolute{x} \gg \absolute{K} $, most of the computation is key-independent, which has security implications.
\end{prop}

\begin{defi}[HMAC]
	\emph{HMAC} is a construction, parametrized by a hash function $ h $ and two constants, $ C_i $ and $ C_o $, which are defined in the standard.
	The signature for a message $ x $ is \[
		\fce{\hmac_h}{x, K} \deq \fce{h}{K \xor C_o \concat \fce{h}{K \xor C_i \concat x} }.
	\]
\end{defi}

\begin{note}[]
	HMAC is believed to be OK even for SHA-1.
\end{note}


\subsection{Authentication and encryption}

\begin{defi}[Encrypt \& MAC]\
	\begin{algorithmic}[1]
		\State $ y \gets \fce{E_K}{x} $
		\State $ s \gets \fce{S_{K'}}{x} $
		\State Return both $ y $ and $ s $.
	\end{algorithmic}
\end{defi}

\begin{prop}[]
	Encrypt \& MAC leaks information about the message, for example, whether two messages are the same.
\end{prop}

\begin{defi}[Encrypt, then MAC]\
	\begin{algorithmic}[1]
		\State $ y \gets \fce{E_K}{x} $
		\State $ s \gets \fce{S_{K'}}{y} $
		\State Return both $ y $ and $ s $.
	\end{algorithmic}
\end{defi}

\begin{prop}[]\
	\begin{itemize}
		\item Attacker is stopped immidiately, before getting to the encryption.
		\item The most secure construction.
	\end{itemize}
\end{prop}

\begin{defi}[MAC, then encrypt]\
	\begin{algorithmic}[1]
		\State $ s \gets \fce{S_{K'}}{x} $
		\State $ y \gets \fce{E_K}{x \concat s} $
		\State Return only $ y $.
	\end{algorithmic}
\end{defi}

\begin{prop}[]
	\ \begin{itemize}
		\item MAC as early as possible -- authenticity $ \gg $ confidentiality.
		\item MAC \textquote{hidden} behind encryption.
		\item Used in TLS $ \leq 1.2 $.
		\item Vulnerable to timing oracles when using block ciphers for both encryption and MACs (\ref{attack:cbc}).
	\end{itemize}
\end{prop}

\begin{algo}[CBC-MAC]\
	\begin{algorithmic}[1]
		\State $ y \gets \fce{E_K}{\absolute x \concat x} $ \Comment IV must be fixed.
		\State Signature is the last block of $ y $. \Comment All other blocks must be kept secret.
	\end{algorithmic}
\end{algo}

\begin{prop}[]
	\
	\begin{itemize}
		\item The intermediate blocks need to remain secret, otherwise vulnerable to forgery.
		\item If the IV wouldn't be fixed, flip a bit in the first block and the IV, found a colision.
		\item Without the length of the message, a message that is a prefix of another would reveal intermediate blocks.
	\end{itemize}
\end{prop}

\begin{attack}
	Suppose usage of CBC-MAC without length, and we have pairs $ \left< m, h \right> $ and $ \left< m', h' \right> $.
	We can construct a new message $ m'' $ with the hash $ h' $ as \[
		m'' \deq m \concat \left( m'_1 \xor h \xor iv \right) \concat m'_{2\dots n}.
	\]
\end{attack}

This can be dealt with by prepending the message with its length.

\begin{cor}[No proof]
	For an ideal cipher, with a fixed IV and a prefix-free set of messages, CBC MAC is secure.
\end{cor}

\begin{defi}[Shanon-secure MACs]
	Let $ K $ be chosen randomly.
	Given a pair $ \left< x, \fce{\sign_K}{x} \right> $, all signatures of $ x' \neq x $ are equally likely.
\end{defi}

In other words, knowledge of a signature of $ x $ doesn't give us any information about the signatures of other plaintexts.

\begin{defi}[$ 2 $-independent functions.]
	A multiset of functions $ \hh \deq \left\{ h_k \suchthat h_k: \plaintexts \to \ciphertexts \land k \in \kk \right\} $ is \emph{2-independent} $ \equiv  $ \[
		\left( \forall x,x' \in \plaintexts \right)\! \left( \forall y,y' \in \ciphertexts \right)\! \left( \bfce{P_{h \in \hh}}{\fce{h}{x} = y \land \fce{h}{x'} = y'} = \frac{1}{\absolute{\ciphertexts}^2} \right)
	\]
\end{defi}

\begin{examp}[]
	Let $ \plaintexts=\ciphertexts = \F_m $. Let $ \kk = \F_m^2 $.
	Then $ \fce{h_{a,b}}{x} $ is $ 2 $-independent.
\end{examp}

We can turn any $ 2 $-independent function into a Shanon-secure MAC using the following construction:

\begin{cor}[]
	Let $ \hh $ be a $ 2 $-independent set of functions $ h_k $.
	Let $ S $ be a MAC, where $ K \in \kk $, and $ \fce{S}{x, K} \deq \fce{h_K}{x} $.
	Then $ S $ is Shanon-secure.
\end{cor}

\begin{defi}[Polynomial-based MAC]
	Let $ \F $ be a field. $ \plaintexts \deq \F^n, \ciphertexts \deq \F, \kk \deq \F^2 $.
	\emph{Polynomial-based MAC} is a hash function $ h $: \[
		\fce{h_{a,b}}{x_1, \dots, x_n} \deq x_1 a^n + \dots + x_n a + b.
	\]
\end{defi}

\begin{cor}[]
	Polynomial-based MAC is not Shanon-secure, but \[
		\fce{P}{\fce{h_{a,b}}{x'} = y' \mid \fce{h_{a,b}}{x} = y} \leq \frac{n}{\absolute{\F}}.
	\]
\end{cor}

\begin{cor}[]
	Though poly-based MAC is not Shanon-secure, we can make it as close to it as we require (given $ n $ is an upper bound on the message length).
\end{cor}

\begin{note}[Using generated keys]
	The two parties share a known key.
	They can use it as an IV to a PRNG, then use it to generate $ a,b $ for each message.
\end{note}

\begin{cor}[]
	Choosing random $ a,b $ for each message is as secure as choosing $ a $ once, then choosing $ b $ randomly.
\end{cor}

\begin{defi}[AEAD]\label{defi:aead}
	\emph{Authenticated encryption with additional data} is a mode of encryption, when we \begin{itemize}
		\item Encrypt our chosen data.
		\item Produce a signature of said data with the same secret key.
		\item Optionally include additional data in the signature, that weren't encrypted.
	\end{itemize}
\end{defi}

\begin{note}[Additional data]
	The additional data needn't be sent, they are usually something that can be computed from the context of the message, such as a \emph{sequence number}.
\end{note}

\begin{defi}[GCM for block ciphers]
	\emph{Galois Counter Mode} is a form of AEAD, with block size 128 bits.\ \\
	\AlgIn $ A_1, \dots, A_m $, the additional data, and $ X_1, \dots X_n $, the message.
	\begin{algorithmic}[1]
		\State Encrypt $ X_1, \dots X_n $ using CTR mode.
		\State Construct an additional block containing $ n,m $.
		\State Use the additional data, the encrypted data and $ \fce {E_K}{IV} $ (from block cipher) as coefficients of a polynomial over $ \F_{128} $.
		\State Evaluate the polynomial at $ \fce {E_K}0 $.
	\end{algorithmic}
	\AlgOut signature of the message, along with the additional data.
\end{defi}

\begin{cor}[]
	GCM takes $ \fce \O{m+n} $ operations in the field and $ \fce \O{n} $ block encryptions.
\end{cor}

\begin{note}[]
	The field used is of size of blocks of the cipher ($ 2^{128} $ for AES), addition is XOR and multiplication is multiplication of polynomials over $ \Z_2 $, so-called \emph{carry-less multiplication}.
	This is very fast on modern CPUs.
\end{note}

\begin{defi}[Poly1305]
	\emph{Poly1305} is a polynomial MAC construction from a block cipher (usually ChaCha20),
	computed\footnote{$ 2^{130}-5 $ is a prime.} in $ \F_{2^{130}-5} $, which can be made very fast.
\end{defi}


\section{Random Number Generators}

\begin{defi}[Properties of RNGs]
	In cryptography, we require our RNGs to be \begin{itemize}
		\item \emph{statistically uniform} $ \equiv $ each output has the same probability,
		\item \emph{unpredictible by the attacker}, even if he has the whole history of the outputs.
	\end{itemize}
\end{defi}

\begin{examp}[Pseudo-RNG via Block Cipher]
	We take a block cipher in CTR mode, use the \emph{seed} as the key, and let it generate the cipher.
\end{examp}

\begin{examp}[Physical processes]
	Sources of \textquote{true randomness} from pyhsical processes include
	\begin{itemize}
		\item Thermal noise
		\item Timing -- ex. keyboard presses
		\item Radio noise
		\item Radioactive decay
	\end{itemize}
\end{examp}

\begin{attack}
	If the attacker can influence the physical processes, he may be able to influence the output of the RNG.
\end{attack}

\begin{defi}[Combined RNG]
	We can combine a pseudo-RNG with a source of true randomness.
	That way, we can recover from a compromise of the pseudo-RNG.
\end{defi}

\begin{defi}[Compromise of a pseudo-RNG]
	A \emph{compromise} of a pseudo-RNG happens when the attacker can guess/get the key and effectively predict the next random bits.
\end{defi}

\begin{attack}
	Suppose we have a RNG that generates pseudo-random numbers, and it has a source of true randomness that updates the key from time to time.
	But the source is slow, so we can ask the RNG hundreds of requests before the update happens, and it has only one bit of entropy.
	Suppose that at some point we get to know the current state.
	We can simply simulate the new states after the update of the generator, then ask the updated generator for a few new bits and see which state actually happened.
\end{attack}

A solution to this problem is incrementing the RNG in bulk, before first gathering the random information into a pool.
But what should the size of the pool be?
We don't really have a good way of predicting entropy.
For this, we can use the following RNG which can recover from a compromise and it doesn't need an estimation of entropy.

\begin{defi}[Fortuna]
	\emph{Fortuna} is a RNG that has two parts: \begin{enumerate}
		\item \emph{Generator:} AES encrypting a 128-bit counter. This is not random, as it doesn't repeat blocks.
		      After each request, or at most $ 2^{16} $ blocks, we re-key: We use the next bits of output as the new key.
		      Also, we don't reset the counter after doing this\footnote{This way, even if the keys repeat, the output won't.}
		\item \emph{Accumulator:} We have input stream(s) of blocks of random bits. We split the blocks into 32 buckets $ B_0, \dots, B_{32} $, always the whole block into a single bucket.
		      After some time ($ \sim$ 100ms), we re-key: $ k \gets \fce{h}{k, B_0} $. After each $ 2^i $ iterations of the accumulator, we also hash in the $ i $-th block.
	\end{enumerate}
\end{defi}

\begin{cor}[]
	Within finite time, the accumulator will hash any amount of entropy, recovering itself from compromise.
\end{cor}

The last problem we have is, how to get the initial key?
We can store it on the disk, but we need to be careful.
If the computer doesn't shutdown properly, or the disk cache doesn't flush properly,
or if someone is reading our disk, we are compromised.

\section{Secure channel}

\begin{defi}[Secure channel]
	A \emph{secure channel} is a bi-directional channel between $ A,B $.
\end{defi}

Ideally, we'd like for all messages sent to be recieved exactly as they are, without tempering and with confidentiality.
That's impossible, if the attacker can influence the channel -- he can just delete them all, and we get nothing.

\begin{defi}[Secure channel requirements]
	So what we settle for is always getting a subsequence of the sent messages, with verification of their validity.
	We achieve this by having \begin{enumerate}
		\item Sequence numbers $ \to $ no repeats, re-shuffles.
		\item A block cipher in both directions $ \to $ confidentiality.
		\item MAC after encrypt $ \to $ authenticity.
	\end{enumerate}
\end{defi}

For this, we need keys. And we need to re-key from time to time. For this, we use key generators.

\begin{defi}[Key generator]
	A \emph{key generator} is a function that can generate keys given an \emph{id} from a \emph{master key}.
	It can also re-key, usually after $ \sim 1 $M blocks.
\end{defi}

\begin{examp}[Key generator]
	Suppose $ m $ is the master key, we want to generate a key for id $ i $.
	We can use \[
		k_i \gets \fce h{m \concat i}.
	\]
\end{examp}

\section{Algebra \& Number Theory}

\begin{thm}[]
	We can do the following operations on $ b $-bit numbers: \begin{itemize}
		\item $ +,-,=,< $ in $ \fce{\O}{b} $,
		\item $ * $ in $ \fce{\O}{b^2} $, or $ \fce{\O}{b} $, but with huge constants, so it isn't used in practice,
		\item $ \slash, $ mod in $ \fce{\O}{b^2} $,
		\item $ x^y \bmod z $\footnote{The trick is to mod during the computation.} in $ \fce{\O}{b^3} $,
	\end{itemize}
\end{thm}

\begin{algo}[Fast exponantiation]
	\[
		x^y = \begin{cases}
			\left( x^t \right)^2 \mod z  & \text{for }y = 2t,   \\
			x\left( x^t \right)^2 \mod z & \text{for }y = 2t+1. \\
		\end{cases}
	\]
\end{algo}

\begin{notation}
	We denote $ x,y $ being coprime as $ x \perp y $.
\end{notation}

\begin{algo}[Euclid, GCD]\ \\
	\AlgIn $ x,y $, for simplicity, we assume $ x \leq y $.
	\begin{algorithmic}[1]
		\Indent While $ x \neq 0 $:
		\State $ r \gets y \mod x $
		\State $ y \gets x $
		\State $ x \gets r $
		\EndIndent
	\end{algorithmic}
	\AlgOut $ y $, their GCD.
\end{algo}

\begin{cor}[]
	\emph{Euclid} works in $ \fce{\O}{b^3} $, can be made $ \fce \O{b^2} $.
\end{cor}

\begin{cor}[]
	As the algorithm does nothing else than subtraction, we get $ \fce{\gcd}{x,y} = ax + by $. $ a,b $ are called the Bézout's coefficients.
\end{cor}

Whenever we compute mod $ N $, we get a \emph{ring} $ \Z_N $.

\begin{defi}[Inverse]
	An \emph{inverse} of $ x $ is $ x^{-1} $, such that $ x x^{-1} = 1 $.
\end{defi}

\begin{obs}[]
	When $ N $ is even, then for even $ x $ there cannot exist an $ x^{-1} $.
\end{obs}

\begin{obs}[]
	Let $ x,N \in \N $. Consider \[
		xy + kN = 1.
	\]
	This equation has exactly one solution for $ x \perp N $, and it is the Bézout coefficients as $ y,k $, and it has no solutions otherwise.

	\begin{proof}
		If $ x \not\perp N $, then $ d = \fce{\gcd}{x,N} > 1 $. But $ d \divides \left( xy + kN \right)  \;\forall k,N $.
		That implies $ d \divides 1 $, so $ d = 1 $.
	\end{proof}
\end{obs}

\begin{cor}[]
	$ x $ is invertible mod $ N $ $ \Leftrightarrow $ $ x \perp N $.
\end{cor}


\begin{defi}[]
	Let $ x < N \in \N $.
	We'll define \[
		\Z^*_N \deq \left\{ x \in \Z_N \suchthat x \perp N \right\}.
	\]
\end{defi}

\begin{obs}[]
	$ \Z^*_N $ is a group.
\end{obs}

\begin{obs}[]
	Let $ p \in \P $.
	Then $ \Z^*_p = \Z_p \divides \left\{ 0 \right\} $, $ \Z_p $ is a field.
\end{obs}

\begin{thm}[Fermat's little]
	Let $ p \in \P $. Then \[
		x^{p-1} \equiv 1 \mod p.
	\]
\end{thm}

\begin{thm}[Lagrange]\label{thm:lagrange}
	Let $ G,H $ be finite groups, $ G \subseteq H $. Then \[
		\absolute{G} \divides \absolute{H}.
	\]

	\begin{proof}[Proof sketch.]
		$ G \cdot a $ covers $ H $ for different choices of $ a \in H $.
	\end{proof}
\end{thm}

\begin{defi}[Euler's function]
	The \emph{Euler's function} is \[
		\fce{\varphi}{N} \deq \absolute{\Z^*_N}.
	\]
\end{defi}

\begin{thm}[Euler's]
	Let $ N > 0, x \perp N $. Then \[
		x^{\fce{\varphi}{N}} \equiv 1 \mod N.
	\]

	\begin{proof}
		Consider $ x^0, x^1, \dots, x^k \equiv 1 $. This is the first repeating element, and it must be a $ 1 $, since $ 1 $ was the first element and $ x^i = x^j \leftrightarrow x^{i+1} = x^{j+1} $.
		The first $ k $ elements form a subgroup $ G \subseteq \Z^*_N$.
		By Lagrange's theorem (\ref{thm:lagrange}), $ k $ divides $ \fce{\varphi}{N} $.
		This means, that $ \fce{\varphi}{N} = kt $ for some $ t $.
		But that implies: \[
			x^{\fce{\varphi}{N}} = x^{kt} = \left( x^k \right)^t \equiv 1 \mod N
		\]
	\end{proof}
\end{thm}

\begin{thm}[Chinese Reminder]
	Let $ N_1 \dots N_k \in \N $, such that $ \left( \forall i,j \right)\! \left( N_i \perp N_j \right) $.
	Let $ N \deq \prod_i N_i $.
	Let $ f: \Z_{N} \to \Z_{N_1} \times \dots \times \Z_{N_k} $, such that \[
		\fce{f}{x} = \left< x \bmod N_1, \dots \right>.
	\]
	Then $ f $ is a \emph{ring isomorphism}.
	Also, $ f $ is computable in both directions in $ \poly b $ time (for a fixed $ k $).
\end{thm}

\begin{proof}
	$ h $ is injective, as \[
		\fce{h}{x} = \fce{h}{y} \implies \fce{h}{x-y} = 0 \implies N_1,N_2 \divides \left( x-y \right) \implies N \divides \left( x-y \right) \implies x-y \equiv 0 \bmod N \implies x-y = 0.
	\]

	But $ \absolute{\Z_N} = \absolute{\Z_{N_1} \times \Z_{N_2}} $, so it must be a bijection.
\end{proof}

\begin{thm}[]
	Let $ p \in \P, k \in \N $.
	Let $ x,y \in \N: x \perp y $.
	\begin{itemize}
		\item $ \fce{\varphi}{p^k} = \left( p-1 \right)p^{k-1} $,
		\item $ \fce \varphi{xy} = \fce \varphi x \fce \varphi y $.
	\end{itemize}

\end{thm}

\begin{prop}[]
	There is no known poly algorithm for factoring, but there are  sub-exponential algorithms.
	There are known quantum poly algs.
\end{prop}

\begin{thm}[]
	There are probabilistic, even deterministic, poly algorithms for primality testing.
\end{thm}

\begin{note}[]
	The only way to compute $ \varphi $ is with factorization of a number.
\end{note}

\begin{prop}[]
	Density of primes around $ x $ is $ \sim \frac 1{\ln x} $.
\end{prop}

\begin{algo}[Generating a prime]\
	\begin{algorithmic}[1]
		\State Generate a random $ b $-bit number $ x $.
		\State If $ x $ is not prime, go to 1.
	\end{algorithmic}
	\AlgOut $ x \in \P $.
\end{algo}

\begin{algo}[Fermat test]\ \\
	\AlgIn $ n \in \N $.
	\begin{algorithmic}[1]
		\State Pick $ x \randin \left[ n \right] $.
		\State If $ x^{n-1} \bmod n \neq 1 $, return \emph{composite}. \Comment $ x $ is a \emph{witness}.
		\State Return \emph{prime}.
	\end{algorithmic}
	\AlgOut $ n \in \P $?
\end{algo}

\begin{cor}[]
	If we find a \emph{witness} $ x $, then $ n $ is composite.
\end{cor}

\begin{defi}[Euclid witness]
	\emph{Euclid witness} is a witness $ x $ in the \emph{Fermat test}, where $ x \not\perp n $.
\end{defi}

\begin{defi}[Fermat witness]
	\emph{Fermat witness} is a witness $ x $ in the \emph{Fermat test}, where $ x \perp n $.
\end{defi}

\begin{defi}[Carmichael number]
	$ n \notin \P $ is a \emph{Carmichael number} $ \equiv  $ it only has Euclid witnesses.
\end{defi}

There are infinitely many Carmichael numbers, though they are not common.

\begin{prop}[]
	Suppose $ n $ is composite, and not Carmichael.
	Then the probability, that the Fermat tests answers incorrectly, is $ \leq \frac{1}{2}. $
\end{prop}

\begin{algo}[Rabin-Miller]\ \\
	\AlgIn $ n \in \N $.
	\begin{algorithmic}[1]
		\State $ x \randin \left\{ 1, \dots, n-1 \right\} $
		\State If the gcd of $ n \neq 1$, we return \emph{composite.} \Comment Fermat witness.
		\State If $ x^{n-1} \bmod n \neq 1 $, return \emph{composite}. \Comment Euclid witness.
		\State $ i \gets 0 $
		\Indent While $ \frac {n-1}{2^i} $ is even:
		\State $ i \gets i+1 $
		\State If $ x^{\frac{n-1}{2^i}} = -1 \bmod n $, return \emph{prime}.
		\State If $ x^{\frac {n-1}{2^i}} \notin \left\{ -1,1 \right\} \bmod n $, return \emph{composite}. \Comment Non-trivial square root of $ 1 $.
		\EndIndent
		\State Return \emph{prime}.
	\end{algorithmic}
	\AlgOut $ n \in \P $?
\end{algo}

\begin{cor}[]
	\[
		\algorithm{Rabin-Miller}{n} = \textit{composite} \implies n \notin \P.
	\]
\end{cor}

\begin{thm}[Rabin]
	\[
		\fce{P}{\algorithm{Rabin-Miller}{n} = \textit{prime} \mid n \notin \P} \leq \frac{1}{4}.
	\]
\end{thm}

\begin{thm}[Miller]
	If the extended Reiman Hypothesis holds,
	$ n $ is composite,
	then $ \forall n $ has a witness in $ \fce{\O}{\log n} $, which is $ \poly b $.
\end{thm}

\begin{defi}[Cyclic group]
	A group $ \Z_n^* $ is \emph{cyclic} $ \equiv $ \[
		\left( \exists g \in \Z^*_n \right)\! \left( \left\{ g^0, g^1, \dots \right\} = \Z^*_n \right).
	\]
	Souch a $ g $ is a \emph{generator}.
\end{defi}

\begin{cor}[]
	For $ \Z^*_p $ it holds \[
		\Z^*_p = \left\{ g^0 \dots g^{p-2} \right\}.
	\]
\end{cor}

\begin{defi}[Discrete Log]
	Let $ x \in \Z_n^* $.
	Let $ g $ be a generator of $ \Z_n^* $.
	Then \[
		\dlog x = i \equiv g^i = x \mod n.
	\]
\end{defi}

\begin{cor}[]
	\[
		\left< \Z^*_p, \cdot \right> \isomorph \left< \Z_{p-1}, + \right>.
	\]
\end{cor}

\begin{prop}[]
	Given $ g $, to check, that it is a generator of $ \Z^*_p $, it is sufficient to check if $ g^k = 1 $ for $ k = \frac{p-1}{q} $, where $ q \in \P $.
\end{prop}

\begin{prop}[]
	Let $ g $ be a generator of $ \Z_p^* $.
	Let $ g' \deq g^t $, for $ t \in \N $.
	Then $ g' $ is a generator, iff $ t \perp p-1 $.
\end{prop}

\begin{cor}[]
	There are $ \fce{\varphi}{p-1} $ generators.
\end{cor}

This means, that it is efficient to sample numbers randomly and check if they are generators.

\begin{prop}[]
	Suppose $ x \in \Z_p $, where $ p \in \P \setminus \left\{ 2 \right\} $.
	Then $ x  $ either has two, or zero, square roots.
	If it has two roots, it is a \emph{quadratic residue}, if not, it is a \emph{quadratic non-residue}.
\end{prop}

\begin{cor}[Euler Criterion]
	Let $ 0 \neq x \in \Z_p $.
	Then $ x $ is a quadratic residue, iff $ x^{\frac{p-1}{2}} = 1 $.
\end{cor}

\begin{cor}[]
	QR are a subgroup of $ \Z^*_p $.
\end{cor}

\begin{cor}[]
	$ f: x \mapsto x^{\frac{p-1}{2}} \bmod p$ is a homomorphism: \[
		\Z^*_p \to \left< \left\{ 1, -1 \right\}, \cdot \right>.
	\]
\end{cor}

\begin{prop}[]
	When $ n = pq $, numbers mod $ n $ can have $ 4 $ different roots.
\end{prop}

\begin{note}[]
	It is known, that square roots are equivalent to factoring.
\end{note}

\begin{note}[Efficiency of squareroots]
	If $ p = 4t+3 $, then $ x^{\frac{p+1}{4}} = \sqrt x $.
	If $ p = 4t+1 $, then you need the Tonelli-Shonks algorithm (randomised).
\end{note}

\section{Asymmetric cryptography}

\begin{notation}[RSA]\
	\begin{enumerate}
		\item $ p,q \in \P $, two big base primes,
		\item $ n \deq p q $, modulus,
		\item $ \fce{\varphi}{n} = \left( p-1 \right)\left( q-1 \right) $,
		\item $ e: e \perp \fce\varphi n $, the encryption exponent,
		\item $ d: de \equiv 1 \bmod \fce{\varphi}{n} $, the decryption exponent,
		\item $ \left< e,n \right> $, encryption key,
		\item $ \left< d,n \right> $, decryption key,
	\end{enumerate}
\end{notation}

\begin{defi}[RSA]
	Let $ x \in \Z_n $ be the message.
	RSA is an asymmetric cipher, with \[
		\fce{E}{x} \deq x^e \mod n,
	\]
	and \[
		\fce{D}{y} \deq y^d \mod n.
	\]
\end{defi}

\begin{lemma}[]
	Given $ x \perp n $, \[
		\fce{D}{\fce{E}{x}} \emod n x.
	\]
\end{lemma}

\begin{lemma}[]
	The time complexity of $ E $ or $ D $ is between $ \fce{\O}{b^3} $ and $ \fce{\O}{b^2} $.
\end{lemma}

\begin{lemma}[Speed-up tricks]
	\
	\begin{enumerate}
		\item small public exponent,
		\item operations with private key computed mod $ q $ and mod $ p $, then combined using CRT.
	\end{enumerate}
\end{lemma}

\begin{lemma}[Properties of RSA]
	RSA has the following properties: \begin{itemize}
		\item we can swap $ e $ and $ d $,
		\item commutative: $ \left( x^e \right)^f \equiv \left( x^f \right)^e $,
		\item homomorphic: $ \fce{E}{x_1 x_2} \equiv \fce{E}{x_1} \fce{E}{x_2} $,
	\end{itemize}
\end{lemma}

\begin{defi}[Blind signature]\label{blind sig}
	\emph{Blind signature} is a protocol, where Alice can sign a message without knowing the content of it.
\end{defi}

\begin{cor}[]
	Thanks to homomorphism, RSA can be used to implement blind signature.
\end{cor}

\begin{thm}[Vulnerabilities of RSA]
	\
	\begin{enumerate}
		\item if $ x < n^{1 \slash e} $, then $ x^e < n $.
		\item if $ \fce{\varphi}{n} $ is known, we can factorize $ n $,
		\item if $ d < n^{1 \slash 4} $, we can compute $ d $ from $ e $.
	\end{enumerate}
\end{thm}

\begin{attack}[Meet in the middle]
	Let $ u,v $ be sets of numbers.
	Let $ e $ be the public key.
	Suppose we have $ y = x^e \bmod n $ for unknown $ x $.
	We repeatadely compute $ \left( \forall a \in u \right)\! \left( a^e \right)  $ and
	$ \left( \forall b \in v \right)\! \left( y b^{-e} \right) $.
	When these sets of numbers intersect, we have \[
		y \equiv \left( ab \right)^e \equiv x^e \mod n.
	\]
	An intersection happens with probability at least a constant for these sets being of size about $ n^{1/2 + \varepsilon} $ for any positive $ \varepsilon $.
\end{attack}

\begin{cor}[]
	For a given $ n $, the probability of a successful attack is at least a constant.
	Hence, $ n $ should be chosen sufficiently large.
\end{cor}

\begin{attack}[Similar messages]
	Suppose we want $ x, x+\delta $, for some small $ \delta $, whose ciphertexts are $ y,y' $.
	Suppose also, that $ e $ is small.
	\begin{algorithmic}[1]
		\State Guess $ \delta $.
		\State $ \fce Ax \gets x^e -y $, $ \fce Bx \gets \left( x+\delta \right)^e - y' $ \Comment $ x $ is a root of $ A $ and $ B $.
		\State Get gcd of $ A,B $. \Comment With high probability, it equals $ \fce Cx = x-c $.
		\State $ x \gets c $. \Comment $ x $ is the root of $ A,B $, so it is also a root of their gcd.
	\end{algorithmic}
\end{attack}

\begin{attack}[Similar $ p,q $]
	\[
		q = p+2d \implies n = pq = p \left( p+2d \right) = p^2 + 2pd \implies n+d^2 = \left( p+d \right)^2.
	\]
\end{attack}

\begin{attack}[Same message, multiple keys]
	Suppose $ e = 3 $, we want to get $ x $ encrypted with moduli $ n_1, n_2, n_3 $ to $ y_1, y_2, y_3 $.
	\begin{algorithmic}[1]
		\State $ n \gets n_1 \cdot n_2 \cdot n_3 $
		\State $ y \gets x^3 \mod n $ \Comment From $ y_1, y_2, y_3 $ using CRT.
		\State $ x \gets \sqrt[3]y $ \Comment Since $ x^3 < n $
	\end{algorithmic}
\end{attack}

The previous attack works even more generally, for different $ e $s.

\begin{attack}[Fault in computation]
	Suppose Alice signs using a key with the optimalization using CRT.
	We have her sign a message repeatadely, and she makes a mistake in one of the sub-computation (for ex, with $ q $).
	Then the difference of the right answer and the wrong one is a multiple of $ q $.
\end{attack}

\begin{defi}[Legender symbol]
	Let $ p \in \P $.
	Let $ a \in \N $.
	Then the \emph{Legender symbol} is \[
		\left( \frac{a}{p} \right) \deq a^{\frac{p-1}{2}} \mod p.
	\]
\end{defi}

\begin{defi}[Jacobi symbol]
	The \emph{Jacobi symbol} is a generalisation of the Legender symbol for $ n = p_1^{d_1} \times \dots \times p_k^{d_k} $: \[
		\left( \frac{a}{n} \right) \deq \left( \frac{a}{p_1} \right)^{d_1} \times\dots\times\left( \frac{a}{p_k} \right)^{d_k}.
	\]
\end{defi}

\begin{thm}[]
	RSA preserves the Jacobi symbol.
\end{thm}

\begin{note}[]
	That is a leak of about $ 1\bit $, and it's the only known leak.
\end{note}

\begin{defi}[]
	\[
		\algorithm{Half}{x} \deq \begin{cases}
			1 & \fce{D}{x} > \frac{n}{2} \\
			0
		\end{cases}
	\]
\end{defi}

\begin{defi}[]
	\[
		\algorithm{Parity}{x} \deq \fce{D}{x} \mod 2.
	\]
\end{defi}

\begin{thm}[Semantic security]
	Suppose we have an oracle for $ \algorithm{Half}{y} $ or $ \algorithm{Parity}{y} $. Then we can compute $ \fce{D}{y} $.
\end{thm}

We don't want to encrypt an arbitrary message, as we want to avoid the insecurities mentioned above. For that, we use \emph{padding}.

\begin{defi}[PKCS \#1 v1.5]
	The message contains \begin{itemize}
		\item some amount of zero bytes to round it to a multiple of $ 8 $,
		\item a $ 02 $ to signal the end of zeros,
		\item at least $ 8 $ random bits,
		\item the message,
		\item some stuff around.
	\end{itemize}
\end{defi}

\begin{attack}[Bleichenbacher]
	This attack creates a padding oracle, that is, it tells Eve whether a message is correctly padded or not.
\end{attack}

\begin{defi}[PKCS \#1 v2.0]
	This version is basically a Feistel network, with two rounds, that combines the message (padded to a multiple of a nice size), with a random string.
\end{defi}

In conclusion, RSA works because we can't do factorization (but it may not be equivalent to it!), it has an algebraic structure, and it is needed to be used with caution.

\begin{algo}[Diffie-Hellman]\ \\ \label{algo:diffie-hellman}
	\AlgIn $ p \in \P $, generator $ g $ of $ \Z_p $.
	\begin{algorithmic}[1]
		\State $ A $ generates $ x \randin \left\{ 2, \dots, p-2 \right\} $, sends $ B $ $ g^x \bmod p $.
		\State $ B $ generates $ y \randin \left\{ 2, \dots, p-2 \right\} $, sends $ A $ $ g^y \bmod p $.
		\State Both can get a shared secret $ g^{xy} \bmod p $.
	\end{algorithmic}
	\AlgOut $ A $ and $ B $ can both compute a shared secret.
\end{algo}

\begin{attack}[Man-in-the-middle]
	An active attacker can communicate separately with $ A $ and $ B $ and just reencrypt the messages with corresponding secrets.
\end{attack}

The solution is to \emph{sign} the result of the protocol.
Alice and Bob need to know each other's public keys.

\begin{attack}
	If $ A $ and $ B $ want to set $ p,g $ themselves, we can give them a $ p \notin \P $ or $ q $ not a generator.
	Then we can break the protocol (bruteforce).
\end{attack}

The solution is to check that $ p \in \P $ and $ g $ is a generator, both can be done in poly.

\begin{note}[Forward security]
	As you need to have the other person's public key, it may seem unimportant to do DH, you can just use the public/private key pairs.
	But there is a big difference -- if you encrypt using the private key, and the key leaks, all your previous messages are compromised.
	If you only sign using the private key, then establish DF, then encrypt using that, then your messages are still safe even if the private key is compromised.
\end{note}


\begin{attack}
	We intercept the sending of $ g^x $ and $ g^y $, and instead send $ g^{kx} $ and $ g^{ky} $.
	This way, the signed key will be ok, but we can force usage of a subgroup that is small enough for bruteforce.
\end{attack}

The solution to this is to sign every stage of the protocol.

\begin{lemma}[DH leak]
	DH compromises $ 1b $ of information: from $ \left( \frac{g^x}{p} \right) $ we can deduce $ x \bmod 2 $, from $ \left( \frac{g^x}{p} \right) $ we can deduce the same about $ y $, from combined $ \left( \frac{g^{xy}}{p} \right) $ we can deduce, whether $ g^{xy} $ is a QR.
\end{lemma}

\begin{defi}[Safe prime]
	A $ p \in \P $ is a so-called \emph{safe prime} $ \equiv $ $ p = 2q+1 $, where $ q \in \P $.
\end{defi}

\begin{lemma}[]
	If $ p $ is a safe prime, then $ \Z_p $ only has two subgroups -- $ \left\{ 1, -1 \right\} $ of size $ 2 $ and QR, of size $ \frac{p-1}{2} $.
\end{lemma}

\begin{note}
	With a safe prime, an attacker can not force us into a small subgroup (if we check for $ \left\{ 1,-1 \right\} $).
	Further, we can use $ g^2 $, and only work inside the bigger subgroup, and we won't even leak information about the QR.
	We need to first check that $ p^x,p^y $ are in the selected subgroup.
\end{note}


\begin{note}[]
	To speed up, we can use $ p = kq+1 $, where $ k \bmod 2 = 0, q \in \P $. We can set $ q $ to have approx. $ 256b $, $ p $ much more than that.
	We work in the subgroup generated by $ g^k $, which has $ q $ elements.
	Again, we cannot be forced into smaller ones.
\end{note}

\begin{note}
	DH can work in even wilder groups, the only restriction is that dlog is hard and there shouldn't be non-trivial subgroups.
\end{note}

\begin{thm}[Semantic security of DH]
	Finding out the least-significant bit of $ g^{xy} $ is as hard as finding the entire $ g^{xy} $.
\end{thm}

\begin{note}
	DH can also be used as an asymmetric cipher, where $ g^x $ is the public key, $ x $ the private one.
\end{note}

\begin{note}[]
	One drawback compared to RSA is that now, we cannot just exchange public and private keys, as the public one is easily derived from the private one.
\end{note}

\begin{defi}[ElGamal cipher]
	An \emph{ElGamal cipher} is an asymmetric cipher based on D-H.
	It is parametrised by \begin{itemize}
		\item $ p \in \P $, $ g $ generator of $ \Z^*_p $,
		\item \emph{private key} $ r \randin \left\{ 2, \dots, p-2 \right\} $,
		\item \emph{public key} $ u \deq g^r \bmod p $.
	\end{itemize}
	Then \begin{itemize}
		\item $ \fce Ex \deq \left< g^t, x \cdot u^t \right> \bmod p $, for $ t \randin \Z^*_p $,
		\item $ \fce D{s, y} \deq y \cdot s^{-r} \bmod p $.
	\end{itemize}
\end{defi}

\begin{note}
	It is important to choose the $ t $ randomly, otherwise we can compute $ s $ from a known plaintext.
\end{note}

\begin{note}[]
	Unlike RSA, the private key and public key cannot be switched, meaning you cannot use ElGamal for private encryption and public decryption.
\end{note}

\begin{lemma}[Leak of ElGamal]
	We can again find out whether $ x $ is a QR.
\end{lemma}

\begin{note}[]
	We can use ElGamal on any group where dlog is hard.
\end{note}

An elliptic curve can generate a group with hard dlog.

\begin{defi}[Elliptic curves, $ \R $]
	Suppose we have a set $ A \deq \left\{ \left< x,y \right> \suchthat y^2 = x^3 + ax + b \right\} $, where $ a,b $ are parameters and it holds
	\footnote{This assures we have 3 intersections with the $ x $ axis.}\[
		4a^3 + 27b^2 \neq 0.
	\]
	An \emph{elliptic curve} is $ \varepsilon \deq A \cup \left\{ \vec o \right\}$, where
	\begin{itemize}
		\item the \emph{neutral element} is $ \vec o $, a special \textquote{point in infinity},
		\item $ - \left< x,y \right> \deq \left< x,-y \right> $,
		\item $ + $ is defined as \[
			      \left< x_1, y_1 \right> + \left< x_2, y_2 \right> \deq \begin{cases}
				      \vec o & \left< x_1,y_1 \right> = -\left< x_2,y_2 \right>, \\
				      -\left< x_3, y_3 \right>,
			      \end{cases}
		      \]
		      where $ \left< x_3, y_3 \right> $ is the third point, in which the line going through $ \left< x_1, y_1 \right> $ and $ \left< x_2, y_2 \right> $ intersects $ A $.
		      If $ \left< x_1, y_1 \right>=\left< x_2, y_2 \right> $, the line we are interested in is the tangent.
	\end{itemize}
\end{defi}

\begin{note}[]
	Proving, that addition defined this way is associative is non-trivial.
\end{note}

\begin{defi}[Elliptic curves, $ \Z_p $]
	Let $ p \in \P, p > 3 $.\footnote{For $ p =2 $ and $ p=3 $ the curves behave a bit differently.}
	We can define an \emph{elliptic curve} as before, but over the field $ \Z_p $.
\end{defi}

\begin{thm}[Hasse]
	Let $ \varepsilon $ be an elliptic curve on $ \F_q $.
	Then \[
		q+1 - 2 \sqrt q \leq \absolute{\varepsilon} \leq q + 1 + 2\sqrt q.
	\]
\end{thm}

\begin{lemma}[]
	There is an algorithm (Schoof) to compute the exact size of the group in poly time.
\end{lemma}

\begin{note}
	This is useful, as we need to find out if the group has a small subgroup.
\end{note}

\begin{thm}[No proof]
	Let $ \varepsilon $ be an elliptic curve on $ \F_q $.
	Then \[
		\left( \exists n_1, n_2  \right)\! \left(n_2 \divides n_1 \land \left< \varepsilon, + \right> \isomorph \Z_{n_1} \times \Z_{n_2} \right).
	\]
\end{thm}

\begin{cor}[]
	If $ \absolute{\varepsilon} \in \P$, then $ n_2 $ must be $ 1 $. Then the group must be cyclic.
\end{cor}

Thus, we can use it in Diffie-Hellman.
Otherwise, we can find a cyclic group of size $ n_1 $.

\begin{note}
	Instead of the full pair $ \left< x,y \right> $, we can only have $ x $ and the parity bit of $ y $.
	We can then compute the whole $ y $, as there are only two square roots and one of them is odd, the other even.
\end{note}

\begin{note}[]
	It is hard to find secure curves.
	The known ones are at \texttt{https://safecurves.cr.yp.to/}.
\end{note}

\section{Asymmetric signatures}

\begin{defi}[Asymmetric signature]
	An asymmetric signature scheme is a tuple $ \left< S, V \right> $, where \begin{enumerate}
		\item $ S $ is the \emph{sign function},
		\item $ V $ is the \emph{verifier function}.
	\end{enumerate}
\end{defi}

The attacker can have the following capabilities: \begin{itemize}
	\item He knows the public key.
	\item He knows the signature of some messages.
	\item He can ask for the signature of some messages.
\end{itemize}

His aim can be: \begin{itemize}
	\item Getting to know the secret key.
	\item Existential forgery: finding a message-signature pair, which is not known to the attacker.
	\item Chosen plaintext forgery: finding a message-signature pair, which is not known to the attacker and the message is not chosen by the attacker.
\end{itemize}

\begin{examp}[Signature using RSA]\label{rsa sig}
	When signing using RSA, $ \fce{S}{x} = x^e \bmod n $ and $ \fce{V}{y} = y^d \bmod n $.
\end{examp}

\begin{attack}[RSA signature]
	When using RSA signatures, we can get \begin{itemize}
		\item \emph{existential forgery} by decrypting a random string,
		\item \emph{chosen plaintext forgery} by a mechanism similar to blind signatures (\ref{blind sig}).
	\end{itemize}
\end{attack}

The fix to this is to hash the message before signing it.

\begin{examp}[ElGamal signature]
	ElGamal signature scheme is similar to the encryption scheme.
	It is parametrized by $ p,q \in \P $.
	For each session, we compute
	\begin{itemize}
		\item \emph{private key} $ k \randin \left\{ 2, \dots, p-3 \right\} $,
		\item \emph{public key} $ a \deq g^k \bmod p $.
	\end{itemize}
	Then \begin{itemize}
		\item $ \fce Sx \deq \left< g^t \bmod p, \left( x-kr \right)t^{-1} \bmod p-1 \right> $,
		\item $ \fce V{r,s} \deq \left( 0 < r < p \right) \land \left( 0 < s < p-1 \right) \land \left( a^rr^s \equiv g^x \bmod p \right) $.
	\end{itemize}
\end{examp}

\begin{note}[]
	We again want to avoid the algebraic properties, so we hash the message before signing it.
\end{note}

\begin{note}[]
	ElGamal works on any group, where dlog is hard.
\end{note}

\begin{note}[]
	The randomness of $ t $ is essential.
	If we don't have true randomness, we can use a pseudo-RNG, with seed as both $ x, k $.
\end{note}

\begin{examp}[DSA]
	The \emph{Digital Signature Algorithm} is a signature scheme parametrized by $ p, g $, where \begin{itemize}
		\item $ p \deq c \cdot q + 1 \in \P $, such that $ p $ has about 4 kilobit, $ q $ has about 256 bit.
		\item $ g $ is a generator of a subgroup of $ \Z_p^* $ of size $ q $.
	\end{itemize}
	Then the secret key is $ k \randin \left\{ 1, \dots, q-1 \right\} $ and the public key is $ a \deq g^k \bmod p $.
	Signing and verifying is similar to ElGamal.
\end{examp}

\begin{examp}[ECDSA]
	ECDSA is DSA with elliptic curves -- instead of $ g $, we use a group defined by an elliptic curve.
\end{examp}

\section{Implementation Issues}

\begin{examp}[Problems with implementation]
	Problems with implementation include \begin{itemize}
		\item no way to eliminate side channels,
		\item inability do design secure software,
		\item code complexity,
		\item dependencies on random people we don't trust,
		\item no way to systematically test software for security,
		\item optimization for speed vs security, \dots
	\end{itemize}
\end{examp}

\begin{note}[]
	A promising way of testing software for security issues is \emph{fuzzying}, though it is not very effective.
\end{note}

\begin{examp}[]
	Timing of the division instruction is usually data dependent.
\end{examp}

\begin{examp}[Possibilities of an attacker]
	\
	\begin{enumerate}
		\item remote \begin{itemize}
			      \item timing
			      \item incorrect/ambiguous input -- for example XML, UTF-8 encoding, null bytes in strings,\dots
		      \end{itemize}
		\item same room -- watch thermal output, noise, radio waves, power consumption,\dots
		\item physical access -- anything, including reading the bits stored on a chip,
		\item another process -- watch properties of CPU, cache access times etc.
	\end{enumerate}

\end{examp}


\begin{attack}[AES]
	Suppose a system uses SW implementation of AES using lookup tables.
	\begin{algorithmic}[1]
		\State Make it so our process is scheduled always before and after AES.
		\State Watch cache access times.
		\State Find out what the key is by what table lookups are usually done when encrypting.
	\end{algorithmic}
\end{attack}

The solution for this is \begin{itemize}
	\item Use different implementation of AES, possibly in HW.
	\item Never index with secret data.
\end{itemize}

\begin{examp}[Storing secrets]
	\
	\begin{enumerate}
		\item memory: Can end up on disk by swap or core dump, fix by memory locking.
		\item disk: Random movement, espetially on SSDs, fix by encrypting disk.
	\end{enumerate}
\end{examp}

\begin{defi}[Objectives of RL cryptography]
	\
	\begin{itemize}
		\item Price of attack $ \gg $ price of the secret.
		\item Provide security testing (specialized companies).
		\item Slow down the attacker enough to get caught.
	\end{itemize}

\end{defi}


\subsection{Passwords}

\begin{prop}[]
	To increase the security of users, we should store hashes of passwords instead of plaintexts.
\end{prop}

\begin{attack}[Hash tables]
	Suppose we get someone's password hashes database.
	Let us define \begin{itemize}
		\item $ N $ a \emph{chain length},
		\item $ P $ a set of likely passwords,
		\item $ g: \left\{ 0,1 \right\}^h \to P $ a \emph{sampling function},
		\item $ f: x \mapsto \fce g{\fce hx} $.
	\end{itemize}
	We will construct chains of passwords of size $ N $, starting from a password $ p \in P $,
	iterating using $ p \gets \fce fp $. After $ N $ iterations, we store the first password and the password we end up in.
	This way, we cover $ P $.
	Then, when guessing password with hash $ h $, we do
	\begin{algorithmic}[1]
		\State Iterate $ f $ until we hit a password at the end of some chain.
		\State Start from the corresponding starting password.
		\State Iterate until we get to $ h $.
	\end{algorithmic}
\end{attack}

This trades space for time.
But a problem is that the chains merge together, so the space needed will still be quite large.

\begin{attack}[Rainbow tables]
	Modify $ g $ from the previous construction to also include a \emph{color}.
	After each iteration, increment the current color.
	This way, when two chains meet, they will likely not stay connected.
	Problem is that now we need to try starting from all colours, increasing time complexity.
\end{attack}

Rainbow tables trade $ \fce \O N $ space for $ \fce \O{N^2} $ time.

\begin{defi}[Salting]
	Instead of storing $ \fce hp $, we store $ \left< \fce h{p \concat s}, s \right> $, where $ s $ is a sufficiently long random string, so-called salt.
\end{defi}

\begin{cor}[]
	Identical passwords suddenly have a different hash value.
\end{cor}

\begin{cor}[]
	Rainbow tables are now ineffective.
\end{cor}

\begin{defi}[Iterated hashing]
	Instead of storing $ \fce hp $, we store $ \fce h{\fce h{\dots \fce hp}} $.
	We don't mind the slowdown, but the attackers do.
\end{defi}

\begin{examp}[PBKDF2]
	Password-Based Key Derivation Function is a pseudo-random function parametrised by \begin{itemize}
		\item a pseudo-random function $ f $ (for example HMAC),
		\item $ k $, the required number of iterations -- can be increased for more important users.
		\item $ n $, the number of blocks -- again, can be increased for more important users.
	\end{itemize}
	The hashing of password $ p $ with salt $ s $ works followingly:
	\begin{algorithmic}[1]
		\Indent For $ i \in \left\{ 1, \dots, n \right\} $:
		\State $ U_{1,i} \gets \fce f{p, s \concat i} $
		\Indent For $ j \in \left\{ 2, \dots, k \right\} $:
		\State $ U_{j,i} \gets \fce f{p, U_{j-1,i}} $
		\EndIndent
		\State $ B_i \gets U_{1,i} \xor \dots \xor U_{k,i} $
		\EndIndent
		\State $ \fce hp \gets B_1 \concat \dots \concat B_n $
	\end{algorithmic}
\end{examp}

\begin{note}[]
	PBKDF2 is effective on memory, but we may not want that, as it enables timing attacks.
	There is an algorithm called \emph{Argon 2}, which requires more memory, hence disabling cache timing attacks.
\end{note}

\begin{defi}[Challenge-response]\
	\begin{enumerate}
		\item Server sends the salt $ s $, number of iterations $ k $, number of blocks $ b $, nonce $ n $.
		\item Client responds with $ \fce h{\algorithm{PBKDF2}{p, k, s, b} \concat n} $.
	\end{enumerate}
\end{defi}

\begin{cor}[]
	The server doesn't need to know the password plaintext at any point.
\end{cor}

\begin{defi}[SCRAM]
	SCRAM is a construction for password storing and checking.
	Each account has \begin{itemize}
		\item $ K_C \deq \fce \hmac {p \concat \text{"Client"}} $,
		\item $ K_S \deq \fce \hmac {p \concat \text{"Server"}} $.
	\end{itemize}
	The server remembers only $ K_S $ and $ \algorithm{PBKDF2}{K_C} $.
	Authentication works as follows
	\begin{algorithmic}[1]
		\State Client sends username, $ n_C $ to the server. \Comment $ n_C $ is a random client nonce.
		\State Server sends parameters for PBKDF2 and $ n_S $. \Comment $ n_S $ is a random server nonce.
		\State Client computes $ K_C \gets \fce \hmac {p \concat \text{"Client"}} $.
		\State Client sends $ K_C \xor \fce \hmac {\algorithm{PBKDF2}{K_C}, t} $. \Comment $ t $ is the transcript so far.
		\State Server gets $ K_C \gets R \xor \fce \hmac {\algorithm{PBKDF2}{K_C}, t}  $ \Comment $ R $ was recieved from the client.
		\State Server can send $ \fce \hmac {K_S, t} $, authenticating itself to the client.
	\end{algorithmic}
\end{defi}

\section{Trust}

\begin{defi}[DNSSEC]
	DNSSEC is an extension of DNS allowing authenticity of the records.
	\begin{itemize}
		\item Everyone knows the public keys for the root domain.
		\item Each zone has a DS record at the parent zone with a hash of its key-signing key.
		\item Each zone also has DNSKEY records for zone-signing and key-signing key.
		\item Key-signing key has a RSIG record signed by the key-signing key.
		\item Every other record has a RSIG record signed by the zone-signing key.
	\end{itemize}
\end{defi}

\begin{defi}[NSEC]
	NSEC record for a given subdomain says \begin{enumerate}
		\item From me to the (next record), there are no other records.
		\item I only have the following records assigned with me.
	\end{enumerate}
	Thus allowing us to sign a non-existence of a record.
\end{defi}

\begin{cor}[]
	NSEC3 uses hashes instead of names, to disallow enumerating.
\end{cor}

\begin{defi}[Root of trust]
	Root of trust is a system where we initially trust someone, and then trust those he trusts and so on.
\end{defi}

\begin{defi}[Directory service]
	A directory service is a service that maps names to public keys on-line.
\end{defi}

\begin{defi}[Certification authority]
	CA signs the keys of others. If we trust the CA, we trust those it trusts.
\end{defi}

\begin{defi}[Public Key Infrastructure]
	PKI is a hierarchy of CAs.
\end{defi}

\begin{defi}[Trust On First Use]
	When we connect for the first time, we trust the other side, on subsequent connections, we want to connect to the same party.
\end{defi}

This is used by SSH.

\begin{defi}[Web Of Trust]
	We sign keys of those we trust.
	Then, when deciding if we turst someone, we look at who signed his key.
\end{defi}

This is used in PGP.

\section{Double Ratchet}

\begin{defi}[KDF chain]
	Let $ f $ be a key derivation function.
	A KDF chain is a sequence of output keys generated by $ f $, where \begin{itemize}
		\item In each step, we use the previous chain key to generate an output key and a chain key.
		\item The first chain key is the initial key.
		\item We also add inputs, so-called sources of entropy.
	\end{itemize}
\end{defi}

\begin{defi}[Symmetric-key Ratchet]
	A symmetric-key ratchet is a KDF chain with constant inputs.
\end{defi}

\begin{prop}[Properties of SKR]
	\
	\begin{itemize}
		\item Without knowledge of the initial key, all output keys look random.
		\item If we get a chain key, we can compute all future keys, but no past keys.
	\end{itemize}
\end{prop}

\begin{defi}[DH Ratchet]
	A DH ratchet is a KDF chain, where in each step we do a round of DH with the other party.
\end{defi}

\begin{defi}[Double Ratchet]
	A \emph{double ratchet} is a symmetric-key ratchet, with inputs being outputs of the DH ratchet.
\end{defi}

\section{TLS}

\begin{defi}[TLS]
	Transport Layer Security protocol is a protocol above the transport layer providing a secure connection.
	Current version is 1.3.
	It handles \begin{itemize}
		\item \emph{key-exchange} -- mailnly Diffie-Hellman, or Diffie-Hellman on elliptic curves (\ref{algo:diffie-hellman}),
		\item \emph{authentication} -- RSA signatures, certificates (\ref{rsa sig}),
		\item \emph{encryption and MAC} -- AEAD (AES with GCM, or ChaCha20+Poly1305) (\ref{defi:aead}),
		\item \emph{negotiation} -- protocol versions, and the parameters above.
	\end{itemize}

\end{defi}

\begin{defi}[DTLS]
	DTLS is a protocol similar to TLS, designed to be used on connection-less transports, such as UDP.
\end{defi}

\begin{defi}[Record Protocol]
	\emph{Record protocol} is the bottom layer of TLS, which handles sending \emph{records}, or messages, to the other side.
	These records can be encrypted and MACed, but they don't have to be (at the start).
\end{defi}

\begin{defi}[Handshake Protocol]
	The general handshake protocol looks like this.
	Note that the messages are bundled and sent together (eg. Server Hello and Certificate).
	\begin{enumerate}
		\item $ \to $ \emph{ClientHello} -- DH key part, supported parameters. \label{tls handshake clienthello}
		\item $ \gets $ \emph{ServerHello} -- DH key part, selected parameters. \label{tls handshake serverhello}
		      \setcounter{saveenum}{\value{enumi}}
	\end{enumerate}
	Now, the connection switches to \emph{handshake} encryption schedule.
	\begin{enumerate}
		\setcounter{enumi}{\value{saveenum}}
		\item (optional) $ \gets $ \emph{EncryptedExtensions} -- the list of extensions we will be using, that are too sensitive to negotiate unencrypted.
		\item $ \gets $ \emph{Certificate} -- the certificate of the server.
		\item $ \gets $ \emph{CertVerify} -- the transcript of the protocol, signed with the key from the certificate.
		\item (optional) $ \gets $ \emph{CertRequest} -- request for the certificate of the client.
		\item $ \gets $ \emph{Finished} -- MAC of transcript.
		\item (optional) $ \to $ \emph{Certificate} -- the certificate of the client.
		\item (optional) $ \to $ \emph{CertVerify} -- the transcript of the protocol, signed with the key from the certificate.
		\item $ \to $ \emph{Finished} -- MAC of transcript.
	\end{enumerate}
	Finally, the connection switches to the \emph{final} schedule.
	With sending \emph{Finished}, we can start sending application data.
\end{defi}

\begin{defi}[Alert Protocol]
	The \emph{alert protocol} handles the applications alerting one another about either an error, thus closing the connection, or that the connection is about to close normally.
	The alert messages still need to be signed.
\end{defi}

\begin{defi}[Key Schedule]
	The key schedule is a type of HKDF, an extension of HMAC.
	It is composed of two steps -- \emph{extraction} and \emph{expansion} -- functioning like a sponge.
	\begin{itemize}
		\item \emph{Extraction} is parametrised by a \textquote{source of randomness} -- initally constant, later the output of previous expansion, and some salt.
		\item \emph{Expansion} is parametrised by the output of extraction and an id.
	\end{itemize}

	The key schedule for TLS has three phases, each starts with an extraction, then an expansion provides keys, and then another expansion provides input to the next phase's extraction.
	\begin{itemize}
		\item \emph{Early} -- generally unencrypted, negotiating DH key.
		      \begin{enumerate}
			      \item Generate the \emph{handshake traffic secrets} -- one for server, one for client.
		      \end{enumerate}
		\item \emph{Handshake} -- use the DH key negotiated in the early phase as the salt for the extraction.
		      \begin{enumerate}
			      \item Generate the \emph{handshake traffic secrets} -- one for server, one for client.
		      \end{enumerate}
		\item \emph{Application} -- the salt is empty.
		      \begin{enumerate}
			      \item Generate the \emph{final traffic secrets} -- one for server, one for client.
			            Each is used in one direction of communication.
			            The keys for encryption and MAC are computed from these secrets, depending on the chosen suite.
			      \item Provide option for the traffic secrets to be re-computed to provide key rotation.
		      \end{enumerate}

	\end{itemize}
\end{defi}

\begin{defi}[Pre-Shared Keys]\label{tls preshared key}
	When the two parties already have some shared secrets, they can use them.
	\begin{enumerate}
		\item Provide the Key Schedule's early phase with a PSK as it's expansion salt.
		\item Use the early phase to generate a \emph{binder} key.
		\item Offer PSK identifiers and the chosen PSK mode in \emph{ClientHello}(\ref{tls handshake clienthello}), and also include signatures of the \emph{ClientHello} with the corresponding binder keys.
		\item Server chooses the PSK and sends it with some nonce in \emph{ServerHello}(\ref{tls handshake serverhello}).
		\item Skip sending certificates -- authentication is already provided by the PSKs.
	\end{enumerate}
	It has two modes: \begin{itemize}
		\item Omit the key-exchange -- use the PSK, skip DH.
		\item Use PSK and DH -- since PSK was added to the Key Schedule, it offers extra protection -- can skip sending certificates.
	\end{itemize}
\end{defi}

\begin{defi}[Session Resume]
	When communicating with a server, which we already sent requests to before, we can use the previous secrets.
	\begin{enumerate}
		\item At any point in the \emph{application} phase, the server generates \emph{NewSessionTicket} message (containing an encrypted state of the server and a nonce).
		\item At the end of the connection, both server and client use the Key Schedule to generate the Resumption Secret.
		\item Both generate a PSK from the Session Ticket and Resumption Secret.
		\item Next time, the client uses PSKs.
	\end{enumerate}
\end{defi}

\begin{defi}[Key Update]
	When communicating for a long time, either party can send a \emph{KeyUpdate} message, which prompts both to re-generate the traffic secrets.
\end{defi}

\begin{defi}[Raw Public Keys Extension]
	Swaps authentication to an out-of-band protocol.
	For example, use DNSSEC records to recieve and authenticate the server's certificate.
\end{defi}

\begin{defi}[0-RTT Handshake Extension]
	Allows sending so-called \emph{Early Data} even in the early and handshake phases, encrypted by the PSK.
	The server needs to notify of the accepted data to be sent as early data in the \emph{NewSessionTicket} message.
\end{defi}

\begin{note}
	0-RTT is potentially voulnerable to replay attacks.
\end{note}

\begin{defi}[Post-Handshake Authentication Extension]
	The server can postpone asking for the client's certificate for later in the \emph{application} phase.
\end{defi}

\begin{defi}[Server Name Indication Extension]
	In the \emph{ClientHello}(\ref{tls handshake clienthello}), specify the domain name of the server we are connecting to.
	Useful when communicating with a server hosting many instances of an application.
\end{defi}

\begin{defi}[Application Level Protocol Negotiation Extension]
	Allows the server and the client to agree on what application protocol to use -- for example, what version of HTTP to use.
\end{defi}

\section{Certificate Authorities}

\begin{defi}[CRL]
	Certificate Revocation List -- list of invalidated certificates. Is not used.
\end{defi}

\begin{defi}[OCSP stapling]
	\
	\begin{enumerate}
		\item The server periodically asks its CA (OCSP server) to provide an OCSP response with a timestamp.
		\item When sending certificate, the server also sends the OCSP response.
		\item The client can verify, that the certificate has not been invalidated in the past, say, two days.
	\end{enumerate}
\end{defi}

\end{document}




























                 [In English]</a></li>

<li><a href="https://gitlab.mff.cuni.cz/uradnikf/bc_lec/-/raw/master/2223l/introai/main.pdf">Úvod do umělé inteligence}
\author{Filip Úradník}
\date{\today}

\input{template}
\input{color}
\input{czech}

\def\given{\mid}

\def\dd{\mathcal{D}}
\def\vv{\mathcal{V}}
\def\cc{\mathcal{C}}

\def\actions{{A}}
\def\states{{S}}
\def\goalStates{\mathcal{G}}
\def\trans{\tau}
\def\rew{\varrho}
\def\discount{\gamma}
\def\ut{U}
\def\eut{\E U}
\def\sens{\sigma}
\def\obss{O}

\def\variables{\mathcal{V}}
\def\domains{\mathcal{D}}
\def\constraints{\mathcal{C}}
\def\solution{\sigma}

\def\stav{\mathcal{X}}
\def\evidence{\mathcal{E}}
\def\query{\mathcal{Q}}
\def\hidden{\mathcal{H}}

\def\hsp{{H}}
\def\trd{\mathcal{D}}
\def\ins{\mathcal{I}}
\def\outs{\mathcal{O}}
\def\attr{A}
\def\entr{H}
\def\rozdel#1#2#3{{#1}_{#2}^{#3}}
\def\rest#1#2{\fce {R}{#1,#2}}
\def\igain#1#2{\fce {G}{#1,#2}}
\def\sql#1{\fce {L}{#1}}
\def\opt#1{{#1}^*}

\begin{document}
\maketitle

\begin{defi}[Racionální agent]
	\emph{Rational agent} je algoritmus $ f: P \to A $, kde $ P $ je množina \emph{vjemů/vstupů/pozorování} a $ A $ je množina \emph{akcí}.
	Agent formalizuje
	\[
		\fce{f}{p} \deq \fce{\argmax_{a \in A}}{\E{\fce{U}{p, a}}},
	\]
	kde $ U $ je tzv. \emph{utility}.
\end{defi}

\begin{defi}[Jednoduchý reflexivní agent]
	\emph{Jednoduchý reflexivní agent} je racionální agent, jehož akce záleží pouze na aktuálním vstupu.
\end{defi}

\begin{defi}[Přechodový model]
	\emph{Přechodový model} je algoritmus $ \trans : S \times A \times O \to S$ popisující změnu \emph{stavu} po \emph{akci} při \emph{stavu} a \emph{pozorování}.
\end{defi}

\begin{defi}[Model-based agent]
	\emph{Model-based reflexivní agent} je racionální agent, který má \emph{vnitřní stav}, který se mění v závislosti na \emph{přechodovém modelu}.
	Vybraná akce pak závisí na aktuálním stavu.
\end{defi}

\begin{defi}[Goal-based agent]
	\emph{Goal-based agent} je zobecnění Model-based agenta, jehož nová akce závisí na \emph{vnitřním stavu} a \emph{cíli}.
\end{defi}

\begin{notation}\
	\begin{itemize}
		\item $ \actions $ je množina \emph{akcí},
		\item $ \states $ je množina \emph{stavů},
		\item $ \trans $ je \emph{přechodový model},
	\end{itemize}
\end{notation}

\begin{defi}[Vlastnosti prostředí]
	Prostředí může být \begin{itemize}
		\item \emph{plně/částečně} pozorovatelné,
		\item \emph{deterministické/stochastické},
		\item \emph{epizodické/sekvenční},
		\item \emph{statické/dynamické},
		\item \emph{diskrétní/spojité},
		\item \emph{jedno-/víceagentní}, pak může být \emph{kompetitivní/kooperativní}.
	\end{itemize}
\end{defi}

\begin{defi}[Stav]
	\emph{Stav} agenta může být: \begin{itemize}
		\item \emph{atomický} $ \equiv $ je to jedna hodnota,
		\item \emph{faktorovaný} $ \equiv $ je to vektor hodnot,
		\item \emph{strukturovaný} $ \equiv $ je to složitější struktura.
	\end{itemize}
\end{defi}

\section{Problem-solving}

\begin{defi}[Problem-solving agent]
	\emph{Problem-solving agent} je \emph{goal-based} agent, který má \begin{itemize}
		\item \emph{atomické} stavy,
		\item množinu \emph{cílových stavů} $ \goalStates \subseteq \states $.
		\item prostředí, které je \emph{deterministické}, \emph{plně pozorovatelné}, \emph{statické} a \emph{diskrétní}.
	\end{itemize}
	Cílem je najít sekvenci akcí, která vede do cílového stavu.
\end{defi}

\begin{defi}[Abstrakce]
	\emph{Abstrakce} je proces odstraňování detailů, které nejsou pro řešení problému důležité.
	Správná úroveň abstrakce by měla být \begin{itemize}
		\item \emph{validní} $ \equiv $ řešení problému v abstrakci odpovídá řešení problému v původním prostředí,
		\item \emph{užitečná} $ \equiv $ řešení problému v abstrakci je snadnější než řešení problému v původním prostředí.
	\end{itemize}
\end{defi}

\begin{defi}[Problém]
	\emph{Problém} je definován \begin{itemize}
		\item \emph{počátečním stavem} $ s_0 \in \states $,
		\item \emph{přechodovým modelem} $ \trans $,
		\item \emph{cílovými stavy} $ \goalStates \subseteq \states $, ty jsou potenciálně zadány jako relace.
	\end{itemize}
\end{defi}

\begin{defi}[Stavový strom]
	\emph{Stavový strom} je strom, jehož vrcholy jsou stavy a jehož hrany jsou akce.
\end{defi}

\begin{algo}[TreeSearch]\ \\
	\AlgIn problém $ P $, strategie výběru dalšího stavu $ o $.
	\begin{algorithmic}[1]
		\State $ Q \gets \left\{ s_0 \right\} $
		\Indent Dokud $ Q \neq \emptyset $:
		\State $ s \gets \fce oQ $
		\Indent Pokud $ s \in \goalStates $:
		\State Vrátíme sekvenci akcí vedoucí do $ s $.
		\EndIndent
		\State $ Q \gets Q \cup \left\{ \fce{\trans}{s, a} \right\}_{a \in \actions} $
		\EndIndent
		\State Vrátíme \emph{neúspěch}.
	\end{algorithmic}
	\AlgOut sekvence akcí vedoucí do cílového stavu.
\end{algo}

Pokud se akce opakují, tak se může stát, že se agent dostane do cyklu.

\begin{algo}[GraphSearch]\ \\
	\emph{Input:} problém $ P $, strategie výběru dalšího stavu $ o $.
	\begin{algorithmic}[1]
		\State $ Q \gets \left\{ s_0 \right\}$
		\State $ B \gets \left\{ s_0 \right\}$
		\Indent Dokud $ Q \neq \emptyset $:
		\State $ s \gets \fce oQ $
		\Indent Pokud $ s \in \goalStates $:
		\State Vrátíme sekvenci akcí vedoucí do $ s $.
		\EndIndent
		\State $ B \gets B \cup \left\{ s \right\} $
		\State $ Q \gets Q \cup \left\{ \fce{\trans}{s, a} \suchthat a \in \actions \land \fce \trans{s,a} \notin B \right\}$
		\EndIndent
	\end{algorithmic}
	\emph{Output:} sequence of states leading from $ s_0 $ to a state $ s $, where $ \fce{\gamma}{s} = 1 $.
\end{algo}

\subsection{Uninformed search}

\begin{algo}[BFS]
	\emph{BFS} je varianta \emph{GraphSearch}, kde se vždy expanduje poslední vrchol.
\end{algo}

\begin{prop}[Vlastnosti BFS]\
	\begin{itemize}
		\item \emph{Kompletnost}: BFS najde řešení, pokud existuje.
		\item \emph{Optimalita}: BFS najde optimální řešení.
		\item \emph{Časová náročnost}: $ \fce{\O}{b^{d+1}} $, kde $ b $ je \emph{branching factor} a $ d $ je hloubka řešení.
		\item \emph{Prostorová náročnost}: $ \fce{\O}{b^{d+1}} $.
	\end{itemize}
\end{prop}

\begin{algo}[DFS]
	\emph{DFS} je varianta \emph{GraphSearch}, kde se postupuje rekurzivně.
\end{algo}

\begin{prop}[Properties of DFS]\
	\begin{itemize}
		\item \emph{Kompletnost pro \sc{GraphSearch}}: DFS najde řešení, pokud existuje.
		\item \emph{Nekompletnost pro \sc{TreeSearch}}: DFS může zacyklit (lze vyřešit pro konečný počet stavů).
		\item \emph{Sub-optimalita}: DFS nemusí najít optimální řešení (lze vyřešit pomocí branch-and-bound).
		\item \emph{Časová náročnost}: $ \fce{\O}{b^m} $, kde $ b $ je \emph{branching factor} a $ m $ je maximální hloubka stromu.
		\item \emph{Prostorová náročnost}: $ \fce{\O}{bm} $ ($ \fce \O{m} $, pokud používáme \emph{backtracking} -- jen jeden následník je v paměti).
	\end{itemize}
\end{prop}

\begin{algo}[Uniform-cost search, Dijkstra]\ \\
	\emph{Input:} problém $ P $, cena $ c: S \times A \to \R^+ $.
	\begin{algorithmic}[1]
		\State $ Q \gets \left\{ s_0 \right\}$
		\State $ B \gets \left\{ s_0 \right\}$
		\State $ \left( \forall s \in \states \right)\! \left( \fce gs \gets \infty \right) $
		\State $ \fce g{s_0} \gets 0 $
		\Indent Dokud $ Q \neq \emptyset $:
		\State $ s \gets \fce {\argmin_{s \in Q}}{\fce gs} $
		\Indent Pokud $ s \in \goalStates $:
		\State Vrátíme sekvenci akcí vedoucí do $ s $.
		\EndIndent
		\State $ B \gets B \cup \left\{ s \right\} $

		\Indent Pro $ a \in \actions $:
		\State $ s' \gets \fce \trans{s, a} $
		\Indent Pokud $ s' \notin B $:
		\State $ \fce g{s'} \gets \fce\min{\fce g{s'}, \fce gs + \fce ca} $
		\State $ Q \gets Q \cup \left\{ s' \right\} $
		\EndIndent

		\EndIndent
		\EndIndent
	\end{algorithmic}
	\AlgOut optimální sekvence akcí vedoucí do cílového stavu.
\end{algo}

\subsection{Informed search}

\emph{Informed search} používá informace o problému k efektivnějšímu prohledávání.

\begin{algo}[Uniform-cost search s evaluační funkcí]\ \\
	\emph{Input:} problém $ P $, cena $ c: S \times A \to \R^+ $, evaluační funkce $ f $.
	\begin{algorithmic}[1]
		\State $ Q \gets \left\{ s_0 \right\}$
		\State $ B \gets \left\{ s_0 \right\}$
		\Indent Dokud $ Q \neq \emptyset $:
		\State $ s \gets \fce {\argmin_{a \in \actions}}{\fce fs} $
		\Indent Pokud $ s \in \goalStates $:
		\State Vrátíme sekvenci akcí vedoucí do $ s $.
		\EndIndent
		\State $ B \gets B \cup \left\{ s \right\} $
		\State $ Q \gets Q \cup \left\{ \fce \trans{s, a} \suchthat a \in \actions \land \fce \trans{s,a} \notin B \right\} $
		\EndIndent
	\end{algorithmic}
	\AlgOut optimální sekvence akcí vedoucí do cílového stavu.
\end{algo}

\begin{defi}[Heuristika]
	\emph{Heuristika} je funkce $ h: S \to \R^+ $, která přiřazuje stavům odhad ceny cesty do cílového stavu.
	Bývá částí funkce $ f $.
\end{defi}

\begin{examp}[Greedy best first search]
	\emph{Greedy best first search} je varianta \emph{Uniform-cost search}, kde $ \fce fs = \fce hs $.
\end{examp}

\begin{cor}[]
	GBFS je nekompletní, neoptimální.
\end{cor}


\begin{algo}[$ A^* $]
	\emph{$ A^* $} je varianta \emph{Uniform-cost search}, kde $ \fce fs = \fce gs + \fce hs $ ($ \fce gs $ je cena z Dijkstry).
\end{algo}

\begin{defi}[Vlastnosti heuristiky]
	Heuristika $ h $ je \begin{itemize}
		\item \emph{admisibilní} $ \equiv $ $ \fce hs \leq \fce Cs $, kde $ C $ je reálná cena z $ s $ do cíle.
		\item \emph{mnotonní} $ \equiv $ $ \fce hs \leq \fce c{s,a} + \fce h{\fce \trans{s,a}} $.
	\end{itemize}

\end{defi}

\begin{prop}[]
	Monotonní heuristika je admisibilní.
\end{prop}

\begin{prop}[Monotonní optimum]
	Nechť $ h $ je monotonní.
	Nechť $ s_0, \dots, s_n $ je libovolná cesta do cíle.
	Pak \[
		\left( \forall i,j: i < j \right)\! \left( \fce h{s_i} \geq \fce h{s_j} \right).
	\]
\end{prop}

\begin{thm}[Optimalita $ A^* $]
	$ A^* $ je optimální, pokud \begin{itemize}
		\item používá \emph{TreeSearch} a $ h $ je admisibilní, nebo
		\item používá \emph{GraphSearch} a $ h $ je monotonní.
	\end{itemize}
\end{thm}


\section{Constraint satisfaction}

\begin{defi}[Forward-checking]
	\emph{Forward-checking} je metoda prohledávání stavového prostoru, kdy ještě než budeme prohledávat, vyřadíme stavy, které nepovedou do konce.
\end{defi}

\begin{defi}[Constraint satisfaction problem]
	Problém \emph{splňování podmínek} je $ P = \left< \vv, \dd, \cc \right> $,
	where \begin{itemize}
		\item $ \variables $ je konečná množina \emph{proměnných},
		\item $ \domains : \variables \to \pot \N $ jsou \emph{domény} proměnných,
		\item $ \constraints $ je konečná množina \emph{podmínek} (lze si představovat jako relace na všech řešeních).
	\end{itemize}
\end{defi}

\begin{defi}[Možné řešení]
	\emph{Přípustné řešení} problému je $ \solution : \variables \to \fceb \domains \variables $, které je \begin{itemize}
		\item \emph{kompletní} $ \equiv $ $ \left( \forall v \in \variables \right)\!  $ dostane hodnotu,
		\item \emph{konsistentní} $ \equiv $ $ \left( \forall v \in \variables \right)\! \left( \fce \solution v \in \fce \domains v \right) \land \left( \forall c \in \constraints \right)\! \left( \fce c\solution \right) $.
	\end{itemize}
\end{defi}

\begin{algo}[Backtracking]\ \\
	\AlgIn problém $ P $, řešení $ \solution $ (na začátku prázdné).
	\begin{algorithmic}[1]
		\State $ v \gets $ volná proměnná.
		\Indent Pro $ h \in \fce \domains v $:
		\Indent Pokud $ \solution \cup \left\{ \left< v, h \right> \right\} $ splňuje $ \constraints $:
		\State $ \solution' \gets \algorithm{Backtracking}{P, \solution \cup \left\{ \left< v,h \right> \right\}} $
		\State Pokud $ \solution' $ není \emph{neúspěch}, vrátíme $ \solution' $.
		\EndIndent
		\EndIndent
	\end{algorithmic}
	\AlgOut řešení $ \solution $.
\end{algo}

\subsection{Binární nerovnostní podmínky}

Předpokládáme, že $ \left( \forall c \in \constraints \right)\!  $ je \emph{binární}, tj. obsahuje nejvýš dvě proměnné.

\begin{defi}[Arc consistency]
	Dvojice $ \left< v, w \right> $ je \emph{konsistentní} $ \equiv $ \[
		\left( \forall x \in \fce \domains v \right)\! \left( \exists y \in \fce \domains w \right)\! \left( \fce \constraints{x,y} \right).
	\]
	Problém je \emph{arc-konsistentní} $ \equiv $ $ \forall v,w \in \variables $ jsou konsistentní.
\end{defi}

\begin{algo}[AC-3]\ \\
	\AlgIn problém $ P $.
	\begin{algorithmic}[1]
		\State $ Q \gets \left\{ \left< v,w \right> \suchthat v,w \in \variables \right\} $
		\Indent Pro $ \left< v,w \right> \in Q $:
		\State Odstraníme $ \left< v,w \right> $ z $ Q $.
		\Indent Pokud $ \fce \domains v $ obsahuje hodnoty nekonsistentní s $ \fce \domains w $:
		\State Odstraníme nekonsistentní hodnoty z $ \fce \domains v $.
		\State Pokud $ \fce \domains v = \emptyset $, vrátíme \emph{nesplnitelný}.
		\State $ Q \gets Q \cup \left\{ \left< z,v \right> \suchthat z \in \variables, z \neq w \right\} $
		\EndIndent
		\EndIndent
	\end{algorithmic}
	\AlgOut $ P $ s redukovanými doménami.
\end{algo}

\begin{cor}[]
	Časová složitost algoritmu je $ \fce \O {ed^3} $, umí se $ \fce \O {ed^2} $.
	$ e $ je počet proměnných a $ d $ je maximální velikost domény.
\end{cor}

\begin{algo}[Look ahead]
	Před backtrackingem projedeme AC-3, a pak při každém vyplnění hodnoty překontrolujeme sousedy.
\end{algo}

\begin{thm}[Look ahead vs FC]
	Forward checking se dívá jen na současnou proměnnou, nevidí \textquote{dál}.
	Look ahead je tedy silnější.
\end{thm}

Konsistence stále negarantuje řešení.

\begin{defi}[$ k $-consistency]
	Množina $ V = \left\{ v_1, \dots, v_k \right\} \subseteq \variables $ je \emph{$ k $-konsistentní} $ \equiv $
	pro každou $ (k-1) $-konsistentní podmnožinu $ V $ a každé její konsistentní řešení existuje hodnota v doméně poslední proměnné, že výsledek je konsistentní.
\end{defi}

\begin{thm}[]
	Pokud je $ P $ $ k $-konsistentní $ \forall k \in \left[ n \right] $, pak ho umíme vyřešit bez backtrackování.
\end{thm}

\begin{prop}[]
	Hledání $ k $-konsistence je exponenciální v $ k $.
\end{prop}

\begin{defi}[Globální podmínky]
	\emph{Globální podmínka} je podmínka o více proměnných.
\end{defi}

Pomocí některých globálních podmínek jsme schopni efektivně filtrovat domény.

\begin{examp}[All-different]
	\emph{All-different} je globální podmínka, která reprezentuje
	\[
		\left( \forall i,j \in I \right)\! \left( v_i \neq v_j \right).
	\]
	Tuto podmínku lze efektivně reprezentovat binárním grafem.
	Pak můžeme odstranit hrany, které nejsou prvkem ani jednoho maximálního párování, čímž zjednodušíme domény.
\end{examp}

\begin{prop}[Fail-first principle] \label{order vars}
	\emph{Fail-first principle} říká, abychom nejdříve vybírali ty \emph{proměnné}, které mají největší šanci neuspět.
	\begin{itemize}
		\item \emph{dom heuristic} $ \equiv $ menší doména znamená pravděpodobněji neuspěje.
		\item \emph{deg heuristic} $ \equiv $ více podmínek znamená pravděpodobněji neuspěje.
	\end{itemize}
\end{prop}

\begin{prop}[Succeed-first principle]\label{order vals}
	\emph{Succeed-first principle} říká, abychom nejdříve vybírali ty \emph{hodnoty}, které nejpravděpodobněji uspějí.
	Heuristiky existují, ale jsou závislé na konkrétním problému.
\end{prop}

\section{Logika a SAT solvery}

Zajímá nás splnitelnost formulí, speciálně formulí v CNF\footnote{Jakoukoliv
	jinou můžu na CNF převést.}.

\begin{algo}[DPLL]\ \\
	\textit{Vstup:} $ \varphi $ v CNF.
	\begin{algorithmic}[1]
		\Indent Dokud $ \left( \exists l \in \varphi \right)\! \left( \{ l \} \in \varphi \lor \left( \forall C \in \varphi \right)\! \left( \overline l \notin C \right) \right) $:
		\Comment Druhé podmínce se říká \textquote{ryzí proměnná}.
		\State $ \varphi \gets \varphi^l $
		\EndIndent

		\Indent Pokud $ \varphi = \emptyset $:
		\State Ohlásíme \textit{splnitelná}.
		\EndIndent
		\Indent Pokud $ \emptyset \in \varphi $:
		\State Ohlásíme \textit{nesplnitelná}.
		\EndIndent
		\State $ p \gets $ náhodná neohodnocená proměnná.
		\State Ohlásíme \textit{splnitelná}, pokud $ \algorithm{DPLL}{\varphi^p} $ nebo $ \algorithm{DPLL}{\varphi^{\lnot p}} $ ohlásí splnitelná, jinak \textit{nesplnitelná}.
	\end{algorithmic}
	\textit{Výstup:} informace o splnitelnosti $ \varphi $ (respektive model $ \varphi $, pokud existuje).
\end{algo}

\begin{note}[]
Další heuristiky mohou být \begin{itemize}
	\item Analýza komponent -- komponenty lze zpracovat samostatně.
	\item Řazení proměnných -- viz \ref{order vals}, \ref{order vars}.
	\item Náhodné restartování -- když jsem někde dlouho, podívám se, jestli neexistuje lepší řešení.
	\item Chytré indexování -- efektivní provedení jednotkové propagace.
	\item Rekonstrukce důvodu chyby -- vytvoření nové klauzule, která chybu zakazuje udělat.
\end{itemize}
\end{note}

Chceme techniky logiky využít na tvorbu \emph{racionálního agenta}. Mohli bychom např.
použít informace o částečném prostředí abychom vybudovali \textquote{bázi
	znalostí}, aby si udělal představu o zbytku světa, který nevidí.

\begin{defi}[Báze znalostí]
	\emph{Báze znalostí} je datová struktura, kterou lze aktualizovat pomocí nové
	informace, a které se lze zeptat na dotaz závislý na již získané informaci.
\end{defi}

Báze znalostí může být výrok $ \varphi $, který zachycuje to, co vím o
prostředí, a dotaz pak může být otázka, zda výrok plyne z $ \varphi $. Dotaz
můžeme zkonstruovat např. pomocí \[
	\varphi \models \alpha \Longleftrightarrow \varphi \land \lnot \alpha \equiv \lightning.
\]

\begin{defi}[Knowledge-based agent]
	KB agent funguje následovně:
	\begin{algorithmic}[1]
		\State Uloží \emph{pozorování} do \emph{báze znalostí}.
		\State Zeptá se báze znalostí na další akci.
		\State Uloží akci do báze znalostí.
		\State Provede akci.
	\end{algorithmic}
\end{defi}

\begin{defi}[Model světa]
	\emph{Model} je ohodnocení proměnných konsistentní s naší bází znalostí.
\end{defi}

Dotaz je tedy \textquote{platí $ \varphi $ ve všech modelech?}

\begin{defi}[Způsoby inference]
	Inference se dá dělat dvěma způsoby \begin{enumerate}
		\item prohledáváním -- jako např. v DPLL,
		\item dokazováním -- viz rezoluce.
	\end{enumerate}
\end{defi}

\begin{defi}[Rezoluce]
	\emph{Rezoluce} je algoritmus využívající rezolučního pravidla aby zjistil, zda je výrok v CNF splnitelný pomocí odvozování prázdné klauzule.
\end{defi}

\subsection{Hornovské formule}

Pokud je $ \varphi $ \emph{Hornovská formule}, můžeme se na ni dívat jako na implikace, tedy \emph{předpoklady} (negativní literály) a \emph{cíl} (pozitivní literál).
\emph{Fakta} jsou klauzule bez předpokladů.
Dotaz nad takovou bází znalostí zvládneme dokonce v $ \fce{\O}{n} $.

\begin{algo}[Forward chaining/data-driven]
	Ze známých faktů postupně odvozujeme všechny možné důsledky dokud buď
	nedokážeme dotaz, nebo nám nedojdou fakta.
\end{algo}

\begin{algo}[Backward chaining/goal-driven]
	Jdeme od cíle, který chceme dokázat, a rozdělujeme ho na pod-dotazy, než
	dojdeme až k faktům.
\end{algo}

\begin{note}[]
	Oba algoritmy jsou jen speciální případy rezoluce.
\end{note}


Racionální agent tedy může používat různé metody logiky (DPLL, rezoluce, ...)
aby vydedukoval potřebné informace o prostředí, které potřebuje ke splnění
cíle.

\section{Plánování}

Racionální agent prozatím neměl pojem o čase.
Toho dosáhneme tak, že budeme uchovávat \textquote{snapshoty} světa v čase.
Některé proměnné budou závislé na čase, některé ne.

\begin{defi}[Fluent]
	\emph{Fluent} je množina proměnných, kde každá zachycuje stav v určitém čase.
	Zpravidla budeme značit stav v čase $ t $ jako $ L^t $.
\end{defi}

\begin{notation}
	Často řešíme problémy kdy se pohybujeme v čase i prostoru. Pak $ L^t_{x,y} $ značí \emph{v čase $ t $ jsem byl na pozici $ x,y $}.
\end{notation}

\begin{defi}[Observační model]
	\emph{Observační model} (pro neměnné informace) se snaží zjistit univerzálně platné informace o světě z informací ze senzorů které jsou závislé na čase.
	Např. \[
		L^t_{x,y} \implies \left( B^t \leftrightarrow B_{x,y} \right).
	\]
\end{defi}

\begin{defi}[Přechodový model]
	\emph{Přechodový model} lze opět zachytit axiomy: \[
		\left( L^t_{x,y} \land F^t \right) \to \left( L^{t+1}_{x+1,y} \land \lnot L^t_{x,y} \right),
	\]
	kde $ L $ má být lokace v čase $ t $ a $ F $ má značit, že jsem si v čase $ t $ vybral akci \emph{forward}.
\end{defi}

Dále je třeba přidat axiom říkající \textquote{pokud něco platilo v $ t $, a já neřeknu jinak, pak to platí i v $ t+1 $}.

\begin{defi}[Axiom rámce]
	Axiom rámce říká bázi znalostí, že pokud daná akce $ A $ nemění vlastnost $ V $, pak se vykonáním $ A $ $ V $ skutečně nezmění. Např.: \[
		A^t \to \left( V^{t+1} \leftrightarrow V^t \right).
	\]
\end{defi}
Problém s tímto přístupem je, že takových axiomů je hodně.
Proto se používá \emph{Successor-state axiom}.

\begin{defi}[Successor-state axiom]
	\emph{Successor-state axiom} je axiom, který lze vystihnout pro vlastnost $ F $ a \textquote{informaci o kauzalitě} $ C_F $ jako \[
		F^{t+1} \leftrightarrow \left( C_F^t \lor \left( F^t \land \lnot C_{\lnot F}^t \right) \right),
	\]
\end{defi}

Nyní se pokusíme vývoj v čase převést i na budoucnost.
Báze znalostí nám tedy bude předvídat akce, které máme dělat.
Idea je zadefinovat \textquote{axiom cíle} na konečný čas, a zkusit, jestli k němu existuje řešení.
K tomu je ještě nutné zadefinovat, co přesně můžeme v jakém stavu dělat (to jsme předtím nepotřebovali definovat, protože báze znalostí o tom nerozhodovala).

\begin{defi}[Precondition axiom]
	\emph{Precondition axiom} je axiom, který říká, kdy je akce aplikovatelná. Tedy pro akci $ A $ předpoklady akce $ P_A $ bude axiom \[
		A \to P_A.
	\]
\end{defi}

\begin{defi}[Action exclusion axiom]
	\emph{AE} axiom říká, že v každém čase si můžeme vybrat nejvýše jednu akci.
\end{defi}

\begin{algo}[Plánování inferencí]\ \\
	\AlgIn Problém $ P $.
	\begin{algorithmic}[1]
		\Indent Zakódujeme informace o problému do logických formulí:
		\State Observační, přechodový model.
		\State Successor-state axiomy.
		\State Precondition axiomy.
		\State \emph{Úplný} počáteční stav.
		\EndIndent
		\Indent Pro $ t \in \N $:
		\State Přidáme axiom \textquote{splníme cíl v čase $ t $}.
		\State Pokusíme se najít model.
		\State Pokud existuje, vrátíme odpovídající plán.
		\State Jinak odstraníme axiom o cíli.
		\EndIndent
	\end{algorithmic}
	\AlgOut Plán pro jeho řešení.
\end{algo}

\begin{cor}[]
	Plánování pomocí výrokové logiky je neefektivní v tom, že každý axiom musí platit pro všechny akce, všechny časy, všechny lokace atd.
\end{cor}

\subsection{Situační kalkulus}

Axiomů je stále hodně, jedním možným řešením je pomocí \emph{predikátové logiky}.

\begin{defi}[Situační kalkulus]
	\emph{Situační kalkulus} je teorie v PL, která kóduje daný problém: \begin{itemize}
		\item universum jsou \emph{akce} a \emph{stavy},
		\item \emph{stavy} jsou termy,
		\item \emph{počáteční stav} je konstanta $ s_0 $,
		\item \emph{vztahy} mezi stavy, akcemi, atd. jsou relace,
		\item \emph{přechodový model} je funkce $ R $, která dává \emph{result} nějaké \emph{akce} v nějakém \emph{stavu},
		\item \emph{axiomy} z modelů výše jsou kódovány pomocí výroků (mnohem efektivněji).
		\item \emph{plánování} je realizováno pomocí výroku \emph{existuje cílový stav}.
	\end{itemize}
\end{defi}

\begin{cor}[]
	K vyřešení problému přes situační kalkulus je třeba \emph{řešič predikátové logiky}, což je mnohem složitější než výroková logika.
\end{cor}

\subsection{Klasické plánování}

\begin{defi}[Klasické plánování]
	\emph{Klasické plánování} je technika řešení problému plánování, kde \begin{itemize}
		\item \emph{stavy} jsou faktorované -- vektor veličin,
		\item \emph{akce} jsou operátory na těchto stavech,
		\item \emph{hledání plánu} je \emph{prohledáváním} stavového prostoru.
	\end{itemize}
\end{defi}

\begin{cor}[]
	Stavový prostor je téměř vždy obrovský, protože potenciálně obsahuje všechny možné kombinace hodnot ve vektoru stavu.
	Nemůžeme ho tedy držet celý v paměti.
\end{cor}

\begin{defi}[Klasické plánování se situačním kalkulem]
	Použijeme situační kalkulus abychom zakódovali problém, následně ho vyřešíme prohledáváním.
	\begin{itemize}
		\item \emph{stav} bude množina pravdivých atomů (formálně vektor $ \in \left\{ 0,1 \right\}^{N} $, kde $ N $ je počet atomů).
		\item \emph{cíl} $ g = g^+ \cup g^- $ je množina atomických tvrzení, které musí na konci platit ($ g^+ $ jsou pozitivní tvrzení, $ g^- $ jsou negativní tvrzení).
	\end{itemize}
\end{defi}

\begin{defi}[Předpoklad uzavřeného světa]
	V \emph{uzavřeném světě} platí, že \emph{co není ve stavu, to explicitně neplatí}.
\end{defi}

\begin{cor}[]
	V klasickém plánování se předpokládá uzavřený svět.
\end{cor}

\begin{defi}[Splnění cíle]
	Stav $ s $ \emph{splňuje} cíl $ g $ $ \equiv $ \[
		g^+ \subseteq s \land g^- \cap s = \emptyset.
	\]
\end{defi}

\begin{defi}[Schéma akce]
	\emph{Operátor} je trojice $ o = \left< \fce n{x_1, \dots, x_n}, p, e \right> $, kde \begin{itemize}
		\item $ n $ je \emph{jméno} operátoru, spolu s parametry $ x_1, \dots, x_n $,
		\item $ p $ jsou \emph{předpoklady} aplikace operátoru, které musí/nesmí platit,
		\item $ e $ jsou \emph{efekty}, seznamy vlastností, které nově budou/nebudou platit po aplikaci operátoru.
	\end{itemize}
\end{defi}

\begin{defi}[Akce]
	\emph{Akce} je potom plná instanciace konkrétního operátoru, tj. za $ x_1, \dots, x_n $ dosadíme konkrétní termy.
\end{defi}

\begin{defi}[Aplikovatelnost]
	Akce je \emph{aplikovatelná} ve stavu $ s $ $ \equiv $ \[
		p_a^+ \subseteq s \land p_a^- \cap s = \emptyset.
	\]
\end{defi}

\begin{defi}[Výsledek akce]
	Výsledek akce je dán funkcí $ \fce{\gamma}{s, a} \deq \left( s \setminus e^-_a \right) \cup e^+_a $.
\end{defi}

\begin{defi}[Interference akcí]
	Akce se navzájem ruší pokud efekty jedné nějak ovlivňují efekty nebo předpoklady druhé.
\end{defi}

\begin{defi}[Relevantní akce]
	Akce $ a $ je \emph{relevantní} pro cíl $ g $ $ \equiv $ \[
		\left( g \cap e_a \neq \emptyset \right) \land \left( g^+ \cap e^-_a = \emptyset \right) \land \left( g^- \cap e^+_a = \emptyset \right).
	\]
\end{defi}

\begin{defi}[Regresivní množina]
	Regresivní množina cíle $ g $ pro \emph{relevantní} akci $ a $ je množina předpokladů, které jsou potřeba, aby akce $ a $ splnila cíl $ g $:\[
		\fce {\gamma^{-1}}a \deq \left( g \setminus e_a \right) \cup p_a.
	\]
\end{defi}

\begin{defi}[Plán]
	\emph{Plán} $ \pi $ je sekvence akcí, které vedou k cíli.
\end{defi}

\begin{defi}[Plánovací problém]
	\emph{Plánovací problém} je $ P = \left< O, s_0, g \right> $, kde $ s_0 $ je stav, $ g $ je cíl a $ O $ je doména modelů, neboli popis všech operátorů.
\end{defi}

\begin{algo}[Forward planning]
	Nechť $ P $ je plánovací problém.
	\emph{Forward planning} je algoritmus, který začne v počátečním stavu a jde do cíle pomocí prohledávání.
\end{algo}

\begin{algo}[Backward planning]
	Nechť $ P $ je plánovací problém.
	\emph{Backward planning} je algoritmus, který začne v cíli a pomocí regresivních množin jde k počátku pomocí prohledávání.
\end{algo}

\begin{note}[]
	Backward planning bývá výhodnější díky tomu, že branching factor u cíle bývá menší.
	Na druhou stranu, algoritmus může pomocí regresivních množin generovat cíle, které nelze splnit.
\end{note}

\begin{note}[]
	Další možností je jít \textquote{oběma směry}, ovšem to je hodně komplikované a paměťově náročné.
	Dnes je nejpoužívanější \emph{forward planning s heuristikami}.
\end{note}

\begin{note}[Heuristiky]
	Nejpoužívanější heuristiky jsou \begin{itemize}
		\item \emph{ignorování předpokladů akcí},
		\item \emph{ignorování negativních efektů}.
	\end{itemize}

\end{note}

\begin{algo}[Plan-space plánování]
	Plán je postupně zdokonalován, aby vyřešil nevyřešené části cíle.
	Je podobné backward-planningu.
\end{algo}


\begin{algo}[Hierarchické plánování]
	Definuji \textquote{procedury}, které umím splnit.
\end{algo}

\section{Práce s neurčitou informací}

\begin{note}[Zdroje neurčitosti]
	Neurčitost vyplývá například z \begin{itemize}
		\item částečně-pozorovatelného světa,
		\item nepřesnost reálných zařízení -- motorů atd.
	\end{itemize}
\end{note}

\begin{note}[Neurčitost pomocí logiky]
	Způsob vypořádání se s neurčitostí v logice jsou například \begin{itemize}
		\item pohybovat se v \emph{domnělých stavech},
		\item při plánování vytvářet také \emph{záložní plány}.
	\end{itemize}
	Tyto techniky však výrazně zvyšují \emph{časovou i prostorovou náročnost}.
	Navíc nejsou schopny \emph{zohlednit pravděpodobnost} při vybírání akcí.
\end{note}

\begin{defi}[Pravděpodobnostní agent]
	\emph{Pravděpodobnostní agent} pracuje s množinou stavů $ \Omega $, kde každému stavu $ \omega \in \Omega $ je přiřazena pravděpodobnost $ \pr{\omega} $.
	\begin{itemize}
		\item Každý $ \omega \in \Omega $ reprezentuje jeden možný \emph{svět}.
		\item Agent zkoumá svět přes \emph{jevy} $ \subseteq \Omega $.
	\end{itemize}
\end{defi}

\begin{defi}[Reprezentace stavu]
	Budeme používat \emph{faktorovanou} reprezentaci stavů -- stav je množina $ \stav $, vektor \emph{náhodných veličin} a jejich hodnot.
	Rozlišujeme veličiny \begin{itemize}
		\item $ \evidence $ -- veličiny, kterým již známe hodnoty,
		\item $ \query $ -- veličiny, které ještě neznáme, ale chtěli bychom je znát,
		\item $ \hidden $ -- skryté veličiny, které neumíme přímo pozorovat, ale hodí se k popisu vztahů mezi ostatními veličinami.
	\end{itemize}
\end{defi}

\begin{note}[]
	Svět je plně popsán hodnotami všech náhodných veličin -- konkrétní úplný stav reprezentuje právě jeden svět.
\end{note}

\begin{defi}[CPT]
	\emph{Conditional Probability Table} je tabulka podmíněných pravděpodobností náhodných proměnných.
\end{defi}

\begin{cor}[Marginalizace]
	Agent využívá znalosti problému ve formě CPT, aby odvodil pravděpodobnostní rozdělení $ \query $ pomocí $ \evidence $.
\end{cor}

\begin{thm}[Bayesova]
	Nechť $ B_1, \dots, B_n \in \ff $ jsou disjunktní množiny, $ \Omega = \cup_i B_i $. Pak \[
		\pr{B_j \mid A} = \frac{\pr{B_j} \pr{A \given B_j}}{\sum_{i}^{} \pr{B_i} \pr{A \mid B_i}}.
	\]
\end{thm}

\begin{note}[]
	Můžeme si buď udržovat pravděpodobnosti \emph{kauzální}, tj pravděpodobnost, že se stal efekt, pokud platí kauzalita, nebo \emph{diagnostické},
	tj. pravděpodobnost, že se stala kauzalita, pokud platí efekt.

	První druh je běžnější např. v učebnicích, tj. snáze o něm někde zjistíme data, navíc je i \emph{stabilnější} -- platí menší neurčitost.
\end{note}

\begin{prop}[Optimalizace výpočtů]
	Abychom si nemuseli držet CPT o dimenzi $ \absolute \stav $, používáme triky pro urychlení výpočtu/zefektivnění uložení:
	\begin{itemize}
		\item \emph{Normalizace} -- když počítáme pravděpodobnosti rozkladu $ \Omega $, víme, že se sečtou na 1, tedy stačí je potom znormalizovat.
		\item \emph{Nezávislost} -- pro $ X,Y $ nezávislé ($ \pr {X \land Y} = \pr X \pr Y $) stačí udržovat dvě menší CPT, protože vztah mezi nimi je jasný.
		\item \emph{Podmíněná nezávislost} -- pro $ X,Y $ \emph{podmíněně} nezávislé ($ \pr {X \land Y \given Z} = \pr {X \given Z} \pr {Y \given Z} $) můžu použít stejný trik (alespoň částečně).
	\end{itemize}

\end{prop}

\begin{defi}[Bayesovská síť]
	\emph{Bayesovská síť} je DAG $ G = \left< V,E,\stav \right> $, kde \begin{itemize}
		\item $ \stav = \left\{ X_v \suchthat v \in V \right\} $,
		\item každý vrchol $ v \in V $ si pamatuje CPT pro $ X_v $ v závislosti na $ \left\{ X_u \suchthat uv \in E \right\} $:\[
				\prfa{x, o}{X_v = x \given \left\{ X_u \suchthat uv \in E \right\} = o}.
		\]
	\end{itemize}
\end{defi}

\begin{cor}[]
	(Správně vybudovaná) Bayesovská síť reprezentuje celou pravděpodobnostní distribuci.
\end{cor}

\begin{note}[]
	Pro zdroj je množina předchůdců prázdná, tedy pamatuje si prostě $ \pr {X_z} $.
\end{note}


\begin{algo}[Budování Bayesovské sítě]\
	\begin{algorithmic}[1]
		\State Zvolíme $ \stav $, seznam náhodných veličin potřebných pro modelování problému.
		\State Seřadíme $ \stav = \left\{ X_1, \dots, X_n \right\} $. \Comment Snažíme se, aby byly kauzality před efekty.
		\State $ V,E \gets \emptyset $
		\Indent Pro $ v \in \range n $:
		\State Zvolíme minimální množinu $ U \subseteq V $, tž. \[
			\prfa{x,o}{X_v = x \given \left\{ X_u \suchthat u \in U \right\} = o} = \prfa{x,o}{X_v = x \given \left\{ X_u \suchthat u \in V \right\}=o}.
		\]
		\State $ V \gets V \cup \left\{ v \right\} $
		\State $ E \gets E \cup \left\{ \left< u,v \right> \suchthat u \in U \right\} $
		\State Uložíme CPT ve $ v $ podle předchůdců.
		\EndIndent
	\end{algorithmic}
	\AlgOut Bayesovská síť $ \left< V,E \right> $.
\end{algo}

Nyní máme Bayesovskou síť, která šetří místo.
Teď bychom chtěli pomocí ní počítat efektivně pravděpodobnosti.

\begin{notation}
	Ohledně grafů budu používat \[
		\fce \delta v \deq \left\{ u \suchthat uv \in E \lor vu \in E \right\},
	\]
	Dále pak pro orientované grafy \[
		\fce { \delta^+ } v \deq \left\{ u \suchthat uv \in E \right\},
	\]
	a \[
		\fce { \delta^- } v \deq \left\{ u \suchthat vu \in E \right\}.
	\]
\end{notation}


\begin{prop}[]
	Nechť $ \stav = \query \disjcup \evidence \disjcup \hidden $.
	Pak platí \[
		\prfa {x,e} {\query = x \given \evidence = e} = \alpha \prfa{x,e}{\query = x \land \evidence = e} = \alpha \sum_{h \in \dom \hidden} \prfa{x,e} {\query =x \land \evidence =e \land \hidden = h }.
	\]
\end{prop}

\begin{prop}[]
	Nechť $ \stav $ je vyjádřen Bayesovskou sítí. Pak \[
		\prfa{x}{\stav = x} = \prod_{v \in V} \prfa{x}{X_v = x_v \given X_{\fce {\delta^+}v}=x_{\fce {\delta^+}v}}.
	\]
\end{prop}

Pomocí dvou předchozích tvrzení můžeme zadefinovat algoritmus pro inferenci na Bayesovských sítích.

\begin{algo}[Inference Enumerací]\ \\
	\AlgIn Bayesovská síť $ G $, veličina $ \query $, které chceme znát pravděpodobnost, pozorované hodnoty $ e $ proměnných $ \evidence $.
	\begin{algorithmic}[1]
		\State $ \pr \query \gets $ prázdná distribuce přes $ \query $.
		\Indent Pro $ x \in \rng \query $:
		\State $ e' \gets e \cup \left\{ \query = x \right\} $
		\State $ P = 0 $
		\Indent Pro $ h \in \rng \hidden $: \Comment Lze počítat postupně pro každou $ X \in \hidden $, rekurzivně.
		\State $ e'' \gets e' \cup \left\{ \hidden = h \right\} $
		\State $ P \gets P + \prod_{v \in V} \pr{ X_v = e''_v \mid X_{\fce {\delta^+}v} = e''_{\fce{\delta^+}v}} $ \Comment Údaje z CPT.
		\EndIndent
		\State $ \pr{ \query = x_i} \gets P $
		\EndIndent
		\State Normalizujeme $ \pr \query $, aby součet všech hodnot byl $ 1 $.
	\end{algorithmic}
	\AlgOut Pravděpodobnostní distribuce hodnot $ \query $.
\end{algo}

Při enumeraci se může stát, že v některých větvích se dostaneme do stejného stavu, které pak tedy počítáme dvakrát.
Toto lze optimalizovat pomocí dynamického programování.

\begin{algo}[Eliminace Proměnných]
	Funguje jako inference enumerací, ale místo počítání pravděpodobností pokaždé
	využívá metod dynamického programování, a reprezentuje pravděpodobnostní
	rozdělení jednotlivých proměnných jako matice. Tím zrychluje výpočet.
\end{algo}

\begin{note}[]
	Eliminace proměnných pracuje s \emph{faktory} -- maticemi reprezentujícími CPT pro množinu proměnných.
	Pomocí operací vysčítání a násobení (pointwise) na faktorech získává faktory pro nové kombinace proměnných a pokračuje až nedojde ke $ \query $.
\end{note}

\begin{note}[]
	Pořadí aplikace operací na faktorech ovlivňuje časovou složitost -- chceme udržovat faktory co nejmenší po celou dobu běhu algoritmu.
\end{note}

\begin{defi}[Operace na faktorech]
	\
	\begin{itemize}
		\item násobení: máme dva faktory, každý obsahuje nějaké proměnné, některé proměnné jsou v obou; uděláme nový faktor se sjednocením proměnných.
		\item vysčítání: z faktoru o $ n $ proměnných uděláme faktor o $ n-1 $ proměnných.
	\end{itemize}

\end{defi}


\begin{algo}[Aproximace Inference]\ \\
	\AlgIn Bayesovská síť $ G $, veličina $ X $, které chceme znát pravděpodobnost, všechny proměnné $ V $, pozorované hodnoty $ e $ proměnných $ E \subseteq V $ ($ X \notin E $).
	\begin{algorithmic}[1]
		\Indent Opakujeme:
		\State Vygenerujeme \textquote{možný svět}.
		\State Určíme pravděpodobnost (nějak).
		\EndIndent
	\end{algorithmic}
	\AlgOut Pravděpodobnostní distribuce hodnot $ X $.
\end{algo}

\begin{defi}[Rejection sampling]
	Generujeme samples, a ty, které nesplňují $ e $, zahazujeme:
	\[
		\pr{X=x \given \evidence = e} \approx \frac{\fce{N}{X=x, \evidence = e}}{\fce{N}{\evidence = e}},
	\]
	kde $ \fce{N}{A} $ je vektor počtu výskytů hodnot z $ A $.
\end{defi}

Problém je, že tímto způsobem velké množství času promrháme, protože to, co vypočteme, zahodíme (kdykoliv nebude platit $ \evidence = e $).

\begin{defi}[Likelihood weighting]
	Místo zahazování samplů, které nesplňují $ e $, prostě zafixujeme $ e $ a generujeme ostatní proměnné.
	Výsledek pak musíme ještě přenásobit pravděpodobností $ e $ (z Bayesovské sítě), tj. $ \fce{w}{e} = \prod_i \pr{\evidence_i = e_i \mid X_{\fce {\delta^+}i}} $.
\end{defi}

Tato metoda má zase problém s tím, že počítá s hodně malými čísly.
S těmi se na počítači celkově nedá moc přesně pracovat.


\section{Neurčitost v čase}

\begin{notation}
	Opět budeme mít množiny náhodných proměnných, tentokrát ještě rozčleněné po čase, tedy máme $ \left( \forall t \in \N \right) \stav_t $.
	Dále budeme předpokládat, že $ \query = \hidden $.
\end{notation}

\begin{defi}[Přechodový model]
	\emph{Přechodový model} specifikuje pravděpodobnostní distribuci skrytých proměnných v čase $ t+1 $ v závislosti na pravděpodobnostní distribuci skrytých proměnných v čase $ t $, tj. \[
		\prfa{h,h'}{\hidden_t = h \given \hidden_{t'<t} = h'}.
	\]
\end{defi}

\begin{defi}[Markov assumption] \label{markov assump}
	\[
		\prfa{h,h'}{\hidden_t = h \given \hidden_{t'<t} = h'} = \prfa{h,h'}{\hidden_t = h \given \hidden_{t-1}=h'}.
	\]
\end{defi}

\begin{defi}[Stacionární předpoklad]
	\[
		\left( \forall t, t' \right)\! \left( \prfa{h,h'}{\hidden_t=h \given \hidden_{t-1}=h'} = \prfa{h,h'}{\hidden_{t'} = h \given \hidden_{{t'}-1}=h'} \right)
	\]
\end{defi}

\begin{defi}[Pozorovací model]
	\emph{Pozorovací model} specifikuje pravděpodobnostní distribuci pozorovaných proměnných v čase $ t $ v závislosti na pravděpodobnostní distribuci skrytých proměnných v čase $ t $, tj. \[
		\prfa{e,h,x}{\evidence_t = e \given \hidden_t = h, \stav_{t'<t} = x} = \prfa{e,h}{\evidence_t = e \given \hidden_t = h}.
	\]
\end{defi}

\begin{defi}[Filtrace]
	\emph{Filtrace} je úloha, kdy známe všechny pozorované proměnné $ \forall i \leq t $, chceme znát pravděpodobnostní distribuci skrytých proměnných v čase $ t $.
\end{defi}

\begin{thm}[Inkrementální filtrace]
	$ \prfa{x}{\hidden_t = x \given \evidence_{t'\leq t} = e} = $\[
		\alpha \prfa{x}{\evidence_t = e_t \given \hidden_t = x} \sum_{y \in \rng \hidden_{t-1}} \prfa{x}{\hidden_t=x \given \hidden_{t-1} = y} \pr{\hidden_{t-1}=y \given \evidence_{t'<t} =e_{t'<t}}.
	\]
	čemuž se také říká \emph{forward message propagation}.
\end{thm}

\begin{defi}[Forward propagation]
	Vycházíme z iniciální distribuce $ \stav_0 $, postupně aplikujeme $ e $, než dospějeme do požadovaného času.
\end{defi}

\begin{defi}[Predikce]
	\emph{Predikce} je úloha, kdy známe všechny pozorované proměnné $ \forall i \leq t $, chceme znát pravděpodobnostní distribuci skrytých proměnných v čase $ t+k $.
\end{defi}

\begin{thm}[Inkrementální predikce]
	$ \prfa{x}{\hidden_{t+k+1} = x \given \evidence_{t' \leq t} = e} = $ \[
		\sum_{y \in \rng\hidden_{t+k}} \prfa{x}{\hidden_{t+k+1} = x \given \hidden_{t+k} = y} \pr{\hidden_{t+k} = y \given \evidence_{t'\leq t}= e}.
	\]
\end{thm}

\begin{defi}[Mixing time]
	Mixing time je časový úsek, od kdy výsledek predikce téměř není rozeznatelný od přechodového modelu.
\end{defi}

\begin{defi}[Vyhlazování]
	\emph{Vyhlazování} je úloha, kdy známe všechny pozorované proměnné $ \forall i \leq t $, chceme znát pravděpodobnostní distribuci skrytých proměnných v čase $ k < t $
	\footnote{Chceme využít nově nabyté informace.}.
\end{defi}

\begin{thm}[Inkrementální vyhlazování]
	$ \prfa{x}{\hidden_k = x \given \evidence_{t' \leq t} = e} =  $ \[
		\alpha \prfa{x}{\hidden_k = x \given \evidence_{t' \leq k} = e_{t' \leq k}} \prfa{x}{\evidence_{t'>k} = e_{t'>k} \given \hidden_k = x},
	\]
	kde $ \prfa{x}{\evidence_{t'>k} = e_{t'>k} \given \hidden_k = x} = $\[
		\sum_{z \in \rng\hidden_{k+1}} \prfa{x}{\hidden_{k+1} = z \given \hidden_k = x} \pr{\evidence_{k+1} = e_{k+1} \given \hidden_{k+1} = z}\pr{\evidence_{t'>k+1} = e_{t'>k+1} \given \hidden_{k+1} =z} ,
	\]
	čemuž se říká \emph{backward message propagation}.
\end{thm}

\begin{defi}[Backward propagation]
	Vycházíme ze současného stavu, postupujeme do minulosti.
\end{defi}


\begin{defi}[Nejpravděpodobnější vysvětlení]
	\emph{Nejpravděpodobnější vysvětlení} je úloha, kdy $ \forall i: i \leq t $ známe všechny pozorované proměnné, chceme znát nejpravděpodobnější řetězec skrytých proměnných.
\end{defi}

\begin{note}[]
Nelze udělat prostě tak, že všechny proměnné vyhladím a pak vyberu nejpravděpodobnější řetězec, protože to by ignorovalo vztahy mezi proměnnými.
\end{note}

\begin{algo}[Viterbi]\ \\
	$ \max_x \prfa{y}{\hidden_{t'\leq t} = x, \hidden_{t+1}=y \given \evidence_{t'\leq t+1} = e} = $
	\[
	\alpha \prfa{y}{\evidence_{t+1} = e_{t+1} \given \hidden_{t+1} = y} \max_{x_t} \left(\prfa{y}{\hidden_{t+1} = y \given \hidden_{t}=x_{t}} \;\max_{x_{t'<t}} \pr{\hidden_{t' \leq t} = x \given \evidence_{t'\leq t} = e} \right).	\]
\end{algo}

\begin{defi}[HMM, Skrytý (Hidden) Markov model]
	Ve skrytém Markovově modelu máme pro každý čas jen jednu skrytou proměnnou a jednu pozorovanou proměnnou.
\end{defi}

\begin{defi}[Přechody v HMM]
	Ve skrytém Markově modelu s $ n $ možnými hodnotami proměnných máme \begin{itemize}
		\item $ T \in \R^{n \times n} $ přechodovou matici, tž. $ T_{i,j} = \pr{\hidden_t = x_j \given \hidden_{t-1} = x_i} $,
		\item $ O \in \R^{n \times n} $ diagonální observační matici, tž. $ O_{i,i} = \pr{\evidence_t = e \given \hidden_{t} = x_i} $,
	\end{itemize}

\end{defi}

\begin{cor}[Přechody v HMM]
	Forward propagation je \[
		f_{1\dots t+1} = \alpha O_{t+1} \times T^T \times f_{1\dots t},
	\]
	Backward propagation je \[
		b_{k+1\dots t} = T \times O_{k+1} \times b_{k+2\dots t}.
	\]
\end{cor}


\begin{defi}[Dynamická Bayesovská síť]
	\emph{Dynamická Bayesovská síť} je síť, která obsahuje: \begin{itemize}
		\item předchozí pravděpodobnostní distribuci,
		\item přechodový model,
		\item pozorovací model.
	\end{itemize}
	Umí generovat odpovídající statickou Bayesovskou síť pro libovolný časový úsek.
\end{defi}

\begin{note}[]
	HMM je speciální případ DBS.
	Samozřejmě, libovolný model lze převést na HMM, ale vzniká obrovská tabulka pravděpodobností.
	Je to analogické Statickým Bayesovským sítím vs úplné CPT.
\end{note}

\begin{algo}[Unrolling]
	\emph{Unrolling} je proces, kdy se ze stávající DBN a nových pozorování vygeneruje nový \textquote{časový slice}.
\end{algo}

\begin{algo}[Inference]
	\emph{Inferenci} lze provádět tak, že nejprve pomocí unrollingu vygenerujeme statickou BS a použijeme klasický algoritmus inference.
\end{algo}

\begin{cor}[]
	Pokud bychom vygenerovali celou síť od času $ 0 $ až do $ t $, bylo by to náročné.
	Lze ale pomocí vysčítání \textquote{zapomenout} předchozí vrstvy a pamatovat si jen tu současnou (jeden krok pak ale trvá exponenciálně v počtu proměnných).
\end{cor}

\begin{algo}[Inference Monte Carlo]
	Jako u klasických BS lze provádět i odhady pomocí Monte Carlo metod, ale tentokrát je to klasickým způsobem ještě méně efektivní -- generovaní probíhá nezávisle na pozorování, tudíž má velmi pravděpodobně hodně malou váhu.
\end{algo}

\section{Rozhodování s neurčitou informací}

Už umíme popsat prostředí, ale jak rozhodovat?

\subsection{Jednoduché rozhodování}

\begin{defi}[Teorie rozhodování]
	\emph{Teorie rozhodování} pracuje s náhodnou veličinou \[
		\trans: \actions \times \states \to \states,
	\]
	která popisuje, jak dopadne nějaká akce $ a $ ve stavu $ s $.
\end{defi}

\begin{defi}[Užitková funkce]
	Užitková funkce $ \ut $ je funkce, která každému stavu $ s $ přiřadí hodnotu \textquote{desirability}.
\end{defi}

\begin{defi}[Očekávaná utility]
	\emph{Očekávaná užitková funkce} akce $ a $ při pozorování $ e $ je \[
		\fce{\eut}{a \given \evidence  =e} = \sum_{s \in \states}^{} \pr{\fce{\trans}{a} = s \given \evidence = e} \fce{U}{s}.
	\]
\end{defi}

Pro výpočet užitkové funkce musíme dát každému stavu číslo, které říká, jak moc se nám líbí.
To je ale těžké, lépe umíme dělat srovnání dvou stavů, než je dávat přímo na stupnici.

\begin{defi}[Teorie utilit]
	\emph{Teorie utilit} řeší, jak přeložit preference na číselné hodnoty utilit.
	Speciálně se snaží, aby bylo zachováno $ \left( \forall A,B \in \states \right)\!  $ \begin{enumerate}
		\item pokud jsme preferovali $ B $ před $ A $, pak $ \fce{U}{A} < \fce{U}{B} $,
		\item pokud jsme nepreferovali $ B $ ani $ A $, pak $ \fce{U}{A} = \fce{U}{B} $.
	\end{enumerate}
\end{defi}

\begin{defi}[Loterie]
	\emph{Loterie} je $ L = \left\{ \left( p_1, s_1 \right), \dots, \left( p_n, s_n \right) \right\} $,
	popisující pravděpodobnostní rozdělení výsledků nějaké akce, tž. \[
		\pr{s_i} = p_i.
	\]
\end{defi}

\begin{cor}[]
	Loterii už umíme přiřadit její utility: \[
		\E \fce{U}{\left\{ \left( p_1, s_1 \right), \dots \right\}} = \sum_{i} p_i \fce{U}{s_i}.
	\]
\end{cor}

\begin{algo}[Utility z preferencí]\ \\
\AlgIn preference, pravděpodobnostní rozložení výsledků akce.
\begin{algorithmic}[1]
	\State Vybereme $ s^+, s^- $, nejhorší a nejlepší výsledek. 
	\Indent Pro $ s \in \states $:
	\State Zvolíme $ p \randin \left( 0,1 \right) $.
	\Indent Dokud není člověk indiferentní mezi $ s $ a loterií $ \left\{ \left( s^+, p \right), \left( s^-, 1-p \right) \right\} $:
		\State Upravíme $ p $ aby lépe odpovídala preferencím.
	\EndIndent
	\State $ \fce \ut s \gets p $
	\EndIndent
\end{algorithmic}
\AlgOut normalizovaná utility splňující axiomy zmíněné výše.
\end{algo}

Nyní máme utility, chceme vybrat akci s největší utilitou. K tomu použijeme \emph{rozhodovací síť}:

\begin{defi}[Rozhodovací síť]
	\emph{Rozhodovací síť} je Bayesovská síť, jejíž vrcholy jsou několika druhů \begin{enumerate}
		\item \emph{náhodné}, skryté odpovídají nějaké proměnné jako v normální BS,
			\item \emph{akce} odpovídá akci zvolené agentem,
				\item \emph{utility} odpovídá pravděpodobnostnímu rozdělení hodnoty utility v závislosti na jiných vrcholech.
	\end{enumerate}
\end{defi}

\begin{algo}[Nalezení optimální akce]\ \\
\AlgIn Rozhodovací síť, stav, pozorování.
\begin{algorithmic}[1]
	\State Vyplníme pozorování.
	\Indent Pro $ a \in \actions $:
		\State Vyplníme $ a $ do rozhodovací sítě.
		\State Spočítáme odpovídající rozložení utilit.
		\State Spočítáme \emph{expected utility}.
	\EndIndent
	\State Zvolíme $ a $ s největší expected utility.
\end{algorithmic}
\AlgOut Optimální akce v daném stavu.
\end{algo}

K tvorbě rozhodovací sítě je potřeba expertní znalost.
Proces lze zachytit následovně:

\begin{algo}[Postavení rozhodovací sítě]\
	\begin{algorithmic}[1]
		\State (Bez expertů) vytvoříme kauzální model. \Comment Vybereme náhodné veličiny, spojíme je kauzálně.
		\State Zjednodušíme ho na kvalitativní kauzální model. \Comment Odstraníme nemožné kombinace, nepotřebné veličiny.
		\State Přiřadíme pravděpodobnostní rozdělení.
		\State Přiřadíme utilitu. \Comment Může záviset i na uživateli.
		\State Zkoušíme a iterujeme model dokud se nechová tak, jak bychom čekali.
		\State Provedeme sensitivity analysis -- zkontrolujeme, jestli je stabilní vůči malým změnám ve vstupech.
	\end{algorithmic}
\end{algo}

Tímto způsobem jsme schopni vyřešit problém, u kterého nás zajímá jen jedna akce.
Nyní budeme chtít vyřešit problémy, na které bude potřeba sekvence akcí.

\subsection{Sekvenční rozhodování}

\begin{defi}[Sekvenční problém]
	Sekvenční rozhodovací problém je problém, na jehož vyřešení je potřeba sekvence akcí.
\end{defi}

\begin{defi}[Markov decision process]
	MDP je sekvenční rozhodovací problém pro plně observovatelné, stochastické prostředí.
	Model obsahuje \begin{itemize}
		\item \emph{reward funkci} $ \rew: \states \to \R $,
		\item  \emph{Markovský přechodový model} $ \fce \trans{s,a} \deq \prfa{s' \in \states}{s' \given s,a} $,
			\item parametr \emph{discount factor} $ \discount $: míru toho, jak je budoucnost důležitá,
	\end{itemize}
\end{defi}

\begin{defi}[Utility MDP]
	Utility funkce pro posloupnost stavů $ \left< s_i \right>_i $ je \[
		\fce{\ut}{s_0, \dots} \deq \sum_{i}^{} \discount^i \fce{\rew}{s_i}.
	\]
\end{defi}

\begin{prop}[]
Díky $ \discount $ je utility omezená a konečná i pro nekonečnou posloupnost stavů.
\end{prop}

Řešením MDP je tzv. \emph{policy}:

\begin{defi}[Policy]
	\emph{Policy} je distribuční funkce \[
		\pi: S \to A,
	\]
	která udává, jakou akci bychom měli zvolit, pokud jsme ve stavu $ s $.
	Může být případně i náhodná, tj. distribuce přes všechny akce.
\end{defi}

\begin{defi}[Očekávaná utility policy] \label{utility policy}
Pro každou policy $ \pi $ můžeme definovat očekávanou utility, kterou získáme, pokud se držíme $ \pi $ jako \[
	\fce{U^\pi}{s} \deq \fce{\E}{\sum_{i}^{} \discount^i \fce{\rew}{s_i}},
\]
kde $ s_i $ je náhodná veličina, vyjadřující stav v čase $ i $.
\end{defi}

\begin{defi}[Optimální policy]
	\emph{Optimální policy} pro začínající stav $ s $ je \[
		\pi^*_s = \fce{\argmax_\pi}{\fce{\ut^\pi}{s}}.
	\]
\end{defi}

\begin{note}[]
Vzhledem k tomu, že proces je Markovský, tak jakmile se optimální policy pro různé stavy dostanou do stejného stavu, pak už se nikdy nebudou rozcházet.
\end{note}

\begin{defi}[Pravá utilita]
Přes optimální policy můžeme definovat pravou utilitu stavu jako \[
	\fce \ut s = \fce{\ut^{\pi^*}}{s}.
\]
\end{defi}

\begin{cor}[]
	\[
		\fce {\pi^*}{s} = \argmax_a \sum_s \pr{\fce \trans{s,a} = s'} \fce \ut{s'}.
	\]
\end{cor}

Vztah mezi utilitou stavu a jeho sousedů vyjadřuje následující rovnice:

\begin{thm}[Bellmanova rovnice]
	\[
		\fce{\ut}{s} = \fce{\rew}{s} + \gamma \fce{\max_{a \in A}}{ \sum_{s' \in S}^{} \pr{\fce \trans{s,a} = s'} \fce{\ut}{s'}}.
	\]
\end{thm}

Přes Bellmanovu rovnici můžeme iteračně aproximovat optimální utilitu:

\begin{algo}[Iterace hodnot]\ \\ \label{utility iteration}
	\AlgIn MDP, $ \varepsilon $.
	\begin{algorithmic}[1]
		\State $ i \gets 0 $
		\State $ U_0 \gets \left\{ 0 \right\}^{\absolute{S}}$
		\Indent Opakujeme:
		\State $ \fce{U_{i+1}}{s} = \fce{\rew}{s} + \gamma \fce{\max_{a \in \actions}}{ \sum_{s' \in S}^{} \pr{\fce \trans{s,a} = s'} \fce{U_i}{s'}}$
		\State $ i \gets i+1 $
		\State Pokud se od poslední iterace změnila hodnota všude nejvýše o $ \frac {1-\gamma}\gamma \varepsilon $, skončíme.
		\EndIndent
	\end{algorithmic}
	\AlgOut $ U_i $, aproximace pravé utility.
\end{algo}

\begin{prop}[]
	Optimální policy se ustálí ještě předtím, než se ustálí utilita.
\end{prop}

\begin{algo}[Iterace policy]\ \\
	\AlgIn MDP.
	\begin{algorithmic}[1]
		\State $ U \gets \left\{ 0 \right\}^{\absolute{A \times S}} $
		\State $ \pi \gets $ náhodná policy.
		\Indent Dokud se $ \pi $ mění:
		\State Spočítáme $ U^\pi $ pro aktuální $ \pi $. \Comment Dosazením do Bellmanovy rovnice, nebo přes iteraci hodnot.
		\Indent Pro $ s \in \states $:
		\Indent Pokud $ \fce{\max_{a \in \actions}}{\sum_{s'}^{} \pr{\fce \trans{s,a} = s'} \fce{\ut}{s'}} > \fce{\ut^\pi}{s}$:
		\State $ \fce{\pi}{s} \gets \fce{\argmax_{a \in \actions}}{\sum_{s'}^{} \pr{\fce \trans{s,a} = s'} \fce{\ut}{s'}} $
		\EndIndent
		\EndIndent
		\EndIndent
	\end{algorithmic}
	\AlgOut Policy $ \pi $.
\end{algo}

Nyní, nechť navíc environment je pouze částečně pozorovatelný.

\begin{defi}[Partially observable MDP]
	POMDP je MDP, kde navíc máme pozorování $ \evidence $ a pozorovací model \[
		\fce \sens{e} \deq \prfa{s \in \states}{s \given e}.
	\]
\end{defi}

\begin{defi}[Domnělý stav]
	\emph{Domnělý stav} je pravděpodobnostní rozdělení, které každému stavu v daný moment říká pravděpodobnost, že v něm jsme.
\end{defi}

\begin{note}[]
	Domnělé stavy lze reprezentovat i pomocí logiky, ale ztratíme informaci o pravděpodobnostním rozdělení -- jen binárně možný/nemožný.
\end{note}

\begin{thm}[POMDP přes DS]
	POMDP lze řešit jako MDP, kde místo se stavy pracujeme s domnělými stavy.
	Jen musíme upravit techniky tak, aby počítaly s nekonečně velkým stavovým prostorem.
\end{thm}

Jiný způsob řešení je pomocí \emph{dynamické rozhodovací sítě}.

\begin{defi}[Dynamická rozhodovací síť]
	\emph{Dynamická rozhodovací síť} je RS, která má jako základ \emph{dynamickou Bayesovskou síť}.
\end{defi}

\begin{algo}[POMDP přes DRS]\ \\
\AlgIn POMDP, odpovídající RS.
\begin{algorithmic}[1]
	\State Rozvineme síť směrem do budoucnosti.
	\State Aplikujeme \emph{ExpectedMiniMax}: jeden hráč je agent, druhý \textquote{hráč} je prostředí.
\end{algorithmic}
\AlgOut optimální policy.
\end{algo}

\begin{prop}[]
	Budoucnost nemusíme rozvíjet do nekonečna díky \emph{discount factoru}.
\end{prop}

\section{Hry s více agenty}

Nyní se zaměříme na hry, kde hraje více agentů najednou.
Hra pro nás zatím bude mít následující vlastnosti:

\begin{defi}[Hra]
	\emph{Hra} pro nás bude \begin{itemize}
		\item \emph{turn-taking}, tedy hraje se po oddělených kolech,
		\item pro \emph{dva hráče},
		\item \emph{zero-sum}, tedy vyhraje jen jeden, druhý prohraje,
		\item s \emph{perfektní informací}.
	\end{itemize}
	Samotný průběh hry pak lze reprezentovat jako průchod stavovým stromem.
\end{defi}

\begin{defi}[Řešení hry]
	Řešením hry je \emph{strategie}, tedy \begin{itemize}
		\item první tah,
		\item následující tah pro každou možnou odpověď soupeře.
	\end{itemize}
\end{defi}

\begin{defi}[Optimální strategie]
	\emph{Optimální strategie} vede k maximálnímu výsledku.
\end{defi}

\begin{defi}[Strom hry]
	\emph{Strom hry} je strom, jehož vrcholy reprezentují stavy.
	Kořen je počáteční stav, a každý vrchol má jakožto syny všechny stavy, do kterých se z něj lze dostat.
\end{defi}

\subsection{Deterministické hry}

\begin{algo}[MiniMax]\ \\
	\AlgIn hra.
	\begin{algorithmic}[1]
		\State Vytvoříme strom hry.
		\State Spodním vrcholům přiřadíme utility.
		\State Od spoda vyplňujeme strom -- ve vrcholu je optimální rozhodnutí pro hráče na tahu.
	\end{algorithmic}
	\AlgOut strategie.
\end{algo}

\begin{thm}[$ \alpha $-$ \beta $ ořezávání]
	Nechť hrjí dva hráči, jeden maximalizuje, druhý minimalizuje.
	Nechť $ \alpha $ je maximum, které zatím známe pro $ \max $, $ \beta $ je minimum, které zatím známe pro $ \min $.
	Potom při hledání nového maxima nemusíme dál prohledávat větve, které na zlepšení $ \alpha $ nepovedou.
	Symetricky pro $ \beta $.
\end{thm}

\begin{cor}[]
	Pořadí prohledávání vrcholů určuje efektivitu ořezávání.
\end{cor}

\begin{cor}[]
	$ \alpha $-$ \beta $ si může dovolit prohledat strom přibližně $ 2\times $ hlubší než klasický MiniMax.
\end{cor}

\begin{defi}[Cut-off search]
	Cut-off search uřízne strom v dané hloubce a posledním stavům nastaví hodnoty pomocí \emph{evaluační funkce}.
\end{defi}

\begin{defi}[Evaluační funkce]
	\emph{Evaluační funkce} vrací odhad hodnoty vrcholu.
	Dosahuje toho přes problem-specific vlastnosti stavu.
\end{defi}

\begin{note}[]
	Více evaluačních funkcí může být kombinováno do jedné pro dosažení lepších výsledků.
\end{note}

\subsection{Stochastické hry}

\begin{defi}[Stochastická hra]
	\emph{Stochastická hra} je hra, při které jsou výsledky akcí náhodné.
\end{defi}

\begin{defi}[Strom stochastické hry]
	\emph{Strom SH} je rozšířený strom hry, který má navíc \emph{pravděpodobnostní} vrcholy, obsahující pravděpodobnostní rozdělení dalšího vývoje hry.
\end{defi}

\begin{algo}[ExpectedMiniMax]\ \\
	\emph{ExpectedMiniMax} je algoritmus, který \begin{itemize}
		\item pro klasické vrcholy pracuje jako MiniMax,
			\item pro pravděpodobnostní vrcholy spočítá hodnoty následníků $ \left< v_i \right>_i $, a následně spočítá očekávanou hodnotu vrcholu jako \[
					\sum_i v_i \pr{s = i}.
			\]
	\end{itemize}
	
\end{algo}

\begin{cor}[]
V deterministických hrách nás zajímalo jen uspořádání stavů, ale ve stochastických je důležité nastavit přesně hodnoty, protože se z nich dělá lineární kombinace (v pravděpodobnostních vrcholech).
\end{cor}

\subsection{Single-move hry}

\begin{defi}[Single-move hra]
	Opět máme determinismus, hráči tentokrát hrají najednou. Mají \begin{itemize}
		\item množinu \emph{akcí},
		\item \emph{payoff} funkci, která udává zisk hráče při daném výsledku.
	\end{itemize}
\end{defi}

\begin{defi}[Řešení single-move her]
	Opět hledáme \emph{strategii}, tentokrát je to prostě jakou akci máme zvolit.
	Může být \begin{itemize}
		\item \emph{čistá} -- deterministická, vždy volíme stejně,
		\item \emph{mixed} -- volíme náhodně podle pravděpodobnostního rozdělení.
	\end{itemize}
	Řešením hry je pak přiřazením \emph{racionální strategie} hráči.
\end{defi}

\begin{defi}[Nashovo ekvilibrium]
	Strategie jsou v \emph{Nashově ekvilibriu}, pokud žádný hráč nebenifituje ze změny strategie.
\end{defi}

\begin{defi}[Pareto]
	Výsledek hry je 
	\begin{itemize}
		\item \emph{Pareto dominated} jiným výsledkem $ x $ $ \equiv $ všichni hráči by preferovali $ x $ vůči stávajícímu výsledku.
		\item \emph{Pareto optimální} $ \equiv $ není jiný výsledek, který by všichni hráči preferovali.
	\end{itemize}
\end{defi}

\begin{algo}[MaxiMin technika]\ 
\begin{algorithmic}[1]
	\State Spustíme dvakrát MiniMax, jednou hraje první jeden hráč, jednou druhý.
\end{algorithmic}
\AlgOut horní a dolní odhad na výsledek.
\end{algo}

\begin{algo}[MaxiMin pro mixed]\ 
\begin{algorithmic}[1]
	\Indent Spustíme MaxiMin:
		\State První hráč má mixed strategii.
		\State Druhý hráč pak má optimální pure strategii podle strategie prvního hráče.
	\EndIndent
	\State První hráč tedy nastaví strategii tak, aby maximalizoval svůj očekávaný zisk, ať druhý hráč dělá cokoliv.
\end{algorithmic}
\end{algo}

\subsection{Multi-move hry}

\begin{defi}[Opakovaná hra]
	\emph{Opakovaná hra} je jednoduchá multi-move hra, kdy se opakuje stále jedna situace.
\end{defi}

\begin{note}[]
	Pro \emph{Prisoner's dilema} s fixním počtem kol je dominantní strategie stále \emph{defect}.
	Přestane to být optimum pokud je počet kol neznámý, nebo nekonečný.
\end{note}

\subsection{Mechanism design}

\begin{defi}[Inversní teorie her]
	\emph{Inversní teorie her} se zabývá tvorbou pravidel, kde cíl je maximalizovat kolektivní zisk všech hráčů.
\end{defi}

\begin{defi}[Aukce]
	\emph{Aukce} je systém prodeje produktů hráčům. Je dána \begin{itemize}
		\item množinou dražitelů (bidders) $ B = \left\{ 1, \dots, n \right\} $,
		\item vektorem \emph{soukromých hodnot pro dražitele} $ v \in \R^n $.
	\end{itemize}
\end{defi}

\begin{defi}[Nabídka]
	Nabídka je vektor $ b $, kde $ b_i $ je nabízená cena hráče $ i $.
\end{defi}

\begin{defi}[Payoff mechanismus]
	Hráč s nejvyšší nabídkou $ b_{\max} $ dostane předmět.
	\emph{Payoff mechanismus} určuje, kolik za něj zaplatí.
\end{defi}

\begin{cor}[]
	Dobrý mechanismus má následující vlastnosti:
	\begin{itemize}
		\item Maximalizuje předpokládaný zisk prodávajícího.
			\item Existuje dominantní strategie dražitelů.
			\item Vítěz $ i $ nezaplatí více než $ v_i $.
	\end{itemize}
	
\end{cor}

\begin{examp}[Ascending-bid, English]
	Začne se s cenou $ b_{\min} $, dokud jsou zájemci, pokračuje se přidáváním $ d $ k ceně.
\end{examp}

Dominantní strategie je pokračovat, pokud je $ b < v_i $.
Pokud je známo, že se o předmět uchází někdo bohatý, může to odradit ostatní.
Hráči musí být přítomni \textquote{online}.


\begin{examp}[Descending-bid, Dutch]
	Začíná se s nejvyšší cenou, jde se dolů, dokud se nikdo nehlásí.
\end{examp}

Je fajn, protože je rychlá.
Využívá se např. při prodávání věcí, které se kazí.

\begin{examp}[Sealed-bid]
	Každý hráč udá jednu nabídku, vyhrává hráč, který nabídl $ b_{\max} $ a platí co nabídl.
\end{examp}

Zde není dominantní strategie. 
Nejlepší je nabídnout $ b_{\max} + \varepsilon $, pokud je to menší než $ v_i $.
To vyžaduje odhad $ b_{\max} $.

\begin{examp}[Sealed-bid second-price, Vickerley]
	Každý hráč udá jednu nabídku, vyhrává hráč, který nabídl $ b_{\max} $ a platí co nabídl ten, kdo byl druhý.
\end{examp}

Zde je dominantní strategie nabídnout $ v_i $.

\begin{defi}[Tragedy of the commons]
	Pokud nikdo nemusí platit za použití komodity, bude zneužita, a nakonec se dojde k menšímu užitku pro všechny agenty.
\end{defi}

Pro odstranění tohoto problému potřebujeme způsob, jak rozdělit konečné zdroje mezi hráče.

\begin{defi}[Vickerley-Clarks-Groves]
	Rozdělujeme $ n $ věcí mezi $ m > n $ hráčů.
	Chceme rozdělit těm, kdo to chtějí nejvíc.
	\begin{algorithmic}[1]
		\State Odebereme od všech agentů jejich nabídku $ b_i $.
		\State $ A \gets $ prvních $ n $ největších.
		\State Každý hráč z $ A $ zaplatí $ \max_{i \in \range n \setminus A} b_i $.
	\end{algorithmic}
\end{defi}

Dominantní strategie je opět nabídnout $ v_i $.

\section{Učení -- supervised}

Při učení získává agent zkušenosti, které jsme mu explicitně nenaprogramovali.
To se hodí, např. pokud \begin{itemize}
	\item nemůžeme předpokládat všechny možné situace,
	\item je těžké popsat, co má kdy agent dělat,
	\item je nemožné situace/řešení popsat.
\end{itemize}

\begin{defi}[Druhy učení]
	Učení agenta je děleno na \begin{enumerate}
		\item \emph{unsupervised} $ \equiv $ učí se rozpoznávat vzory bez explicitní zpětné vazby,
		\item \emph{reinforcement} $ \equiv $ učení probíhá pomocí odměn a trestů,
		\item \emph{supervised} $ \equiv $ agent udělá odhad, a ví, jestli odhadl správně nebo ne.
	\end{enumerate}
\end{defi}

\begin{defi}[Trénovací data]
	Trénovací data jsou množinou $ \trd = \left\{ \left< x_i, y_i \right> \right\}_i $, kde $ \ins = \left\{ x_i \right\}_i $ jsou vstupy, a $ \outs = \left\{ y_i \right\}_i $ jejich odpovídající výstupy, které chceme, aby se agent naučil.
\end{defi}

\begin{defi}[Hypotéza]
	Hypotéza je libovolná funkce $ h $.
\end{defi}

\begin{defi}[Prostor hypotéz]
	\emph{Prostor hypotéz} je množina hypotéz značena $ \hsp $.
\end{defi}

\begin{defi}[Konsistence]
	Hypotéza $ h $ je \emph{konsistentní} s trénovacím vzorkem $ \left< x,y \right> $ $ \equiv $ \[
		\fce hx = y.
	\]
\end{defi}

\begin{prop}[Ochkamova břitva]
	Pokud existuje více konsistentních hypotéz $ h_1, \dots, h_n $, zvolíme tu, která je nejjednodušší.
\end{prop}

\begin{defi}[Třídy problémů]
	Supervised learning se používá na řešení problémů: \begin{itemize}
		\item \emph{klasifikace} $ \equiv $ $ x_i $ je vstup, $ y_i $ je odpovídající skupina,
		\item \emph{regrese} $ \equiv $ $ x_i $ je vstup, $ y_i $ je jemu přiřazená hodnota.
	\end{itemize}
\end{defi}

\subsection{Rozhodovací stromy}

Jedním z nejjednodušších způsobů klasifikace je technika tzv. \emph{rozhodovacích stromů}.

\begin{defi}[Rozhodovací strom]
	\emph{Rozhodovací strom} je struktura pro klasifikaci $ T: \ins \to \left\{ 0,1 \right\} $.
	$ \ins $ obsahuje $ n $-tice, kde každá pozice má význam \emph{atributu} z množiny atributů $ \attr $.
\end{defi}

\begin{defi}[Entropie]
	Nechť $ X $ je náhodná veličina.
	\emph{Entropie} je hodnota neurčitosti informace, definovaná jako \[
		\fce \entr X \deq -\sum_{x \in \R} \pr{X = x} \log_2 \pr{X = x}.
	\]
\end{defi}

\begin{defi}[Rozdělení dat]
	Nechť $ \ins $ jsou vstupy.
	Nechť $ a \in \attr $ je atribut.
	Rozdělení podle $ a $ s hodnotou $ k $ je \[
		\rozdel \ins ak \deq \left\{ x \in \ins \suchthat x_a = k \right\}.
	\]
\end{defi}

\begin{defi}[Zbytek entropie]
	Nechť $ \fce Y{\trd} $ je náhodná veličina vyjadřující hodnotu výstupu u náhodně vybraného prvku z $ \trd $.
	\emph{Zbytek entropie po rozdělení podle $ a $} je hodnota udávající entropii trénovacích dat poté, co je rozdělíme do skupin podle atributu $ a $: \[
		\rest \trd a \deq \sum_k \fce \entr {\fce Y{\rozdel \trd ak} } \frac {\absolute {\rozdel \trd ak}}{\absolute \trd}.
	\]
\end{defi}

\begin{defi}[Zisk informace]
	Nechť $ \fce Y{\trd} $ je náhodná veličina vyjadřující hodnotu výstupu u náhodně vybraného prvku z $ \trd $.
	Zisk informace pro atribut $ a $ je definován jako \[
		\igain \trd a \deq \fce \entr{\fce Y{\trd}} - \rest\trd a.
	\]
\end{defi}

\begin{defi}[Nejdůležitější atribut]
	Atribut $ a $ je \emph{nejdůležitější} $ \equiv $ po rozdělení hodnot trénovacích dat podle $ a $ se maximalizuje $ \igain \trd a $.
\end{defi}

\begin{algo}[Učení RS -- Divide \& Conquer]\ \\
	\AlgIn trénovací data $ \trd $, mající atributy $ A $.
	\begin{algorithmic}[1]
		\State Pokud jsou všechna data z $ \trd $ v jedné skupině, jsme hotovi.
		\State Pokud $ A = \emptyset $, vrátíme \emph{neseparovatelné}.
		\State $ a \gets $ nejdůležitější atribut z $ A $.
		\State Rozdělíme $ \trd $ na $ \rozdel \trd a{k_1} \dots $.
		\State Jinak budujeme strom rekurzivně.
	\end{algorithmic}
	\AlgOut strom $ T $, který je konsistentní s $ \trd $, a co nejmenší.
\end{algo}

\begin{examp}[Logická reprezentace stromu]
	Při reprezentaci RS v logice \begin{itemize}
		\item \emph{atributy} jsou binární predikáty $ P_1, \dots, P_n $,
		\item \emph{klasifikace} je vyjádřena unárním \emph{cílovým} predikátem $ G $,
		\item \emph{hypotézy} jsou výroky ve tvaru $ \left( \forall x \right)\! \left( \fce Gx \leftrightarrow \fce {\varphi}x \right) $, kde $ \varphi $ je formule složená z $ P_i $.
	\end{itemize}
\end{examp}

\begin{note}
	Učící algoritmus předpokládá, že existuje konsistentní hypotéza.
\end{note}

\begin{defi}[Nekonsistence]
	Hypotéza může být nekonsistentní typu \begin{itemize}
		\item \emph{false positive} $ \equiv $ vrátí \emph{ano}, když měla vrátit \emph{ne},
		\item \emph{false negative} $ \equiv $ vrátí \emph{ne}, když měla vrátit \emph{ano}.
	\end{itemize}
\end{defi}

\begin{defi}[Generalizace hypotézy]
	\emph{Generalizace} je proces, kdy se z $ \varphi $ odstraňují klauzule, nebo přidávají literály do existujících klauzulí.
\end{defi}

\begin{cor}[]
	Generalizovaná hypotéza odpoví \emph{ano} pro více vstupů.
\end{cor}

\begin{defi}[Specializace hypotézy]
	\emph{Specializace} je proces, kdy se k $ \varphi $ přidávají nové klauzule, nebo odstraňují literály z existujících klauzulí.
\end{defi}

\begin{cor}[]
	Specializovaná hypotéza odpoví \emph{ne} pro více vstupů.
\end{cor}

Jeden z přístupů k budování stromu je metodou \emph{Current-best-hypothesis search} -- začneme se špatnou hypotézou a vylepšujeme ji.

\begin{algo}[Current-best-hypothesis search]\ \\
	\AlgIn prvotní hypotéza $ h $, trénovací data $ \trd $, mající atributy $ \attr $.
	\begin{algorithmic}[1]
		\State $ x,y \gets $ první dvojice v $ \trd $.
		\State Pokud $ \fce hx = y $, vrátíme $ \algorithm{Current-best-hypothesis search}{h, \trd \setminus \left\{ \left< x,y \right> \right\}} $.
		\Indent Pokud false positive:
		\Indent Pro $ h' $ \emph{specializace} $ h $ konsistentní s předchozími trénovacími daty:
		\State $ h'' \gets \algorithm{Current-best-hypothesis search}{h', \trd \setminus \left\{ \left< x,y \right> \right\}} $
		\State Pokud $ h'' $ není neúspěch, vrátíme $ h'' $.
		\EndIndent
		\EndIndent
		\Indent Pokud false negative:
		\Indent Pro $ h' $ \emph{generalizace} $ h $ konsistentní s předchozími trénovacími daty:
		\State $ h'' \gets \algorithm{Current-best-hypothesis search}{h', \trd \setminus \left\{ \left< x,y \right> \right\}} $
		\State Pokud $ h'' $ není neúspěch, vrátíme $ h'' $.
		\EndIndent
		\EndIndent
		\State Vrátíme \emph{neúspěch}.
	\end{algorithmic}
	\AlgOut hypotéza $ h $, která je konsistentní s $ \trd $, a co nejmenší.
\end{algo}

Jiným přístupem je mít všechny konsistentní hypotézy.

\begin{algo}[Version-space learning]\ \\
	\AlgIn trénovací data $ D $, mající atributy $ A $.
	\begin{algorithmic}[1]
		\State $ V \gets $ prostor všech hypotéz.
		\Indent Pro $ \left< x,y \right> \in D $:
		\State $ V \gets \left\{ h \in V \suchthat \fce hx = y \right\} $
		\EndIndent
	\end{algorithmic}
	\AlgOut hypotéza $ h $, která je konsistentní s $ D $, a co nejmenší.
\end{algo}

\begin{cor}[Reprezentace prostoru hypotéz]
	Místo všech hypotéz, kterých je moc, budeme mít jen reprezentaci celého prostoru.
	Prostor budeme reprezentovat pomocí hraničních hypotéz -- udržujeme si co nejvíc generalizované a co nejvíc specializované konsistentní hypotézy.
	Takovou reprezentaci jsme schopni si dynamicky uržovat.
\end{cor}

\subsection{Lineární regrese, klasifikace}

\begin{defi}[Lineární model]
	Lineární aproximační model je model pro regresi pomocí lineárních funkcí.
	Prostor hypotéz je tedy $ \hsp = \left\{ h \suchthat \fce {h_w}x = w_1x + w_0 \right\} $\footnote{Lze definovat i pro více dimenzí.}.
\end{defi}

Hledáme funkci, která minimalizuje chybu.

\begin{defi}[Chyba]
	Chyba je libovolná funkce, která měří, jak daleko je funkce $ h $ od trénovací dat.
	Typicky se používá \emph{square loss}: \[
		\sql h \deq \sum_{x,y \in \trd} \left( y -  \fce h{x} \right)^2.
	\]
\end{defi}

\begin{algo}[Lineární regrese -- analyticky]
	Mějme trénovací data.
	Lineární regrese se snaží najít optimální $ h $, resp. optimální váhy $ w^* $ jako \[
		\opt w \deq \argmin_w \fce L{h_w}.
	\]
	Tuto funkci lze analyticky vyřešit jako $ \frac{\partial L}{\partial w_0} $ a $ \frac{\partial L}{\partial w_1} $.
\end{algo}

Ovšem derivace nemusí být snadno vyčíslitelná.
Pak lze použít následující metodu.

\begin{algo}[Gradient descent]
	Při \emph{gradient descent} metodě začínáme v nějakém bodě v prostoru hypotéz, a inkrementujeme ji pomocí \[
		w_i \gets w_i - \alpha \frac{\partial \fce L{h_w}}{\partial w_i}.
	\]
\end{algo}

\begin{defi}[Learning rate]
	\emph{Learning rate} je člen $ \alpha $, určující rychlost učení. 
	Může být konstantní, nebo se postupně zmenšovat podle toho jak se přibližujeme k optimu.
\end{defi}

\begin{defi}[Lineární klasifikace]
	Problém lineární klasifikace rozděluje body v prostoru do dvou skupin.
\end{defi}

\begin{defi}[Lineární klasifikátor]
	\emph{Lineární klasifikátor} je $ h $, tž. $ \fce hx = 1 $, právě když je $ x $ v jedné skupině, $ 0 $ jinak.
\end{defi}

\begin{defi}[Treshold funkce]
	Námi definovaná $ h: x \mapsto w_1x + w_0 $ nemusí vracet přesně $ 0 $ a $ 1 $, pomůžeme si proto tzv. treshold funkcí: \[
		\fce {T}y \deq \begin{cases}
			1 & y \geq 0,  \\
			0 & \text{jinak,}
		\end{cases}
	\]
	a předefinujeme $ h $ jako $ h: x \mapsto \fce T{w_1x+w_0} $.
\end{defi}

\begin{defi}[Perceptron]
	Perceptron je pravidlo na aktualizaci vah tak, aby funkce konvergovala ke klasifikátoru.
	Pravidlo říká: \[
		w_i \gets w_i - \alpha \left( y- \fce {h_w}x \right) x_i.
	\]
\end{defi}

\begin{cor}[]
	Pokud jsou skupiny lineárně neseparovatelné, perceptron nekonverguje. Můžeme místo toho $ \alpha $ zmenšovat podle $ \fce \O {\frac 1t} $.
\end{cor}

\begin{defi}[Druhy tresholdu]
	Treshold funkce může být \begin{itemize}
		\item binární $ \equiv $ vrací skutečně $ 0,1 $ podle toho, co je nejpravděpodobnější,
			\item logistická $ \equiv $ vrací číslo mezi $ 0,1 $ určující pravděpodobnostní rozložení, že $ x $ patří do dané skupiny: \[
		\fce Tz \deq \frac 1{1+e^{-z}}.
	\]
	\end{itemize}
\end{defi}

\begin{note}[]
	Pro takto definovanou logistickou $ T $ existuje derivace, tedy existuje derivace celé loss funkce. Můžeme tedy zadefinovat \emph{sigmoid perceptron} pravidlo pomocí GD: \[
		w_i \gets w_i - \alpha \frac{\partial \fce L{h_w}}{\partial w_i} = w_i + 2\alpha \left( y- \fce {h_w}x \right) \fce {h_w}x \left( 1 - \fce {h_w}x \right) x_i.
	\]
\end{note}

\subsection{Neuronové sítě}

\begin{defi}[Neuronová síť]
	(Feed-forward) neuronová síť $ N = \left< G,g,w \right> $, kde
	\begin{enumerate}
		\item $ G $ je DAG,
			\item $ w $ jsou váhy $ \fce EG $,
				\item $ g $ je \emph{aktivační funkce}, neboli treshold funkce -- buď binární, nebo logistická.
	\end{enumerate}
	Na zdrojových vrcholech $ v $ se nastaví hodnota na vstup: $ \fce Nv \gets \ins_v $. 
	Počítá se iterativně, v každém vrcholu $ v $ se hodnota $ \fce Nv $ nakonec dopočítá následovně: \[
		\fce Nv \gets \fce g{\fce nv}, \qquad \fce nv \deq \sum_{u \in \fce {\delta^{+}} v} w_{uv} \fce Nu.
	\]
	Výstup celé neuronové sítě pro nějaké $ x $ budeme také značit $ \fce Nx $, a bude to vektor hodnot $ \fce Ns $ pro $ s $ stok.
\end{defi}

\begin{defi}[Rekurentní NN]
	Rekurentní NN je NN, která povoluje cykly.
	Reprezentuje dynamický systém, který může konvergovat, nebo oscilovat.
	Pomocí cyklů simuluje krátkodobou paměť.
\end{defi}

\begin{algo}[BackPropagation]\ \\
	\AlgIn $ N = \left< G,g,w \right> $ neuronová síť, ze začátku náhodné váhy; trénovací data $ \trd $.
	\begin{algorithmic}[1]
		\Indent Pro $ \left< x,y \right> \in \trd $:
		\State $ o \gets \fce Nx $.
		\Indent Pro $ v \in V $ na poslední vrstvě:
		\State $ \Delta_v \gets \fce {g'}{\fce nv} \left( y_v - o_v \right) $
		\EndIndent
		\Indent Pro $ v \in V $ na prostředních vrstvách, odzadu:
		\State $ \Delta_v \gets \fce {g'}{\fce nv} \sum_{u \in \fce {\delta^-}v} w_{vu} \Delta_u $.
		\EndIndent
		\Indent Pro $ uv \in E $:
		\State $ w_{uv} \gets {w_{uv}} + \alpha \fce Nu \Delta_v $.
		\EndIndent

		\EndIndent
	\end{algorithmic}
	\AlgOut přeučená NN. Opakujeme, dokud nekonvergujeme.
\end{algo}

\subsection{Neparametrické modely}

\begin{defi}[Modely podle parametrizace]
	Modely lze rozdělit na \begin{itemize}
		\item \emph{parametrické} $ \equiv $ hypotéza je reprezentována parametry (váhy),
		\item \emph{neparametrické} $ \equiv  $ hypotéza je reprezentována samotnými trénovacími daty.
	\end{itemize}
\end{defi}

\begin{defi}[$ k $-nearest klasifikace]
	Při klasifikaci dalšího prvku se podíváme na $ k $ jeho nejbližších sousedů z $ D $, a zařadíme ho tak, aby seděl s nadpoloviční většinou.
\end{defi}

\begin{defi}[$ k $-nearest regrese]
	Regresi můžeme provést následujícími způsoby: \begin{itemize}
		\item spojení bodů,
		\item zprůměrování $ k $ nejbližších.
	\end{itemize}
\end{defi}

\begin{defi}[Minkowského vzdálenost]
	Při porovnávání se hodí \emph{Minkowského vzdálenost} definovaná jako \[
		\fce {L^p}{x_j, x_q} \deq \left( \sum_i \absolute{x_{ji} - x_{qi}}^p \right)^{\frac 1p}.
	\]
	Pro $ x \in \left\{ 0,1 \right\}^n $ je toto tzv. \emph{Hammingova vzdálenost}.
\end{defi}

\begin{note}[]
	Důležitá věc je pohlídat si jednotky.
	Většinou je potřeba normalizace -- aby měly všechny směry stejnou std. deviaci.
\end{note}

\begin{defi}[Support-Vector Machine]
	SVM je neparametrický model pro lineární separaci.
	Konstruuje \emph{separátor s maximální margin}, tedy fasetu, která maximalizuje vzdálenost od všech bodů každým směrem.
	Místo parametrů si pamatuje tzv. \emph{support vektory}, což jsou body z trénovacích dat, které jsou nejblíž k separátoru.
\end{defi}

\begin{note}[]
	Pokud jsou data lineárně neseparovatelná, často pomůže mapování do prostoru větší dimenze pomocí \emph{kernel funkce}.
\end{note}

\subsection{Bayesovské učení}

\begin{defi}[Bayesovské učení]
	Mějme množinu hypotéz $ \hsp $.
	V Bayesovském učení se díváme na $ \hsp $ jako na náhodnou proměnnou, zjišťujeme její distribuci v závislosti na naměřených datech (opět náhodné proměnné).
	Pak počítáme \[
		\prfa{h,d}{\hsp = h \given \trd = d} = \alpha \prfa{d,h}{\trd = d \mid \hsp = h} \prfa{h}{\hsp = h},
	\]
	kde $ \alpha $ je \emph{normalizační faktor}.
\end{defi}

\begin{cor}[Inference]
	Nechť $ \query $ je n.v. závisející na $ \hsp $. Její pravděpodobnost spočítáme jako \[
		\prfa x{\query = x \mid \trd = d} = \sum_h \prfa x{\query = x \given \trd = d, \hsp = h} \pr{\hsp = h \given \trd = d}.
	\]
\end{cor}

\subsection{Učení Bayesovských sítí}

Nyní rozebereme, jak naučit Bayesovskou síť -- tj. jak vyplnit distribuce pomocí trénovacích dat.
Nejprve bez skrytých proměnných.

\begin{algo}[Maximum-likelihood parameter learning]\ \\
	\AlgIn Bayesovská síť s danou strukturou, všemi proměnnými pozorovatelnými, ale s neznámými distribucemi; naměřená data $ \trd $.
	\begin{algorithmic}[1]
		\State Rozepíšeme rovnici pro $ \log \prfa{h}{\trd = d \given \hsp = h} $. \Comment Využijeme nezávislosti $ \trd $.
		\State Derivujeme podle jednotlivých neznámých.
		\State Najdeme hodnoty neznámých, kdy je derivace nulová.
	\end{algorithmic}
	\AlgOut Bayesovská síť s distribucemi, které jsou nejpravděpodobnější, v závislosti na naměřených datech.
\end{algo}

Pokud máme skryté proměnné, musíme použít pokročilejší techniky:

\begin{algo}[Expectation-Maximization]\ \\
	\AlgIn Bayesovská síť se skrytými proměnnými a neznámými distribucemi, naměřená data $ \trd $.
	\begin{algorithmic}[1]
		\State Vyplníme Bayesovskou síť s náhodnými pravděpodobnostmi.
		\Indent Opakujeme, dokud nekonverguje:
		\State Inferencí zjistíme střední hodnoty skrytých proměnných. \Comment E-step: expectation.
		\State Aktualizujeme hodnoty parametrů jako v Maximum-likelihood learninu. \Comment M-step: maximization.
		\EndIndent
	\end{algorithmic}
	\AlgOut Bayesovská síť s distribucemi, které jsou nejpravděpodobnější, v závislosti na naměřených datech.
\end{algo}

\begin{note}[]
	Každá Bayesovská síť jde převést na síť bez skrytých proměnných, ale počet spojů mezi vrcholy roste exponenciálně.
\end{note}

\section{Učení - reinforcement}

\begin{defi}[Reinforcement learning]
	Předpokládejme plně pozorovatelné prostředí.
	Mějme agenta v prostředí, který dělá \emph{akce} podle \emph{policy}.
	V každém stavu dostane \emph{reward} $ \fce \rew s $.
	Reinforcement learning je \begin{itemize}
		\item \emph{pasivní} $ \equiv $ cíl je zjistit užitečnost současné policy,
		\item \emph{aktivní} $ \equiv $ cíl je najít optimální policy.
	\end{itemize}
	Užitečnost je měřena pomocí \emph{utility funkce} (\ref{utility policy}).
\end{defi}

\subsection{Pasivní učení}

\begin{algo}[Direct Utility Estimation]\ \\
	\AlgIn agent.
	\begin{algorithmic}[1]
		\State V každém stavu držíme seznam, zatím prázdný.
		\State Projdeme ze startovního stavu do konce.
		\Indent Pro každý navštívený stav:
		\State Spočítáme, jaký reward jsme získali při průchodu z toho stavu až do konce.
		\State Uložíme tuto hodnotu do seznamu pro daný stav.
		\EndIndent
		\State Iterujeme.
		\State Spočítáme $ \fce {U^\pi}s \gets \frac 1n \sum_{i=1}^n r_{s,i} $.
	\end{algorithmic}
	\AlgOut odhad na $ U^\pi $.
\end{algo}

Toto konverguje hrozně pomalu, protože nepoužíváme vůbec vlastnost utility -- splňuje Bellmanovu rovnici.

\begin{algo}[Adaptive Dynamic Programming]\ \\
	\AlgIn agent.
	\begin{algorithmic}[1]
		\State Iterujeme průchod s $ \pi $.
		\State Odvodíme přechodový model pomocí frekvenčních zastoupení přechodů z jednotlivých stavů.
		\State Použijeme odvozený přechodový model pro zjištění utility z Bellmanovy rovnice.
	\end{algorithmic}
	\AlgOut odhad na $ U^\pi $.
\end{algo}

\begin{note}[]
	ADP konverguje nejrychleji v počtu iterací (díky využití Bellmanových rovnic).
	Na druhou stranu ale každá iterace trvá dlouho.
\end{note}

\begin{algo}[Temporal-Difference Learning]\ \\
	\AlgIn agent, learning rate $ \alpha $.
	\begin{algorithmic}[1]
		\Indent Pro $ s,s' $ dvojici po sobě jdoucích stavů při průchodu s $ \pi $:
		\State $ \fce {U^\pi}s \gets \fce {U^\pi}s + \alpha \left( \fce \rew s + \gamma \fce {U^\pi}{s'} - \fce {U^\pi}s \right) $ \Comment $ \alpha $ může záviset na četnosti navštívení stavu.
		\EndIndent
	\end{algorithmic}
	\AlgOut odhad na $ U^\pi $.
\end{algo}

\begin{cor}[]
	TD je \emph{model-free} metoda -- není třeba se učit transition model.
\end{cor}

\subsection{Aktivní učení}

\begin{algo}[Greedy aktivní adaptabilní agent]\ \\
	\AlgIn prostředí.
	\begin{algorithmic}[1]
		\State $ \pi \gets $ náhodná policy.
		\Indent Opakujeme:
		\State Agent projde k cíli.
		\State Vyřešíme soustavu rovnic \Comment Value/Utility Iteration (\ref{utility iteration})\[
			\fce {U^\pi}s = \fce \rew s + \gamma \max_{a \in A} \sum_{s' \in S} \pr{s' \given s, a} \fce {U^\pi}{s'}.
		\] 
		\State $ \pi \gets $ policy vybírající akci, která maximalizuje utilitu.
		\EndIndent
	\end{algorithmic}
	\AlgOut policy $ \pi $.
\end{algo}

\begin{cor}[]
Greedy přístup nekonverguje k optimu -- neprozkoumáváme lepší cesty.
\end{cor}

Na začátku chceme více prozkoumat, pak už chceme méně prozkoumat a využívat toho, co jsme se naučili.

\begin{defi}[Pravidla pro exploraci]
	\
	\begin{itemize}
		\item \emph{random action} $ \equiv $ v $ \fce \O{\frac 1t} $ vybereme náhodnou akci, jinak greedy $ \to $ pomalé.
		\item \emph{weighted actions} $ \equiv $ akcím, které jsme moc nezkoušeli, dáme reward navíc: \[
			      \fce {U^+}s = \fce \rew s + \gamma \max_{a \in A} \fce f{\sum_{s' \in S} \pr{s' \mid s,a} \fce {U^+}{s'}, \#_{s,a}},
		      \]
			  kde $ f $ je tzv. \emph{explorační funkce} -- upravuje skutečnou utilitu v závislosti na prozkoumanosti stavu.
	\end{itemize}
\end{defi}

Pokusíme se vybudovat aktivní verzi Temporal-Difference Learningu.

\begin{algo}[Q-learning]\ \\
	\AlgIn prostředí.
	\begin{algorithmic}[1]
		\Indent Pro $ s,s' $ dvojici po sobě jdoucích stavů při průchodu s policy podle pravidel pro exploraci:
		\State $ \fce {Q}{s,a} \gets \fce Q{s,a} + \alpha \left( \fce \rew s + \gamma \max_{a' \in A}\fce Q{s',a'} - \fce Q{s,a} \right) $
		\State Aktualizujeme $ \pi $.
		\EndIndent
	\end{algorithmic}
	\AlgOut $ \pi $.
\end{algo}

\begin{algo}[SARSA]\ \\
	\AlgIn prostředí.
	\begin{algorithmic}[1]
		\Indent Pro $ s,s' $ dvojici po sobě jdoucích stavů při průchodu s policy podle pravidel pro exploraci:
		\State $ a' \gets $ akce, kterou podle policy uděláme při kroku z $ s' $. \Comment Zohledňujeme exploraci v $ s' $.
		\State $ \fce {Q}{s,a} \gets \fce Q{s,a} + \alpha \left( \fce \rew s + \gamma \fce Q{s',a'} - \fce Q{s,a} \right) $
		\State Aktualizujeme $ \pi $.
		\EndIndent
	\end{algorithmic}
	\AlgOut $ \pi $.
\end{algo}

\begin{cor}[]
	Díky zohlednění explorace dopadá SARSA lépe, než Q-learning.
\end{cor}

\end{document                </a></li>

<li><a href="https://gitlab.mff.cuni.cz/uradnikf/bc_lec/-/raw/master/2223l/autogra/main.pdf">Automaty a gramatiky}
\author{Filip Úradník}
\date{\today}

\input{template}
\input{color}
\input{czech}

\def\ff{\mathcal{F}}
\def\L{\mathcal{L}}
\def\G{\mathcal{G}}
\def\lamcl{\lambda CLOSE}
\DeclareMathOperator\rege{RegE}
\DeclareMathOperator\ChNF{ChNF}

\def\potfin#1 {\fce{\mathcal{P}_{F}}{#1}}

\def\step{\vdash}
\def\steps{\step^*}

\def\cfg{\G_{F}}
\def\cg{\G_{C}}
\def\chnf{\fce{\ChNF}{\cfg}}
\def\deriv{\Rightarrow^*}
\def\Lbezpref{\L_{BPFX}}
\def\cfl{\L_{CF}}
\def\dcfl{\L_{DCF}}

\begin{document}
\maketitle
% https://ktiml.mff.cuni.cz/~marta
% https://dl1.cuni.cz/course/index.php?categoryid=337

\section{Regulární jazyky}

\subsection{Konečný automat}

\begin{defi}[Deterministický konečný automat]
	\textit{Deterministický konečný automat} je pětice $ A = \left< Q, \Sigma, \delta, q_0, F \right> $, kde \begin{itemize}
		\item $ Q $ je neprázdná, konečná množina \emph{stavů},
		\item $ \Sigma $ je neprázdná, konečná \emph{vstupní abeceda},
		\item $ \delta: Q \times \Sigma \to Q $ je \emph{přechodová funkce},
		\item $ q_0 \in Q $ je \emph{počáteční stav},
		\item $ F \subseteq Q $ je množina \emph{přijímajících stavů}.
	\end{itemize}
\end{defi}

Přechodová funkce může nebo nemusí být totální, pokud je totální, pak přidám
stav \emph{fail}, nebo prostě vracím na $ \lambda $.

\begin{defi}[Slovo]
	Mějme $ \Sigma $. \emph{Slovo} je konečná posloupnost znaků ze $ \Sigma $.
	Prázdné slovo značíme $ \lambda $, případně $ \epsilon $. Množinu slov nad $
		\Sigma $ značíme $ \Sigma^* $. Množinu neprázdných slov nad $ \Sigma $
	značíme $ \Sigma^+ $.
\end{defi}

\begin{defi}[Jazyk]
	\emph{Jazyk} je množina $ L \subseteq \Sigma^* $.
\end{defi}

\begin{defi}[Zřetězení]
	Pro $ u,v \in \Sigma^* $ je $ u \cdot v $ \emph{zřetězení} $ u $ a $ v $.

	Pokud $ U, V $ jsou množiny slov, pak $ U \cdot V \deq \left\{ u \cdot v \suchthat u \in U, v \in V \right\} $.

	Obecně pak $ u^n \deq u \cdot u \cdot \ldots \cdot u $, $ n $-krát zřetězené $ u $. $ u^0 \deq \lambda $.
\end{defi}

\begin{defi}[Délka slova]
	Nechť $ u $ je slovo. \emph{Délka slova} $ u $ je $ \left| u \right| \deq $ \# znaků $ u $.
\end{defi}

\begin{defi}[Rozšířená přechodová funkce]
	Nechť $ \delta $ je přechodová funkce. \emph{Rozšířená přechodová funkce} je $ \delta^*: Q \times \Sigma^* \to Q $, kde \[
		\fce{\delta^*}{q, u} = \begin{cases}
			q                                     & u = \lambda                                    \\
			\fce{\delta}{q, u}                    & \absolute{u} = 1                               \\
			\fce{\delta}{\fce{\delta^*}{q, v}, a} & u = v \cdot a, \absolute{v} = \absolute{u} - 1
		\end{cases}
	\]
\end{defi}

\begin{defi}[Dosažitelné stavy]
	Stav $ q \in Q $ je \emph{dosažitelný} $ \equiv $ $ \left( \exists w \in \Sigma^* \right)\! \left( \fce{\delta^*}{q_0, w} = q \right) $.
\end{defi}


\begin{defi}[Přijímání jazyka/slova]
	Jazyk \emph{rozpoznaný/přijímaný/akceptovaný} konečným automatem $ A $ je \[
		\fce{L}{A} \deq \left\{ u \in \Sigma^* \suchthat \fce{\delta^*}{q_0, u} \in F \right\}.
	\]

	Slovo je \emph{rozpoznané/přijímané/akceptované} konečným automatem $ A $ $ \equiv $ náleží do jazyka $ \fce{L}{A} $.
\end{defi}

\begin{defi}[Rozpoznatelný jazyk]
	Jazyk je \textit{rozpoznatelný} konečným automatem $ \equiv \exists A: \fce{L}{A} = L $.
	Jazyky rozpoznávané konečnými automaty jsou \emph{regulární}, značíme $ \ff $.
\end{defi}

\begin{thm}[Iterační (pumping) lemma]
	\label{pumping}
	$ \forall L $ regulární $ \exists n \in \N $, zvané konstanta, takové, že $ \forall w \in L: \absolute{w} \geq n: $ \[
		\exists x,y,z \in \Sigma^*: \left( \left( w = x \cdot y \cdot z \right) \land
		\left( y \neq \lambda \right) \land \left( \absolute{x \cdot y} \leq n \right) \land
		\left( \forall k \in \N_0: x \cdot y^k \cdot z \in L
			\right)
		\right).
	\]

	\begin{proof}
		Mějme regulární $ L $ a $ A: L = \fce{L}{A} $. Za $ n $ zvolím $
			\absolute{Q} $. Mějme $ w \in L : \absolute{w} \geq n $.

		Označím $ p_0 = q_0 $ a $ p_i = \fce{\delta}{p_{i-1}, w_i} $.
		Protože mezi $ p_0 $ a $ p_n $ je $ n+1 $ stavů, musí se některý opakovat:
		$ \exists i \neq j: p_i = p_j $. Vezmu nejmenší takové $ i,j $.

		Zvolíme $ x = w_1 \dots w_i $, $ y = w_{i+1} \dots w_j $ a $ z = w_{j+1} \dots w_{-1} $.
		Pro tyto $ x,y,z $ lemma platí.
	\end{proof}
\end{thm}

\begin{defi}[Kongruence]
	Ekvivalence $ \sim $ je \emph{kongruence} $ \equiv \left( \forall x,y,z \right)\!\left( x \sim y \implies x\cdot z \sim y \cdot z \right) $.
\end{defi}

\begin{thm}[Myhill-Nerodova]
	Nechť $ L $ je jazyk nad konečnou $ \Sigma $. Potom $ L $ je regulární $ \Longleftrightarrow \exists \sim $ kongruence s konečně mnoha ekvivalenčními třídami, tž. \[
		\left( \exists S \subseteq \Sigma^*\slash_\sim \right)\! \left( L = \bigcup S \right).
	\]

	\begin{proof}\
		\begin{itemize}
			\item[$ \Rightarrow $:] Mějme regulární $ L $, a $ A: L = \fce{L}{A} $.
				Kongruenci zadefinujeme jako $ a \sim b \equiv \fce{\delta^*}{q_0, a} =
					\fce{\delta^*}{q_0, b} $.
			\item[$ \Leftarrow $:] Mějme $ \sim $ kongruenci s konečně mnoha ekvivalenčními třídami, $ S \subseteq \Sigma^* \slash_\sim $.
				Zvolíme konečný automat $ A = \left< \Sigma^*\slash_\sim, \Sigma, \delta, \left[ \lambda \right]_\sim, S \slash_\sim \right> $, kde \[
					\fce{\delta}{\left[ q \right]_\sim, a} = \left[ q\cdot a \right]_\sim.
				\] \qedhere
		\end{itemize}
	\end{proof}
\end{thm}

\begin{thm}[]
	Pro regulární jazyk $ L $ platí: Je nekonečný $ \Longleftrightarrow \left( \exists u \in L \right)\! \left( n \leq \absolute{u} < 2n \right) $, kde $ n $ je z pumping lemma (\ref{pumping}).

	\begin{proof}\
		\begin{itemize}
			\item[$ \Leftarrow $:] Mějme $ u \in L $. $ u $ lze pumpovat, tedy $
					\exists $ nekonečně slov v $ L $.
			\item[$ \Rightarrow $:] Nechť $ L $ je nekonečný. Obsahuje tedy slovo $ w:
					\absolute{w} \geq n $. Pokud $ \absolute{w} < 2n $, důkaz je u konce.
				Jinak, dokud $ \absolute{w} \geq 2n $, rozkládáme $ w $ pomocí pumping
				lemma (\ref{pumping}) na $ xyz $, nahradíme $ w = xz $, které je
				kratší. $ y $ má vždy $ < n $ písmen, tedy jednou bude $ n \leq
					\absolute{w} < 2n $. \qedhere
		\end{itemize}
	\end{proof}
\end{thm}

\begin{algo}[Dosažitelné stavy]\ \\
	\emph{Vstup:} konečný automat $ A = \left< Q, \Sigma, \delta, q_0, F \right> $.
	\begin{algorithmic}[1]
		\State $ D \gets \left\{ q_0 \right\} $
		\State $ T \gets \left\{ q_0 \right\} $
		\Indent Dokud $ T \neq \emptyset $
		\State $ q \Leftarrow T $
		\Indent Pro $ a \in \Sigma $:
		\Indent Pokud $ \fce{\delta}{q,a} \notin D $:
		\State $ D \gets D \cup \left\{ \fce{\delta}{q,a} \right\} $
		\State $ T \gets T \cup \left\{ \fce{\delta}{q,a} \right\} $
		\EndIndent
		\EndIndent
		\EndIndent
	\end{algorithmic}
	\emph{Výstup:} $ D \subseteq Q $, množina stavů dosažitelných pomocí $ A $.
\end{algo}

\begin{defi}[Ekvivalence automatů]
	Automaty $ A $ a $ B $ jsou \emph{ekvivalentní} $ \equiv $ $ \fce{L}{A} = \fce{L}{B} $.
\end{defi}

\begin{defi}[Automatový homomorfismus]
	Zobrazení $ h: Q_A \to Q_B $ je \emph{automatový homomorfismus} $ \equiv $ \begin{enumerate}
		\item $ \fce{h}{q_{A0}} = q_{B0} $,
		\item $ \fce{h}{\fce{\delta_A}{q,x}} = \fce{\delta_B}{\fce{h}{q}, x} $,
		\item $ \fceb h {F_A} = F_B $.
	\end{enumerate}
	Je-li $ h $ prosté a na, nazývá se \emph{automatový isomorfismus}.
\end{defi}

\begin{thm}[O ekvivalenci automatů]
	Nechť $ A,B $ jsou automaty. Pak pokud $ \exists h: Q_A \to Q_B $ homomorfismus, pak $ A
	$ a $ B $ jsou ekvivalentní.
\end{thm}

\begin{defi}[Rozlišitelné a ekvivalentní stavy]
	Stavy $ p,q \in Q $ jsou \emph{ekvivalentní} $ \equiv $ \[
		\left( \forall w \in \Sigma^* \right)\! \left( \fce{\delta^*}{p, w} \in F \Leftrightarrow \fce{\delta^*}{q,w} \in F \right).
	\]
	Stavy jsou \emph{rozlišitelné} $ \equiv $ nejsou ekvivalentní.
\end{defi}

\begin{lemma}[]
	Ekvivalence na stavech je transitivní.
\end{lemma}

\begin{algo}[Rozlišitelné stavy]\ \\
	\emph{Vstup:} konečný automat $ A = \left< Q, \Sigma, \delta, q_0, F \right> $.
	\begin{algorithmic}[1]
		\State $ R \gets $ prázdná, symetrická relace, defaultně všude $ e $.
		\State Pro dvojice $ p,q: p \in F, q \in Q \setminus F $: nastavíme $ \fce{R}{p,q} \gets r $.
		\State $ T \gets F \times \left( Q \setminus F \right) $
		\Indent Dokud $ T \neq \emptyset $:
		\State $ p,q \Leftarrow T $
		\Indent Pro $ a \in \Sigma $:
		\Indent Pro $ u,v \in Q: \fce{\delta}{u,a} = p \land \fce{\delta}{v,a} = q $:
		\Indent Pokud $ \fce{R}{u,v} = e $:
		\State $ \fce{R}{u,v} \gets r $
		\State $ T \gets T \cup \left\{ \left( u,v \right) \right\} $
		\EndIndent
		\EndIndent
		\EndIndent
		\EndIndent
	\end{algorithmic}
	\emph{Výstup:} relace $ R: Q \times Q \to \left\{ r, e \right\} $.
\end{algo}

\begin{algo}[Testování ekvivalence jazyků]\ \\
	\emph{Vstup:} Jazyky $ L, M $.
	\begin{algorithmic}[1]
		\State $ A \gets $ konečný automat, který přijímá $ L $.
		\State $ B \gets $ konečný automat, který přijímá $ M $.
		\State $ C \gets A \cup B = \left< Q_A \cup Q_B, \Sigma, \delta_A \cup \delta_B, q_A, F_A \cup F_B \right> $
		\State $ R \gets \algorithm{Rozlišitelné stavy}{C} $
		\State Vrátíme \emph{ekvivalentní}, pokud $ \fce{R}{q_A, q_B} = e $.
	\end{algorithmic}
	\emph{Výstup:} informace o jejich ekvivalenci.
\end{algo}

\begin{defi}[Redukovaný automat]
	Automat $ A $ je \emph{redukovaný} $ \equiv $ \begin{itemize}
		\item nemá nedosažitelné stavy,
		\item nemá dvojici ekvivalentních stavů.
	\end{itemize}
\end{defi}

\begin{defi}[Redukt]
	Automat $ B $ je \emph{reduktem} automatu $ A $ $ \equiv  $ \begin{itemize}
		\item $ B $ je redukovaný,
		\item $ A  $ je ekvivalentní s $ B $.
	\end{itemize}
\end{defi}

\begin{algo}[Redukce]\ \\
	\emph{Vstup:} automat $ A $.
	\begin{algorithmic}[1]
		\State Vyhodíme nedosažitelné stavy.
		\State $ R \gets \algorithm{Rozlišitelné stavy}{A} $
		\State $ Q \gets \left[ Q \right]_R $
		\State Upravíme zbytek automatu aby fungoval s novými stavy, pomocí reprezentantů.
	\end{algorithmic}
	\emph{Výstup:} redukt automatu $ A $.
\end{algo}

\subsection{Nedeterministický konečný automat}

\begin{defi}[Nedeterministický konečný automat]
	\emph{Nedeterministický konečný automat} je $ A = \left< Q, \Sigma, \delta, S_0, F \right> $, kde \begin{itemize}
		\item $ Q $ je neprázdná, konečná množina \emph{stavů},
		\item $ \Sigma $ je neprázdná, konečná \emph{vstupní abeceda},
		\item $ \delta: Q \times \Sigma \to \pot Q $ je \emph{přechodová funkce},
		\item $ S_0 \subseteq Q $ je neprázdná množina \emph{počátečních stavů},
		\item $ F \subseteq Q $ je množina \emph{přijímajících stavů}.
	\end{itemize}
\end{defi}

\begin{defi}[Rozšířená přechodová funkce]
	Nechť $ \delta $ je přechodová funkce pro nedeterministický konečný automat.
	\emph{Rozšířená přechodová funkce} je $ \delta^*: Q \times \Sigma^* \to \pot
		Q $, kde \[
		\fce{\delta^*}{q, u} = \begin{cases}
			\left\{ q \right\}                                                                & u = \lambda,                                    \\
			\bigcup_{}\left\{ \fce{\delta}{w, a} \suchthat w \in \fce{\delta^*}{q,v} \right\} & u = v \cdot a, \absolute{v} = \absolute{u} - 1.
		\end{cases}
	\]

	Pro množiny stavů $ S \subseteq Q $ definujeme $ \fce{\delta^*}{S,u} \deq \bigcup_{q \in S} \fce{\delta^*}{q,u} $.
\end{defi}

\begin{defi}[Přijímání jazyka/slova]
	Jazyk \emph{rozpoznaný/přijímaný/akceptovaný} nedeterministickým konečným automatem $ A $ je \[
		\fce{L}{A} \deq \left\{ u \in \Sigma^* \suchthat \left( \exists q \in S_0 \right)\! \left( \fce{\delta^*}{q, u} \cap F \neq \emptyset \right) \right\}.
	\]

	Slovo je \emph{rozpoznané/přijímané/akceptované} konečným automatem $ A $ $ \equiv $ náleží do jazyka $ \fce{L}{A} $.
\end{defi}

\begin{algo}[Podmnožinová konstrukce]\ \\
	\emph{Vstup:} nedeterministický konečný automat $ A = \left< Q_A, \Sigma, \delta_A, S_0, F_A \right> $.
	\begin{algorithmic}[1]
		\State Vyhodíme nedosažitelné $ S \in Q_A $. \Comment Není nutné, ale zjednodušuje výsledek.
		\State $ Q_D \gets \pot {Q_A} $
		\State $ q_0 \gets S_0 $
		\State $ F_D \gets \left\{ S \in Q_A \suchthat S \cap F_A \neq \emptyset \right\} $
		\Indent Pro $ a \in \Sigma, S \in Q_A $:
		\State $ \fce{\delta_D}{S,a} \gets \bigcup_{p \in S} \fce{\delta_A}{p,a} $
		\EndIndent
	\end{algorithmic}
	\emph{Výstup:} deterministický konečný automat $ D = \left< Q_D, \Sigma, \delta_D, q_0, F_D \right> $, tž. $ \fce{L}{A} = \fce{L}{D} $.
\end{algo}

\begin{thm}[Nedeterministický na deterministický]
	Pro každý nedeterministický automat $ N $ existuje deterministický $ D $, tž. $ \fce{L}{D} = \fce{L}{N} $.
\end{thm}

Díky této větě víme, že nedeterministické automaty jsou stejně silné jako ty deterministické.

\begin{defi}[$ \lambda $-nedeterministický konečný automat]
	\emph{$ \lambda $-nedeterministický konečný automat} je $ A = \left< Q, \Sigma, \delta, S_0, F \right> $, kde \begin{itemize}
		\item $ \lambda$ je \emph{prázdné slovo},
		\item $ Q $ je neprázdná, konečná množina \emph{stavů},
		\item $ \Sigma $ je neprázdná, konečná \emph{vstupní abeceda},
		\item $ \delta: Q \times \left( \Sigma \cup \left\{ \lambda \right\} \right) \to \pot Q $ je \emph{přechodová funkce},
		\item $ S_0 \subseteq Q $ je neprázdná množina \emph{počátečních stavů},
		\item $ F \subseteq Q $ je množina \emph{přijímajících stavů}.
	\end{itemize}
\end{defi}

\begin{defi}[$ \lambda $ uzávěr]
	\emph{$ \lambda $-uzávěr} pro stav $ p $ je množina $ \fce \lamcl p $, tž. \begin{enumerate}
		\item $ p \in \fce \lamcl p $,
		\item $ q \in \fce \lamcl p \to \fce \delta {q, \lambda} \subseteq \fce \lamcl p $.
	\end{enumerate}

	Pro množiny je $ \fce{\lamcl}{S} \deq \bigcup_{q \in S} \fce{\lamcl}{q} $.
\end{defi}

\begin{defi}[Rozšířená přechodová funkce]
	Nechť $ \delta $ je přechodová funkce pro $ \lambda $-nedeterministický konečný automat.
	\emph{Rozšířená přechodová funkce} je $ \delta^*: Q \times \Sigma^* \to \pot
		Q $, kde \[
		\fce{\delta^*}{q, u} = \begin{cases}
			\fce{\lamcl}{q}                                                                                 & u = \lambda,                 \\
			\fce{\lamcl}{\bigcup_{}\left\{ \fce{\delta}{p, a} \suchthat p \in \fce{\delta^*}{q,v} \right\}} & u = v \cdot a, a \in \Sigma.
		\end{cases}
	\]

	Pro množiny stavů $ S \subseteq Q $ definujeme $ \fce{\delta^*}{S,u} \deq \bigcup_{q \in S} \fce{\delta^*}{q,u} $.
\end{defi}

\begin{defi}[Přijímání jazyka/slova]
	Jazyk \emph{rozpoznaný/přijímaný/akceptovaný} nedeterministickým konečným automatem $ A $ je \[
		\fce{L}{A} \deq \left\{ u \in \Sigma^* \suchthat \left( \exists q \in S_0 \right)\! \left( \fce{\delta^*}{q, u} \cap F \neq \emptyset \right) \right\}.
	\]

	Slovo je \emph{rozpoznané/přijímané/akceptované} konečným automatem $ A $ $ \equiv $ náleží do jazyka $ \fce{L}{A} $.
\end{defi}

\begin{algo}[Eliminace $ \lambda $-přechodů]\ \\
	\emph{Vstup:} $ \lambda $-nedeterministický konečný automat $ A = \left< Q_A, \Sigma, \delta_A, S_0, F_A \right> $.
	\begin{algorithmic}[1]
		\State $ Q_D \gets \left\{ \fce{\lamcl}{S} \suchthat S \subseteq Q_E \right\} $
		\State $ q_0 \gets \fce{\lamcl}{S_0} $
		\State $ F_D \gets \left\{ S \in Q_D \suchthat S \cap F_A \neq \emptyset \right\} $
		\Indent Pro $ a \in \Sigma, S \in Q_D $:
		\State $ \fce{\delta_D}{S,a} \gets \fce{\lamcl}{\bigcup_{p \in S} \fce{\delta_A}{p,a}} $
		\EndIndent
	\end{algorithmic}
	\emph{Výstup:} deterministický konečný automat $ D = \left< Q_D, \Sigma, \delta_D, S_0, F_D \right> $, tž. $ \fce{L}{D} = \fce{L}{A} $.
\end{algo}

\begin{thm}[$ \lambda $-nedeterministický na deterministický]
	Pro každý $ \lambda $-nedeterministický konečný automat $ A $ existuje deterministický $ D $, tž. $ \fce{L}{D} = \fce{L}{A} $.
\end{thm}

\subsection{Algebraický popis regulárních jazyků}

\begin{defi}[Řetězcové operace]
	Nechť $ L,M \subseteq \Sigma^* $. Pak \begin{enumerate}
		\item $ L \cdot M \deq \left\{ l \cdot m \suchthat l \in L, m \in M \right\} $,
		\item $ L^0 \deq \left\{ \lambda \right\} $,
		\item pro $ n \in \N: L^n \deq L^{n-1} \cdot L $,
		\item pro $ a \in \Sigma $ je $ L \cdot a \deq \left\{ l \cdot a \suchthat l \in L \right\}  $,
		\item $ L^* \deq \bigcup\left\{ L^i \suchthat i \in \N_0 \right\} $,
		\item $ L^+ \deq \bigcup\left\{ L^i \suchthat i \in \N \right\} $,
		\item $ L^R \deq \left\{ a_n \cdot a_{n-1} \cdot \dots \cdot a_1 \suchthat a_1 \cdot \dots \cdot a_n \in L \right\} $,
		\item $ \partial_w L = \left\{ v \suchthat w\cdot v \in L \right\} $,
		\item $ \partial^R_w L = \left\{ v \suchthat v\cdot w \in L \right\} $,
		\item $ M \backslash L = \left\{ v \suchthat uv \in L \land u \in M \right\} $,
		\item $ L \slash M = \left\{ u \suchthat uv \in L \land v \in M \right\} $.
	\end{enumerate}
\end{defi}

\begin{defi}[Množinové operace]
	Nechť $ L,M \subseteq \Sigma^* $. Pak \begin{enumerate}
		\item $ L \cup M \deq \left\{ x \suchthat x \in L \lor x \in M \right\} $,
		\item $ L \cap M \deq \left\{ x \suchthat x \in L \land x \in M \right\} $,
		\item $ L - M \deq \left\{ x \suchthat x \in L \land x \notin M \right\} $,
		\item $ \overline L \deq \Sigma^* - L $.
	\end{enumerate}
\end{defi}

\begin{thm}[]
	Všechny množinové a řetězcové operace jsou uzavřené na regularitu jazyků.
\end{thm}

\begin{defi}[R]
	Třída jazyků $ \fce R\Sigma $ je definovaná jako \begin{enumerate}
		\item $ \emptyset \in \fce R\Sigma $,
		\item $ \left( \forall a \in \Sigma \right)\! \left( \left\{ a \right\} \in \fce R\Sigma \right) $,
		\item $ \fce R\Sigma $ je uzavřená na sjednocení,
		\item $ \fce R\Sigma $ je uzavřená na zřetězení,
		\item $ \fce R\Sigma $ je uzavřená na iteraci.
	\end{enumerate}
\end{defi}

\begin{thm}[Kleene]
	Třída $ \fce R\Sigma $ je právě třída všech regulárních jazyků.
\end{thm}



\subsection{Regulární výrazy}

\begin{defi}[Regulární výraz]
	Množina \emph{regulárních výrazů} nad $ \Sigma^* $ je $ \fce{\rege}{\Sigma} $, tž.
	\begin{enumerate}
		\item $ \emptyset \in \fce{\rege}{\Sigma} $,
		\item $ \lambda \in \fce{\rege}{\Sigma} $,
		\item $ a \in \fce{\rege}{\Sigma} $ pro $ a \in \Sigma $,
		\item $\alpha, \beta \in \fce{\rege}{\Sigma} \implies \alpha + \beta \in \fce{\rege}{\Sigma} $
		\item $\alpha, \beta \in \fce{\rege}{\Sigma} \implies \alpha  \beta \in \fce{\rege}{\Sigma} $
		\item $\alpha \in \fce{\rege}{\Sigma} \implies "\alpha^*" \in \fce{\rege}{\Sigma} $
		\item $\alpha \in \fce{\rege}{\Sigma} \implies "( \alpha )" \in \fce{\rege}{\Sigma} $
	\end{enumerate}
\end{defi}

\begin{defi}[Hodnota regulárního výrazu]
	Nechť $ \fce{\rege}{\Sigma} $ je množina regulárních výrazů. Pak \emph{hodnota} regulárního výrazu $ \alpha $ je
	\begin{enumerate}
		\item $ \fce{L}{\emptyset} = \emptyset $,
		\item $ \fce{L}{\lambda} = \left\{ \lambda \right\} $,
		\item $ \fce{L}{a} = \left\{ a \right\} $,
		\item $ \fce{L}{\alpha \beta} = \fce{L}{\alpha} \cdot \fce{L}{\beta} $,
		\item $ \fce{L}{\alpha + \beta} = \fce{L}{\alpha} \cup \fce{L}{\beta} $,
		\item $ \fce{L}{\alpha^*} = \fce{L}{\alpha}^* $,
		\item $ \fce{L}{(\alpha)} = \fce{L}{\alpha} $.
	\end{enumerate}
\end{defi}

Někdy se zaměňuje regulární výraz a jeho hodnota.

\begin{thm}[Kleene, varianta]
	Jazyk je regulární, právě když je popsatelný regulárním výrazem.
	\begin{proof}[Důkaz \textquote{$ \Leftarrow $}, RegE $ \to \lambda $-NFA ]
		Indukcí podle struktury.
	\end{proof}
	\begin{proof}[Důkaz \textquote{$ \Rightarrow $}, DFA $ \to $ RegE]
		Mějme DFA. Očíslujeme stavy.

		Zadefinujeme regulární výraz $ R^k_{ij} \deq $ \textquote{z uzlu $ i $ do $ j $ přes uzly s číslem $ \leq k $}.
		$ R^0_{ii} = \lambda + a_1 + \dots + a_l $ pro $ a_1, \dots, a_l $ písmena na smyčce $ i \to i $.
		Dále, pro $ i \neq j $ je $ R^0_{ij} = a_1 + a_2 + \dots + a_l $ pro $ a_1, \dots, a_l $ písmena na smyčce $ i \to j $.
		Nakonec, $ R_{ij}^{k+1} = R^k_{ij} + R^k_{i \left( k+1 \right)} \cdot \left( R^k_{\left( k+1 \right)\left( k+1 \right)} \right)^* \cdot R^k_{\left( k+1 \right)j} $.
		Konečný regulární výraz bude součet pro všechny $ R^n_{1j} $, kde $ j \in F $.
	\end{proof}
\end{thm}

Ve skriptech jsou převody na slidu 79.

\subsection{Substituce}

\begin{defi}[Substituce]
	Nechť $ \Sigma $ je abeceda. Dále, definujme $ \forall x \in \Sigma: Y_x $
	abecedu. Definujme dále $ Y \deq \bigcup_{x \in \Sigma} Y_x $
	\emph{Substituce} je zobrazení \[
		\sigma: \Sigma^* \to \pot{Y^*},
	\]
	tž. \begin{enumerate}
		\item $ \fce{\sigma}{\lambda} \deq \left\{ \lambda \right\} $,
		\item pro $ a \in \Sigma $ je $ \fce{\sigma}{a} \subseteq Y_a^* $,
		\item $ \fce{\sigma}{u \cdot v} \deq \fce{\sigma}{u} \cdot \fce{\sigma}{v} $,
		\item pro $ L \subseteq \Sigma^*: \fce{\sigma}{L} \deq \bigcup_{w \in L} \fce{\sigma}{w} $.
	\end{enumerate}

	Substituce je \emph{nevypouštějící} $ \equiv \left( \forall a \in \Sigma \right)\! \left( \left\{ \lambda \right\} \notin \fce{\sigma}{a} \right) $.
\end{defi}

\begin{defi}[Homomorfismus]
	Substituce $ \sigma $ je \emph{homomorfismus} $ \equiv \left( \forall x \in \Sigma \right)\! \left( \absolute{\fce{\sigma}{x}} = 1 \right) $.
\end{defi}

U homomorfismů často nepíšeme složené závorky, tj. pokud $ \fce{h}{a} = \left\{ abc \right\} $, napíšeme radši $ \fce{h}{a} = abc $.

\begin{thm}[Uzavřenost na homomorfismus]
	Nechť $ L $ je regulární nad $ \Sigma^* $, $ \sigma $ je substituce, tž. $ \forall a \in \Sigma: \fce{\sigma}{a} $ je regulární.
	Pak $ \fce{\sigma}{L} $ je regulární.

	\begin{proof}
		Písmena samotná jsou regulární (z předpokladu).
		Veškeré ostatní řetězce v $ \fce{\sigma}{L} $ se dají rozepsat pomocí operací na jazycích, které zachovávají regularitu.

		Jediný menší problém je s $ \fce{\sigma}{\fce{L}{\alpha}^*} $, protože ten je nekonečný, ale lze si ho představit jako sjednocení nekonečně mnoha regulárních jazyků $ \fce \sigma{\fce{L}{\alpha}^i} $ pro $ i \in \N_0 $.
	\end{proof}
\end{thm}

\begin{defi}[Inversní homomorfismus]
	Nechť $ L $ je jazyk.
	\emph{Inversní homomorfismus} je inversní zobrazení k homomorfismu. \[
		\fce{h^{-1}}{L} \deq \left\{ w \suchthat \fce{h}{w} \in L \right\}.
	\]
\end{defi}

Pozor, inversní homomorfismus nemusí být homomorfismus.

\begin{thm}[]
	Nechť $ L \subseteq \Sigma^* $ je regulární.
	Nechť $ h: T \to \Sigma^* $ je homomorfismus
	Pak $ \fce{h^{-1}}L $ je regulární.

	\begin{proof}
		Nechť $ A $ je det. automat $ L $ (z regularity).
		Zkonstruujeme nový $ \lambda $-NFA $ B $.
		\[
			Q_B = \left\{ \left< q,u \right> \suchthat q \in Q_A \land \left( \exists a \in T \right)\! \left( \exists v \in \Sigma^* \right)\! \left( \fce{h}{a} = v \cdot u \right)   \right\}.
		\]
		Druhý řetězec ve dvojici je \emph{buffer}. Ten má délku omezenou nejdelším obrazem písmena z $ T $, tedy je konečný
		Přechodovou funkci zadefinuji tak, že \begin{enumerate}
			\item pro $ a \in T $ je $ \fce{\delta_B}{\left< q, \lambda \right>, a} = \left< q, \fce{h}{a} \right> $,
			\item pro $ b \in \Sigma, w \in \Sigma^* $ je $ \fce{\delta_B}{\left< q, b \cdot w \right>, \lambda} = \left< \fce{\delta_A}{q, b}, w \right> $.
		\end{enumerate}
		$ q_{B0} = \left< q_{A0}, \lambda \right> $.
		Tento automat přijímá $ \fce{h^{-1}}{L} $, tedy je to regulární jazyk.
	\end{proof}
\end{thm}

% df: dvousměrný automat.

\section{Gramatiky}

\begin{defi}[Gramatika]
	\emph{(Formální/Generativní) gramatika} je $ G = \left< V,T,P,S \right> $, kde \begin{itemize}
		\item $ V $ je konečná množina \emph{neterminálů},
		\item $ T $ je neprázdná konečná množina \emph{terminálů},
		\item $ S $ je \emph{počáteční symbol},
		\item $ P $ je konečná množina \emph{pravidel}, tj. nápisů ve tvaru \[
			      \alpha A \beta \to \gamma,
		      \] kde $ A \in V \land \alpha, \beta, \gamma \in \left( T \cup V \right)^* $.
	\end{itemize}
\end{defi}

\begin{defi}[Chomského hierarchie]
	Nechť $ G $ je gramatika.
	Nechť $ A,B \in V $.
	Nechť $ \alpha, \beta, \delta \in \left( T \cup V \right)^* $.
	Nechť $ \gamma \in \left( T \cup V \right)^+ $.
	Nechť $ \omega \in T^* $.
	Gramatika $ G $ je typu \begin{itemize}
		\item \emph{0, rekurzivně spočetná} $ \equiv  $ dovoluje pravidla $ \alpha A \beta \to \delta $,
		\item \emph{1, kontextová} $ \equiv $ obsahuje jen pravidla typu $ \alpha A \beta \to \alpha \gamma \beta $\footnote{Nezkracuje.} nebo $ S \to \lambda $, pokud se $ S $ nevyskytuje jinde,
		\item \emph{2, bezkontextová, CFG\footnote{Context Free Grammar.}} $ \equiv $ obsahuje jen pravidla typu $ A \to \alpha $,
		\item \emph{3, regulární} $ \equiv $ obsahuje jen pravidla typu $ A \to \omega B $, případně $ A \to \omega $.
	\end{itemize}
	Třída jazyků typu $ i $ je značena $ \L_i $.
\end{defi}

\begin{cor}[]
	\[
		\L_0 \supseteq \L_1\supseteq \L_2\supseteq \L_3.
	\]
\end{cor}

\begin{defi}[Derivace]
	Nechť $ G $ je gramatika.
	Nechť $ \alpha, \beta \in \left( V \cup T \right)^* $.
	Říkáme, že \begin{enumerate}
		\item $ \alpha $ se \emph{přímo přepíše na $ \omega $, $ \alpha \Rightarrow \omega $} $ \equiv $ \[
			      \left( \exists \delta, \epsilon, \mu, \pi \right)\! \left( \alpha = \mu \delta \pi \land \omega = \mu \epsilon \pi \land \left( \delta \to \epsilon \right) \in P \right),
		      \]
		\item $ \alpha $ se \emph{přepíše na $ \omega $, $ \alpha \deriv \omega $} $ \equiv $ \[
			      \left( \exists \beta_1 ,\dots, \beta_n \right)\! \left( \alpha = \beta_1 \Rightarrow \beta_2 \dots \Rightarrow \beta_n = \omega \right),
		      \]
		      kde $ \beta_1, \dots, \beta_n $ se nazývají \emph{derivací}.
	\end{enumerate}
	Navíc, pokud $ \left( \forall i,j \right)\! \left( \beta_i \neq \beta_j \right) $, pak je to \emph{minimální derivace}.
\end{defi}

\begin{defi}[Sentenciální forma]
	\emph{Sentenciální forma} je libovolný řetězec, který je získatelný z $ S $ derivací.
\end{defi}

\begin{defi}[Jazyk gramatiky]
	Nechť $ G $ je gramatika.
	\emph{Jazyk gramatiky} je $ \fce{L}{G} \equiv $ \[
		\fce{L}{G} \deq \left\{ w \in T^* \suchthat S \deriv w \right\}.
	\]
\end{defi}

\begin{defi}[Jazyk neterminálu]
	Nechť $ G $ je gramatika.
	Nechť $ A \in V $.
	\emph{Jazyk neterminálu $ A $} je $ \fce{L}{A} \equiv $ \[
		\fce{L}{A} \deq \left\{ w \in T^* \suchthat A \deriv_G w \right\}.
	\]
\end{defi}

\begin{notation}
	Typicky dodržujeme: \begin{itemize}
		\item $ \alpha, \beta, \gamma, \dots \in \left( T \cup V \right)^* $,
		\item $ A,B,C,\dots \in V $,
		\item $ a,b,c,\dots, w, x ,y ,z \in T^* $,
		\item $ X,Y,Z \in T \cup V $,
		\item $ A \to \alpha \mid \beta \equiv \left\{ A \to \alpha, A \to \beta \right\}$.
	\end{itemize}
\end{notation}

\begin{notation}
	Moje značení navíc: \begin{itemize}
		\item $ \G_i $ třída gramatik $ i $,
		\item $ \G $ je třída všech gramatik,
		\item $ \cfg $ je třída bezkontextových gramatik,
		\item $ \cg $ je třída kontextových gramatik,
		\item $ \G_L, \L_L $ jsou lineární jazyky, gramatiky,
		\item $ \L_R $ jsou regulární jazyky,
	\end{itemize}

\end{notation}


\begin{thm}[]
	Nechť $ L $ je regulární nad $ \Sigma^* $.
	Pak \[
		\left( \exists G \in \G_3 \right)\! \left( L = \fce{L}{G} \right).
	\]
\end{thm}

\begin{lemma}[]
	Nechť $ G \in \G_3 $.
	Pak \[
		\left( \exists G' \in \G_3 \right)\! \left( \fce{L}{G'} = \fce{L}{G} \land \left( \forall \pi \in P_{G'} \right)\! \left( \exists A,B \in V_{G'} \right)\!  \left( \pi \equiv A \to aB \lor \pi \equiv A \to \lambda \right) \right).
	\]
\end{lemma}

\begin{thm}[]
	Nechť $ G \in \G_3 $.
	Pak $ \fce{L}{G} $ je regulární.
\end{thm}

\section{Bezkontextové jazyky}

\begin{defi}[Pravá lineární gramatika]
	Pravá lineární gramatika, neboli regulární, má pravidla typu \[
		A \to w, A \to wB.
	\]
\end{defi}

\begin{defi}[Levá lineární gramatika]
	Levá lineární gramatika, má pravidla typu \[
		A \to w, A \to Bw.
	\]
\end{defi}

\begin{thm}[]
	Nechť $ L $ je jazyk.
	$ L $ je regulární $ \Longleftrightarrow $ $ \exists G $ levá nebo pravá lineární, tž. $ L = \fce{L}{G} $.
\end{thm}

\begin{defi}[]
	Gramatika je \emph{lineární} $ \equiv  $ má pouze pravidla tvaru \[
		A \to uBw \lor A \to w,
	\]
	a navíc na pravé straně je vždy nejvýše jeden neterminál.
\end{defi}

\begin{cor}[]
	\[
		\L_R \subset \L_L.
	\]
\end{cor}

\begin{defi}[Derivační strom CFG]
	Nechť $ G \in \cfg $.
	Pak \emph{derivační strom CFG} je strom, jehož \begin{enumerate}
		\item kořen je označen $ S $,
		\item vnitřní vrcholy jsou označeny $ A \in V $,
		\item listy mohou být označeny $ a \in T $ nebo $ \lambda $,
		\item pokud synové vrcholu $ A $ jsou $ x_1 , \dots ,x_k $, pak $ A \to x_1 \dots x_k \in P $.
	\end{enumerate}
\end{defi}

\begin{defi}[]
	Strom \emph{dává} slovo na listech -- to vznikne konkatenací listů ve směru z leva do prava.
\end{defi}

\begin{defi}[Levá derivace]
	\emph{Levá derivace} je taková, kde se vždy rozvíjí nejlevější neterminál.
\end{defi}

\begin{defi}[Pravá derivace]
	\emph{Pravá derivace} je taková, kde se vždy rozvíjí nejpravější neterminál.
\end{defi}

\begin{thm}[]
	Nechť $ G \in \cfg $.
	Nechť $ w \in T^* $.
	Pak jsou ekvivalentní \begin{enumerate}
		\item $ \exists  $ derivační strom dávající $ w $,
		\item $ \exists  $ levá derivace $ w $,
		\item $ \exists  $ pravá derivace $ w $,
		\item $ \exists  $ derivace $ w $.
	\end{enumerate}
\end{thm}

\begin{defi}[]
	Nechť $ G_1, G_2 \in \G $.
	$ G_1 $ a $ G_2 $ jsou \emph{ekvivalentní} $ \equiv $ \[
		\fce{L}{G_1} = \fce{L}{G_2}.
	\]
\end{defi}

\begin{defi}[Jednoznačnost gramatiky]
	Nechť $ G \in \cfg $.
	$ G $ je \emph{víceznačná} $ \equiv  $ existuje řetězec $ w \in \fce LG $, pro který existují dva různé derivační stromy s kořenem $ S $.
	$ G $ je \emph{jednoznačná} $ \equiv $ není víceznačná.
\end{defi}

\begin{defi}[Jednoznačnost jazyka]
	Nechť $ L \in \fce L\cfg $.
	$ L $ je \emph{(podstatně) nejednoznačný, víceznačný} $ \equiv \forall G \in \cfg: \fce LG = L $  je $ G $ víceznačná.
	$ L $ je \emph{jednoznačný} $ \equiv $ není víceznačný.
\end{defi}

\begin{defi}[Charakterizace symbolu v CFG]
	Nechť $ G \in \cfg $.
	Nechť $ x \in V \cup T $.
	$ x $ je \begin{itemize}
		\item \emph{užitečný} $ \equiv $ \[
			      \left( \exists w \in \fce{L}{G} \right)\! \left( S \deriv \alpha x \beta \deriv w \right),
		      \]
		\item \emph{zbytečný} $ \equiv $ není užitečný,
		\item \emph{negenerující} $ \equiv $ \[
			      \left( \nexists w \in \fce LG \right)\! \left( x \deriv w \right),
		      \]
		\item \emph{nedosažitelný} $ \equiv $ \[
			      S \not\deriv \alpha x \beta.
		      \]
		\item \emph{dosažitelný} $ \equiv $ \[
			      S \deriv \alpha x \beta,
		      \]
		\item \emph{nulovatelný} $ \equiv $ \[
			      x \deriv \lambda.
		      \]
	\end{itemize}
\end{defi}

\begin{algo}[Odstranění zbytečných]\ \\
	\AlgIn $ G \in \cfg $.
	\begin{algorithmic}[1]
		\State Odstraníme všechny negenerující symboly, a všechna pravidla, která je obsahovaly\footnote{Tomuto kroku se říká \emph{eliminace symbolu}.}.
		\State Odstraníme všechny nedosažitelné symboly, a všechna pravidla, která je obsahovaly.
	\end{algorithmic}
	\AlgOut $ G \in \cfg $ bez zbytečných symbolů.
\end{algo}

\begin{algo}[Získání generujících]\ \\
	\AlgIn $ G \in \cfg $.
	\begin{algorithmic}[1]
		\State $ g \gets T $
		\Indent Opakujeme:
		\Indent Pro $ x \to x_1 \dots x_k \in P: \forall i: x_i \in g $:
		\State Přidáme $ x $ do $ g $.
		\EndIndent
		\State Pokud se v současném průchodu $ g $ nezměnilo, skončíme.
		\EndIndent
	\end{algorithmic}
	\AlgOut $ g $, seznam generujících symbolů.
\end{algo}

\begin{algo}[Získání dosažitelných]\ \\
	\AlgIn $ G \in \cfg $.
	\begin{algorithmic}[1]
		\State $ d \gets \left\{ S \right\} $
		\Indent Opakujeme:
		\Indent Pro $ x \to x_1 \dots x_k \in P: x \in d $:
		\State Přidáme $ \left\{ x_1, \dots, x_k \right\} \cap V $ do $ d $.
		\EndIndent
		\State Pokud se v současném průchodu $ d $ nezměnilo, skončíme.
		\EndIndent
	\end{algorithmic}
	\AlgOut $ d $, seznam dosažitelných symbolů.
\end{algo}

\begin{algo}[Získání nulovatelných]\ \\
	\AlgIn $ G \in \cfg $.
	\begin{algorithmic}[1]
		\State $ n \gets \left\{ x \suchthat x \to \lambda \in P \right\} $
		\Indent Opakujeme:
		\Indent Pro $ x \to x_1 \dots x_k \in P: \forall i: x_i \in n $:
		\State Přidáme $ x $ do $ n $.
		\EndIndent
		\State Pokud se v současném průchodu $ n $ nezměnilo, skončíme.
		\EndIndent
	\end{algorithmic}
	\AlgOut $ n $, seznam nulovatelných symbolů.
\end{algo}

\begin{algo}[Eliminace nulovatelných pravidel]\ \\
	\AlgIn $ G \in \cfg $.
	\begin{algorithmic}[1]
		\State $ n \gets $ nulovatelné symboly.
		\State Vyhodíme všechna pravidla typu $ x \to \lambda $.
		\Indent Pro $ x \to x_1 \dots x_k \in P $:
		\State $ I \gets \left\{ i \suchthat x_i \in n \right\} $
		\State $ \overline I \gets \range k \setminus I $
		\Indent Pro všechny $ J \subseteq I $:
		\State $ K \gets \overline I \cup J $
		\State Pokud $ K \neq \emptyset $, přidáme pravidlo $ x \to x_{k_1} \dots x_{k_{\absolute{K}}} $.
		\EndIndent
		\EndIndent
	\end{algorithmic}
	\AlgOut Gramatika $ G $ bez $ \lambda $-pravidel.
\end{algo}

\begin{defi}[]
	Nechť $ G \in \G $.
	Pravidlo $ X \to Y \in P $ je \emph{jednotkové} $ \equiv X,Y \in V $.
\end{defi}

\begin{algo}[Získání jednotkových párů]\ \\
	\AlgIn $ G \in \cfg $.
	\begin{algorithmic}[1]
		\State $ j \gets \left\{ \left< X,Y \right> \suchthat X \to Y \in P \land X,Y \in V \right\} $
		\Indent Opakujeme:
		\Indent Pro $ \left< X,Y \right> \in j \land Y \to B \in P \land B \in V $:
		\State Přidáme $ \left< X,B \right> $ do $ j $.
		\EndIndent
		\State Pokud se v současném průchodu $ j $ nezměnilo, skončíme.
		\EndIndent
	\end{algorithmic}
	\AlgOut $ j $, seznam jednotkových párů.
\end{algo}

\begin{algo}[Eliminace jednotkových pravidel]\ \\
	\AlgIn $ G \in \cfg $.
	\begin{algorithmic}[1]
		\State $ j \gets $ jednotkové páry.
		\Indent Pro $ \left< X,Y \right> \in j \land Y \to \omega \in P: \omega \notin V $:
		\State Přidáme pravidlo $ X \to \omega $
		\EndIndent
		\State Vyhodíme jednotková pravidla.
	\end{algorithmic}
	\AlgOut Gramatika $ G $ bez jednotkových pravidel.
\end{algo}

% TODO: bin. pravidla?

\begin{lemma}[Gramatika v NF]
	Nechť $ G \in \cfg $.
	Nechť $ \fce{L}{G} \setminus \left\{ \lambda \right\} \neq \emptyset $.
	Pak \[
		\left( \exists G_1 \in \cfg \right)\! \left( \fce{L}{G_1} = \fce{L}{G} \setminus \left\{ \lambda \right\} \right),
	\]
	a $ G_1 $ neobsahuje $ \lambda $-pravidla, jednotková pravidla, ani zbytečné symobly.
	Taková $ G_1 $ se nazývá \emph{redukovaná.}
\end{lemma}

\begin{defi}[Chomského NF]
	Nechť $ G \in \cfg $.
	$ G $ je v \emph{Chomského normální formě} $ \equiv  $ neobsahuje zbytečné symboly a všechna pravidla jsou v jednom ze dvou tvarů: \begin{enumerate}
		\item $ A \to BC $ pro $ A,B,C \in V $,
		\item $ A \to a $ pro $ A \in V, a \in T $.
	\end{enumerate}
\end{defi}

\begin{notation}[Moje značení]
	CFG gramatika v Chomského NF je z $ \chnf $.
\end{notation}

\begin{thm}[Chomského NF pro $ \cfg $]
	Nechť $ G \in \cfg $.
	Nechť $ \fce{L}{G} \setminus \left\{ \lambda \right\} \neq \emptyset $.
	Pak \[
		\left( \exists G' \in \chnf \right)\! \left( \fce{L}{G'} = \fce LG \setminus \left\{ \lambda \right\} \right).
	\]
\end{thm}

\begin{lemma}[Velikost derivačního stromu]
	Nechť $ G \in \chnf $.
	Nechť velikost nejdelší cesty v derivačním stromu $ G $ z kořene do listu je $ n $.
	Pak \[
		\left( \forall w \in \fce{L}{G} \right)\! \left( \absolute{w} \leq 2^{n-1} \right).
	\]
\end{lemma}

\begin{cor}[]
	Pokud najdeme slovo $ w $, které má $ \absolute{w} \geq 2^{n-1} $, pak existuje ve stromě cesta delší než $ n $.
\end{cor}

\begin{thm}[Iterační lemma pro $ \cfg $]
	Nechť $ G \in \cfg $ je v Chomského NF. \\
	Pak $ \left( \exists n \in \N^+ \right)\! \left( \forall z \in \fce{L}{G}: \absolute{z} > n \right)\! \left( \exists u,v,w,x,y \in T^* \right) $ \[
		\left( z = u \cdot v \cdot w \cdot x \cdot y \land \absolute{v \cdot w \cdot x} \leq n \land \left( v \neq \lambda \lor x \neq \lambda \right) \land \left( \forall i \in \N_0 \right)\! \left( u\cdot v^i\cdot w\cdot x^i\cdot y \in \fce{L}{G} \right)  \right).
	\]
\end{thm}

\begin{algo}[CYK]\ \\
	\AlgIn $ G \in \chnf, w \in T^* $.
	\begin{algorithmic}[1]
		\State $ n \gets \absolute{w} $
		\State Vytvoříme tabulku $ n \times n $.
		\Indent Vyplníme tabulku zdola:
		\State $ X_{ii} \gets \left\{ A \suchthat A \to a_i \in P \right\} $
		\State $ X_{ij} \gets \left\{ A \suchthat A \to BC \in P \land B \in X_{ik} \land C \in X_{k+1, j} \right\} $
		\EndIndent
		\State $ w \in \fce LG \Longleftrightarrow S \in X_{1n} $
	\end{algorithmic}
	\AlgOut Odpověď, jestli $ w \in \fce LG $.
\end{algo}

\subsection{Zásobníkové automaty}

\begin{defi}[Zásobníkový automat]
	\emph{Zásobníkový automat} je $ P = \left< Q, \Sigma, \Gamma, \delta, q_0, Z_0, F \right> $, kde \begin{itemize}
		\item $ Q $ je neprázdná, konečná množina \emph{stavů},
		\item $ \Sigma $ je neprázdná, konečná \emph{vstupní abeceda},
		\item $ \Gamma $ je neprázdná, konečná \emph{zásobníková abeceda},
		\item $ \delta: Q \times \left( \Sigma \cup \left\{ \lambda \right\} \right)  \times \Gamma \to \potfin {Q \times \Gamma^*} $ je \emph{přechodová funkce},
		\item $ q_0 \in Q $ je \emph{počáteční stav},
		\item $ Z_0 \in \Gamma $ je \emph{počáteční zásobníkový symbol},
		\item $ F \subseteq Q $ je množina \emph{přijímajících stavů}, může být nedefinovaná.
	\end{itemize}
\end{defi}

\begin{defi}[Situace]
	Nechť $ P $ je zásobníkový automat.
	\emph{Situace} automatu $ P $ je trojice $ \left< q,w,\gamma \right> $, kde \begin{itemize}
		\item $ q $ je stav,
		\item $ w $ je zbývající vstup,
		\item $ \gamma $ je obsah zásobníku (vrchol je vlevo).
	\end{itemize}
\end{defi}

\begin{defi}[Posloupnost situací]
	Nechť $ P $ je zásobníkový automat.
	Pak \begin{enumerate}
		\item situace $ \left< p, a \cdot w, X\beta \right> $ \emph{bezprostředně vede} na $ \left< q,w, \alpha \cdot \beta \right> $ $ \equiv  $ \[
			      \left< q,\alpha \right> \in \fce{\delta}{p,a,X},
		      \]
		\item situace $ I $ \emph{vede} na $ J $, pokud mezi nimi existuje posloupnost situací, které na sebe bezprostředně vedou.
	\end{enumerate}
\end{defi}

\begin{notation}
	Pro \emph{krok}, neboli vztah, že $ I $ bezprostředně vede na $ J $, používáme \[
		I \step J,
	\]
	pro \emph{posloupnost kroků}, neboli vztah, že $ I $ vede na $ J $, používáme \[
		I \steps J.
	\]
\end{notation}

\begin{defi}[Jazyk přijímaný koncovým stavem]
	Nechť $ P $ je zásobníkový automat.
	Jazyk $ \fce{L}{P} $ je \emph{jazyk přijímaný koncovým stavem} $ \equiv $ \[
		\fce{L}{P} \deq \left\{ w \suchthat \left< q_0, w, Z_0 \right> \steps \left< q, \lambda, \alpha  \right>, \alpha \in \Gamma^*, q \in F \right\}.
	\]
\end{defi}

\begin{defi}[Jazyk přijímaný prázdným zásobníkem]
	Nechť $ P $ je zásobníkový automat.
	Jazyk $ \fce{N}{P} $ je \emph{jazyk přijímaný koncovým stavem} $ \equiv $ \[
		\fce{N}{P} \deq \left\{ w \suchthat \left< q_0, w, Z_0 \right> \steps \left< q, \lambda, \lambda  \right>, q \in Q \right\}.
	\]
\end{defi}

\begin{lemma}[]
	Nechť $ P $ je zásobníkový automat.
	Nechť $ \left< p,u,\alpha \right> \steps \left< q,v,\beta \right> $.
	Pak \[
		\left( \forall w \in \Sigma^* \right)\! \left( \forall \gamma \in \Gamma^* \right)\! \left( \left< p, u \cdot w, \alpha \cdot \gamma \right> \steps \left< q, v \cdot w, \beta \cdot \gamma \right> \right).
	\]
\end{lemma}

\begin{lemma}[]
	Nechť $ P $ je zásobníkový automat.
	Nechť $ \left< p, u \cdot w, \alpha \right> \steps \left< q, v \cdot w, \beta \right> $.
	Pak \[
		\left< p, u, \alpha \right> \steps \left< q,v\beta \right>.
	\]
\end{lemma}

\begin{thm}[]
	Nechť $ L $ je jazyk.
	Pak jsou ekvivalentní: \begin{enumerate}
		\item $ L $ je generovaný gramatikou $ G \in \cfg $,
		\item $ L = \fce{L}{P} $ pro nějaký zásobníkový automat $ P $,
		\item $ L = \fce{N}{P} $ pro nějaký zásobníkový automat $ P $.
	\end{enumerate}
\end{thm}

\begin{notation}
	Pro takové jazyky ona používá značení CFL, tj. bezkontextové jazyky, já budu používat $ \cfl $ jako třídu jazyků CFL.
\end{notation}

\begin{defi}[Deterministický zásobníkový automat, DPDA]
	Zásobníkový automat $ P $ je \emph{deterministický} $ \equiv  $ \begin{enumerate}
		\item $ \left( \forall q \in Q \right)\! \left( \forall a \in \Sigma \cup \left\{ \lambda \right\} \right)\! \left( \forall X \in \Gamma \right)\! \left( \absolute{\fce{\delta}{q,a,X}} \leq 1 \right)  $
		\item $ \left( \forall q \in Q \right)\! \left( \forall X \in \Gamma \right)\! \left( \left( \exists a \in \Sigma \right)\! \left( \fce{\delta}{q,a,X} \neq \emptyset \right) \to \fce{\delta}{q, \lambda, X} = \emptyset \right)  $
	\end{enumerate}
\end{defi}

\begin{thm}[]
	Nechť $ L $ je regulární nad $ \Sigma^* $.
	Pak $ \exists P $ deterministický zásobníkový, tž. $ L = \fce{L}{P} $.
\end{thm}

\begin{lemma}[]
	Existuje jazyk přijímaný DPDA, který není regulární.
\end{lemma}

\begin{defi}[Bezprefixový jazyk]
	Jazyk $ L \subset \Sigma^* $ je \emph{bezprefixový} $ \equiv $ \[
		\left( \nexists u,v \in L  \right)\! \left( \exists z \in \Sigma^+ \right)\! \left( u = v \cdot z \right).
	\]
\end{defi}

\begin{notation}[Moje]
	Bezprefixové jazyky značím $ \Lbezpref $.
\end{notation}

\begin{thm}[]
	Nechť $ L \in \L $.
	Pak existuje $ P $ NPDA, pro který $ L = \fce NP $, právě když $ L \in \Lbezpref $ a existuje $ P' $ DPDA, pro který \[
		L = \fce{L}{P'}.
	\]
\end{thm}

\begin{notation}
	Označím deterministické bezkontextové jazyky $ \dcfl $.
\end{notation}

\begin{note}[]
	Platí $ \dcfl \subset \cfl $.
\end{note}


\begin{thm}[]
	$ \cfl $ je uzavřená na sjednocení, konkatenaci, iteraci, pozitivní iteraci, zrcadlový obraz ($ w^R $).
\end{thm}

\begin{note}[]
	Pozor, $ \cfl $ není uzavřená na průnik!
\end{note}

\begin{thm}[]
	Nechť $ L \in \cfl $.
	Nechť $ L' \in \dcfl $.
	Nechť $ L_R \in \L_R $.
	Pak $ L \cap L_R \in \cfl $ a $ L' \cap L_R \in \dcfl $.
\end{thm}

\begin{thm}[]
	Nechť $ L \in \cfl $.
	Nechť $ \sigma $ je substituce, a \[
		\left( \forall a \in \Sigma \right)\! \left( \fce{\sigma}{a} \in \cfl \right).
	\]
	Pak $ \fce\sigma L \in \cfl $.
\end{thm}

\begin{cor}[]
	$ \cfl $ je uzavřena na homomorfismus.
\end{cor}

\begin{thm}[]
	Nechť $ h $ je homomorfismus.
	Nechť $ L \in \cfl $.
	Nechť $ L' \in \dcfl $.
	Pak $ \fce{h^{-1}}{L} \in \cfl $ a $ \fce{h^{-1}}{L'} \in \dcfl $.
\end{thm}

\begin{lemma}[]
	$ \cfl $ je uzavřena na levý/pravý kvocient s regulárním jazykem, tj.
	pro $ L \in \cfl $, $ L_R \in \L_R $ je \[
		L_R \backslash L \in \cfl \land L \slash L_R \in \cfl.
	\]
\end{lemma}

\begin{lemma}[]
	Nechť $ L \in \cfl $, $ L_R \in \L_R $. Pak \[
		L - L_R \in \cfl.
	\]
\end{lemma}

\begin{thm}[]
	$ \cfl $ není uzavřena na doplněk ani rozdíl.
\end{thm}

\begin{note}[]
	Programovací jazyky bývají $ \in \dcfl $.
\end{note}

\begin{thm}[]
	$ \dcfl $ je uzavřena na doplněk.
\end{thm}

\begin{note}[]
	$ \dcfl $ není uzavřena na homomorfismus, sjednocení.
\end{note}

\section{Turingovy stroje}

\begin{defi}[Turingův stroj, TM]
	\emph{Turingův stroj} je $ M = \left< Q, \Sigma, \Gamma, \delta, q_0, B, F \right> $, kde \begin{itemize}
		\item $ Q $ je konečná množina \emph{stavů},
		\item $ \Sigma $ je konečná neprázdná množina \emph{vstupních symbolů},
		\item $ \Gamma \supset \Sigma $ je konečná množina \emph{symbolů pro pásku}, $ Q \cap \Gamma = \emptyset $,
		\item $ \delta: \left( Q \setminus F \right)\times \Gamma \to Q \times \Gamma \times \left\{ \gets, \to \right\}  $ je \emph{přechodová funkce},
		\item $ q_0 \in Q $ je \emph{počáteční stav},
		\item $ B \in \Gamma \setminus \Sigma $ je \emph{defaultní symbol prázdné buňky},
		\item $ F \subseteq Q $ je množina \emph{koncových stavů}.
	\end{itemize}
\end{defi}

\begin{defi}[Konfigurace]
	\emph{Konfigurace} Turingova stroje $ M $ je $ X_1 \dots X_{i-1} q X_i X_{i+1} \dots X_n $, kde \begin{itemize}
		\item $ q $ je aktuální stav $ M $,
		\item $ X_j $ jsou znaky na pásce, kde všude kolem jsou znaky $ B $,
		\item $ X_i $ je symbol, který páska právě čte.
	\end{itemize}
\end{defi}

\begin{defi}[Krok]
	\emph{Krok} Turingova stroje $ M $ je $ \step_M $, kde pokud $ \fce \delta {q, X_i} = \left< p, Y, \gets \right> $, pak \[
		X_1 X_2 \dots X_{i-1} q X_i X_{i+1 } \dots X_n \step_M X_1 X_2 \dots X_{i-2} p X_{i-1} Y X_{i+1 } \dots X_n.
	\]
	Dále definujeme \emph{kroky} $ \steps_M $ jako transitivní uzávěr $ \step_M $.
\end{defi}

\begin{defi}[Přijímání jazyka]
	Turingův stroj $ M $ \emph{přijímá jazyk}  $ \fce LM $$ \equiv  $  \[
		\fce LM \deq \left\{ w \in \Sigma^*: q_0 w \steps_M \alpha p \beta \land p \in F \land \alpha, \beta \in \Gamma^* \right\}.
	\]
\end{defi}

\begin{defi}[Rekurzivně spočetný jazyk]
	Nechť $ L $ je jazyk.
	$ L $ je \emph{rekurzivně spočetný} $ \equiv $ existuje Turingův stroj $ M $, tž. \[
		L = \fce LM.
	\]
\end{defi}

\begin{defi}[Zastavení]
	Nechť $ M $ je Turingův stroj.
	$ M $ se \emph{zastaví} $ \equiv $ vstoupí do stavu $ q $, čte $ X $, a $ \left< q,X \right> \notin \dom \delta $.
\end{defi}

\begin{defi}[Rekurzivní jazyk]
	Nechť $ L $ je jazyk.
	$ L $ je \emph{rekurzivní} $ \equiv $ existuje Turingův stroj $ M $, tž. $ \fce LM = L $ a $ \forall w \in \Sigma^* $ se $ M $ zastaví.
	Říkáme, že $ M $ \emph{rozhoduje} jazyk $ L $.
\end{defi}

\begin{lemma}[]
	Nechť $ L_R \in \L_R $.
	Pak existuje Turingův stroj $ M $, který rozhoduje $ L_R $.
\end{lemma}

\begin{note}[]
	Lze zařídit, aby Turingův stroj měl více stop na pásce tím, že páska bude obsahovat dvojice.
\end{note}

\begin{thm}[Rekurzivní $ \L_0 $]
	Rekurzivní jazyky jsou právě $ \L_0 $.
\end{thm}

\begin{defi}[Vícepáskový Turingův stroj]
	Turingův stroj je \emph{vícepáskový} $ \equiv $ \begin{itemize}
		\item vstup je na první pásce, ostatní prázdné,
		\item první hlava začíná vlevo od vstupu, ostatní libovolně
		\item v každém kroku na každé pásce zapíšeme symbol, a hlava se může pohnout na každé pásce libovolným směrem.
	\end{itemize}
\end{defi}

\begin{thm}[]
	Každý jazyk přijímaný vícepáskovým Turingovým strojem je přijímaný i nějakým jednopáskovým Turingovým strojem.
\end{thm}

\begin{defi}[Nedeterministický Turingův stroj]
	\emph{Nedeterministický TM} je $ M= \left< Q, \Sigma, \delta, q_0, B,F \right> $, kde \begin{itemize}
		\item $ Q $ je konečná množina \emph{stavů},
		\item $ \Sigma $ je konečná neprázdná množina \emph{vstupních symbolů},
		\item $ \Gamma \supset \Sigma $ je konečná množina \emph{symbolů pro pásku}, $ Q \cap \Gamma = \emptyset $,
		\item $ \delta: \left( Q \setminus F \right)\times \Gamma \to \pot {Q \times \Gamma \times \left\{ \gets, \to \right\}}  $ je \emph{přechodová funkce},
		\item $ q_0 \in Q $ je \emph{počáteční stav},
		\item $ B \in \Gamma \setminus \Sigma $ je \emph{defaultní symbol prázdné buňky},
		\item $ F \subseteq Q $ je množina \emph{koncových stavů}.
	\end{itemize}
\end{defi}

\begin{defi}[Přijímání slova]
	Slovo $ w \in \Sigma^* $ je přijímáno nedeterministickým $ M $ $ \equiv  $ existuje nějaký výpočet $ q_0 w \steps_M \alpha p \beta $, kde $ p \in F $.
\end{defi}

\begin{thm}[]
	Nechť $ M_N $ je nedeterministický Turingův stroj.
	Pak existuje $ M_D $ deterministický Turingův stroj, tž. \[
		\fce L{M_N} = \fce L{M_D}.
	\]
\end{thm}

\section{Kontextové gramatiky}

\begin{defi}[Monotonní gramatika]
	Nechť $ G $ je gramatika.
	$ G $ je \emph{monotónní/nevypouštějící} $ \equiv $ \[
		\left( \forall \left( \alpha \to \beta \right) \in P \right)\! \left( \absolute{\alpha} \leq \absolute \beta \right).
	\]
\end{defi}

\begin{lemma}[]
	Nechť $ G $ je monotónní gramatika.
	Pak $ \left( \exists G' \in \cg \right)\! \left( \fce LG = \fce L{G'} \right) $.
\end{lemma}

\begin{defi}[LBA]
	\emph{Lineárně omezený automat (LBA)} je nedeterministický TM, kde na vstup je ohraničen $ \underline l, \underline r $,
	což jsou speciální symboly, které nelze přepsat, ani přeskočit.
\end{defi}

\begin{defi}[Přijímání LBA]
	Nechť $ M $ je LBA.
	Pak $ w \in \fce LM $ $ \equiv $ \[
		\left( \exists p \in F \right)\! \left( q_0\underline l w \underline r \steps_M \alpha p \beta \right).
	\]
\end{defi}

\begin{thm}[]
	Jazyky přijímané LBA jsou právě $ \fce L\cg $.
\end{thm}

\section{Rekurzivní, rekurzivně spočetné jazyky, rozhodnutelnost}

\begin{thm}[Kódování]
	Pro každý TM $ M $ existuje kódování do abecedy $ \left\{ 0,1 \right\} $.
	TM odpovídající kódování $ w $ budeme značit $ M_w $.
\end{thm}

\begin{defi}[Diagonální jazyk]
	Diagonální jazyk je $ L_d $: \[
		L_d \deq \left\{ w \in \left\{ 1,0 \right\}^* \suchthat w \notin \fce L{M_w} \right\}.
	\]
\end{defi}

\begin{thm}[]
	$ L_d $ není rekurzivně spočetný.
\end{thm}

\begin{defi}[Univerzální jazyk]
	Univerzální jazyk je $ L_u $: \[
		L_u \deq \left\{ \left< M,w \right> \suchthat w \in \fce LM \right\}.
	\]
\end{defi}

\begin{thm}[Postova]
	$ L $ i $ \overline L $ jsou rekurzivně spočetné $ \Longleftrightarrow $ $ L $ je rekurzivní.
\end{thm}

\begin{thm}[Nerozhodnutelnost univerzálního jazyka]
	$ L_u $ je rekurzivně spočetný, ale není rekurzivní.
\end{thm}

\begin{defi}[Problém]
	Problém je matematická struktura, resp. funkce $ P: T \subseteq \Sigma^* \to \left\{ 1,0 \right\} $.
	Na problémy se lze dívat i jako na jazyky, v tom případě máme na mysli $ \dom P $.
\end{defi}

\begin{defi}[Rozhodnutelný problém]
	Problém $ P $ je \emph{(algoritmicky) rozhodnutelný} $ \equiv $ existuje TM $ M $, který vždy zastaví a \[
		\left( \forall w \in \Sigma^* \right)\! \left( \fce LM \subseteq \dom P \land \fce Pw = 1 \leftrightarrow w \in \fce LM \right).
	\]
\end{defi}

\begin{lemma}[]
	Ne-prázdnost regulárního jazyka je rozhodnutelná.
\end{lemma}

\begin{lemma}[]
	Náležení slova do regulárního jazyka je rozhodnutelná.
\end{lemma}

\begin{defi}[Redukce]
	\emph{Redukce} problému $ P_1 $ na $ P_2 $ je algoritmus $ R: \dom P_1 \to \dom P_2 $, tž. \[
		\left( \forall w \in \dom P_1 \right)\! \left( \fce {P_1}w = \fce {P_2}{\fce Rw} \right).
	\]
\end{defi}

\begin{thm}[Redukce]
	Nechť $ P_1 $ a $ P_2 $ jsou problémy.
	Nechť $ R $ je redukce z $ P_1 $ na $ P_2 $.
	Pak \begin{itemize}
		\item $ P_1 $ je nerozhodnutelný $ \Rightarrow $ $ P_2 $ je nerozhodnutelný,
		\item $ P_1 $ není rekurzivně spočetný $ \Rightarrow $ $ P_2 $ není rekurzivně spočetný.
	\end{itemize}
\end{thm}

\begin{defi}[Problém zastavení]
	Problém zastavení je $ P_H $: \[
		\fce {P_H}{m,w} = \begin{cases}
			1 & \text{pokud } M_m \text{ zastaví na vstupu } w, \\
			0 & \text{jinak}.
		\end{cases}
	\]
\end{defi}

\begin{thm}[]
	$ P_H $ není rozhodnutelný.
\end{thm}

\begin{defi}[Prázdné stroje]
	Definujeme $ L_e \deq \left\{ w \suchthat \fce Lw = \emptyset \right\} $ a $ L_{ne} \deq \left\{ w \suchthat \fce Lw \neq \emptyset \right\} $.
\end{defi}

\begin{thm}[]
	$ L_{ne} $ je rekurzivně spočetný, ale není rekurzivní.
\end{thm}

\begin{defi}[Instance PCP]
	\emph{Instance Postova korespondenčního problému} nad abecedou $ \Sigma $ je dvojice $ \left< I,A,B \right> $, kde
	$ I $ je konečná množina indexů, $ A = \left( w_i \suchthat i \in I, w_i \in \Sigma^* \right) $ a $ B = \left( x_i \suchthat i \in I, x_i \in \Sigma^* \right) $.
\end{defi}

\begin{defi}[Řešení PCP]
	\emph{Řešení PCP} je posloupnost $ \left( i_j \right)_j \in I^* $, tž. \[
		w_{i_1} \cdot w_{i_2} \cdot \dots \cdot w_{i_k} = x_{i_1} \cdot x_{i_2} \cdot \dots \cdot x_{i_k}.
	\]
\end{defi}

\begin{defi}[Postův korespondenční problém]
	Samotný \emph{Postův korespondenční problém} je rozhodnout, zda daná instance má řešení.
\end{defi}

\begin{defi}[Částečné řešení]
	\emph{Částečné řešení PCP} je posloupnost indexů taková, že jeden z řetězců je prefixem druhého.
\end{defi}

\begin{lemma}[]
	Je-li posloupnost indexů řešením, pak každý její prefix je částečným řešením.
\end{lemma}

\begin{defi}[Modifikovaný Postův korespondenční problém]
	Nechť $ \left< I,A,B \right> $ je instance PCP.
	\emph{Modifikovaný Postův korespondenční problém} je rozhodnout, zda $ \left< I,A,B \right> $ má \emph{iniciální řešení}, tj. řešení, začínající indexem $ i_1 $.
\end{defi}

\begin{lemma}[]
	MPCP lze převést na PCP.
\end{lemma}

\begin{thm}[Nerozhodnutelnost PCP]
	PCP je algoritmicky nerozhodnutelný.
\end{thm}

\begin{cor}[]
	Je algoritmicky nerozhodnutelné, zda je bezkontextová gramatika víceznačná.
\end{cor}

\begin{cor}[]
	Nechť $ G_1, G_2 \in \cfg $. Nechť $ R \in \fce\rege\Sigma $.
	Pak následující jsou algoritmicky nerozhodnutelné:
	\begin{itemize}
		\item $ \fce L{G_1} \cap \fce L{G_2} = \emptyset $,
		\item $ \fce L{G_1}  = T^* $,
		\item $ \fce L{G_1} = \fce L{G_2} $,
		\item $ \fce L{G_1} = \fce L{R} $,
		\item $ \fce L{G_1} \subseteq \fce L{G_2} $,
		\item $ \fce L{R} \subseteq \fce L{G_1} $.
	\end{itemize}
\end{cor}

\end{document}





                </a></li>

<li><a href="https://gitlab.mff.cuni.cz/uradnikf/bc_lec/-/raw/master/2223l/aj/main.pdf">English exam -- ESP definitions}
\author{Filip Úradník}
\date{\today}

\input{template}
\input{color.tex}
\input{english.tex}

\begin{document}
\maketitle

\begin{defi}[Numbers]
	\
	\begin{enumerate}
		\item Imaginary Numbers
		\item Complex Numbers
		\item Real Numbers
		      \begin{enumerate}
			      \item Integers
			      \item Fractions -- Proper fractions, Mixed fractions, Improper fractions
		      \end{enumerate}
	\end{enumerate}
\end{defi}

\begin{notation}
	\
	\begin{itemize}
		\item \emph{approximately equal, similar} $ \equiv $ $ \approx $,
		\item a \emph{ray} $ \equiv $ $ \overrightarrow {AB} $.
	\end{itemize}
\end{notation}

\begin{defi}[Lines]
	\
	\begin{itemize}
		\item oblique $ \equiv $ a straight line that is niether horizontal nor vertical
	\end{itemize}
\end{defi}

\begin{defi}[Angles]
	An angle is \begin{itemize}
		\item \emph{acute} $ \equiv $ $ 0 < \alpha \leq \frac \pi 2 $,
		\item \emph{obtuse} $ \equiv $ $ \frac \pi 2 < \alpha \leq \pi $,
		\item \emph{reflex} $ \equiv $ $ \pi < \alpha \leq 2\pi $.
	\end{itemize}
	Two angles are \begin{itemize}
		\item \emph{complementary} $ \equiv $ $ \alpha + \beta = \frac \pi 2 $,
		\item \emph{supplementary} $ \equiv $ $ \alpha + \beta = \pi $.
	\end{itemize}
\end{defi}

\begin{notation}[Symbols]
	\
	\begin{itemize}
		\item $ \sgn x $ $ \equiv $ the \emph{sign} of $ x $,
	\end{itemize}
\end{notation}

\begin{defi}[Triangles]
	\
	\begin{itemize}
		\item \emph{acute-angled} $ \equiv $ all interior angles are acute,
		\item \emph{obtuse-angled} $ \equiv $ one interior angle is obtuse,
		\item \emph{scalene} $ \equiv $ no sides are equal,
		\item \emph{equilateral} $ \equiv $ all sides are equal,
		\item \emph{isosceles} $ \equiv $ two sides are equal,
		\item \emph{centroid}, or \emph{centre of gravity} $ \equiv $ těžiště,
		\item \emph{median} (of a triangle) $ \equiv $ těžnice,
		\item \emph{hypotenuse} $ \equiv $ the longest side of a right-angled triangle.
	\end{itemize}
\end{defi}

\begin{defi}[]
	\emph{Critical point} of a function is $ c $ $ \equiv $ $ \fce {f'}c = 0 $.
\end{defi}

\begin{defi}[Circle]
	\
	\begin{itemize}
		\item \emph{chord} $ \equiv $ a line segment whose endpoints both lie on the circle,
		\item \emph{diameter} $ \equiv $ a chord that passes through the centre of the circle,
		\item \emph{radius} $ \equiv $ a line segment joining the centre of the circle to any point on the circle itself,
		\item \emph{segment} $ \equiv $ a region of a circle which is bounded by a chord and the arc subtended by the chord,
		\item \emph{sector} $ \equiv $ a region of a circle bounded by two radii and the arc between them,
		\item \emph{semicircle} $ \equiv $ a region of a circle bounded by a diameter and the arc subtended by the diameter,
		\item \emph{tangent} $ \equiv $ a line that touches the circle at exactly one point, never entering the circle's interior,
		\item \emph{secant} $ \equiv $ a line that intersects a circle in two points.
	\end{itemize}
\end{defi}

\begin{defi}[Conic sections]
	\
	\begin{itemize}
		\item focus,
		\item directrix.
	\end{itemize}
\end{defi}

\begin{defi}[Plane figures]
	\
	\begin{itemize}
		\item $ n $-gon,
		\item regular $ n $-gon,
		\item kite
	\end{itemize}

	Convex quadrilaterals:
	\begin{itemize}
		\item trapezoids
		\item trapezia
		\item parallelograms
		      \begin{itemize}
			      \item rectangles
			      \item squares
			      \item rhombi
			      \item rhomboids
		      \end{itemize}
	\end{itemize}
	British:
	\begin{itemize}
		\item \emph{trapezium} $ \equiv $ has 2 parallel sides, no sides equal,
		\item \emph{trapezoid} $ \equiv $ no sides equal, no 2 sides parallel.
	\end{itemize}
\end{defi}

\begin{defi}[]
	\emph{Series:} posloupnost
\end{defi}

\begin{defi}[3D Figures]
	\
	\begin{itemize}
		\item sphere,
		\item cube,
		\item $ n $-hedron,
		\item $ x $ prism (triangular, $ n $-gonal, \dots),
		\item pyramid -- oblique, right,
		\item cylinder,
		\item cone -- oblique, right,
		\item \emph{frustum} $ \equiv $ part of a pyramid between the base and a plane parallel to the base,
		\item \emph{truncated $ x $} $ \equiv $ $ x $ with apex cut off, not necessairly parallel to the base.
	\end{itemize}
\end{defi}

\end{document}                 [In English]</a></li>

            </li>


            <li>2021/2022 summer
                
            </li>


            <li>2021/2022 summer
                <li><a href="https://gitlab.mff.cuni.cz/uradnikf/bc_lec/-/raw/master/2122l/prog/main.pdf">Programování 2}
\author{Filip Úradník}
\date{\today}

\input{template}
\input{czech_c}


\begin{document}
\maketitle

\section{Událostmi řízené programování}

\begin{defi}[Hierarchie obrazovky] \
  \begin{enumerate}
    \item Windows
    \begin{enumerate}
      \item Okna
      \begin{enumerate}
        \item Komponenty
        \begin{enumerate}
          \item Subkomponenty
          \item[] \indent $\ddots$
        \end{enumerate}
      \end{enumerate}
    \end{enumerate}
  \end{enumerate}
\end{defi}
\end{document                </a></li>

<li><a href="https://gitlab.mff.cuni.cz/uradnikf/bc_lec/-/raw/master/2122l/pcsys/main.pdf">Počítačové systémy}
\author{Filip Úradník}
\date{\today}

\input{template}
\input{czech_c}

\setlist[description]{labelindent=\parindent,font=\normalfont\itshape}


\begin{document}
\maketitle

\section{C, C++} % {{{

\begin{defi}[Vnitřní zarovnání]
	Když přistupuji k položce ve struktuře, musí začínat na adrese, která je násobkem její velikosti. Před ní se tedy dá mezera.
\end{defi}

\begin{defi}[Vnější zarovnání]
	Velikost struktury musí být násobkem největšího prvku. Doplní se tedy mezerami na konci.
\end{defi}

\begin{defi}[Pointer, reference]
	Pointer lze měnit, k hodnotě je třeba přistupovat přes operátor \texttt{*}, případně ve struktuře přes \texttt{->}. Reference je proměnná ukazující na stejný kus paměti, ale jinak se chová jako klasická proměnná.
\end{defi}

% }}}

\section{Procesor} %{{{

Podmínky cyklů se dělají až na konci cyklu. 

\begin{defi}[ISA]
	 \textit{ISA} definuje abstraktní procesor. 
	 \begin{itemize}
	 	\item Flagy
		\item Registry
		\item Instrukce, sémantiku instrukcí (\# parametrů)
		\item Zásobník, pokud je HW
	 \end{itemize}
\end{defi}

\begin{defi}[ABI]
	 \textit{ABI} definuje další informace o tom, jak by měl být procesor
	 používán. Například jak by měly být využívány registry, implementaci
	 stacku, konvence při volání funkcí.
\end{defi}

\begin{defi}[Příznaky - Flags]
  Pomocné informace instrukcí. 
  \begin{description}
    \item [Aritmetické]- někdy např. zvlášt pro znaménkové a bezznaménkové, aby procesor nemusel vědět s čím počítá.
    \item [Systémové]- pro vnitřní chod instrukcí, často nepřístupné programátorovi.
  \end{description}
\end{defi}

\begin{defi}[Klasicikace] \
  \begin{description}
    \item[CISC]- komplexní instrukce 
    \item[RISC]- jednoduché instrukce
    \item[VLIW]- dlouhá slova, která se načtou, a pak najednou vykonají - když je potřeba rychlost, např. switche
    \item[EPIC]- explicitně dáno, jaké instrukce se mají vykonávat paralelně
  \end{description}
\end{defi}

\begin{defi}[Typy instrukcí]
	\
	\begin{itemize}
		\item Load
		\item Store
		\item Move
		\item Aritmetické, logické
		\item jumps
		\begin{itemize}
			\item Direct: adresa konstantou
			\item Indirect: adresa registrem
			\item Relative: adresa relativní
		\end{itemize}
		\item Call, return
	\end{itemize}
\end{defi}

\begin{defi}[Typy registrů]
	\ 
	\begin{enumerate}
		\item General
		\item Integer, float, address, vector
		\item  Flag
		\item Predicate, application, system
	\end{enumerate}
\end{defi}

\begin{defi}[Aliasing]
	Některé registry se mohou částečně překrývat, např. x86: 64 bit vs 32 bit
\end{defi}

\begin{defi}[Ortogonalita architektury]
  Všechny instrukce umožnují práci s více registry, narozdíl od akumulátorových architektur.
\end{defi}

\begin{defi}[Load-Execute-Store architektura]
  Instrukce \textit{Load} a \textit{Store}, vše ostatní pracuje s registry (narozdíl od x86).
\end{defi}

\begin{defi}[MIPS]
	 \textit{MIPS} je téměř ortogonální, téměř RISC jednoduchý procesor, 31 registrů, LSE architektura.
\end{defi}

\begin{defi}[HW Architektura CPU] \
	\begin{itemize}
		\item Řadič paměti
		\item Cache (hierarchie)
		\item Jádra
		\begin{itemize}
			\item Registry
			\item Logické procesory: vykonávají instrukce paralelně
			\item Zakódování logiky instrukcí
		\end{itemize}
	\end{itemize}
\end{defi}

\begin{algo}[Pipeline]\
	Způsob zrychlení CPU. Vykonává fetch, decode, execute, memory, writeback
	pro více instrukcí najednou. Je třeba předpovídat budoucí chování kódu,
	jinak se musí práce zahodit a udělat znovu. Pomalý náběh, výběh. Typicky
	cca 14-20 stage.
\end{algo}

\begin{defi}[Superskalarita]
	V každé pipeline můžu mít až $n$ instrukcí. Pak je pipeline $n$-cestně superskalární. 

	Dnes obvykle $n \approx 5$.
\end{defi}

\begin{algo}[Out-of-order execution]\
	Instrukce se rozdělí na mikroinstrukce, pak přijdou do "bazénku", čekají,
	než se jim uvolní výkonná jednotka (správná pro daný typ instrukce).

	Na venek nesmí jít poznat že je to out-of-order.
\end{algo}

\begin{defi}[Reorder buffer]
	 \textit{Reorder buffer} zajišťuje opětovné seřazení po out-of-order execution.
\end{defi}

% }}}

\section{Paměti} %{{{

\begin{defi}[Slovo]
	 \textit{Slovo} je skupina bitů o dané velikosti. Každé slovo má
	 $n$-bitovou adresu. Dnes se používá téměř exkluzivně velikosti slova
	 8-bit: byte.
\end{defi}

\begin{defi}[Adresový prostor]
	 \textit{Adresový prostor} je 1D pole očíslované adresami.

	 Fyzicky realizováno 2D polem, adresa slova se dělí (bitově) na dvě části.
	 Změna řádku je pomalejší než sloupce, proto lepší sekvenční vyhledávání. 

	 Rychlost udává CAS: Column Access Strobe.
\end{defi}

\subsection{Reprezentace dat} % {{{

\begin{defi}[Dvojkový doplněk]
	$\mathbb{Z}$, jedna nula, používá se proto téměř exkluzivně.
\end{defi}

\begin{defi}[Floating point]
	Standard IEEE: single, double.
	
	Mantisa, exponent, znaménko. Hidden 1.

	Vnější formát, procesor má interní reprezentaci.
\end{defi}

\begin{defi}[Endianita]
	\
	\begin{itemize}
		\item Little endian: LSB first. Intel.
		\item Big endian: MSB first. Internet, zbytek procesorů.
	\end{itemize}
\end{defi}

% }}}

\subsection{Alokace paměti} % {{{

\begin{defi}[Práce s pamětí]
	Alokace $\to$ využití $\to$ free.
\end{defi}

\begin{defi}[Fragmentace]
	Vznikání kusů nevyužitelné paměti.
	\begin{itemize}
		\item Vnitřní: alokováno více, než je třeba.
		\item Vnější: alokované bloky mají mezi sebou nevyužitelné mezery.
	\end{itemize}
\end{defi}


\begin{algo}[Dynamická alokace paměti]\
	Potřeba udržení informace o volných blocích (spoják, bitmapa).

	Algoritmy:

	\begin{itemize}
		\item Best fit: projdu vše, najdu nejmenší možné místo. Fajn, ale pomalý a vytváří hodně malých bloků.
		\item Worst fit: projdu vše, najdu největší možné místo. Nepoužívá se.
		\item First fit: první volné místo. Zbytečná fragmentace.
		\item Next fit: jako First fit, ale začínám tam kde jsem posledně skončil.
		\item Buddy memory alloc: bloky o velikosti $2^N$, najdu $N$ nejmenší,
			podívám se, jestli mám přesně tak velký blok, když ne, rozdělím
			větší. Při free zase spojuji (buddies).
	\end{itemize}
\end{algo}

\begin{defi}[Dealokace]
	\
	\begin{itemize}
		\item Explicitní: C, C++
		\item Automatická: Garbage collector - nestávají se memory leaky, ale program je méně předvídatelný.
	\end{itemize}
\end{defi}

\begin{algo}[Garbage collection]
	\
	\begin{itemize}
		\item Tracing: test kam můžu přistoupit z živých objektů
		\item Reference counting: udržuji \# referencí na objekt
		\item Pokročilé metody
	\end{itemize}
\end{algo}

% }}}

\subsection{Cache} % {{{

\begin{defi}[Cache]
	\textit{Cache} je struktura (HW nebo i SW) na držení dat, aby k nim byl rychlejší přístup. V CPU hlavně zrychlují přístup do paměti. Nejprve se prochází cache vždy od nejrychlejší po nejpomalejší, až když v nich nenajdeme co chceme, jdeme do paměti. 

	Když dojde místo, stránkovací algoritmus vybere oběť, kterou vyhodí.

	Když data jsou v cache, nastává \textit{hit}, jinak \textit{miss}.
\end{defi}

\begin{defi}[Koherence cache]
	Všechna jádra musí mít stejné věci v paměti. Ale L1 a L2 cache jsou zvlášť
	pro každé jádro. Procesor musí tedy zajistit, aby měla k datům přístup i
	ostatní jádra.

	Protokol, který zajišťuje koherenci, se jmenuje \textit{MESI}.
\end{defi}

\begin{defi}[Asociativní paměť]
	Data jsou uložena jako dvojice \texttt{klíč: hodnota}. Asociativní paměť je rychlá, používá se často právě v CPU cache.

	Je implementovaná pomocí HW, odtud i omezená velikost.
\end{defi}

\subsection{Přístup k paměti multiprocesorů} % {{{

\begin{defi}[Symmetric multi-processing]
	Všechny části RAM pro všechny procesory jsou stejně rychlé. Implementace
	sběrnicí, tam je hodně kolizí když je hodně jader nebo moc procesorů.
\end{defi}

\begin{defi}[Non-uniform memory access]
	Každý procesor má k sobě připojenou RAM (dohromady je to NUMA uzel), zbytek přes ostatní procesory. 

	Nejrychlejší je jen část adresového prostoru (NUMA faktor: kolikrát je zbytek pomalejší).
\end{defi}

% }}}

% }}}

% }}}

\section{Programovací jazyky} % {{{

\begin{defi}[Překlad]
	 \textit{Překlad} se skládá z několika kroků:
	 \begin{itemize}
		 \item Preprocesor (nemusí) (\texttt{\#include})
		 \item Compiler (+ interface knihoven)
		 \item Assembler ($\to$ object)
		 \item Linker (vezme i objecty knihoven atd): relokace (přepočítání relativních adres)
	 \end{itemize}
\end{defi}

\begin{defi}[Knihovna]
	Soubor zdrojáků. Např. \texttt{stdin}.

	Statickou přeloží už linker, dynamická až za běhu (loaderem). Šetří paměť, ale žere čas a stabilitu.
\end{defi}

\begin{defi}[Loader]
	 \textit{Loader} je součástí OS. Načte program do paměti, provede relokace vůči umístění v paměti.
\end{defi}

\begin{defi}[Organizace paměti]
	\
	\begin{itemize}
		\item Kód (+ konstanty)
		\item Statická data (inicializovaná, neinicializovaná)
		\item Stack: lokální proměnné (různý pro každé vlákno)
		\item Heap: místo pro manuálně alokovanou paměť
	\end{itemize}
\end{defi}

\begin{defi}[Runtime]
	Podpora jazyka
	\begin{itemize}
		\item Statická: compiler, interface knihoven
		\item Dynamická: run-time program environment (organizace paměti,
			konstruktory globálních objektů,...), dynamické knihovny atd.
	\end{itemize}
\end{defi}

\begin{defi}[Aktivační záznam / Stack frame]
	Data jsou uložena na zásobník při volání funkce:
	\begin{itemize}
		\item Parametry, místo pro návratovou hodnotu (když vracím něco
			velkého) - C: připravuje caller
		\item Adresa na vrácení, adresa aktivačního záznamu volající funkce,
			saved machine status (některé registry musím obnovit)
		\item Lokální data, proměnné
	\end{itemize}
\end{defi}

\begin{defi}[Volací konvence]
	 \textit{Volací konvence} je informace o tom, jak má v daném jazyku na
	 daném procesoru vypadat volání funkcí:
	 \begin{itemize}
		\item Public name mangling (přetěžování funkcí)
		\item Housekeeping
		\item Předávání parametrů, return values
		\item Pořadí parametrů
		\item Jaké registry je třeba obnovit
	 \end{itemize}
\end{defi}

\begin{defi}[Předávání parametrů]
	 \textit{Předávání parametrů} se provádí:
	 \begin{itemize}
		 \item Hodnotou: parametr je lokální proměnná (C)
		 \item Referencí: předání pointeru, možnost IO parametrů (C++ pomocí \texttt{\&})
	 \end{itemize}
\end{defi}

\begin{defi}[Uložení proměnných] \
	\begin{itemize}
		\item ve statických datech (globální proměnné)
		\item Stack (lokální proměnné)
		\item Heap (dynamicky alokovaná data)
		\item Dictionary (Python, proměnné jako prvky slovníku)
	\end{itemize}
\end{defi}

\begin{defi}[Přenositelnost]
	\
	\begin{itemize}
		\item Architektura CPU: velikosti typů (fixní vs. jak to vyhovuje)
		\item Compiler: syntax a standardy stejné, detaily různé (gcc, clang, \dots)
		\item OS: různé volání systémových funkcí $\to$ podmíněný překlad pokročilejších věcí
	\end{itemize}
\end{defi}

\begin{defi}[Přenositelnost pomocí Virtual Machine]
	Způsob jak zajistit přenositelnost zabudovanou přímo do jazyků. Řeší se
	přes překlad do \textit{mezikódu}, což je binární forma nezávislá na
	konkrétním procesoru. Na každém stroji je pak nativně přeložen spouštěč
	mezikódů, \textit{Virtual Machine}, na kterém se interpretuje mezikód.

	Java: bytecode $\to$ JRE

	C\#: CIL $\to$ CLR

	Umožňují také kontrolu pomocí sandboxingu: VM kontrolují, jestli kód nedělá
	co nemá.
\end{defi}

\begin{algo}[Řešení problémů rychlosti VM]\
	\begin{itemize}
		\item JIT: Just in time - překlad mezikódu do nativního kódu za běhu.
		\item AOT: Ahead of time - překlad programu z mezikódu do nativního
			kódu při instalaci.
	\end{itemize}
\end{algo}

% }}}

\section{Operační systém} % {{{

\begin{defi}[Role operačního systému]
	\
	\begin{itemize}
		\item Abstraktní stroj: jádro zprostředkuje API na systémová volání, schovává komplexitu HW
		\item Správce prostředků: OS rozhoduje, kdy má kdo přístup k HW
	\end{itemize}
\end{defi}

\begin{defi}[Režimy CPU]
	\
	\begin{itemize}
		\item Uživatelský režim
		\item Systémový režim: plný přístup ke všem prostředkům.
	\end{itemize}

	Info o režimu je uloženo ve speciálním registru, k přechodu do systémového
	režimu existuje speciální instrukce která navíc skočí do předem určeného
	místa v kódu. Navíc jsou další registry kde se specifikuje např. číslo
	služby a další parametry. To je ale vše zabaleno do C rozhraní.
\end{defi}

\begin{defi}[Architektura jádra]
	\
	\begin{itemize}
		\item Monolitická: vstupní bod, pak už vše v sys. režimu, "switch".
			Efektivní, ale nelze nic schovat, původně nešlo ani rozšiřovat o
			další moduly.
		\item Vrstevnatá: na $n$ vstvě můžu používat jen $n-1$-vrstevné funkce.
		\item Microkernel: co nejvíc z kernel space do user space. Microkernel
			jen zajišťuje komunikaci mezi aplikacemi.
	\end{itemize}
\end{defi}

\begin{defi}[HAL]
	 \textit{Hardware Abstraction Layer} je součást kernelu specifická pro daný
	 procesor. Zbytek je univerzální.
\end{defi}

\subsection{Zařízení} % {{{

\begin{defi}[Device controller]
	\textit{Device controller / řadič} se stará o elektrické ovládání zařízení
	na sběrnici.
\end{defi}

\begin{defi}[Device driver]
	 \textit{Device driver / ovladač} je SW součást, která umožňuje komunikaci
	 se zařízení přes instrukce.
\end{defi}

\begin{defi}[Topologie]
	\
	\begin{itemize}
		\item Bus
		\item Ring
		\item Star: nevýhoda pro řadič: musí mít více konektorů, potřebuje umět
			paralelní komunikaci.
		\item Tree: transparentní huby.
	\end{itemize}
\end{defi}

\begin{algo}[Device handling]\
	User IO $\leftrightarrow$ Device in/dependent IO $\leftrightarrow$ Device controllers
\end{algo}

\begin{algo}[Komunikace se zařízením]\
	\begin{itemize}
		\item Polling: CPU aktivně periodicky sleduje jestli už jsou data ready.
		\item Interrupt: zařízení dá vědět CPU že je ready (IRQ handling), CPU
			má alespoň jeden port na IRQ. Pak se ze speciálního místa v
			paměťovém prostoru kopírují data tam kam je chceme.
		\item Direct Memory Access: navíc ještě DMA řadič, data se bez CPU
			kopírují mezi pamětí. Pak až přijde IRQ.
			\begin{itemize}
				\item Scatter: Distribuce paměti bez kopírování.
				\item Gather: Seskupení bloků paměti bez kopírování.
			\end{itemize}
	\end{itemize}
\end{algo}

\begin{defi}[Interrupt]
	 \textit{Interrupt} je způsob jak přerušit CPU a donutit ho chvíli
	 vykonávat něco jiného. Lze se vrátit zpátky. 
	 \begin{itemize}
		 \item Externí: od zařízení zvenku pomocí IRQ pinu. Dá se zamaskovat:
			 vypnout když je potřeba třeba přesné časování (jen Kernel mode).
		\item Exception: výjimka, někdy se stane, že je něco špatně, třeba
			neznámá instrukce, špatný vstup atd. CPU sám vyvolá interrupt.
			 Každý typ výjimky má fixně dané číslo.
		\begin{itemize}
			\item Trap: hlásí se až za instrukcí.
			\item Fault: není schopna doběhnout (ochrana, dělení nulou, \dots),
				dělá se rollback, interrupt se dělá "před" instrukcí.
		\end{itemize}
		\item Software: speciální instrukce, používá se na system call.
	 \end{itemize}
\end{defi}

\begin{defi}[IRQ controller]
	 \textit{IRQ controller} je součástka, která odstává interrupty a informuje
	 o nich CPU, k tomu přidá i číslo interruptu - to pozná podle toho, z
	 jakého pinu na něj IRQ přišel (mapování z pinů na čísla lze
	 naprogramovat).
\end{defi}

\begin{defi}[Interrupt table]
	Číselný prostor, kde mají všechny interrupty přiřazené číslo. 0-31 (na x86)
	jsou fixně výjimky, zbytek záleží na naprogramování IRQ controlleru.

	OS musí vědět pro každý interrupt (podle čísla) na jakou adresu skočit aby
	zavolal správný handler. Někdy fixní adresy, ale např. x86 má interrupt
	table, do kterého zaindexuje, odtamtud se dozví adresu. Interrupt table si
	vyplní na spuštění.
\end{defi}

\begin{algo}[Request handling]\
	\begin{algorithmic}[1]
		\State CPU vyhodnotí zdroj interruptu (přes IRQ controller)
		\State CPU zjistí adresu handleru
		\State změna do Kernel módu
		\State uložení současného stavu CPU
		\State proběhne Interrupt handler
		\State obnovení stavu CPU
		\State pokračování ve vykonávání instrukcí
	\end{algorithmic}
\end{algo}

% }}}

\subsection{Processing} % {{{

\begin{defi}[Program]
	 \textit{Program} je pasivní set instrukcí a dat vytvořený
	 linkerem/compilerem.
\end{defi}

\begin{defi}[Proces]
	\textit{Proces} je instance programu vytvořená OS, obsahuje navíc data
	(address space), vlastní další prostředky (spravované pomocí OS - např.
	paměť, otevřené soubory, zařízení atd. - když umře, tak se o ně musí OS
	postarat)
\end{defi}

\begin{defi}[Vlákno / thread]
	 \textit{Vlákno / thread} je instance, která obstarává vykonávání určité
	 části kódu. Drží kontext procesoru - kde se zrovna nachází v kódu, co má
	 v registrech, atd.
\end{defi}

\begin{defi}[Fiber]
	\textit{Fiber} je jiná jednotka plánování, CPU o nich neví, dobrovolně se
	vzdávají práva výpočtu ($\to$ kooperativní plánování).
\end{defi}

\begin{defi}[Scheduler]
	 \textit{Scheduler} je součást OS používající plánovací algoritmy, aby
	 umožnil vláknům pracovat.
\end{defi}

\begin{defi}[Multitasking]
	Vytvářím iluzi exekuce více procesů zároveň.
	\begin{itemize}
		\item kooperativní: všichni se po čase vzdají práva výpočtu a nechají
			jiný proces. Jednodušší, ale nerealistické.
		\item preemptivní: každá jednotka plánování má časový slot
			(time-slice), pak se přepne (vnější zdroj přerušení).
	\end{itemize}
\end{defi}

\begin{defi}[Multiprocessing]
	Více CPU na jednom systému. Složitější pro scheduler.
\end{defi}

\begin{defi}[Kontext]
	Stav procesoru za vykonávání určitého vlákna. Context switch je proces
	uložení a obnovení (výměny) kontextů dvou vláken.
\end{defi}

\begin{defi}[Real-time scheduling]
	 \textit{Real-time scheduling} je systém plánování procesů podle
	 \textit{release time} a \textit{deadline}.
	 \begin{itemize}
		\item Release time: čas, kdy proces musí začít, např. pro správné
			seřazení
		\item Deadline: čas, do kdy musí skončit
			\begin{itemize}
				\item Soft: když přetáhne, snižuje se hodnota výpočtu.
				\item Hard: když přetáhne, výpočet už je k ničemu.
			\end{itemize}
	 \end{itemize}
\end{defi}

\begin{defi}[Stavy jednotky plánování]
	\
	\begin{itemize}
		\item Vytvořena
		\item Připravena: čeká na naplánování
		\item Bežící: byla naplánovaná a vykonává se na nějakém jádře
		\item Blokována: např. čeká na paměť
		\item Ukončena / zombie: čeká se na vyzvednutí výsledků, odevzdání
			prostředků
	\end{itemize}
\end{defi}

\begin{defi}[Cíle plánování]
	\
	\begin{itemize}
		\item Maximalizace využití CPU
		\item Férová alokace CPU
		\item Maximalizovat \# ukončených procesů
		\item Minimalizovat čas běhu procesu
		\item Minimalizovat čas, který proces tráví ve stavu READY
		\item Minimalizovat čas odpovědi (interaktivní aplikace)
	\end{itemize}
\end{defi}

\begin{defi}[Priorita]
	Číslo přiřazeno procesu, které určuje, jak je důležitý. Zohledněna při
	plánování
	\begin{itemize}
		\item Statická: nastavena před startem procesu
		\item Dynamická: jednou za čas se inkrementuje všem READY procesům,
			když je proces spuštěn, spadne na 0
	\end{itemize}
	Celková priorita je součet statické a dynamické
\end{defi}

\begin{algo}[Kooperativní plánování]\
	\begin{itemize}
		\item First Come, First Serve: jednoduchá fronta
		\item Shortest Job First: seřazení podle očekávaného času dokončení
		\item Longest Job First
	\end{itemize}
\end{algo}

\begin{algo}[Preemptivní plánování]\
	\begin{itemize}
		\item Round Robin: jako FCFS
		\item Multi-level feedback queue: je více front, směrem dolů mají větší
			time-slice. Když končí time-slice, jednotka se hodí o frontu dolů
			nebo nahoru podle toho, jestli chtěla ještě počítat. Pak se bere z
			první fronty která má nezablokovaný proces. 
		\item Completely fair scheduler: RB strom indexován časem výpočtu,
			time-slice je počítán jako $\frac{\text{ čas čekání } }{\text{ \#
			procesů ve stromě } }$. Vždy se bere nejlevější proces (s nejnižším
			dosavadním časem výpočtu).
	\end{itemize}
\end{algo}

% }}}

\subsection{Souborové systémy} % {{{

\begin{defi}[Soubor]
	 \textit{Soubor} je kolekce relevantních informací, abstraktní stream dat.
	 Má operace \textit{open, close, read, write, seek}. 
\end{defi}

\begin{defi}[Adresář]
	 \textit{Adresář} je kolekce souborů. Efektivnost, organizovanost,
	 reprezentace speciálním typem souboru. Pamatuje si detaily o svých
	 souborech, jako přístupová práva. Operace \textit{list, search,
	 open/edit/delete/rename}.
\end{defi}

\begin{defi}[Souborový systém]
	 \textit{Souborový systém} udává způsob, jak jsou soubory uloženy. Operace
	 \textit{překlad jména, lokace souboru, uvolnění bloků}
	 \begin{itemize}
	 	\item Lokální: FAT, NTFS, ext4, BTRFS
		\item Síťové: NFS, SMB
	 \end{itemize}
\end{defi}

\begin{algo}[File Allocation Table]\
	Adresář má uloženy informace o souborech, soubory jsou uloženy jako spojový
	seznam po blocích (cca \texttt{4 KB}).
\end{algo}

\begin{algo}[Extended FS (2)]\
	Celý FS z bloků: 
	\begin{itemize}
		\item Superblock
		\item Descriptor
		\item Data bitmap
		\item Inode bitmap
		\item Inodes: 15, indirect (2x, 3x)
		\item Data
	\end{itemize}
\end{algo}

\begin{defi}[HDD]
	Stopa (track), sektory, plotna, blok (sektor na všech plotnách), cluster
	(stopa na všech plotnách)

	Hlavy jsou cca $5$ nm od sebe. Disky rotují cca 5-15 tisíc RPM.
\end{defi}

\begin{algo}[Disk scheduling]\
	Minimalizují $T_{\text{access} } \deq T_{\text{seek} } + T_{\text{rotation latency} } + T_{\text{transfer} }$
	\begin{itemize}
		\item FCFS: férový, jednoduchý, ale pomalý, protože vlastně nic
			neoptimalizuje
		\item Shortest Seek Time First: průměrně rychlejší, větší throughput,
			možnost vyhladovění requestu
		\item SCAN: princip výtahu, férovější, málo rozdílu v access time
		\item Circular SCAN: nové requesty bere jen jedním směrem
		\item LOOK: jako SCAN, ale nejede od začátku do konce, jen tam, kde
			zákazníci
		\item CLOOK: jako CSCAN
		\item FSCAN: dvě fronty, z jedné se bere SCAN, do druhé se přidává
	\end{itemize}
\end{algo}

% }}}

% }}}

\section{Virtuální paměť} % {{{

Přístupy do paměti z programů jsou ve virtuální paměti. Operační paměť
zprostředkovává fyzickou paměť. V procesoru je HW součást, Memory Management
Unit, která mapuje virtuální na fyzickou. Když to nejde, vyhodí Exception
(fault).

Mechanismy \textit{segmentace, stránkování}.

Může vytvořit iluzi více paměti než je k disposici. Pak toho může dosáhnout
pomocí např. SWAP paměti. Dále zajišťuje bezpečnost: separaci a práva (R-O
memory).

\begin{defi}[Segmentační tabulka]
	 \textit{Segmentační tabulka} je pole deskriptorů, její umístění je
	 definováno speciální instrukcí, u které se používá fyzická adresa.

	 Ukládá BPA (začátek ve fyzické adrese), délku a další atributy. Indexovaná
	 číslem segmentu.
\end{defi}

\begin{algo}[Segmentace]\
	Rozdělím PAS na segmenty, ty jsou očíslované, pak každá virtuální adresa má
	číslo segmentu a offset.  (číslování unikátní pro každý proces, např. jeden
	segment pro konstanty, \dots, tedy každý proces má svou segmentační
	tabulku)

	Při přístupu do paměti zkontroluji, jestli je platné číslo segmentu,
	offsetu, atd, pokud ano, přistoupí k fyzické adrese. 

	Když dojde místo (např. kvůli vnější fragmentaci), OS nějaký segment
	Přesune na SWAP a v segmentační tabulce nastaví present bit na $0$. 
\end{algo}

\begin{defi}[Stránkovací tabulka]
	 \textit{Stránkovací tabulka} je pole deskriptorů, její umístění je
	 definováno speciální instrukcí, u které se používá fyzická adresa.

	 Ukládá BPA (začátek ve fyzické adrese), délku a další atributy. Indexovaná
	 číslem segmentu.
\end{defi}

\begin{algo}[Stránkování]\
	Nechť $n \deq$ velikost offsetu, $N \deq \#$ bitů ve VA, $P \deq \#$ bitů v
	PA, $q \deq \#$ úrovní stránkování. 

	VAS je rozdělen na bloky -- stránky -- velikosti $2^n$. PAS rozdělen na
	bloky -- frame, rámce -- stejné velikosti jako stránky.

	Nejnižších $n-1$ bitů virtuální adresy je offset, dále je tam $q$ úrovní
	stránkování, každá úroveň o $\frac{n}{q}$ bitech. 

	Pro $i \deq \range{q}$ zaindexujeme do $i$-té tabulky, tam najdeme index
	začátku $i+1$ tabulky.  Index první tabulky známe, v poslední tabulce se
	nachází adresa začátku rámce v PAS. 

	Více-úrovňové stránkování umožňuje ušetřit paměť. Navíc, pro $q=2$ jsou
	stránky stejně velké jako rámce, tzn. není potřeba speciálně vymýšlet kam
	je vložit.

	Pro zrychlení se dále používá Translation Lookaside Buffer.
\end{algo}

\begin{algo}[Hledání oběti]\
	Snaha o vyměnění rámce, který bude nejdéle nepoužit.

	\begin{itemize}
		\item Hodiny: rámce v kruhu, jdu po kruhu, nuluju $A$, dokud nenajdu $A = 0$
		\item NRU: $A$ periodicky nuluju, $D$ nechávám. Pak vybírám náhodně z $A0D0,
			A0D1, A1D0, A1D1$, podle toho, co najdu první.
		\item LRU: vyhodím tu stránku, na kterou nejdéle nikdo nesáhl
			\begin{itemize}
				\item SW: zásobník -- při použití vytáhnu a dám nahoru, pak
					oběť vespod -- komplikované $\to$ aproximace (NFU)
				\item HW: cache, bit matrix
			\end{itemize}
		\item NFU: každý rámec má počítadlo, periodicky když $A=1$,
			inkrementuju a vynuluju $A$, navíc aging, nová stránka
			$\rightarrow$ max. skóre
	\end{itemize}
\end{algo}

\begin{defi}[Sdílená paměť]
	Více stránek ukazuje na jeden rámec.
\end{defi}

\begin{defi}[Memory-mapped soubory]
	VA neukazuje do paměti, ale do souboru. Čtení probíhají, když se rámec má
	brát z paměti, zápis probíhá při odstraňování rámce (např. když byl použit
	jako oběť), pomocí dirty bitů.

	Problém s natahováním velikosti souboru.
\end{defi}

% }}}

\section{Virtuální stroj} % {{{

\begin{defi}[Virtuální stroj]
	 \textit{Virtuální stroj} je emulace reálného počítače.
\end{defi}

\begin{defi}[Virtualizační vrstva]
	 \textit{Virtualizační vrstva} je speciální OS, který má za úkol vytvořit
	 iluzi komunikace s abstraktním HW.
\end{defi}

\begin{defi}[Plná virtualizace]
	\textit{Plná virtualizace} je vytvoření iluze, že procesy běží na odděleném
	stroji (s nějakým abstraktním HW).
\end{defi}

\begin{defi}[Container]
	\textit{Container} není plný virtuální stroj, je to virtualizace na úrovni
	OS (sdílený kernel)
\end{defi}

% }}}

\section{Paralelní programování} % {{{

\begin{defi}[Paralelní výpočet]
	Instrukce se vykonávají reálně současně.
\end{defi}

\begin{defi}[Konkurentní výpočet]
	Dochází ke střídání mezi výpočty.
\end{defi}

\subsection{Problémy} % {{{

\begin{defi}[Race condition]
	 \textit{Race condition} je situace, kdy výsledek výpočtu závisí na
	 plánování procesů.

	 Je potřeba zajistit, aby určité části kódu řešilo vždy jen jedno vlákno.
	 Této části kódu se říká \textit{kritická sekce} $\to$ synchronizace.
\end{defi}

\begin{defi}[Synchronizační primitivy]
	Způsob implementace synchronizace. 
	\begin{itemize}
		\item Aktivní: vlákno opakovaně zjišťuje jestli už může
		\item Pasivní: vlákno blokováno dokud nemůže (ale syscally jsou drahé)
	\end{itemize}

	HW implementace: atomické instrukce \textit{Test and Set Lock, aka. Compare
	And Swap}.
\end{defi}

\begin{algo}[Synchronizační primitivy]\
	\begin{itemize}
		\item Spin-lock: aktivní čekání pomocí TSL/CAS
		\item Semafor: counter určující, kolik procesů může být v dané sekci
			najednou, ostatní čekají ve frontě
		\item Mutex: semafor s counter $= 1$
		\item Bariéra: stanovený počet vláken, které na sebe mají počkat na
			bariéře v kódu
		\item Monitor: zámek implementovaný jazykem, např. Java: \texttt{synchronized}
	\end{itemize}
\end{algo}

\begin{defi}[Problémy SP]
	\
	\begin{itemize}
		\item Deadlock: kružnice v grafu vlastnictví. Podmínky:
			\begin{itemize}
				\item Alespoň jeden proces běží v zamčeném režimu
				\item Vlákno už má jeden zámek a žádá o další
				\item Nelze odebrat zámek vláknu bez problémů
				\item Kruh
			\end{itemize}
		\item Producer-consumer: ve skladu dojde místo? p i c přijedou
			najednou? Musím opatrně některé konce blokovat.
		\item Dining philosophers: pozor na zacyklení v blokování-odblokování
		\item Sleeping barber

	\end{itemize}
\end{defi}



% }}}

% }}}

\end{document                </a></li>

<li><a href="https://gitlab.mff.cuni.cz/uradnikf/bc_lec/-/raw/master/2122l/matalyza/main.pdf">Matematická analýza}
\author{Filip Úradník}
\date{\today}

\input{template}
\input{czech_c}


\begin{document}
\maketitle
% }}}

\section{Množiny} % {{{

\begin{defi}[Horní a dolní závora množiny]
	 \textit{Horní a dolní závora množiny} 
\end{defi}

\begin{defi}[Shora, zdola omezená množina]
	 \textit{Shora, zdola omezená množina} 
\end{defi}

\begin{defi}[Spočetná množina]
	 \textit{Spočetná množina} 
\end{defi}

\begin{thm}[Hustota $\mathbb{Q}$]
	
\end{thm}

\begin{thm}[Nespočetnost $\R$]
	
\end{thm}

\begin{defi}[Metrický prostor]
	 \textit{Metrický prostor} 
\end{defi}

\begin{thm}[Bernoulliho nerovnost]
	\[
		(1+x)^n \geq 1+nx
	\]
	
	
\end{thm}

\begin{defi}[Vlastní, nevlastní limita posloupnosti]
	 \textit{Vlastní, nevlastní limita posloupnosti} 
\end{defi}

\begin{thm}[Aritmetika limit]
	Pokud jsou pravé strany definovány:
	\begin{itemize}
		\item $\lim_{n \to \infty} a_nb_n = AB$
		\item $\lim_{n \to \infty} a_n+b_n = A+B$
		\item $\lim_{n \to \infty} a_n/b_n = A/B$ (navíc pokud $b_n$ od nějakého bodu už není 0)
	\end{itemize}
\end{thm}

\begin{thm}[Násobení limitní nulou]
	Pro $a_n$ omezenou a $b_n$ limitně $0$:
	\[
		\lim_{n \to \infty} a_nb_n = 0
	\]
\end{thm}

\begin{thm}[Limita a uspořádání]
	\
	\begin{enumerate}
		\item \[
			A < B \Rightarrow \exists n_0: \forall n > n_0: a_n < b_n
		\]
		\item \[
			a_n \leq b_n \forall n > n_0 \Rightarrow A \leq B
		\]
	\end{enumerate}
\end{thm}

\begin{thm}[Policajti]
	Pro $a_n, b_n: \lim_{n \to \infty} a_n = \lim_{n \to \infty} b_n \; c_n$:
	\[
		\forall n: a_n \geq c_n \geq b_n \Leftarrow \lim_{n \to \infty} c_n = \lim_{n \to \infty} a_n
	\]
	Pro nevlastní limity stačí jen jeden policajt.
\end{thm}

\begin{defi}[Konvergence, divergence posloupnosti]
	 \textit{Konvergence, divergence posloupnosti} 
\end{defi}

\begin{defi}[Shora, zdola omezená posloupnost]
	 \textit{Shora, zdola omezená posloupnost} 
\end{defi}

\begin{defi}[Podposloupnost]
	 \textit{Podposloupnost} 
\end{defi}

\begin{defi}[Hromadné body posloupnosti, limes sup/inf]
	 \textit{Hromadné body posloupnosti, limes sup/inf} 
\end{defi}

\begin{thm}[Monotónní podposloupnost]
	$ \forall a_n$ má monotonní podposloupnost.
\end{thm}

\begin{thm}[Bolzanova-Weierstrassova]
	$ \forall $ omezená posloupnost má konvergující podposloupnost.
\end{thm}

\begin{defi}[Řada, součet řady]
	 \textit{Řada, součet řady} 
\end{defi}

\begin{defi}[Konvergence/divergence řady]
	 \textit{Konvergence/divergence řady} 
\end{defi}

\begin{thm}[Nutná podmínka konvergence]
	
\end{thm}

\begin{thm}[Srovnávací kritérium]
	Pro $0 \leq a_n \leq b_n$:
	\[
		\sum b_n \text{ konverguje } \Rightarrow \sum a_n \text{ konverguje } 
	\]
	\[
		\sum a_n \text{ diverguje } \Rightarrow \sum b_n \text{ diverguje } 
	\]
\end{thm}

% }}}

% Funkce {{{
\section{Funkce}
\begin{defi}[Vlastnosti funkcí]\ Pro funkci $f: M \rightarrow \mathbb{R}$ platí, že $f$ je:
\begin{enumerate}
  \item shora omezená $\equiv \exists K \in \mathbb{R}: \forall x \in M: f(x) < K $
  \item zdola omezená $\equiv \exists K \in \mathbb{R}: \forall x \in M: f(x) > K $
  \item omezená $\equiv$ je omezená zdola i shora
  \item rostoucí $\equiv \forall x,y: x<y \Rightarrow f(x) < f(y)$
  \item neklesající $\equiv \forall x,y: x<y \Rightarrow f(x) \leq f(y)$
  \item klesající $\equiv \forall x,y: x<y \Rightarrow f(x) > f(y)$
  \item nerostoucí $\equiv \forall x,y: x<y \Rightarrow f(x) \geq f(y)$
  \item monotonní $\equiv$ je nerostoucí nebo neklesající
  \item periodická $\equiv \exists P: \forall x: f(x) = f(x+P)$
  \item prostá $\equiv \forall x,y: x \neq y \Rightarrow f(x) \neq f(y)$
  \item sudá $\equiv \forall x: f(x) = f(-x)$
  \item lichá $\equiv \forall x: f(x) = -f(-x)$ 
\end{enumerate}
\end{defi}
\begin{defi}[Inverzní fce]
  $f^{\langle -1 \rangle}$ je \textit{invezní} k fci $f \equiv \forall x,y: f(x) = y \Leftrightarrow f^{\langle -1 \rangle}(y) = x $
  Pro neprosté funkce vybereme jen prostý interval z jejich $D_f$.
\end{defi}

% Exponenciální funkce {{{
\subsection{Exponenciální funkce}

\begin{defi}[Exponenciála] \
  \begin{itemize}
    \item $e^x = \exp(x) := \sum_{n=0}^{\infty}\frac{x^n}{n!}$
    \item Eulerovo číslo $e := \exp(1)$ 
  \end{itemize}
\end{defi}
\begin{thm}[Vlastnosti exponenciály] \
  \begin{enumerate}
    \item $\exp(x+y) = \exp(x)\exp(y)$
    \item $\exp(-x) = \frac{1}{\exp(x)}$
    \item $\forall x \in \mathbb{R}: \exp(x) > 0$
    \item $\forall x < 0: \exp(x) < 1 $
    \item $\exp(x)$ je rostoucí na $\mathbb{R}$
    \item $\lim_{n \rightarrow \infty}\exp(n) = +\infty$
    \item $\lim_{n \rightarrow -\infty}\exp(n) = 0$
  \end{enumerate}
\end{thm}
\begin{defi}[Logaritmus]
  Pro $x > 0$ definujeme $\ln(x) := \exp^{\langle -1 \rangle}(x)$
\end{defi}
\begin{defi}[Logaritmus o základu $b$] 
  Pro $b \in \mathbb{R}^+ \ \{1\}$ definujeme $\log_b(x) := \frac{\ln(x)}{\ln(a)}$ jako inverzi k $b^x$
\end{defi}
% }}}

% Goniometrické funkce {{{
\subsection{Goniometrické funkce}
\begin{defi}[Goniometrické funkce]\
  \begin{itemize}
    \item $\sin(x) = \sum^\infty_{n=0}\frac{(-1)^{n}x^{2n+1}}{(2n+1)!}$
    \item $\cos(x) = \sum^\infty_{n=0}\frac{(-1)^{n}x^{2n}}{(2n)!}$
    \item $\tan(x) = \frac{\sin(x)}{\cos(x)}$
    \item $\cot(x) = \frac{\cos(x)}{\sin(x)}$
  \end{itemize}
\end{defi}
\begin{defi}[Cyklometrické funkce]\
  \begin{itemize}
    \item $\arcsin(x) = \sin^{\langle -1 \rangle}(x)$ s hodnotami $x \in [-1, 1] \rightarrow [-\frac{\pi}{2}, \frac{\pi}{2}]$
    \item $\arccos(x) = \cos^{\langle -1 \rangle}(x)$ s hodnotami $[-1, 1] \rightarrow [0, \pi]$
    \item $\arctan(x) = \tan^{\langle -1 \rangle}(x)$ s hodnotami $\mathbb{R} \rightarrow \left(\frac{-\pi}{2}, \frac{\pi}{2}\right)$
  \end{itemize}
\end{defi}
% }}}
% }}}

% Okolí {{{
\section{Okolí}

\begin{defi}[Okolí bodu] \
  \begin{itemize}
    \item \textit{$\delta$ okolí} bodu $a \in \mathbb{R}$ pro $\delta > 0 $ je funkce $U(a,\delta) := \left(a-\delta, a+\delta\right) =\{x \in \mathbb{R}, |x-a| < \delta \}$ 
    \item \textit{okolí} $\pm \infty$ pro $\delta > 0 $ definujeme jako $U(+\infty, \delta) := (\frac{1}{\delta}, +\infty)$, $U(-\infty, \delta) := (-\infty, -\frac{1}{\delta})$
    \item \textit{pravé okolí} bodu $a \in \mathbb{R}$ pro $\delta > 0 $ je funkce $U^+(a,\delta) := \left[a, a+\delta\right)$ 
    \item \textit{levé okolí} bodu $a \in \mathbb{R}$ pro $\delta > 0 $ je funkce $U^-(a,\delta) := \left(a-\delta, a\right]$ 
    \item \textit{prstencová okolí} bodu $a \in \mathbb{R}$ jsou klasická okolí bez bodu $a$, např. $P(a, \delta) \deq U(a, \delta) \backslash \{a\}$ 
  \end{itemize}
\end{defi}
\begin{defi}[Limita funkce] $A \in \mathbb{R}^*$:
  $$\lim_{x \rightarrow a}f(x) = A \Leftrightarrow \forall \varepsilon > 0\; \exists \delta > 0: x \in P(a, \delta) \Rightarrow f(x) \in U(A, \varepsilon)$$
\end{defi}

\begin{defi}[Limita zleva, zprava] 
  $$\lim_{x \rightarrow a^{-}}f(x) = A \Leftrightarrow \forall \varepsilon > 0\; \exists \delta > 0: x \in P^{-}(a, \delta) \Rightarrow f(x) \in U(A, \varepsilon)$$
  $$\lim_{x \rightarrow a^{+}}f(x) = A \Leftrightarrow \forall \varepsilon > 0\; \exists \delta > 0: x \in P^{+}(a, \delta) \Rightarrow f(x) \in U(A, \varepsilon)$$
  $$\exists \lim_{x \rightarrow a}f(x) \Leftrightarrow \lim_{x \rightarrow a^{-}}f(x) = \lim_{x \rightarrow a^{+}}f(x)$$
\end{defi}

\begin{thm}[Jednoznačnost limity fce]
  $\forall f\; \exists$ nanejvýš jedna limita v daném bodě.
\end{thm}
\begin{proof}
  Sporem nechť $A \neq B$ jsou limity $f$ v bodě $a$. Pak stačí zvolit $\varepsilon < |\frac{B-A}{2}|$. Dostaneme spor s definicí.
\end{proof}

\begin{thm}[Heineho definice limity] Nechť $f$ je funkce definovaná na prstencovém okolí $P(b,\Delta)$ bodu $b \in \mathbb{R}^*$ pro nějaké $\Delta > 0$. Pak
  $$ \lim_{x \rightarrow b} f(x) = L \Leftrightarrow \forall \text{ posloupnost } (x_n) \subseteq P(b, \Delta): \lim_{n \rightarrow \infty}(x_n) = b
  \Rightarrow \lim_{n \rightarrow \infty}f(x_n) = L
  $$

\end{thm}

\begin{cor}[Heineho definice limity]
  Spoustu vět posloupností lze přepsat jako věty o limitách funkcí:
  \begin{itemize}
    \item Aritmetika limit funkcí
  \end{itemize}
\end{cor}

\begin{thm}[Limity funkcí a uspořádání] Pro funkce $f, g, h$ definované na $P(c, \delta):$
  \begin{enumerate}
    \item $\lim_{x \rightarrow c}f(x) < \lim_{x \rightarrow c}g(x) \Rightarrow \exists \delta > 0: f(x) < g(x)\; \forall x \in P(c,\delta)$
    \item $\exists \delta > 0: f(x) \geq g(x) \; \forall x \in P(c,\delta) \Rightarrow \lim_{x \rightarrow c}f(x) \geq \lim_{x \rightarrow c}g(x)$ 
    \item $\exists \delta > 0: \forall x \in P(c, \delta): f(x) \leq h(x) \leq g(x) \land  \lim_{x \rightarrow c}f(x) = \lim_{x \rightarrow c}g(x) = A \Rightarrow \lim_{x \rightarrow c} h(x) = A$
  \end{enumerate}
\end{thm}
\begin{thm}[Limita monotónní funkce]
  Pro $a < b \in \R: f$ je na $(a, b)$ monotonní:
  $$ \exists \lim_{x \rightarrow a^+}f(x) \land \exists \lim_{x \rightarrow b^-}f(x)$$ 
\end{thm}

\begin{defi}[Spojitost]
  Funkce $f$ je v bodě $a$ \textit{spojitá} $\equiv$
  $$f(a) = \lim_{x \rightarrow a}f(x)$$
\end{defi}

\begin{defi}[Spojitost zleva]
  Funkce $f$ je v bodě $a$ \textit{spojitá zleva} $\equiv$
  $$f(a) = \lim_{x \rightarrow a^-}f(x)$$
\end{defi}

\begin{defi}[Spojitost zprava]
  Funkce $f$ je v bodě $a$ \textit{spojitá zprava} $\equiv$
  $$f(a) = \lim_{x \rightarrow a^+}f(x)$$
\end{defi}

\begin{thm}[Limita složené funkce]
  Pro $A, B, C \in \R^*$, $f(x): \lim_{x \rightarrow A}g(x) = B$,$f(x): \lim_{x \rightarrow B}f(x) = C$:
  $$ f(x) \text{ je spojitá v } B \lor B \notin g(P(A, \eta)) \Rightarrow \lim_{x \rightarrow A}f(g(x)) = C$$
\end{thm}

\begin{defi}[Asymptotická notace]\
  \begin{enumerate}
    \item $f \in \O{g} \equiv \forall \delta > 0, x \in P(a,\delta): |f(x)| < cg(x)$
    \item $f \in \o{g} \equiv lim_{x \rightarrow a}\frac{f(x)}{g(x)} = \infty$
  \end{enumerate}
\end{defi}

\begin{defi}[Vnitřní, krajní bod]
  Vnitřní bod je bod, který v intervalu leží i s okolím. Krajní bod je bod, který není vnitřní.
\end{defi}

\begin{defi}[Spojitost funkce na intervalu]
  Funkce $f$ je spojitá na intervalu $I \Leftrightarrow$ je spojitá na všech jeho vnitřních bodech, a v krajních bodech jednostranně spojitá odpovídajícím způsobem.
\end{defi}

\begin{thm}[Darbouxova]
  Nechť $a < b \in \R$ a $f: \left[a,b\right] \rightarrow \R$ je na intervalu $\left[a,b\right]$ spojitá. Pak pro $m \deq \min{f(a), f(b)}, M \deq \max{f(a), f(b)}:$
  $$ \forall y \in \left[m, M\right] \exists \alpha \in \left[a, b\right]: f(\alpha) = y$$
\end{thm}
\begin{cor}
  Obraz intervalu je opět interval.
\end{cor}

\begin{cor}[Obraz inverzní funkce]
  Pro $f$ spojitou a prostou na intervalu $I$: $f^{\langle -1 \rangle}$ je také spojitá.
\end{cor}

% extrémy{{{
\begin{defi}[Extrémy]
  \ \begin{description}
    \item[minimum] $\equiv \forall x \in M: f(x) \geq f(a)$ 
    \item[maximum] $\equiv \forall x \in M: f(x) \leq f(a)$
    \item[ostré minimum] $\equiv \forall x \in M \backslash \{a\}: f(x) > f(a)$  
    \item[ostré maximum] $\equiv \forall x \in M \backslash \{a\}: f(x) < f(a)$
    \item[lokální minimum] $\equiv \exists \delta > 0 : \forall x \in M \cap U^+(a,\delta): f(x) \geq f(a)$ 
    \item[lokální maximum] $\equiv \exists \delta > 0 : \forall x \in M \cap U^+(a,\delta): f(x) \leq f(a)$
    \item[ostré lokální minimum] $\equiv \exists \delta > 0 : \forall x \in M \cap P^+(a,\delta): f(x) > f(a)$ 
    \item[ostré lokální maximum] $\equiv \exists \delta > 0 : \forall x \in M \cap P^+(a,\delta): f(x) < f(a)$
  \end{description}
\end{defi}
%}}}

\begin{thm}[Princip maxima]
  Pro $a \leq b \in \R$ a $f: \arr{a, b} \rightarrow \R$ je spojitá: $f$ na $\left[a, b\right]$ nabývá maxima i minima.
\end{thm}
% }}}

% Metrické prostory {{{
\section{Metrické prostory}
\begin{defi}[Limita a spojitost v metrických prostorech]
  \begin{align*}
    U_M(a, \delta) = \{x \in M | d(a,x) < \delta\} \
    P_M(a, \delta) = U_M(a, \delta) \backslash \{a\}
  \end{align*}
  Pro $(M, d), (N, e)$ dva metrické prostory má $f: M \rightarrow N$ v bodě $a \in M$ limitu $A \in N \Leftrightarrow$ 
  $$\forall \varepsilon >0 \; \exists \delta >0 : f(P_M(a,\delta)) \subseteq U_N(A, \varepsilon)$$
\end{defi}

\begin{defi}[Kompaktní množina v $\R^n$]
  $M \subset \R^n$ je 
  \begin{description}
    \item[omezená] $\Leftrightarrow\exists a \in \R^n, r > 0: M \subseteq U(a,r)$
    \item[otevřená]$ \Leftrightarrow \forall a \in M \exists \delta > 0: U(a, \delta) \subseteq M$
    \item[uzavřená]$ \Leftrightarrow\R^n \backslash M$ je \textit{otevřená}
  \end{description}
\end{defi}

% TODO: derivace zápis <11-04-22, tmq> %

\begin{thm}[Nutná podmínka pro lokální extrém]
	Pokud $f$ nemá v bodě nulovou derivaci a ta derivace v tom bodě existuje, nenabývá v něm extrém.
\end{thm}

\begin{thm}[Rollerova věta]
	Pro $f:$ \[ \exists a,b:
	f(a) = f(b) \Rightarrow \exists c \in \left( a,b \right): f'(c) = 0
	\]
\end{thm}

\begin{thm}[Lagrangeova o střední hodnotě]
	Pro $f$ definovanou na $\langle a, b \rangle$ platí, že $\exists c \in \left( a,b \right) $,
	tž. $f'(c) = \frac{f(b) - f(a)}{b-a}$.
\end{thm}

\begin{thm}[]
	Pro $J \subseteq \R$ nedegenerovaný interval, funkci $f: J \to \R$ spojitou na $J$ a $f'$
	existuje na každém bodě $J$. Pokud $\forall x \in J: f'(x) >/\geq/</\leq$, pak $f$ je na $J$
	rostoucí/neklesající/klesající/nerostoucí.
\end{thm}

\begin{defi}[Derivace vyššího řádu]
	Derivace derivace.
\end{defi}

\begin{defi}[Konkávnost, konvexnost]
	Konvexní, konkávní, ryze konvexní/konkávní,
	podle toho, jestli body leží nad/pod sečnou.
\end{defi}

\begin{thm}[Konvexnost, konkávnost a druhá derivace]
	Pro $I \subseteq \R$ otevřený interval, funkci $f$ s druhou derivací definovanou 
	na $I$:
	$f''$ kladná, nezáporná, záporná, nekladná $\Rightarrow$ ryze konvexní, konvexní, ryze konkávní, konkávní.
\end{thm}

\begin{thm}[Spojitost v krajním bodě]
	Pro $I$ jednostranný interval, $f$ spojitou v $a$ krajním bodě $I$
	\[
		\lim_{x \to a^+}  f'(x) = A \in \R* \Rightarrow f'_+(a) = A 
	\]
\end{thm}

% }}}

% Taylor {{{

\begin{defi}[Taylorův polynom]
	Pro $a \in \R, n \in \N_0, f$ s derivací na okolí $a$, vlastní $n$-tou derivací v $a$
	Pokud $n = 0$, předpokládejme i spojitost $f$ v $a$. Pak \textit{Taylorův polynom}
	řádu $n$ funkce $f$ v bodě $a$ je
	\[
		T_n^{f,a} \deq \sum_{i=0}^{n} \frac{f^{(i)}(a)}{i!} (x-a)^i
	\]
\end{defi}

\begin{thm}[Charakterizace Taylorova polynomu]
	Nechť $f$ má Taylorův polynom řádu $n \in \N_0$ v bodě $a \in \R$. 
	Pak $T(x) = T_n^{f,a}(x)$ je jediný polynom stupně nejvýše $n$ s vlastností
	\[
		\lim_{x \to a} \frac{f(x) - T(x)}{\left( x-a \right)^n} = 0 
	\]
\end{thm}

\begin{lemma}
	Nechť $a \in \R, Q$ polynom stupně nejvýše $n$ takový, že $\lim_{x \to a} \frac
	{Q(x)}{\left( x-a \right) ^n} = 0$. 

	Pak $Q$ je identicky nulový polynom.
\end{lemma}

\begin{thm}[Lagrangeův odhad zbytku]
	Nechť $f$ má na otevřeném intervalu $I \subseteq \R$ vlastní derivaci řádu $n+1$.
	Pak pro $a \neq b \in I \exists c \in \left( a,b \right) $, tž:
	\[
		R_n^{f,a}(b) = \frac{f^{(n+1)}(c)}{\left( n+1 \right) !}\left( b-a \right) ^{n+1}
	\]
	Speciálně pro $M \in \R$, kde $\forall x \in \left( a,b \right) : 
	\absolute{f^{(n+1)}(x)} \leq M:$
	\[
		\absolute{R_n^{f,a}(b)} \leq \frac{M}{(n+1)!}\absolute{b-a}^{n+1}
	\]
	
\end{thm}

\begin{defi}[Taylorova řada]
	Nechť $f$ má v bodě $a$ derivace všech řádů. Pak její \textit{Taylorova řada se středem v $a$} je
	\[
		T^{f,a}(x) = T_{\infty}^{f,a}(x).
	\]
	
\end{defi}

% }}}

% Primitivní fce {{{

\section{Primitivní funkce}

\begin{defi}[Primitivní funkce]
	Pro $f$ definovanou na $\left( a,b \right), -\infty < a < b <\infty$ je $F$
	primitivní fukce, pokud platí \[
		\forall x: F'(x) = f(x)
	\]
\end{defi}

\begin{thm}[Jednoznačnost až na konstantu]
	Je-li $F$ primitivní funkce k $f$, pak $F+c$ je také primitivní funkce. 
	Jsou-li $F, G$ primitivní funkce k $f$, pak $\exists c: F-G = c$
\end{thm}

\begin{thm}[Spojitost a primitivní funkce]
	\begin{itemize}
		\item Pokud k $f$ existuje primitivní funkce, je vždy spojitá na celém $D_F$.
		\item Ne vždy ale musí $F$ existovat. 
		\item Spojitost $f$ není nutnou podmínkou existence $F$.
	\end{itemize}
\end{thm}

\begin{thm}[Postačující podmínka]
	Pro $I$ neprázdný interval a $f: I \to \R:$ 
	\[
		f \text{ je spojitá} \Rightarrow \text{má primitivní funkci}
	\]
\end{thm}

\begin{thm}[Nutná podmínka]
	$\forall f:$ \[
		f \text{ má primitivní funkci} \Rightarrow \forall I \text{ intervaly}: f(I) \text{ je také interval}
	\]
	
\end{thm}

\begin{thm}[]
	\[
		 \int \alpha f(x) + \beta g(x) \,dx = \alpha \int_{}^{} f(x) \,dx + \beta \int_{}^{} g(x) \,dx
	\]
\end{thm}

\begin{thm}[O substituci]
	\[
		\int_{}^{} f(\varphi(x))\varphi'(x) \,dx = F(\varphi(x)) + c
	\]
\end{thm}

\begin{thm}[Per Partes]
	Pro $f,g$ a $F,G$ jejich primitivní fce na $\left( a,b \right) $ platí, že $ Fg, fG$ jsou spojité a
	\[
		\int_{}^{} f(x)G(x) \,dx = F(x)G(x) - \int_{}^{} F(x)g(x) \,dx
	\]
\end{thm}

% }}}

% Určitý integrál {{{
\section{Určitý integrál}

\begin{defi}[Newtonův integrál]
	Nechť $f: (a,b) \to \R$. Pak $f$ má na $\left( a,b \right) $ \textit{Newtonův integrál} $\equiv$ \[
		\left( \exists F: \left( a,b \right) \to \R \right)   \land \left( F\! \left( a^+ \right) = \lim_{x \to a^+} F\! \left( x \right) \in \R \right)  \land
		\left( 		F\! \left( b^- \right) = \lim_{x \to b^-} F\! \left( x \right) \in \R  \right) 
	\]
	Dále: \[
		\left[ F \right] ^b_a \deq F \! \left( b^- \right)- F \! \left( a^+ \right)
	\]
	Samotný Newtonův integrál pak definujeme jako \[
		(N) \int_{a}^{b} f \! \left( x \right) \,\text{d}x \deq \left[ F \right] _a^b = F \! \left( b^- \right)- F \! \left( a^+ \right) = \lim_{x \to b^-} F \! \left( x \right) - 
		 \lim_{x \to a^+} F \! \left( x \right)
	\]
	
\end{defi}

\begin{defi}[Newtonovsky integrovatelné funkce]
	\[
		\mathcal{N}\! \left( a,b \right) = \left\{ f: \exists \int_{a}^{b} f \! \left( x \right) \,\text{d}x \right\} 
	\]
\end{defi}

\begin{thm}[Newtonův integrál a spojitost]
	Nechť $f: \left[ a,b \right] \to \R $. Pak
	\[
		f \text{ spojitá } \Rightarrow \exists \int_{a}^{b} f \! \left( x \right) \,\text{d}x
	\]
\end{thm}

\begin{thm}[Per partes pro určitý integrál]
	Nechť $f,g$ jsou spojité na $\left[ a,b \right] $, mají na $\left( a,b \right) $ primitivní funkce $F,G$, a ty jdou spojitě dodefinovat na $\left[ a,b \right] $.
	Pak existují určité integrály $ \int_{a}^{b} fG, \int_{a}^{b} Fg$ a platí \[
		\int_{a}^{b} fG = \left[ FG \right] _a^b - \int_{a}^{b} Fg
	\]
\end{thm}

\begin{defi}[Vnitřek intervalu]
	Interval bez krajních bodů
\end{defi}

\begin{thm}[Substituce pro určitý integrál]
	Nechť $\varphi: \left[ \alpha, \beta \right] \to \R $ je spojitá, a navíc $ \exists \varphi' \! \left( x \right): \left( \alpha, \beta \right) \to \R$.
	Dále, nechť $f: \varphi \! \left( \left( \alpha, \beta \right)  \right) \to \R$ je spojitá a 
	Newtonovsky integrovatelná na vnitřku $\varphi \! \left( \left( \alpha, \beta \right)  \right)$.
	
	Potom
	\begin{equation}
		\varphi \! \left( \left( \alpha, \beta \right)  \right) \text{ je omezený interval} \\
	\end{equation}
	\begin{equation}
		\int_{\alpha}^{\beta} f \! \left( \varphi \! \left( t \right) \right) \varphi' \! \left( t \right) \,\text{d}t = 
		\int_{\varphi \! \left( \alpha \right)}^{\varphi \! \left( \beta \right)} f \! \left( x \right) \,\text{d}x
	\end{equation}
\end{thm}

\subsection{Riemannův integrál}

\begin{defi}[Dělení intervalu]
	Nechť $a,b \in \R $.
	Pak \textit{dělení} intervalu $\left[ a,b \right] \equiv D \deq \left( a_0, a_1, \dots, a_k \right) $ pro \[
		a = a_0 < a_1 \dots < a_k = b
	\]
	Body z dělení dělí interval na intervaly $I_i = \left[ a_{i}, a_{i+1} \right] $. Délka intervalu $\absolute{I_i} \deq a_{i+1}-a_i, \absolute{\left[ a,b \right] } \deq b-a$.
\end{defi}

\begin{defi}[Horní, dolní Riemannovy sumy]
	$s$ je dolní, $S$ je horní: \[
		\fce{s}{f,D} \deq \sum_{i=0}^{k-1} \absolute{I_i} m_i
	\]
	\[
		\fce{S}{f,D} \deq \sum_{i=0}^{k-1} \absolute{I_i} M_i
	\]
	kde $m_i = \text{ inf} \left\{ \fce{f}{x};\; x \in I_i \right\}, M_i =\text{ sup} \left\{ \fce{f}{x};\; x \in I_i \right\}$
\end{defi}

\begin{defi}[Horní, dolní Riemannovy integrály]
	\[
		\underline{ \int_{a}^{b} }\fce{f}{x} \,\text{d}x = \text{ sup} \left\{ \fce{s}{f,D}: D \text{ dělení } \left[ a,b \right]  \right\}
	\]
	\[
		\overline{ \int_{a}^{b} }\fce{f}{x} \,\text{d}x = \text{ inf} \left\{ \fce{S}{f,D}: D \text{ dělení } \left[ a,b \right]  \right\}
	\]
\end{defi}

\begin{defi}[Riemannův integrál]
	Funkce $f: \left[ a,b \right] \to \R $ má \textit{Riemannův integrál} $\equiv$ \[
		\underline{ \int_{a}^{b} }\fce{f}{x} \,\text{d}x =\overline{ \int_{a}^{b} }\fce{f}{x} \,\text{d}x \in \R 
	\]
\end{defi}

\begin{defi}[Riemannovsky integrovatelné funkce]
	\[
		\fce{\mathcal{R}}{\left[ a,b \right] } \deq \left\{ f; \; \exists \int_{a}^{b} \fce{f}{x} \,\text{d}x \right\} 
	\]
\end{defi}

\begin{thm}[Vlastnosti Riemannova integrálu]\
	\begin{enumerate}
		\item neomezená funkce není Riemannovsky integrovatelná
		\item $\fce{S}{f,D} \geq \fce{s}{f,D}$
		\item $ \forall D: \fce{s}{f,D} \leq \int_{a}^{b} \fce{f}{x} \,\text{d}x \leq \fce{S}{f,D}$, pokud integrál existuje
	\end{enumerate}
\end{thm}

\begin{thm}[]
	Nechť $f: \left[ a,b \right] \to \R $, $D, D'$ jsou dělení $\left[ a,b \right] $. Pak
	\[
		\fce{s}{f,D} \leq \underline{\int_{a}^{b}} \fce{f}{x} \,\text{d}x \leq \overline{\int_{a}^{b}} \fce{f}{x} \,\text{d}x \leq \fce{S}{f,D}
	\]
\end{thm}

\begin{thm}[Kritérium integrovatelnosti]
	Nechť $f: \left[ a,b \right] \to \R $. Pak \[
		f \in \fce{\mathcal{R}}{\left[ a,b \right] } \Leftrightarrow \forall \varepsilon > 0 \;\exists D: 0 \leq \fce{S}{f,D} -\fce{s}{f,D} < \varepsilon
	\]
\end{thm}

\begin{thm}[Monotonie \& integrovatelnost]
	Je-li $f: \left[ a,b \right] \to \R$ na $\left[ a,b \right] $ monotónní, pak $f \in \fce{\mathcal{R}}{\left[ a,b \right] }$
\end{thm}

\begin{thm}[Spojitost \& integrovatelnost]
	Je-li $f: \left[ a,b \right] \to \R$ na $\left[ a,b \right] $ spojitá, pak $f \in \fce{\mathcal{R}}{\left[ a,b \right] }$
\end{thm}

\begin{thm}[1. Základní věta analýzy]
	Nechť $f: \left[ a,b \right] \to \R, F: \left[ a,b \right] \to \R, F \deq \int_{a}^{x} \fce{f}{t} \,\text{d}t $. Pak
	\begin{enumerate}
		\item $F$ je na $\left[ a,b \right] $ spojitá
		\item $ \forall x_0 \in \left[ a,b \right] : F'(x_0) = f(x_0)$, platí i jednostraně pro $a,b$
	\end{enumerate}
\end{thm}

\begin{thm}[2. Základní věta analýzy]
	Pokud $f \in \fce{\mathcal{N}}{\left( a,b \right) } \cap \fce{\mathcal{R}}{\left[ a,b \right]}$, pak \[
		\int_{a}^{b} \fce{f}{x} \,\text{d}x = (N)\int_{a}^{b} \fce{f}{x} \,\text{d}x
	\]
\end{thm}

\begin{thm}[]
	Pro $ \fce{C}{\left[ a,b \right] } \deq $ množina spojitých funkcí: \[
		\fce{C}{\left[ a,b \right] } \subseteq \fce{\mathcal{N}}{\left( a,b \right) } \cap\fce{\mathcal{R}}{\left[ a,b \right] }
	\]
	
\end{thm}

\begin{thm}[Rozdíly mezi integrály]
	Množiny $\mathcal{N} \backslash \mathcal{R}$ a $\mathcal{R} \backslash \mathcal{N}$ jsou neprázdné.
\end{thm}

\begin{thm}[Odhad součtů]
	Nechť $n \in \N$ a $f$ neklesající funkce na $\left[ 1,n \right] $. Pak
	\[
		\sum_{i=1}^{n-1} \fce{f}{i} \leq \int_{1}^{n} \fce{f}{x} \,\text{d}x \sum_{i=2}^{n} \fce{f}{i}
	\]
\end{thm}

\begin{thm}[Integrální kritérium konvergence]
	Nechť $f: \left[ 1,\infty \right) \to \left[ 0, \infty \right)$ je nezáporná, neklesající. Pak 
	\[
		\sum_{k=1}^{\infty} \fce{f}{k} \text{ konverguje } \Leftrightarrow \lim_{b \to \infty} \int_{1}^{b} \fce{f}{x} \,\text{d}x \in \R
	\]
\end{thm}

\begin{thm}[Křivky a integrály]\
	\begin{enumerate}
		\item Plocha pod křivkou $\deq \int_{a}^{b} \fce{f}{x} \,\text{d}x$
		\item Délka křivky $\deq \int_{a}^{b} \sqrt{1+ \frac{df}{dx}} \,\text{d}x$
		\item Objem rotačního tělesa $\deq \pi \int_{a}^{b} \fce{f^2}{x} \,\text{d}x$
		\item Obsah rotačního tělesa $\deq 2 \pi \int_{a}^{b} \fce{f^2}{x} \sqrt{1+ \frac{df}{dx}} \,\text{d}x$
	\end{enumerate}
\end{thm}

%}}}

\end{document                </a></li>

<li><a href="https://gitlab.mff.cuni.cz/uradnikf/bc_lec/-/raw/master/2122l/lingebra/main.pdf">Lineární algebra 2}
\author{Filip Úradník}
\date{\today}


% custom for skripta
\newcommand{\skripta}[1]{\href{https://www.ms.mff.cuni.cz/~sejkoraji/sbirka/zalohy/skripta_la.pdf\#page=#1}{[H]}}


\input{template}
\input{czech_c}

\begin{document}
\maketitle

\section{Skalární součin}

\begin{defi}[Standardní skalární součin]
\end{defi}
\begin{thm}
  Odvození duality vzorečku
\end{thm}
\begin{proof}
  Viz cosinová věta.
\end{proof}

\begin{defi}[Skalární součin nad $\R$]
  \skripta{159} \textit{Skalární součin} $\langle x,y \rangle$ pro $x,y \in \V \equiv$ \
  \begin{enumerate}
    \item $\dotpr{x}{x} \geq 0$
    \item $\dotpr{x+y}{z}=\dotpr{x}{z}+\dotpr{y}{z}$
    \item $\dotpr{\alpha x}{y} = \alpha \dotpr{x}{y}$
    \item $\dotpr{x}{y} = \dotpr{y}{x}$
  \end{enumerate}
\end{defi}

\begin{defi}[Skalární součin nad $\C$] \
  \textit{Skalární součin} $\langle x,y \rangle$ pro $x,y \in \V \equiv$ \
  \begin{enumerate}
    \item $\dotpr{x}{x} \in \R \land \dotpr{x}{x} \geq 0$
    \item $\dotpr{x+y}{z}=\dotpr{x}{z}+\dotpr{y}{z}$
    \item $\dotpr{\alpha x}{y} = \alpha \dotpr{x}{y}$
    \item $\dotpr{x}{y} = \overline{\dotpr{y}{x}}$
  \end{enumerate}
\end{defi}

\begin{defi}[Norma] $\norm{x}$ pro $x \in \V \equiv$ \
  \begin{enumerate}
    \item $\norm{x} \geq 0 \land \norm{x} \Leftrightarrow x = o$
    \item $\norm{\alpha x} = \absolute{\alpha}\norm{x} \; \forall \alpha \in \C$
    \item $\norm{x+y} \leq \norm{x} + \norm{y}$
  \end{enumerate}
\end{defi}

\begin{defi}[Norma podle skalárního součinu]
  $\norm{x} := \sqrt{\dotpr{x}{x}}$ pro $x \in \V$
\end{defi}

\begin{sthm} \skripta{133}
  Norma podle skalárního součinu je norma
\end{sthm}

\begin{sdefi}[Kolmost]
  pro $x,y \in \V: x \perp y \equiv \dotpr{x}{y} = 0$
\end{sdefi}

\begin{sthm}[Pythagorova] \skripta{131}
	$ \forall x,y$ \[
		x \perp y \Rightarrow \norm{x+y}^2 = \norm{x}^2 \norm{y}^2
	\]
	Pro $\V$ nad $\R$ platí i druhá implikace.
\end{sthm}

\begin{sthm}[Cauchyho-Schwarzova nerovnost] \skripta{131}
	$ \forall x,y:$ \[
		\absolute{\dotpr{x}{y}} \leq \norm{x} \norm{y}
	\]
	
\end{sthm}

\begin{sthm}[Trojúhelníková nerovnost] \skripta{131}
\end{sthm}

\begin{defi}[P-norma]
  $\norm{x}_p := \left(\sum{\absolute{x_i}^p}\right)^{\frac{1}{p}}$
\end{defi}

\begin{sdefi}[Součtová norma]
  $\equiv p = 1 \Rightarrow \norm{x}_1 = \sum {x_i}$
\end{sdefi}

\begin{sdefi}[Maximová norma]
  $\equiv p = \infty \Rightarrow \norm{x}_\infty = \max{\absolute{x_i}}$
\end{sdefi}

\begin{defi}[Metrika]
  $d: M \times M \rightarrow \R^+$, tž.: \
  \begin{enumerate}
    \item $d(x,y) = 0 \Leftrightarrow y = x$
    \item $d(x,y) = d(y,x)$
    \item $d(x,y) + d(y,z) \geq d(x,z)$
  \end{enumerate}
\end{defi}

\section{Ortonormální báze}

\begin{defi} [Ortogonální systém vektorů]
  $x_{1,\dots,n}$ je \textit{ortogonální} systém vektorů $\equiv \forall i,j: \dotpr{x_i}{x_j} = 0$ 
\end{defi}

\begin{defi} [Ortonormální systém vektorů]
  $x_{1,\dots,n}$ je \textit{ortonormální} systém vektorů $\equiv \\ \forall i,j: \dotpr{x_i}{x_j} = 0 \land \norm{x_i} = 1$ 
\end{defi}

\begin{thm}
  $\forall $ ortonormální systém vektorů je lineárně nezávislý
\end{thm}

\begin{thm}[Fourierovy koeficienty] Pro $z_{1,\dots,n}$ ortonormální bázi $\V$ platí:
  $ \forall x \in \V: x = \sum_{i=1}^{n} \dotpr{x_i}{z_i}z_i $
\end{thm}

\begin{algo}[Gramova-Schmidtova ortogonalizace]
  \skripta{137}
  \begin{algorithmic}
    \For{$k \in {1, \dots, n}$}
      \State $y_k \gets x_k - \sum_{i=1}^{k-1} \dotpr{x_k}{z_i}z_i$
      \State $z_k \gets \frac{y_k}{\norm{y_k}}$
    \EndFor
  \end{algorithmic}
\end{algo}

\begin{cor}
  $\forall$ konečně generovaný $\V$ má ortonormální bázi.
\end{cor}

\begin{cor}
  $\forall$ konečně generovaný $\V: \forall$ nezávislé $x_{1, \dots, k}$ lze rozšířit na ortonormální bázi.
\end{cor}

\begin{thm}[Skalární součin vůči ortonormální bázi]
  \skripta{139}  $\forall$ skalární součin lze vyjádřit jako standardní skalární součin vůči nějaké ortonormální bázi.
\end{thm}


\section{Ortogonální doplněk}

\begin{defi}[Ortogonální doplněk]
  $M^\perp := \{ x \in \V: \forall y \in M: \dotpr{x}{y} = 0\}$ 
\end{defi}

\begin{thm}[Vlastnosti $M^\perp$] \
  \begin{enumerate}
    \item $M^\perp$ je podprostorem
    \item $M \subseteq N \Leftrightarrow N^\perp \subseteq M^\perp$
    \item $M^\perp = \Span{M}^\perp$
  \end{enumerate}
\end{thm}

\begin{thm}[Vlastnosti prostoru $M^\perp$] Pro $z_{1, \dots n}$ ortonormální bázi $M$.
  \begin{enumerate}
    \item vektory přidané do báze $M$ aby vznikla ortonormální báze $\V$ jsou bází $M^\perp$
    \item $\dim{M} + \dim{M^\perp} = \dim{V}$
    \item $M \cap M^\perp = \{o\}$
    \item $M^\perp + M = V$
    \item $\left(M^\perp\right)^\perp = M$
  \end{enumerate}
\end{thm}

\section{Ortogonální projekce}

\begin{defi}[Ortogonální projekce]
  Pro $M \Subset \V, x \in \V$ je \textit{ortogonální projekce} vektor $x_M \in M$, tž. $\norm{x-x_M} = \min{\norm{x-y} | y \in M}$
\end{defi}

\begin{thm}[O projekci]
  \skripta{141}
  Pro $M \Subset \V$ s bází $z_{1, \dots, m}$ a $x \in \V$ existuje jednoznačně určená projekce $x_M := \sum_{i=1}^m \dotpr{x}{z_i}z_i$
\end{thm}

\begin{slemma}[O kolmici]
  pro $x \in \V$ a $y \in M$, tž. $x-y \in M^\perp$ platí, že $\forall z \in M: \norm{x-y} \leq \norm{x-z}$
\end{slemma}

\begin{thm}[Výpočet ortogonálního doplňku v $\R^n$]
  \skripta{144}
  Pro $A \in \R^{m \times n}$ platí, že $\Ker{A} = \Rowsp{A}^\perp$
\end{thm}

\begin{cor}$\forall A \in \R^{n\times n}:$
\begin{enumerate}
  \item $\Ker{A^TA} = \Ker{A}$
  \item $\Rowsp{A^TA} = \Rowsp{A}$
  \item $\rank{A^TA} = \rank{A}$
\end{enumerate}  
\end{cor}

\begin{thm}[Výpočet projekce v $\R^n$]
  \skripta{146}
  Pro $A \in \R^{n\times m}, x \in \R^{n}$ platí, že $x_{\Colsp{A}} = A\left(A^TA\right)^{-1}\!A^Tx$
\end{thm}

\begin{thm}[Matice projekce]
  Pro $P:$ \[
	  (P \text{ symetrická } \land \; P^2 = P) \Leftrightarrow (P \text{ je matice projekce})
  \]
\end{thm}

\section{Ortogonální matice}

\begin{defi}[Ortogonální matice]
	Matice $Q \in \R ^{n \times n}$ je \textit{ortogonální} $\equiv$
	\[
		Q ^TQ = I_n
	\]
\end{defi}

\begin{defi}[Unitární matice]
	Matice $Q \in \C ^{n \times n}$ je \textit{unitární} $\equiv$
	\[
		\bar{Q }^TQ = I_n
	\]
\end{defi}

\begin{thm}[Charakterizace ortogonálních matic]
	Pro $Q \in \R ^{n \times n}$ jsou ekvivalentní
	\begin{enumerate}
		\item $Q$ je ortogonální
		\item $Q$ je regulární a $Q ^{-1}=Q^T$
		\item $QQ^T = I_n$
		\item $Q^T$ je ortogonální
		\item $Q ^{-1}$ existuje a je ortogonální
		\item sloupce $Q$ tvoří ortonormální bázi $\mathbb{R} ^n$
		\item řádky $Q$ tvoří ortonormální bázi $\mathbb{R} ^n$
	\end{enumerate}
\end{thm}

\begin{thm}[Ortogonální matice a součin]
	\[
		Q_1, Q_2 \text{ ortogonální } \Rightarrow Q_1Q_2 \text{ ortogonální }
	\]
\end{thm}

\begin{examp}[Householderova matice]
	(+ odvození)
	\[
		H(a) \deq I_n - \frac{2aa^T}{a^Ta}
	\]
\end{examp}

\begin{examp}[Givensova matice]
	Reprezentuje otočení v prostoru
\end{examp}

\begin{thm}[]
	Ortogonální matice nemění délky ani úhly:
	\begin{enumerate}
		\item $\left<Qx, Qy \right> = \left<x,y \right>$
		\item $\norm{x} = \norm{Qx}$
		\item $\absolute{Q _{ij}} \leq 1 \land \absolute{Q ^{-1} _{ij}} \leq 1$
	\end{enumerate}
\end{thm}

\begin{thm}[]
	Pokud $\left<Qx, Qy \right> = \left<x,y \right>$, je $Q$ ortogonální.
\end{thm}

\section{Determinant}

\begin{defi}[Determinant]
  Pro $A \in \T^{n\times n}:$ \textit{Determinant} matice A je $$\det A \deq \sum_{p \in S_n} \sgn{p}\prod_{i=1}^n A_{i,p(i)}$$
\end{defi}

\begin{thm}
  Pro $A \in \T^{n \times n}$ horní trojúhelníkovou platí: $$\det A = \prod_{i \in \range n} A_{ii}$$
\end{thm}
\begin{proof}
  $p(n)$ se musí rovnat $n$ aby $A_{np(n)} \neq 0$. Pokračujeme nahoru indukcí.
\end{proof}

\begin{thm}[Řádková linearita determinantu]
  \skripta{156}
  $\forall A \in \T^{n \times n}, b \in \T^{n}, i \in \range{n}:$
  $$ \det{A + e_ib^T} = \det{A} + \det{A + e_i(b^T - A_{i*})}$$
\end{thm}
\begin{proof}
  Z definice determinantu.
\end{proof}

\begin{thm}[Chování elementárních řádkových úprav vůči determinantu] \label{det:elementarni radkovy upravy}
  \skripta{156} \
  \begin{enumerate}
    \item $A'_{i*} = \alpha A_{i*} \Rightarrow \det{A'} = \alpha\; \det{A} $ \label{det:elementarni radkovy upravy:1}
    \item $A'_{i*} \leftrightarrow A_{j*} \Rightarrow \det{A'} = - \det A$
    \item $A'_{i*} = A_{i*} + \alpha A_{j*} \Rightarrow \det{A'} = \det A$
  \end{enumerate}
\end{thm}

\begin{cor}[\ref{det:elementarni radkovy upravy:1}]
  Pro $A \in T^{n \times n}: \exists i \neq j: A_{i*} = A_{j*} \Rightarrow \det A = 0$
\end{cor}

\begin{algo}[Výpočet determinantu pomocí REF] \
  \begin{algorithmic}[1]
    \State $A' \gets \REF{A}$
    \State $C \gets $ koeficient zachycující změny při REF algoritmu
    \State $\det A = C^{-1} \det{A'}$
  \end{algorithmic}
\end{algo}

\begin{thm}[Determinant a regularita]
  $\forall A \in \T^{n \times n}: A \text{ regulární} \Leftrightarrow \det A = 0$
\end{thm}

\begin{thm}[Determinant a transpozice]
  $\forall A \in \T^{n \times n}: \det A = \det {A^T}$
\end{thm}

\begin{thm}[Determinant a násobení]
  $\forall A,B \in \T^{n \times n}: \det {AB} = \det A \det B$
\end{thm}

\begin{thm}[Laplaceův rozvoj]
  Podle $i$-tého řádku, pro $A \in \T^{n\times n}, i \in \range{n}$
  $$ \det{A} = \sum_{j=1}^n(-1)^{i+j}A^{ij}$$
  Funguje i podle sloupce, z $A = A^T$.
\end{thm}
\begin{proof} \
  \begin{enumerate}
    \item Nechť $A_{i*} = e^T_{j}$. Pak prohodíme řádky, sloupce, aby $i=n, j=n$. Pak už můžeme vzít menší determinant.
    \item Pro obecné $A_{i*}$ stejné podle linearity $\det{A}$ podle řádku.
  \end{enumerate}
\end{proof}

\begin{thm}[Cramerovo pravidlo]
  Pro regulární $A \in \T^{n\times n}, b \in \T{n}$: řešení soustavy $Ax = b$ je:
  $$x_i = \frac{\det{A + (b-A_{*i})e_i^T}}{\det{A}}$$
\end{thm}

\begin{defi}[Adjungovaná matice]
  $\adj A_{ij} \deq \left( -1 \right) ^{i+j}\det{A^{ji}}$
\end{defi}

\begin{thm}[O adjungované matici]\skripta{161}
  $A \adj A = \det A I_n$
\end{thm}

\begin{cor}
  $A^{-1} = \frac{\adj A}{\det A}$ (z jednoznačnosti $A^{-1}$)
\end{cor}

\begin{defi}[Rovnoběžnostěn]
  \textit{Rovnoběžnostěn} s lineárně nezávislými hranami $a_{\range{n}}$ je 
  $$R \deq \{x \in \R^n: x = \sum_{i=1}^{m} \alpha_i a_i, \alpha_i \in \left[0, 1\right]\} $$
\end{defi}

\begin{thm}[Geometircký význam determinantu]
  objem rovnoběžnostěnu $R(A) = \absolute{\det A}$. Pro obecnou matici $A \in \R^{m \times n}$:
  $$ \text{objem } R(A) = \sqrt{\det{AA^T}} $$
\end{thm}
\begin{proof}
  Indukcí podle $m$, viz \skripta{163}.
\end{proof}

\section{Vlastní čísla}

\begin{defi}[Vlastní číslo]
  Pro $A \in \C^{n \times n}: \lambda$ je \textit{vlastním číslem} matice $A \equiv \exists x \neq o: Ax = \lambda x$. Takové $x$ je \textit{vlastním vektorem}.
\end{defi}

\begin{thm}[Charakterizace vlastních čísel]
	Pro $A \in \C^{n \times n}:$
	\begin{enumerate}
		\item $\lambda \in \C$ je vlastním číslem $A \Leftrightarrow \det{A - \lambda I_n} = 0$
		\item $x \neq o$ je \textit{vlastním vektorem} příslušícím $\lambda \Leftrightarrow$ 
	\end{enumerate}
\end{thm}

\begin{cor}
	Vlastnímu číslu $\lambda$ přísluší dim(Ker($A - \lambda I_n$)) $= \rank{A - \lambda I_n}$ lineárně nezávislých vlastních vektorů.
\end{cor}
\begin{cor}
	Pro trojúhelníkové matice jsou vlastními čísly prvky na diagonále.
\end{cor}
\begin{proof}
	Z výpočtu determinantu.
\end{proof}

\begin{cor}
	Hledání vlastních čísel se dá převést na hledání kořenů polynomu $\det{A - \lambda I_n} = 0$
\end{cor}

\begin{defi} \skripta{170}
	Polynom $\det{A - \lambda I_n}$ nazveme \textit{charakteristickým polynomem} matice $A \equiv p_A(\lambda)$
\end{defi}
\begin{thm}
	Protože $p_A(\lambda)$ je stupně $n$, má právě $n$ kořenů, tzn. $A$ má právě $n$ vlastních čísel (včetně násobností).
\end{thm}

\begin{defi}[Stopa]
	\textit{Stopa} matice $A \equiv \trace{A} \deq \sum_{i=0}^{n} A_{ii}$
\end{defi}

\begin{thm}[O součtu a součinu vlastních čísel]
	Pro $\lambda_{1 \dots n}$ vlastní čísla matice $A$:
	\begin{enumerate}
		\item $\det{A} = \prod \lambda_i$
		\item $\trace{A} = \sum \lambda_i$
	\end{enumerate}
\end{thm}

\begin{thm}[Vlastnosti vlastních čísel]
	Pro $A \in \C^{n \times n}$, $\lambda_{1 \dots n}$ její vlastní čísla a $x_{1 \dots n}$ odpovídající vlastní vektory:
	\begin{enumerate}
		\item $A$ je regulární $\Leftrightarrow 0$ není vlastním číslem.
		\item $A$ je regulární $\Rightarrow A^{-1}$ má vlastní čísla $\lambda^{-1}_{1 \dots n}$ a vlastní vektory $x_{1 \dots n}$.
		\item $A^2$ má vlastní čísla $\lambda^{2}_{1 \dots n}$ a vlastní vektory $x_{1 \dots n}$.
		\item $\alpha A$ má vlastní čísla $\alpha \lambda_{1 \dots n}$ a vlastní vektory $x_{1 \dots n}$.
		\item $\alpha I_n + A$ má vlastní čísla $\alpha + \lambda_{1 \dots n}$ a vlastní vektory $x_{1 \dots n}$.
		\item $A^T$ má vlastní čísla $\lambda_{1 \dots n}$, ale vlastní vektory se můžou změnit.
	\end{enumerate}
\end{thm}

\begin{thm}[Komplexně združená vlastní čísla] Pro $\lambda$ vlastní číslo matice $A: $ $\overline{\lambda}$ je také vlastním číslem matice $A$.
\end{thm}
\begin{defi}
	\textit{Spektrum} matice $A$ je $\set{\lambda_1, \dots \lambda_n}$. \textit{Spektrální poloměr} je $\max{\absolute{\lambda_i}}$.
\end{defi}

\begin{defi}[Matice společnice] Pro $p(x)$, tž. $\alpha_n = 1$ je \textit{matice společnice} 
	$c(p) \equiv$ matice $\in C^{n \times n}$, tž. 
	$A_{ ij } = 1$ pro $i=j+1$, $-\alpha_i$ pro $j=n$, jinak $0$.
\end{defi}

\begin{thm}
	$p_{c(p)}(\lambda) = (-1)^n p(\lambda)$
\end{thm}

\begin{thm}[Cayleho-Hamiltonova věta] \skripta{176}
	Pro $A \in C^{n \times n}, p_A(\lambda) : p(A) = 0$
\end{thm}

\begin{cor} Pro $A \in C^{n \times n}$:
	\begin{enumerate} 
		\item $\forall k \in \N: A^k \in \Span \Range{I_n}{A^{n-1}}$
		\item Pro $A$ regulární: $A^{-1} \in \Span \Range{I_n}{A^{n-1}}$
	\end{enumerate}
\end{cor}

\section{Diagonalizovatelnost}

\begin{defi}[Podobnost]
	Pro $A, B \in \C^{n \times n}$: $A, B$ jsou si \textit{podobné} $\equiv \exists$ regulární $S \in
	\C^{n \times n}$: $A = SBS^{-1}$
\end{defi}

\begin{cor} Relace podobnosti je \textit{ekvivalence}
\end{cor}

\begin{thm} Podobnost zachovává vlastní čísla
\end{thm}
\begin{proof} Přes $p_A(\lambda) = p_B(\lambda)$:
	\begin{align*} p_A(\lambda) &= \det{SBS^{-1} - \lambda I_n} = \det{SBS^{-1} - \lambda SI_nS^{-1}} =
		\det{S(B - \lambda I_n)S^{-1}} \\ &= \det S \det S^{-1} \det{B - \lambda I_n} 
		= \det{B - \lambda I_n} \\ &= p_B(\lambda)
	\end{align*}
\end{proof}

\begin{thm} Pro $A, B$ podobné: $\dim{\Ker{A - \lambda I_n}} = \dim{\Ker{B - \lambda I_n}}$
\end{thm}

\begin{defi}[Diagonalizovatelnost]
	Pro $A \in \C^{n \times n}:$ $A$ je \textit{diagonalizovatelná} pokud $\exists S \in \C^{n \times n}
	$ regulární a diagonální $\Lambda \in \C^{n \times n}$, tž.
	$$ A = S\Lambda S^{-1} $$
\end{defi}

\begin{thm} \skripta{178} $A \in \C^{n \times n}$ je diagonalizovatelná $\equiv A$ má $n$ 
	lineárně nezávislých vlastních vektorů.
\end{thm}

\begin{cor}
	Vlastní vektory $A^T$ jsou sloupce $S^{-T}$.
\end{cor}

\begin{thm}[Dostačující podmínka diagonalizace]
	Pro $\lambda_{1 \dots k}$ různá vlastní čísla $A \in \C^{n \times n}$ platí, že 
	příslušné vlastní vektory $x_{1 \dots k}$ jsou lineárně nezávislé.
	
	Proto pokud má matice $n$ různých vlastních čísel, je diagonalizovatelná.
\end{thm}

\begin{defi}[Jordanova buňka]
	Pro $\lambda \in \C, k \in \N$ je \textit{Jordanova buňka}
	$$J_k(\lambda) \in R^{k \times k}: J_k(\lambda)_{i,i} = \lambda, J_k(\lambda)_{i-1,i} = 1 $$
\end{defi}

\begin{defi}[Jordanova normální forma]
	$J \in C^{n \times n}$ je v \textit{Jordanově normální formě}, pokud je v blokově diagonálním
	tvaru, kde na diagonále má $J_k(\lambda)$ pro $\lambda$ vlastní čísla.
\end{defi}

\begin{thm}
	$\forall A \in \C^{n \times n}$ je podobná matici v Jordanově normální formě, která je
	jednoznačně určena až na pořadí buněk.
	(bez Dk)
\end{thm}

\begin{cor}
	$\#$ buněk s $\lambda$ = $\#$ lineárně nezávislých vlastních vektorů příslušných k $\lambda$.
\end{cor}

\begin{cor}
	Násobnost $\lambda \geq \#$ lineárně nezávislých vektorů příslušících $\lambda$.
\end{cor}

\begin{cor} Skripta 10.44 (poznámka) \end{cor}

\begin{defi}[Hermitovská transpozice]
	Pro $A \in \C^{n \times m}$ je $A^* \deq \bar{A^T}$
\end{defi}

\begin{defi}[Hermitovská matice]
	Pro $A \in \C^{n \times n}$ je $A$ \textit{Hermitovská} $\Leftrightarrow A^* = A$
\end{defi}

\begin{defi}[Unitární matice]
	Pro unitární $Q \in \C^{n \times n}: QQ^* = I_n$
\end{defi}

\begin{thm}[Vlastnosti hermitovské transpozice]
	Podobné jako klasické transpozice.
\end{thm}

\begin{thm}
	Na $\R^{n \times n}$ je matice hermitovská $\Leftrightarrow$ je symetrická.
\end{thm}

\begin{thm}
	Vlastní čísla Hermitovské matice jsou reálné.
	(tedy i pro symetrické reálné)
\end{thm}

\begin{thm}
	Vlastní vektory Hermitovské matice příslušící různým vlastním číslům jsou ortogonální.
\end{thm}
\begin{proof}
	$\lambda_2 x_1^* x_2 = x_1^* A x_2 = (x_2^* A x_1)^* = (x_2^* \lambda_1 x_1)^*
	 = (x_2^* \lambda_1 x_1)^* = \lambda_1 x_1^* x_2 = 0$
\end{proof}

\begin{thm}
	Vlastní vektor symetrické $A \in \R^{n \times n}$ je reálný.
\end{thm}
\begin{proof}
	Při výpočtu $\Ker{A - \lambda I_n}$ neopouštím $\R$.
\end{proof}

\begin{thm}[Spektrální rozklad symetrických matic] \skripta{187}
	Pro $A \in \R^{n\times n}$ symetrickou platí, že $\exists$ ortogonální $Q$ 
	a diagonální $\Lambda$, tž. $A = Q\Lambda Q^T$.
\end{thm}

\section{Pozitivně (semi-)definitní matice}

\begin{defi}[Pozitivně semi-definitní matice]
	Pro $A$ symetrickou: je \textit{pozitivně semi-definitní}, ptk:
	$$\forall x \in \R ^{n \times n}: x ^{T} Ax \geq 0$$
\end{defi}

\begin{defi}[Pozitivně definitní matice]
	Pro $A \in \R ^{n \times n} \backslash \set 0$ symetrickou: je \textit{pozitivně definitní}, ptk:
	$$\forall x \in \R ^{n \times n}: x ^{T} Ax > 0$$
\end{defi}

Je to vlastně zobecnění kladných čísel.

\begin{thm}[Vlastnosti pozitivně definitních matic]
	Pro $A, B$ pozitivně definitní:
	\begin{enumerate}
		\item $A+B$ je pozitivně definitní
		\item $\alpha A$ je pozitivně definitní
		\item $A$ je regulární a $A ^{-1}$ je pozitivně definitní
	\end{enumerate}
\end{thm}

\begin{thm}[Vlastnosti pozitivně semi-definitních matic]
	Pro $A, B$ pozitivně semi-definitní:
	\begin{enumerate}
		\item $A+B$ je pozitivně semi-definitní
		\item $\alpha A$ je pozitivně semi-definitní
	\end{enumerate}
\end{thm}

\begin{thm}[Alternativní definice pozitivně definitních matic]
	\ \begin{enumerate}
		\item $A$ je pozitivně definitní
		\item všechna vlastní čísla $A$ jsou kladná
		\item $\exists U \in \R ^{m \times n}: A = U ^{T} U$
	\end{enumerate}
\end{thm}

\subsection{Hledání semi-definitních matic}

\begin{thm}[Rekurzivní vzoreček semi-definitní matice] \skripta{199}
	Pro symetrickou $A = \begin{pmatrix} \alpha & a ^{T} \\ a & \bar A \end{pmatrix} $
	\[
		A \text{ je pozitivně definitní} \Leftrightarrow \bar A - \frac{1}{\alpha} a a ^{T} \text{ je pozitivně definitní}, \alpha > 0
	\]
\end{thm}

\begin{thm}[]
	Symetrická $A$ je \textit{pozitivně definitní} ptk. Gaussova eliminace, kdy můžeme jen přičítat $\alpha-$násobek řádku k řádkům pod ním, vede na trojúhelníkovou
	matici s kladnou diagonálou.
\end{thm}

\begin{defi}[Hlavní vedoucí podmatice]
	Pro matici $A \in \R ^{n \times n}$ jsou $A_1 \dots A_n$, tž. \[
		A_i \in \R ^{(n-i+1) \times (n-i+1)}, (A_i)_{i,j} = A_{i,j} 
	\]
\end{defi}

\begin{defi}[Hlavní podmatice]
	Pro matici $A \in \R ^{n \times n}$ jsou takové $B$, které vzniknou z $A$ škrtnutím $i$ řádků a sloupců pro $i \in \Range{0}{n-1}$.
\end{defi}

\begin{thm}[Sylvestrovo kritérium pro pozitivně definitní matice]
	Symetrická $A$ je \textit{pozitivně definitní} ptk. determinanty hlavních vedoucích podmatic jsou kladné.
\end{thm}

\begin{thm}[Sylvestrovo kritérium pro pozitivně semi-definitní matice]
	Symetrická $A$ je \textit{pozitivně semi-definitní} ptk. determinanty hlavních podmatic jsou nezáporné.
\end{thm}

\begin{thm}[Choleského rozklad] \skripta{199}
	Nechť $A \in \R ^{n \times n}$ je pozitivně definitní. 
	Pak \[
		\exists !L \in \R ^{n \times n} \text{ dolní trojúhelníková s kladnou diagonálou}: A = L L ^T
	\]
\end{thm}


\begin{thm}[Choleského rozklad pro pozitivně semi-definitní matice] \skripta{199}
	Nechť $A \in \R ^{n \times n}$ je pozitivně definitní. 
	Pak \[
		\exists L \in \R ^{n \times n} \text{ dolní trojúhelníková s nezápornou diagonálou}: A = L L ^T
	\]
\end{thm}

\begin{algo}[Choleského rozklad]
	Postupujeme po sloupcích $k \in \range{n}$
	\skripta{200}
\end{algo}

\begin{thm}[]
	Funkce $\left< x,y \right>$ je skalárním součinem v $\R ^n \Leftrightarrow$ \[
		\exists \text{ pozitivně definitní } A: \left<x,y \right> = x^TAy
	\]
\end{thm}

\section{Bilineární formy} % {{{

\begin{defi}[Bilineární forma]
	Zobrazení $b: \V \times \V \to \T$ lineární v obou složkách.
\end{defi}

\begin{defi}[Symetrická bilineární forma]
	$ \forall u,v \in \V:$ \[
		\fce{b}{u,v} = \fce{b}{v,u}
	\]
	
\end{defi}

\begin{defi}[Maticové vyjádření]
	Matice $b$ vzhledem k bázi $B$ je $A \in \T^{n \times n}:$  \[
		A_{ij} = \fce{b}{w_i, w_j}
	\]
\end{defi}

\begin{thm}[Maticové vyjádření]
	Nechť $B$ je báze $\V$ a $b$ je bilineární forma. Pak \[
		A \text{ je maticí } b \text{ vzhledem k } B \Leftrightarrow \forall u,v \in \V: \fce{b}{u,v} = \left[ u \right] _B^T A \left[ v \right] _B
	\]
\end{thm}

\begin{cor}[]
	Nechť $B$ je báze $\V$ a $A \in \T^{n \times  n}$. Pak \[
		\exists ! b: \forall i,j: \fce{b}{w_i, w_j} = A_{ij}
	\]
\end{cor}

\begin{cor}[]
	Pro $\V = \T^n$ lze $b$ vyjádřit přímo jako $u^TAv$
\end{cor}

\begin{thm}[Matice bilineární formy při změně báze]
	Pro $B, B'$ báze, matici přechodu $S \deq _{B} \! \left[ id \right] _{B'}$, $b$ bilineární formu a $A$ matici $b$ vzhledem k $B$:
	\[
		A_{B'} = S^T\!AS
	\]
\end{thm}

\begin{defi}[Kvadratická forma]
	Zobrazení $f: \V \to \T$, tž. \[
		\exists b \text{ symetrická bilineární forma} : \forall v \fce{f}{v} = \fce{b}{v,v}
	\]
	Pak říkáme, že $b$ indukuje $f$
\end{defi}

\begin{defi}[Maticové vyjádření]
	Matice $f$ vzhledem k $B$ je matice libovolné symetrické $b$ indukující $f$.
\end{defi}

\begin{thm}[Sylvestrův zákon setrvačnosti]
	Pro $f$ kvadratickou formu nad $\R^n$, $A$ její maticové vyjádření existuje jediná báze, kdy je $A$ diagonální a na diagonále má jen $0, -1, 1$.
	Matice je až na pořadí prvků jednoznačná.
\end{thm}

\begin{cor}[]
	Pro $A \in R^{n \times n}$ symetrickou matici s $S^T \Lambda S$ diagonálním tvarem s $\pm 1, 0$ na diagonále:
	\begin{enumerate}
		\item $\# 1 = \#$ kladných vlastních čísel $A$
		\item $\# -1 = \#$ záporných vlastních čísel $A$
		\item $\# 0 = \#$ nulových vlastních čísel $A$
	\end{enumerate}
\end{cor}

\begin{cor}[]
	Pro $A \in R^{n \times n}$ symetrickou matici s $S^T \Lambda S$ diagonálním tvarem s $\pm 1, 0$ na diagonále:
	\begin{enumerate}
		\item $A$ je pozitivně definitní $\Leftrightarrow S^TAS$ má kladnou diagonálu
		\item $A$ je pozitivně semi-definitní $\Leftrightarrow S^TAS$ má nezápornou diagonálu
	\end{enumerate}

\end{cor}

% }}}



\end{document                </a></li>

<li><a href="https://gitlab.mff.cuni.cz/uradnikf/bc_lec/-/raw/master/2122l/ads/main.pdf">Algoritmy a datové struktury 1}
\author{Filip Úradník}
\date{\today}

\input{template}
\input{czech_c}

\begin{document}
\maketitle

\section{DAG} % {{{

\begin{defi}[Zdrojový, stokový vrchol]
    
\end{defi}

% TODO: finish <26-04-22, yourname> %

% }}}

\section{Komponenty silné souvislosti} % {{{
\begin{defi} \textit{Graf komponent} $\mathcal{C}(G)$ grafu $G$, tž. 
  komponenty $G$ jsou vrcholy $\mathcal{C}(G)$
\end{defi}
\begin{thm}[Vlastnosti $\mathcal{C}(G)$] \
  \begin{enumerate}
    \item $\forall G: \mathcal{C}(G)$ je $DAG$
    \item $\exists $ zdrojová a stoková komponenta
    \item Pro $C$ \textit{stokovou komponentu} a $v \in V(C):$ $DFS(v)$ navštíví právě C.
    \item Pro $A_i$ \textit{zdrojové komponenty} víme, že po opakovaném $DFS$ platí pro $v \in V(G): \out{v} = \max{\out{u}| u \in V(G) }$, že $\exists i: v \in A_i$ 
  \end{enumerate}
\end{thm}

\begin{defi}[Transponovaný graf]
  $G^T := (V(G), \{uv | vu \in E(G)\})$
\end{defi}
\begin{thm}[Vlastnosti $G^T$] \
  \begin{enumerate}
    \item $G$ je $DAG$ $\Leftrightarrow$ $G^T$ je $DAG$
    \item $KSS(G) = KSS(G^T)$
    \item Zdrojová komponenta $G$ $\leftrightarrow$ Stoková komponenta $G^T$
  \end{enumerate}
\end{thm}

\begin{algo}[Hledání KSS, triviální] \
  \begin{algorithmic}[1]
    \State Najdeme $v$ ve zdrojové komponentě $G^T\rightarrow$ stokové komponentě $G$
    \State Odebereme stokovou komponentu
    \State Opakujeme dokud $V \neq \emptyset$
  \end{algorithmic}
\end{algo}

\begin{lemma}
  Pro $C_1, C_2 \in KSS$, tž. $C_1C_2 \in E(\mathcal{C}(G^T))$ platí, že $\max{\out{u} |\; {u \in C_1}} > \max{\out{v} |\; {v \in C_2}}$
\end{lemma}
\begin{proof}
  Protože neexistuje $C_2C_1 \in E(G^T)$, jinak by to byla jedna komponenta, tak nejdřív musí přijít DFS do $C_1$, pak hranou do $C_2$, tu celou projít, a pak uzavřít
  ten vrchol v $C_1$.
\end{proof}

\begin{algo}[Hledání KSS, optimalizované] \
\begin{algorithmic}[1]
  \State Sestrojíme $G^T$
  \State $Z \gets$ prázdný zásobník
  \For {$v \in DFS(G^T)$}
    \State při opouštění $v$ přidáme do $Z$
  \EndFor
  \State $\forall v \in G: \text{komp}(v) \gets \emptyset$
  \For {$v \in Z$}
    \If{$\text{komp}(v) = \emptyset$}
      \State komp($v$) $\gets v$
      \For {$w \in DFS(G, v)$ ignorující $\forall u: \text{komp}(u) \neq \emptyset$}
        \State komp($w$) $\gets v$
      \EndFor
    \EndIf
  \EndFor
\end{algorithmic}
\begin{itemize}
  \item čas i prostor $\Theta(n+m)$
\end{itemize}
\end{algo}

% }}}

\section{Nejkratší cesty} % {{{

\begin{defi}[Délka cesty]
  Pro cestu $p$ ve $\vec{G}$ s hranami ohodnocenými funkcí $l: E \rightarrow \mathbb{R}^+$ je délka cesty $l(P) := \sum_{e \in P} l(e)$  
\end{defi}
\begin{defi}[Vzdálenost]
  Vzdálenost $\text{dist}(u, v) := \min{l(p) | \forall p $ cesty/sledu mezi $u,v}$
\end{defi}
\begin{lemma}
  Pokud $S$ je $uv$-sled, pak $\exists P$ $uv$-cesta, tž. $l(P) \leq l(S)$
\end{lemma}
\begin{proof}
  Pokud $S$ už není cesta, vrcholy se opakují. Tedy můžu vystřihnout opakující-se úseky
  dokud nezbyde cesta, ta bude kratší.
\end{proof}
\begin{lemma}
  Trojúhelníková nerovnost platí i pro záporné hrany, jen ne záporné cykly.
\end{lemma}
\begin{algo}[Nejkratší cesta pro jednotkové hrany]
  \label{algo:nejkratsi cesta jednotkove e}
  Prostě BFS - rozdělení na vrstvy podle vzdálenosti. Konstrukce cesty zpětným tahem.
\end{algo}
\begin{defi}[Strom nejkratších cest]
  Strom vytvořený BFS.
\end{defi}
\begin{lemma}
  Prefix nejkratší $v_0v$ cesty je nejkratší cesta, neboli $\forall w \in P(v_0v): P(v_0w)$ je také nejkratší.
\end{lemma}
\begin{algo}[Nejkratší cesta pro $\mathbb{N}_0$]
  Triviálně pomocí přerozdělením hran, převedení na \ref{algo:nejkratsi cesta jednotkove e}.
  \begin{itemize}
    \item Čas $O(mL)$, kde $L$ je $\max{l(e) \;|\; e \in E}$
  \end{itemize}
\end{algo}


\begin{defi}
  \textit{Invariant} je tvrzení platné po celou dobu běhu algoritmu.
\end{defi}

\subsection{Dijkstra}

\begin{salgo}[Dijkstra] Pro vzdálenost z vrcholu $u$.  \
\begin{algorithmic}[1]
  \For{$v \in V$}
    \State $h(v) \gets \infty$
    \State $stav(v) \gets \emptyset$
  \EndFor

  \State $h(u) \gets 0$
  \State $stav(v) \gets$ otevřený
  
  \While{$\exists v: stav(v) = $ otevřený}
    \State $v \gets $ otevřený vrchol s min. $h(v)$
    \For{$w \in V: vw \in E$}
      \State $h(w) \gets \min{h(w), h(v) + l(vw)}$
      \State $stav(w) \gets $ otevřený
    \EndFor
    \State $stav(v) \gets$ uzavřený
  \EndWhile
\end{algorithmic}
\begin{itemize}
\item Čas, prostor až $O(n\log(n)+m)$ (Fibbonaciho halda)
\item Čas podle struktury pro hledání minima
\begin{itemize}
  \item vkládání - až \textit{n-krát}
  \item vybírání - až \textit{n-krát}
  \item snižování existujícího - až \textit{m-krát}
  \item [$\Rightarrow$] $O(nT_{\text{vkládání}}+nT_{\text{vybírání}}+mT_{\text{snižování}})$
\end{itemize}
\item Čas pro haldu je $O((n+m)\log(n))$
\begin{itemize}
  \item pozor na \textit{snižování}, nutno udržovat si o každém prvku kde v haldě se nachází
    aby bylo konstantní vyhledávání
  \item pro husté grafy až $O(n^2\log n)$, horší než s klasickým polem.
\end{itemize}
\item Správnost:
\begin{itemize}
  \item \textit{hrany z} $\mathbb{N}$: analogie s budíky
  \item \textit{hrany z} $\mathbb{R}^+$: \ref{algo:dijkstra:spravnostr+} 
\end{itemize}
\end{itemize}
\end{salgo}

\begin{sdefi}[Relaxace]
  \textit{Relaxace} vrcholu je pokus o vylepšení ohodnocení sousedů.
\end{sdefi}

\begin{salgo}[Obecný relaxační algoritmus] Z vrcholu $u$ \
  \begin{algorithmic}[1]
    \For{$v \in V$}
      \State $h(v) \gets \infty$
      \State $stav(v) \gets \emptyset$
    \EndFor
  
    \State $h(u) \gets 0$
    \State $stav(v) \gets$ otevřený
    
    \While{$\exists v: stav(v) = $ otevřený}
      \State $v \gets$ otevřený vrchol
      \For{$w \in V: vw \in E$}
        \If{$h(w) > h(v) + l(v,w)$}
          \State $h(w) \gets h(v) + l(v,w)$
          \State $stav(w) \gets$ otevřený
        \EndIf
      \EndFor
      \State $stav(v) \gets$ uzavřený
    \EndWhile
  \end{algorithmic}
\end{salgo}

\begin{sinvar}[Obecný] \
  \label{alg:djikstra:invo}
  \begin{enumerate}
    \item $\forall v: h(v)$ nikdy neroste
    \item pro $h(v)$ konečné: $h(v) = l(\text{uv-sled})$
  \end{enumerate}
\end{sinvar}
\begin{proof} \
  \begin{enumerate}
    \item triviálně - dáváme vždy minimum
    \item $h(v)$ je už délka sledu z IP, přidám $d(vw)$, čímž prodloužím sled o hranu
  \end{enumerate}
\end{proof}

\begin{slemma}[Dosažitelnosti] Pokud se algoritmus zastaví, \label{alg:dijkstra:dosazitelnost}
  pak $\forall v \in V: $
  $$  v \text{ dosažitelný} \overset{1}{\Leftrightarrow} v \text{ zavřený} \overset{2}{\Leftrightarrow} h(v) \text{ konečné}  $$
\end{slemma}
\begin{proof} \
  \begin{enumerate} 
    \item z korektnosti $BFS$
    \item triviálně indukcí podle běhu
  \end{enumerate} 
\end{proof}

\begin{slemma}[Vzdálenosti] Pokud se algoritmus zastaví, \label{alg:dijkstra:vzdalenost}
  pak $\forall v \in V: h(v) = d(u,v)$
\end{slemma}
\begin{proof} \
  \begin{enumerate}
    \item $v$ nedosažitelný $\Rightarrow h = \infty, d = \infty$
    \item Z \ref{alg:djikstra:invo}: $h(v) \geq d(u,v)$. Kdyby $ \exists h(v) > d(u,v)$, vybereme $v$ tž nejkratší $uv$-cesta má nejméně hran. Pak na té cestě
      $\exists p \in uv$. Protože $p$ je blíž, musí být dobrý. Tím pádem v průběhu algoritmu jsme ho otevřeli a tím pádem relaxovali, tedy přepočítali $h(v)$. To je spor.
  \end{enumerate} 
\end{proof}


\begin{sinvar}[Monotonie: Dijkstra s $l \geq 0$] Pro $o$ otevřený vrchol a $z$ zavřený vrchol: \ \label{alg:dijkstra:monotonie}
  \begin{enumerate}
    \item $h(z) \leq h(o)$ \label{alg:dijk:invm1}
    \item $h(z)$ se nemění \label{alg:dijk:invm2}
  \end{enumerate}
\end{sinvar}
\begin{proof} Indukcí podle výpočtu.
  \begin{itemize}
    \item zpočátku: platí triviálně
    \item při relaxaci: pro $v$ platí, že $\forall w \text{ otevřené}: h(v) \leq h(w)$, protože bereme minimum. Pak $\forall s $ otevřené  nebo neviděné sousedy $v: 
    h(s)$ nechám, tj. zůstane větší, nebo změním na $h(s) = h(v) + l(v,w) \geq h(v)$ ($\Rightarrow$ \ref{alg:dijk:invm1}). Zavřené vrcholy neměním protože už mají $h(s) \leq h(v)$ ($\Rightarrow$ \ref{alg:dijk:invm2}). Následně $v$ zavřu, čímž 
    nerovnosti neporuším. 
  \end{itemize}
  \begin{enumerate}
    \item $v$ nedosažitelný $\Rightarrow h = \infty, d = \infty$
    \item Z \ref{alg:djikstra:invo}: $h(v) \geq d(u,v)$. Kdyby $ \exists h(v) > d(u,v)$, vybereme $v$ tž nejkratší $uv$-cesta má nejméně hran. Pak na té cestě
      $\exists p \in uv$. Protože $p$ je blíž, musí být dobrý. Tím pádem v průběhu algoritmu jsme ho otevřeli a tím pádem relaxovali, tedy přepočítali $h(v)$. To je spor.
  \end{enumerate} 
\end{proof}

\begin{sthm} \label{algo:dijkstra:spravnostr+}
  Dijkstrův algoritmus zavírá vrcholy v pořadí podle $d$, každý dosažitelný právě jednou, a při zavření $h(v) = d(v)$.
\end{sthm}
\begin{proof}
  Plyne z \ref{alg:dijkstra:dosazitelnost}, \ref{alg:dijkstra:monotonie}, \ref{alg:dijkstra:vzdalenost}
\end{proof}

\subsection{Bellman-Fordův algoritmus}

Opět relaxační algoritmus, pouze s frontou místo haldy, který funguje i se zápornými hranami (jen ne zápornými cykly). Má ale horší časovou složitost.

\begin{salgo}[Bellman-Fodrův] Pro $G$ s počátečním vrcholem $u$ a délkami hran $l: V \rightarrow \mathbb{R}$ \
\begin{algorithmic}[1]
  \State $q \gets$ prázdná fronta
  \State $q.\mathit{insert}(u)$
  \While{$q$ není prázdná}
    \State $v$ z fronty
    \State RELAXACE $v$
  \EndWhile
\end{algorithmic}
\end{salgo}

\begin{sdefi}[Fáze výpočtu] \
  \begin{itemize}
    \item $F_0 := \text{otevření } u$
    \item $F_i :=$ zavírání vrcholů otevřených v $F_{i-1}$ a otevírání jejich následovníků
  \end{itemize}
\end{sdefi}

\begin{sinvar}
  Na konci $F_i: \forall v \in V: h(v) \leq$ délka nejkratšího $uv$-sledu o max. $i$ hranách.
\end{sinvar}
\begin{proof}
  Indukcí podle $i$.
  \begin{enumerate}
    \item $i=0$ platí - všude $\infty$.
    \item Na konci $(i+1)$-té fáze: $S :=$ nejkratší $uv$-sled. \
    \begin{itemize}
      \item $|E(S)| \leq i \rightarrow$ tvrzení platilo už předtím
      \item $|E(S)| = i$, pak $\exists p \in V$ předchůdce $v$, tzn. nejkratší $up$-sled má délku $h(p) \stackrel{IP}{\Rightarrow} h(v) \leq h(p) + l(p,v) \leq l(S') + l(p,v) \leq l(S)$ 
    \end{itemize}
  \end{enumerate}
\end{proof}

\subsection{Floydův-Warshallův algoritmus}

\begin{salgo}[Floydův-Warshallův] Pro $G$ s délkou hran $l: V \rightarrow \mathbb{R}$ bez záporných cyklů: \
$$ D^k_{ij} \deq \text{ nejkratší cesta z $i$ do $j$, tž. všechny vrcholy leží v } \{1, \dots, k\}$$
V každém kroku $\forall i,j: $
$$ D^{k+1}_{ij} \deq \min{D^k_{ij}, \; D^k_{i,k+1} + D^k_{k+1,j} }$$
$D^n$ už má nejkratší cesty mezi všemi vrcholy v čase $\O{n^3}$ a prostoru $\O{n^2}$.
\end{salgo}

% }}}

\section{Minimální kostra} % {{{

\begin{defi}[Minimální kostra]
  Pro graf $G = (V, E, w), w: E \rightarrow \R$ je kostra $T$ \textit{minimální} $\equiv w(T) \deq \sum_{e \in E(T)}w(e)$ je nejmenší možná 
\end{defi}

\begin{algo}[Jarníkův]
  Začneme z vrcholu $v_0$, postupně vybíráme hrany vedoucí z dosažitelných vrcholů do nedosažitelných, které mají $min(w)$ a přidáváme je do $T$. 
\end{algo}

\begin{thm}
  Jarníkův algoritmus se zastaví, a $T$ je na konci kostra.
\end{thm}

\begin{defi}[Elementární řez]
  Množina $R \subseteq E(G)$ je \textit{elementární řez} $\equiv \exists A \subseteq V(G), B \subseteq V(G) \backslash A, A,B \neq \emptyset $, tž. $R = E(A,B)
  \deq \{ \{a, b\} \in E(G) | a \in A, b \in B\}$
\end{defi}

\begin{lemma}[Řezové] \label{algo:jar:rez:lemma}
  Pro $G$ graf s unikátními hranami, $R$ unikátní řez $G$, $e$ nejlehčí hranu v $R$, $T$ nějakou minimální kostru platí: $e \in T$.  
\end{lemma}
\begin{proof}
  Nechť $T$ je kostra, $e \notin T$. Pak $\exists C $ cesta v $T$ mezi $A, B$. $\exists f \in R \cap T$. $T-f+e$ je taky kostra, ale lehčí, protože $e$ je nejlehčí v $R$.
\end{proof}

\begin{thm}[Správnost Jarníkova algoritmu] \
  \begin{enumerate}
    \item Jarníkův algoritmus najde minimální kostru.
    \item Existuje jediná minimální kostra.
    \item Minimální kostra je jednoznačně určena jen pořadím vah, nemusí to být nutně čísla. \label{algo:jar:sprav:poradi}
  \end{enumerate}
\end{thm}
\begin{proof}
  V každém kroku existuje elementární řez, jeho nejlehčí hranu vybere Jarník, a ta podle \ref{algo:jar:rez:lemma} patří do každé minimální kostry. Podle 
  \ref{algo:jar:sprav:poradi} když nejsou ohodnocení hran unikátní, prostě je náhodně poskládáme za sebe.
\end{proof}

\begin{algo}[Jarník podle Dijkstry]
  V každém kroku pro $v$ sousedy aktuálního $T \deq $ nejlehčí hrana mezi $v$ a $T$: \
  \begin{algorithmic}[1]
    \State Přidáme $v$ do $T$ s min. hranou,
    \State $\forall w$ sousedy $v$ přepočítáme $h(w)$
  \end{algorithmic}
  $\Rightarrow \O{(n+m)\log n}$
\end{algo}

\begin{algo}[Borůvkův]
  Začínáme s lesem, každý strom má jeden vrchol. V každé fázi každému stromečku vybereme min. hranu a srosteme stromečky.
\end{algo}

\begin{lemma}
  Borůvkův algoritmus má $\leq \log n$ fází.
\end{lemma}
\begin{proof}
  V každé fázi má každý stromeček $2^k$ vrcholů, indukcí. Ale dohromady jen $n$ vrcholů.
\end{proof}
\begin{thm}[Správnost Borůvkova algoritmu] \
  Borůvkův algoritmus pro graf s unikátními hranami najde minimální kostru.
\end{thm}
\begin{proof}
  Přidaná hrana je nejlehčí v elemetárním řezu mezi stromečkem a zbytkem grafu.
\end{proof}
\begin{thm}[Správnost Borůvkova algoritmu]
  Borůvkův algoritmus najde minimální kostru v grafu s unikátními hranami v čase $\Theta(m \log n)$
\end{thm}

\begin{algo}[Kruskalův]
  \ \begin{enumerate}
    \item Seřadíme hrany - až $\Theta (m \log n)$
    \item Procházíme podle velikosti
    \item Přidáme, pokud nevytvoří cyklus
  \end{enumerate}
  (Složitost záleží na tom, jak hledáme komponenty souvislosti. Až $\O{mn}$)
\end{algo}

\begin{defi}[Union-Find]
  Datová struktura pro udržování komponent souvislosti.
  \begin{description}
    \item [Find] najde jestli $u,v$ jsou ve stejné komponentě.
    \item [Union] spojí $u$ a $v$.
  \end{description}
\end{defi}
Reprezentace:
\begin{description}
  \item Pole: Find $\O{1}$, Union $\O n$, dohromady Kruskal až $\O{n^2}$
  \item Komponenty reprezentované keříky: strom orientovaný ke kořeni. Find: pro $u, v$ prostě najdu jejich kořeny a porovnám, Union: spojím kořeny.
  Navíc si udržuji velikosti keříků, a připojuji menší do většího, tím pádem hloubka $h$ má $\geq 2^h$ vrcholů - Dk. stejný jako u Borůvkova algoritmu.
\end{description}


%}}}

\section{Binární stromy} % {{{

\begin{defi}[Binární strom]
  Zakořenený strom, kde $\forall v$ má:
  \begin{enumerate}
    \item $T(v)$ celý podstrom (syn | potomci)
    \item $R(v)$ pravý podstrom
    \item $L(v)$ levý podstrom 
    \item $h(v)$ hloubka $T(v)$
    \item $k(v) \in \mathcal{U}$ klíč ve vrcholu
    \item $n$ celkový počet vrcholů
  \end{enumerate}
  Dále platí, že $\forall v: \forall r \in R(v), l \in L(v): k(l) < k(v) < k(r)$.
  Z toho mimo jiné vyplývá, že $\forall v,w: k(v) \neq k(w)$
  \ Operace
  \begin{enumerate}
    \item Enumerace - $\O{n}$
    \item Find - $\O h$
    \item Delete - $\O h$
    \item Insert - $\O h$
  \end{enumerate}
\end{defi}

\begin{defi}[Dokonale vyvážený BVS]
  je BVS, pro který platí $\forall v: \absolute{\absolute{L(v)} - \absolute{L(v)}} \leq 1$
\end{defi}

\begin{thm}[Statičnost DVBVS]
  Pro DVBVS platí, že alespoň jedna z operací $Insert$ nebo $Delete$ trvá $\Omega(n)$ pro $\infty \# n$
\end{thm}
\begin{proof}
  Zvolíme $n = 2^k - 1$, pak DVBVS jednoznačně určen. Provedeme $Insert(1)$ a $Delete(n+1)$, zase jednoznačně určen, ale sudá
  a lichá čísla se prohodila - to znamená alespoň $\Omega(n)$ změn ukazatelů.
\end{proof}

\begin{defi}[AVL stromy]
  Binární vyhledávací strom je \textit{hloubkově vyvážený}, neboli \textit{AVL}, pokud platí $\forall v \in V: \absolute{h(r(v)) - h(l(v))} \leq 1$
\end{defi}

\begin{thm}
  Hloubka AVL stromu o $n$ vrcholech je $\Theta(\log n)$
\end{thm}
\begin{proof}
  Počítáme $A_h \deq \min{\# v: h(v) = h}$. Dokážeme indukcí podle $h$, že $A_h \geq 2^{\frac{h}{2}}$:
  \begin{enumerate}
    \item $h = 0$
    $$ A_0 = 1 \geq 2^0$$
    \item $h = 1$
    $$ A_1 = 2 \geq 2^{\frac{1}{2}}$$
    \item $h = n$ víme, že splňuje $A_h = 1 + A_{h-1} + A_{h-2}$ - to jsou zase minimální stromy nižších stupňů.
    $$ A_n \geq A_{n-1} + A_{n-2} \stackrel{IP}{\geq} 2^{\frac{n-1}{2}} + 2^{\frac{n-2}{2}} \geq 2^{\frac{n}{2}}$$
  \end{enumerate}
  Tedy $A_h$ roste exponenciálně, a proto strom na $n$ vrcholech má hloubku $\leq \log_c n$ pro nějaké $c > 1$. Jinak by měl více než $n$ vrcholů.
  $\Rightarrow h \in \O{\log n}$

  Pro dolní odhad uvažujeme max. $\#$ vrcholů, to je určitě úplný strom, ten má hloubku logaritmickou.
\end{proof}

\begin{algo}[Vyvažování AVL stromu]
	Ukládáme si znaménko, pokud překročí $\pm 1$, zarotujeme.
\end{algo}

\begin{defi}[Rotace]
	Způsob vyvážení AVL stromu. Trigger pomocí signálu, může posílat signál dál. Odlišné významy při insertu a deletu
\end{defi}

\subsection{Vícecestné vyhledávací stromy}

\begin{defi}[Vícecestný vyhledávací strom]
	Zakořeněný, s interními i externími vrcholy, v každém vrcholu má alespoň jeden klíč.

	$\forall x_i$ klíč a $T_i$ podstrom: $\forall v \in V( T_i ): x_i < v < x_{i+1}$
\end{defi}

\begin{defi}[($a,b$)-strom]
	pro $a \geq 2, b \geq 2a-1$ je vícecestný vyhledávací strom, tž:
	\begin{enumerate}
		\item má všechny externí vrcholy na poslední hladině.
		\item $\forall v$ interní vrcholy: $a-1 \leq \# k(v) \leq b-1$.
		\item kořen má $2 \leq \# $ podstromů $v  \leq b$.
	\end{enumerate}
\end{defi}

\begin{lemma}
	$(a,b)$-strom s $n$ klíči má hloubku $\Theta(\log n)$
\end{lemma}

\begin{cor}[]\
	\begin{enumerate}
		\item Find: $\O 1$ na hladinu $\O{ \log n}$ celkem.
		\item Insert: vložíme na poslední vnitřní hladinu, ošetříme přetečení 
			\item Delete: převedeme na delete listu, řešíme podtečení: buď ukradneme, nebo slepíme
	\end{enumerate}	
\end{cor}

\begin{cor}[Vysvětlení minimálního požadavku pro $b$]
	Protože dochází ke štěpení, musí platit $\frac{b-1}{2} \geq a - 1$.
\end{cor}

\begin{defi}[LLRB strom]
	BVS s externími vrcholy a hranami obarvenými červeně a černě, tž.
	\begin{enumerate}
		\item Nejsou 2R hrany nad sebou
		 \item Pokud vede z vrcholu R hrana, tak doleva
		 \item Hrany do listů jsou B
		 \item Na všech cestách z kořene do listů je stejný počet B hran
	\end{enumerate}
\end{defi}

\begin{lemma}
	$\exists$ bijekce mezi $(2,4)$-stromy a LLRB stromy.
\end{lemma}

\begin{defi}[Operace na LLRB stromech]\
	\begin{enumerate}
		\item Rotace R hrany
		\item Přebarvení 4-ostrůvku
	\end{enumerate}
\end{defi}

\begin{lemma}
	Operace zachovávají B axiomy. Pomocí nich lze udělat insert, který zachovává i R axiomy.
\end{lemma}

\subsection{Trie}

\begin{defi}[Trie]
	\textit{Písmenkový strom}, neboli \textit{trie} je zakořeněný strom, který má v každém vrcholu
	až na kořen písmeno, značku a pole následníků indexované abecedou (ta je malá).
\end{defi}

\begin{thm}[Operace - pro $\Sigma \deq$ abeceda]\
	\begin{enumerate}
		\item Member v $\Theta(\absolute{y})$
		\item Insert a Delete v $\Theta(\absolute{\Sigma}\absolute{y})$
		\item paměť $\Theta(\absolute{\Sigma}\sum \absolute{x_i})$
	\end{enumerate}
Pro velkou abecedu nahradíme pole nějakou jinou strukturou, např. vyhledávacím stromem:
	\begin{enumerate}
		\item Member, Insert i Delete v $\Theta(\absolute{y}\log \absolute{\Sigma})$
		\item paměť $\Theta(\sum \absolute{x_i})$
	\end{enumerate}
\end{thm}

\begin{defi}[Číslicový strom]
	Ukládání čísel pomocí jejich zápisu v soustavě $z$. Časová složitost může být na konstanty 
	rychlejší než BVS: $\O {\log_z L}$
\end{defi}
% }}}

\section{Hešování} % {{{

\begin{defi}[Hešovací datové struktury]
	Ukládají prvky do přihrádek pomocí hešovací fce $h$, můžou nastávat kolize.

	Pro $n$ prvků a \(m\) přihrádek, kde \(m \in \Omega \left( n \right) \) jsou všechny 
	základní operace až konstantní.
\end{defi}

Empirická volba hešovací fce:
\begin{enumerate}
	\item \(x \to ax \mod m\) pro \(m\) prvočíslo a \(a\) nesoudělné s \(m\), optimální je 
		\(a \approx \frac{1}{\phi} m\)  
	\item Pro $\mathcal{U} = \left[ 2^{W} \right], m = 2^{k}: $
	\[
		x \to (ax \mod 2^{W}) >> w-k
	\]
	\item $x_0 \dots x_{d-1} \to \left( \sum a_i x_i \right) \mod m  $ pro $a_i$ parametry
	\item jako předchozí, kde $a_i = a ^{i}$
\end{enumerate}

\begin{defi}[Hustota / faktor naplnění]
	$\alpha \deq \frac{n}{m}$, chceme udržovat konstantní 
\end{defi}

Pokud $\alpha$ příliš vzroste, přehešujeme tabulku pro $m _{1} = cm$, např. pro $c \deq 2$. 
Ale přehešovat z $2 ^{i}$ do $2 ^{i+1}$ trvá až $\Theta \left( n + 2 ^{i+1} \right) = \Theta \left( n \right) $

\begin{defi}[Systém funkcí]
	$\mathcal{H}$ \textit{systém funkcí} z $\mathcal{U}$ do $\left[ m \right]$ je $c$-univerzální
	pro $c > 0 \equiv$ \[
		\forall x,y \in \mathcal{U}, x \neq y: P _{h \in \mathcal{H}} \left[ h(x) = h(y) \right] 
		\leq \frac{c}{m}
	\]
\end{defi}

\begin{lemma}
	Všechny výše uvedené systémy jsou $\mathcal{H}$
\end{lemma}

\begin{lemma}
	Nechť $\mathcal{H}$ je $c$-univerzální systém funkcí z $\mathcal{U}$, $x_1 \dots x_n \in \mathcal{U}$ navzájem různé, $y \in \mathcal{U}$. 

	Potom \[
		\mathbb{E}_{h \in \mathcal{H}} \! \left[ \#i: h(x_i) = h(y) \right] \leq c \frac{n}{m} + 1
	\]
	
\end{lemma}

\begin{cor}[]
	$\mathbb{E}$ časové složitosti operací Insert, Delete, Find je $\O{\frac{n}{m}}$, což umíme udržet $\O 1$ přehešováváním.
\end{cor}

\begin{defi}[Otevřená adresace]
	Způsob hešování, kdy v každé přihrádce může být max. jeden prvek. Kolize řešíme tak, že se zeptáme funkce na novou hodnotu. 

	Hešovací funkce, $h(x,i)$, tvoří \textit{vyhledávací posloupnost} pro každý prvek, což je podle $i$ permutace na $\arr m$.

	\begin{itemize}
		\item Insert běží dokud nenajde volnou přihrádku.
		\item Find se zastaví o první volnou přihrádku - neúspěch.
		\item Delete dělá pomníčky, aby se nerozbil Find ostatních prvků.
		\item Jednou za $n$ operací přebudujeme, abychom neměli hřbitov.
	\end{itemize}
\end{defi}

\begin{sexamp}[Otevřená adresace] \
	\begin{itemize} 
		\item Lineární přidávání: $h(x,i) = f(x)+i$
		\item Dvojité hešování: $h(x,i) = (f(x) + ig(x)) \text{ mod } m$
	\end{itemize}
\end{sexamp}

\begin{thm}[]
	Pokud vyhledávací posloupnosti jsou plně náhodné permutace, pak \[
		\mathbb{E} \! \left[ \# \text{ přihrádek navštívených při neúspěšném Findu} \right] \leq \frac{1}{1- \alpha} 
	\]
\end{thm}

% }}}

\section{Rozděl a panuj} % {{{

\begin{algo}[Mergesort]
	Třídí posloupnost v $\Theta \! \left( n \log n \right) $
\end{algo}

\begin{thm}[Paměť a čas Mergesortu]
	Paměť $\Theta \! \left( n \right)$ a čas $\Theta \! \left( n \log n \right)$
\end{thm}

\begin{thm}[Rychlé násobení]
	Rozdělení na 3 pomocí triku $(A+B)(C+D)$. 

	Vede na časovou složitost $ \O{n ^{\log_23}}$.
\end{thm}

\begin{defi}[Rekurze obecně]
	Celkový čas je \[
		T \! \left( n \right) = a T \! \left( \frac{n}{b} \right) + \Theta \! \left( n^{c} \right), T \! \left( 1 \right) = 1
	\]
\end{defi}

\begin{thm}[Kuchařka]
	\[
		T \! \left( n \right) = a T \! \left( \frac{n}{b} \right) + \Theta \! \left( n^{c} \right)
		 = n^c \sum_{i=1}^{\log_bn} \left( \frac{a}{b^c} \right) ^i
	\]
	Pro $q = \frac{a}{b^c}:$
	\begin{align}
		q = 1 & \Rightarrow T \! \left( n \right) = \Theta \! \left( n^c \log n \right) \\
		q < 1 & \Rightarrow T \! \left( n \right) = \Theta \! \left( n^c \right) \\
		q > 1 & \Rightarrow T \! \left( n \right) = \Theta \! \left( n^{\log_ba} \right)
	\end{align}
	Pokud $n \neq b^k$, pak definujeme $n^+, n^-$ jako nejbližší vyšší a nižší mocnina $b$. Pak $\frac{n}{b}$ zaokrouhlené kamkoliv je mezi $\left( \frac{n}{b} \right) ^-, 
	\left( \frac{n}{b} \right) ^+$. 

	Ale $n^-$ je asymptoticky stejné jako $n^+$. Proto musí být $T \! \left( n^- \right) \leq T \! \left( n \right) \leq T \! \left( n^+ \right)$ také asymptoticky stejné.
\end{thm}

\begin{algo}[Násobení matic - Strassenův algoritmus]
	Dělení matic na $\frac{n}{2} \times \frac{n}{2}$ bloky.

	Využívá blokové násobení:\[
		\begin{pmatrix} A & B \\ C & D \end{pmatrix} \times \begin{pmatrix} P & Q \\ R & S \end{pmatrix} = \begin{pmatrix} I & J \\ K & L \end{pmatrix} 
	\]
	\[
		I = AC+PR
	\]
	Strassenův trik: 7 násobení $\to \Theta \! \left( n^{\log_27} \right)$
	
\end{algo}

\begin{algo}[Selekce]
	Hledání $k$-tého nejmenšího prvku z $x_1 \dots x_n$.

	Při dělení na části a prohledávání jen té relevantní části je to $\Theta \! \left( n \right)$, pokud se části dostatečně rychle zmenšují. To závisí na volbě pivota.

	\begin{enumerate}
		\item $p = $ medián $\Rightarrow T \! \left( n \right) = T \! \left( \frac{n}{2} \right)+ \Theta \! \left( n \right) \to \Theta \! \left( n \right)$
		\item $p \in \left( x_{\frac{k}{4}}, x_{\frac{3}{4}k} \right) \Rightarrow T \! \left( n \right) = T \! \left( \frac{3}{4}n \right)+ \Theta \! \left( n \right) \to \Theta \! \left( n \right)$
		\item randomizace: $\E \left[ T \! \left( n \right) \right] = \Theta \! \left( n \right) \Leftrightarrow \E \left[ \# \text{ pokusů}  \right] = \Theta \! \left( 1 \right)$
			\[
				P \! \left[ \text{pokus uspěje}  \right] \geq \frac{1}{2} \stackrel{\text{ džbán } }{\implies} \E \left[ \# \text{ pokusů}  \right] \leq 2 
			\]

			Rozdělíme na fáze. Každá fáze končí výběrem skoromediánu. Fáze trvá průměrně až 2 pokusy, zmenší $n$ alespoň na $\frac{3}{4}$.

			Celkem vychází $\fce{\Theta}{n\sum_{i=0}^{n}  \left( \frac{3}{4} \right) ^i} = \fce{\Theta}{n}$
	\end{enumerate}
\end{algo}

\begin{thm}[Čas Selectu]
	Select má časovou složitost $\fce{\Theta}{n}$
\end{thm}

\begin{algo}[QuickSort]
	
\end{algo}

\begin{thm}[Čas QuickSortu]
	QuickSort s náhodnou volbou pivota má časovou složitost se střední hodnotou $\fce{\Theta}{n \log n}$
\end{thm}

% }}}

\section{Dynamické programování} % {{{

Máme systém podproblémů a závislosti mezi nimi, které tvoří DAG. Podprobémy procházíme v topologickém uspořádání (resp. opačným směrem).

\subsection{Editační vzdálenost} % {{{

\begin{defi}
	\textit{Editační vzdálenost} řetězců $\alpha, \beta$ je $\fce{L}{\alpha, \beta} \deq $ min. délka operací, které z $\alpha$ udělá $\beta$.
\end{defi}

\begin{defi}[]
	\textit{Editační operace} je smazání, vložení nebo změna znaku v řetězci.
\end{defi}

\begin{algo}[Edit]\
	\textit{Vstup:} Indexy začátků $i,j$

	\textit{Výstup:} $\fce{L}{\alpha_i \dots \alpha_n, \beta_j \dots \beta_m}$
\end{algo}

% }}}

% }}}


\end{document                </a></li>

            </li>
